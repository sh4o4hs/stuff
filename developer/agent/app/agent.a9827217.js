import{i as A,s as e,a,b as l,c as o,G as t,o as n,M as s}from"./agent.19cb3885.js";import"mithril";import"localforage";import"nuts";async function g(){let g,i=o,r=a,m=t,h=globalThis.location.search.substring(1),u=null,c={module:A=>r.module=A,lang:A=>r.langID=A,launch:A=>r.launch=A,res:A=>r.res=A,logo:A=>{A.indexOf("//")>=0?r.logo=A:r.logo="data/img/"+A},agent:A=>{"megahot"===A?r.agent="bg":"jigtp"===A?r.agent="tp":"gatest"===A?r.agent="bg":"aekvnd01"===A?r.agent="ae":"kingco"===A?r.agent="kc":"wnd"===A&&(r.agent="wd")},hostname:A=>i.host=A,key:A=>i.key=A,group:A=>i.group=A,game:A=>i.game=A,room:A=>i.room=A,currency:A=>i.currency=A,mode:A=>i.mode=A,namespace:A=>i.namespace=A,tablekey:A=>i.tablekey=A,menu:A=>r.menu=A,options:A=>u=A,lobbyName:A=>r.lobbyName=A,mobileMode:A=>r.mobileMode=A,ping:()=>r.ping=!0,version:A=>r.version=A};if(g=h.split("&",25),g.forEach((A=>{let e=A.split("=",2),a=c[e[0]];a&&a(e[1])})),r.launch&&r.launch.length>0&&(i.game=r.launch),r.menu&&r.menu.length>0){let A=[];for(let e=0;e<r.menu.length;e+=1)A[e]=parseInt(r.menu[e]);r.menu=A}let b=n;if(u&&u.length>0){r.useOptions=!0;for(let A=0;A<u.length;A+=1)b[A]=parseInt(u[A])}i.host&&0===i.host.length&&(i.host=null),i.host||(i.host=globalThis.location.hostname+":"+globalThis.location.port),l&&(i.key||(i.key="a1")),(!i.mode||i.mode.length<=1)&&(i.mode=m.REAL);let f=i.info;if(f.token=i.key,i.tablekey&&(f.tablekey=i.tablekey),r.langID=A[r.langID],r.langID||(r.langID="en-us"),e(r.langID),r.module)if(0===r.module.length)r.module=null;else{let A=s,e=r.module[A.PROTOCOL];"p"===e?i.protocol="protobuf":"a"===e&&(i.protocol="avro"),e=r.module[A.GAME_FORMAT],i.gameFormat="gti","g"===e?i.gameFormat="gti":"v"===e&&(i.gameFormat="video")}return new Promise((A=>{a.useAvif=!1;let e=new Image;e.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=",e.onload=()=>{a.useAvif=!0,A()},e.onerror=()=>{A()}}))}async function i(){if(globalThis.BASE_URL)return new Promise((A=>{let e=!1;a.cdnList=[],a.hasCDN=!1,a.selectCDN=!1;let l=[];if(Array.isArray(globalThis.DISABLE_AUTO_CDN))l=globalThis.DISABLE_AUTO_CDN;else if(globalThis.DISABLE_AUTO_CDN)return;let o=globalThis.BASE_URL.indexOf("/",9),t=globalThis.BASE_URL.substring(o+1);function n(A){a.cdnList.push(A),a.hasCDN||(a.hasCDN=!0)}setTimeout((function(){A(),e=!0}),500),function(){let o=[];globalThis.CDN_LIST&&Array.isArray(globalThis.CDN_LIST)&&globalThis.CDN_LIST.forEach((A=>{if(A&&A.url){let e=A.url;e.lastIndexOf(".jpg")<0&&(A.target=`${e}${t}`,A.url=`${e}webedit/it.jpg`),a.isReload?A.target!==globalThis.BASE_URL&&o.push(A):o.push(A)}})),0===o.length&&(o=[]);let s=0,g=0,i=0;o.forEach(((o,t)=>{if(l[t])return;let r=Math.round(performance.now()),m=o.url;s+=1,fetch(m,{credentials:"omit"}).then((A=>A.ok?A.arrayBuffer():null)).then((l=>{if(!e)if(l){if(r=Math.round(performance.now()-r),i>=8)return void A();a.isReload?o.target!==globalThis.BASE_URL&&(n(o),i+=1):(n(o),i+=1),g+=1,g>=s&&A()}else g+=1,g>=s&&A()})).catch((e=>{g+=1,g>=s&&A()}))})),0===s&&A()}()}))}export{i as checkCDN,g as start};
