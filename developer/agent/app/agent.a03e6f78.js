import{r as e,i as t,s as i,o as n,O as s,b as a,G as r,a as o,c as l,d as c,T as h,e as g,f as u}from"./agent.e254a991.js";import d from"mithril";import*as m from"nuts";import{g as p,a as f,I as b,b as w}from"./agent.00d1e5bf.js";import y from"localforage";let v=!1;function x(){return v}let L="title";function C(){return L}let T="message";function E(){return T}function k(e){L=e.title,T=e.msg,v=!0,d.redraw()}function R(){v=!1,d.redraw()}var O=Object.freeze({__proto__:null,getMessage:E,getTitle:C,hide:R,isVisible:x,show:k});let I=null,$={oninit(e){let t=e.attrs;this.style=t.style,this.complete=t.complete,this.logo=null},async oncreate(e){let t=this,i=e.attrs,n=e.dom,s=i.url,a=await fetch(s);if(a&&a.ok){let e=await a.blob();const i=URL.createObjectURL(e);n.src=i,d.redraw(),t.complete&&t.complete()}},view(){return d("img",{style:this.style})}},U={timeBase:1,oninit(e){let t=e.attrs;this.class=t.class||"ba b--light-blue animate__animated animate__bounceIn",this.style=t.style||{left:"0%",top:"0%",width:"100%",height:"100%"},this.info=t.info,this.serve=t.serve,this.config=t.config||{width:300,height:200,resolution:1,antialias:!1,transparent:!0},this.id=t.id,this.group=t.group,this.title=t.title||"標題",this.logo=t.logo,this.game=null,this.eventClass={current:"ba b--dotted bw1 white-50",onmouseenter:"ba b--dotted bw2 white-50",onmouseleave:"ba b--dotted bw1 white-50"}},onbeforeremove(e){let t=this;return t.game&&t.game.pause(),["animate__animated","animate__lightSpeedOut"].forEach((t=>{e.dom.classList.add(t)})),new Promise((e=>{m.updateManager.setTimeout(e,.4)}))},view(){let t=this,i=t.eventClass;return d(".",{class:t.class,style:t.style},[d(".game-card-title",t.title),d($,{class:"game-card-view ba b--light-gray",style:{zValue:0,position:"absolute",left:"0%",top:"0%",width:"100%",height:"100%"},url:t.logo,complete(){}}),d(".",{onclick(){globalThis.Howl&&(I||(I=new globalThis.Howl({src:["data/f82550ea2e80cd97.wav"]}),I.volume(.01)),I.play()),ri(!1),_t({serve:t.serve,id:t.id,group:t.group})},onmouseenter(){i.current=i.onmouseenter,d.redraw()},onmouseleave(){i.current=i.onmouseleave,d.redraw()},class:i.current,style:{position:"absolute",left:"10%",top:"10%",width:"80%",height:"75%"}}),d(".game-card-download",{onclick(){k({yesno:!1,title:"connecting",msg:"disconnect"})}},[d.trust(`<div class="no-underline near-white bg-animate bg-near-black hover-bg-gray inline-flex items-center ma2 tc br2 pa2">\n    <svg fill="#77ff77" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">\n    <path d="M19 8l-4 4h3c0 3.31-2.69 6-6 6-1.01 0-1.97-.25-2.8-.7l-1.46 1.46C8.97 19.54 10.43 20 12 20c4.42 0 8-3.58 8-8h3l-4-4zM6 12c0-3.31 2.69-6 6-6 1.01 0 1.97.25 2.8.7l1.46-1.46C15.03 4.46 13.57 4 12 4c-4.42 0-8 3.58-8 8H1l4 4 4-4H6z"/>\n    <path d="M0 0h24v24H0z" fill="none"/>\n</svg>\n    <span class="f6 ml3 pr2">${p("download")}</span>\n  </div>`)]),d(".game-card-stop",{onclick(){e.getIP().then((e=>{}))}},[d.trust(`<div class="no-underline near-white bg-animate bg-near-black hover-bg-gray inline-flex items-center ma2 tc br2 pa2">\n    <svg fill="#77ff77" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">\n    <path d="M0 0h24v24H0z" fill="none"/>\n    <path d="M14.59 8L12 10.59 9.41 8 8 9.41 10.59 12 8 14.59 9.41 16 12 13.41 14.59 16 16 14.59 13.41 12 16 9.41 14.59 8zM12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"/>\n</svg>\n    <span class="f6 ml3 pr2">${p("stop")}</span>\n  </div>`)])])}},M={left:"0px",top:"0px",width:"300px",height:"200px"},_={},P={},A=null;function F(e){return _[e]||(_[e]={}),P=_[e],P}function B(e,t,a,r){let o={};function l(){let e=i.registration;e&&e.active&&navigator.serviceWorker.controller?navigator.serviceWorker.controller.postMessage(o):m.updateManager.setTimeout(l,.05)}if(!i.versionTimestamp){let e=new Date;i.versionTimestamp=e.getTime()}let c=i.versionTimestamp,h=!1,g=null;return g=new Promise((g=>{if(!e||!t)return void g(null);function u(){let r=`config/${t}/${e}/gamecard.txt?v=${c}`,u=`config/${t}/${e}/cache.txt`;if(a){let i=a;"/"===i[i.length-1]&&(i=i.substring(0,i.length-1)),r=`${i}/config/${t}/${e}/gamecard.txt?v=${c}`,u=`${i}/config/${t}/${e}/cache.txt`}else r=`config/${t}/${e}/gamecard.txt?v=${c}`,u=`config/${t}/${e}/cache.txt`;o.cacheName=`${t}${e}`,o.url=u,i.useCache&&l(),fetch(r,{headers:{"Content-Type":"text/plain"}}).then((e=>e.ok?e.text():null)).then((e=>{if(!e)return;let t={},r=new String(e),o=r.indexOf("{");if(o>=0&&o<=9){let e=JSON.parse(r);if(!e.options||!e.options.overview){let e=s;i.useOptions||(n[e.OVERVIEW_LOGO]=1,n[e.OVERVIEW_ANIMATION]=0,n[e.OVERVIEW_BACKGROUND]=0,n[e.OVERVIEW_PROGRESS]=1)}if(e.templateVersion="slot.2.1",t.gameCard=e,a){let e=a;"/"===e[e.length-1]&&(e=e.substring(0,e.length-1)),t.gameCard.baseURL=`${e}/`}h=!0,g(t)}})).catch((e=>{}))}let d,m;if(a){let i=a;"/"===i[i.length-1]&&(i=i.substring(0,i.length-1)),r?d=`${i}/${t}/${e}/config/v${r}.txt`:(d=`${i}/${t}/${e}/config/gamecard.txt?v=${c}`,m=`${i}/${t}/${e}/config/cache.txt`)}else r?d=`${i.projectURL}${t}/${e}/config/v${r}.txt`:(d=`${i.projectURL}${t}/${e}/config/gamecard.txt?v=${c}`,m=`${i.projectURL}${t}/${e}/config/cache.txt`);o.cacheName=`${t}${e}`,o.url=m,i.useCache&&l(),fetch(d,{headers:{"Content-Type":"text/plain"}}).then((e=>e.ok?e.text():(u(),null))).then((e=>{if(!e)return;let t={},n=new String(e),s=n.indexOf("{");if(s>=0&&s<=9){if(t.gameCard=JSON.parse(n),a)if(t.gameCard.baseURL){let e=a;"/"===e[e.length-1]&&(e=e.substring(0,e.length-1)),t.gameCard.baseURL=e+t.gameCard.baseURL.replace(i.projectURL,"/")}else t.gameCard.baseURL=a;else{let e=globalThis.location.origin;t.gameCard.baseURL?t.gameCard.baseURL.indexOf("://")<0&&(t.gameCard.baseURL=e+t.gameCard.baseURL):t.gameCard.baseURL=globalThis.location.origin+"/"}h=!0,g(t)}if(h)return!0;u()})).catch((()=>{u()}))})),g}function N(e,i,n){let s=Date.now(),a="";t&&(a="test/data/gameList.txt?v="+s),i[e]=[],n[e]=0;let r=0;d.request(a).then((t=>{i[e]=t||[],t.forEach((e=>{if(!e)return;e.isSub&&(r+=1);let t=F(e.group);if(globalThis.BASE_URL)if(e.baseURL){let t=globalThis.BASE_URL;"/"===t[t.length-1]&&(t=t.substring(0,t.length-1)),e.baseURL=t+e.baseURL}else e.baseURL=globalThis.BASE_URL;else{let t=globalThis.location.origin;e.baseURL?e.baseURL=t+e.baseURL:e.baseURL=globalThis.location.origin+"/"}t[e.id]=e})),n[e]=t.length-r}))}function S(e){const i=e.key||e.code;if(t)switch(i){case"r":case"R":if(A){globalThis.scene[A.id].reload({game:A.appConfig,group:A.group,id:A.id,tablekey:"abcd1234"})}}}function z(e){e.key||e.code}let H={oninit(){let e={},i={};t?N("test",e,i):(N("slot",e,i),N("video",e,i),N("game",e,i)),this.group=e,this.displayCount=i,globalThis.addEventListener("keydown",S),globalThis.addEventListener("keyup",z)},view(){let e=this;return t?d(".gameCardList",{style:{left:"0%",top:"0%",width:"100%",height:"100%"}},d(".",{style:{position:"absolute",left:"0%",top:"40%",width:"100%",height:"25%"}},"group zzzz",d(".layout",{style:{left:"0%",marginTop:"0px",width:25*e.displayCount.game+"%",height:"100%"}},e.group.test?e.group.test.map((e=>{if(!e||e.isSub)return d(".");let t=e.baseURL||"",n=e.images;return i.useAvif?n.v2&&(n=n.v2):n.v1&&(n=n.v1),d(".",{style:M},[d(U,{id:e.id,group:e.group,serve:{game:e.id,group:e.group},logo:t+n.logo,title:`${e.name[f()]}(${e.appConfig})`})])})):d(".")))):d(".gameCardList",{style:{left:"0%",top:"0%",width:"100%",height:"100%"}},d(".",{style:{position:"absolute",left:"0%",top:"65%",width:"100%",height:"25%",overflowX:"scroll"}},"group game",d(".layout",{style:{left:"0%",marginTop:"0px",width:25*e.displayCount.game+"%",height:"100%"}},e.group.game.map((e=>{if(!e||e.isSub)return d(".");let t=e.baseURL||"";return d(".",{style:{left:"0%",top:"0%",width:"90%",height:"100%"}},d(U,{id:e.id,group:"game",serve:{game:e.id,group:"game"},logo:t+e.images.logo,title:e.name[f()]}))})))),d(".",{style:{position:"absolute",left:"0%",top:"5%",width:"100%",height:"25%",overflowX:"scroll"}},"group slot",d(".layout",{style:{left:"0%",marginTop:"0px",width:25*e.displayCount.slot+"%",height:"100%"}},e.group.slot.map((e=>{if(!e&&e.isSub)return d(".");let t=e.baseURL||"";return d(".",{style:{left:"0%",top:"0%",width:"100%",height:"100%"}},[d(U,{id:e.id,group:"slot",serve:{game:e.id,group:"slot"},logo:t+e.images.logo,title:e.name[f()]})])})))),d(".",{style:{position:"absolute",left:"0%",top:"35%",width:"100%",height:"25%",overflowX:"scroll"}},"group video",d(".layout",{style:{left:"0%",marginTop:"0px",width:25*e.displayCount.video+"%",height:"100%"}},e.group.video.map((e=>{if(!e||e.isSub)return d(".");let t=e.baseURL||"";return d(".",{style:{left:"0%",top:"0%",width:"100%",height:"80%"}},[d(U,{id:e.id,group:"video",serve:{game:e.id,group:"video"},logo:t+e.images.logo,title:e.name[f()]})])})))))}},V={Android:()=>navigator.userAgent.match(/Android/i),BlackBerry:()=>navigator.userAgent.match(/BlackBerry/i),iOS:()=>navigator.userAgent.match(/iPhone|iPad|iPod/i),Opera:()=>navigator.userAgent.match(/Opera Mini/i),Windows:()=>navigator.userAgent.match(/IEMobile/i),any:()=>V.Android()||V.BlackBerry()||V.iOS()||V.Opera()||V.Windows()},j=null;function D(e){j=e}function W(e){j&&j.fix&&(globalThis.innerHeight>=e.screenHeight-j.fix.height?e.isFullscreen=!0:e.isFullscreen=!1)}let G={name:"chrome",0:{offset:{x:0,y:0,width:0,height:0},fix:{height:68}},90:{offset:{x:0,y:0,width:0,height:0},fix:{height:28}},"-90":{offset:{x:0,y:0,width:0,height:0},fix:{height:28}},270:{offset:{x:0,y:0,width:0,height:0},fix:{height:28}},180:{offset:{x:0,y:0,width:0,height:0},fix:{height:68}}};var Y=Object.freeze({__proto__:null,checkFullscreen:function(e){W(e)},getCurrentValue:function(){return j},setCurrentValue:function(e){D(G[e])},value:G});let q={name:"firefox",0:{offset:0,fix:{height:26}},90:{offset:0,fix:{height:26}},"-90":{offset:0,fix:{height:26}},270:{offset:0,fix:{height:26}},180:{offset:0,fix:{height:26}}};var X=Object.freeze({__proto__:null,checkFullscreen:function(e){W(e)},getCurrentValue:function(){return j},setCurrentValue:function(e){D(q[e])},value:q});let K={name:"opera",0:{offset:0,fix:{height:114}},90:{offset:0,fix:{height:72}},"-90":{offset:0,fix:{height:72}},270:{offset:0,fix:{height:72}},180:{offset:0,fix:{height:114}}};var J=Object.freeze({__proto__:null,checkFullscreen:function(e){W(e)},getCurrentValue:function(){return j},setCurrentValue:function(e){D(K[e])},value:K});let Q={name:"uc",0:{offset:0,fix:{height:0}},90:{offset:0,fix:{height:0}},"-90":{offset:0,fix:{height:0}},270:{offset:0,fix:{height:0}},180:{offset:0,fix:{height:0}}};var Z=Object.freeze({__proto__:null,checkFullscreen:function(e){W(e)},getCurrentValue:function(){return j},setCurrentValue:function(e){D(Q[e])},value:Q});let ee={name:"baidu",0:{offset:{x:0,y:0,width:0,height:0},fix:{height:87}},90:{offset:0,fix:{height:87}},"-90":{offset:0,fix:{height:87}},270:{offset:0,fix:{height:87}},180:{offset:0,fix:{height:87}}};var te=Object.freeze({__proto__:null,checkFullscreen:function(e){W(e)},getCurrentValue:function(){return j},setCurrentValue:function(e){D(ee[e])},value:ee});let ie={name:"lieao",0:{offset:{x:0,y:0,width:0,height:0},fix:{height:0}},90:{offset:0,fix:{height:0}},"-90":{offset:0,fix:{height:0}},270:{offset:0,fix:{height:0}},180:{offset:0,fix:{height:0}}};var ne=Object.freeze({__proto__:null,checkFullscreen:function(e){W(e)},getCurrentValue:function(){return j},setCurrentValue:function(e){D(ie[e])},value:ie});let se={name:"unknown",0:{offset:{x:0,y:0,width:0,height:0},fix:{height:0}},90:{offset:0,fix:{height:0}},"-90":{offset:0,fix:{height:0}},270:{offset:0,fix:{height:0}},180:{offset:0,fix:{height:0}}};var ae=Object.freeze({__proto__:null,checkFullscreen:function(e){W(e)},getCurrentValue:function(){return j},setCurrentValue:function(e){D(se[e])},value:se});let re={name:"chrome",0:{offset:{x:0,y:0,width:0,height:4},fix:{height:24}},90:{offset:{x:0,y:0,width:0,height:4},fix:{height:24}},"-90":{offset:{x:0,y:0,width:0,height:4},fix:{height:24}},180:{offset:{x:0,y:0,width:0,height:4},fix:{height:24}}},oe=null;var le=Object.freeze({__proto__:null,checkFullscreen:function(e){oe&&oe.fix&&(globalThis.innerHeight>=e.screenHeight-oe.fix.height?e.isFullscreen=!0:e.isFullscreen=!1)},eventOrientation:function(e){let t=re.state;switch(oe=re[e],D(oe),e){case 0:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!0,t.isLandscape=!1),t.screenHeight=screen.height,t.screenWidth=screen.width;break;case-90:case 90:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!1,t.isLandscape=!0),screen.width<screen.height?(t.screenHeight=screen.width,t.screenWidth=screen.height):(t.screenHeight=screen.height,t.screenWidth=screen.width);break;case 180:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!0,t.isLandscape=!1),t.screenHeight=screen.height,t.screenWidth=screen.width}},getCurrentValue:function(){return j},value:re});let ce={name:"firefox",0:{offset:{x:0,y:0,width:0,height:4},fix:{height:40}},90:{offset:{x:0,y:0,width:0,height:4},fix:{height:8}},"-90":{offset:{x:0,y:0,width:0,height:4},fix:{height:8}},180:{offset:{x:0,y:0,width:0,height:4},fix:{height:40}}},he=null;var ge=Object.freeze({__proto__:null,checkFullscreen:function(e){he&&he.fix&&(globalThis.innerHeight>=e.screenHeight-he.fix.height?e.isFullscreen=!0:e.isFullscreen=!1)},eventOrientation:function(e){let t=ce.state;switch(he=ce[e],D(he),e){case 0:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!0,t.isLandscape=!1),t.screenHeight=screen.height,t.screenWidth=screen.width;break;case-90:case 90:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!1,t.isLandscape=!0),screen.width<screen.height?(t.screenHeight=screen.width,t.screenWidth=screen.height):(t.screenHeight=screen.height,t.screenWidth=screen.width);break;case 180:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!0,t.isLandscape=!1),t.screenHeight=screen.height,t.screenWidth=screen.width}globalThis.outerWidth<globalThis.innerWidth&&(globalThis.outerWidth=globalThis.innerWidth),globalThis.outerHeight<globalThis.innerHeight&&(globalThis.outerHeight=globalThis.innerHeight)},getCurrentValue:function(){return j},value:ce});let ue={name:"uc",0:{offset:{x:0,y:0,width:0,height:4},fix:{height:82}},90:{offset:{x:0,y:0,width:0,height:4},fix:{height:100}},"-90":{offset:{x:0,y:0,width:0,height:4},fix:{height:100}},180:{offset:{x:0,y:0,width:0,height:4},fix:{height:82}}},de=null;var me=Object.freeze({__proto__:null,checkFullscreen:function(e){e.isFullscreen=!0},eventOrientation:function(e){let t=ue.state;switch(de=ue[e],D(de),e){case 0:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!0,t.isLandscape=!1),t.screenHeight=screen.height,t.screenWidth=screen.width;break;case-90:case 90:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!1,t.isLandscape=!0),screen.width<screen.height?(t.screenHeight=screen.width,t.screenWidth=screen.height):(t.screenHeight=screen.height,t.screenWidth=screen.width);break;case 180:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!0,t.isLandscape=!1),t.screenHeight=screen.height,t.screenWidth=screen.width}},getCurrentValue:function(){return j},value:ue});let pe={name:"safari",0:{offset:{x:0,y:0,width:0,height:4},fix:{height:32}},90:{offset:{x:0,y:0,width:0,height:4},fix:{height:16}},"-90":{offset:{x:0,y:0,width:0,height:4},fix:{height:16}},180:{offset:{x:0,y:0,width:0,height:4},fix:{height:32}}},fe=null;var be=Object.freeze({__proto__:null,checkFullscreen:function(e){fe&&fe.fix&&(globalThis.innerHeight>=e.screenHeight-fe.fix.height?e.isFullscreen=!0:e.isFullscreen=!1)},eventOrientation:function(e){let t=pe.state;switch(fe=pe[e],D(fe),e){case 0:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!0,t.isLandscape=!1),t.screenHeight=screen.height,t.screenWidth=screen.width;break;case-90:case 90:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!1,t.isLandscape=!0),screen.width<screen.height?(t.screenHeight=screen.width,t.screenWidth=screen.height):(t.screenHeight=screen.height,t.screenWidth=screen.width);break;case 180:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!0,t.isLandscape=!1),t.screenHeight=screen.height,t.screenWidth=screen.width}},getCurrentValue:function(){return j},value:pe});let we={name:"baidu",0:{offset:{x:0,y:0,width:0,height:4},fix:{height:0}},90:{offset:{x:0,y:0,width:0,height:4},fix:{height:0}},"-90":{offset:{x:0,y:0,width:0,height:4},fix:{height:0}},180:{offset:{x:0,y:0,width:0,height:4},fix:{height:0}}},ye=null;var ve=Object.freeze({__proto__:null,checkFullscreen:function(e){ye&&ye.fix&&(globalThis.innerHeight>=e.screenHeight-ye.fix.height?e.isFullscreen=!0:e.isFullscreen=!1)},eventOrientation:function(e){let t=we.state;switch(ye=we[e],D(ye),e){case 0:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!0,t.isLandscape=!1),t.screenHeight=screen.height,t.screenWidth=screen.width;break;case-90:case 90:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!1,t.isLandscape=!0),screen.width<screen.height?(t.screenHeight=screen.width,t.screenWidth=screen.height):(t.screenHeight=screen.height,t.screenWidth=screen.width);break;case 180:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!0,t.isLandscape=!1),t.screenHeight=screen.height,t.screenWidth=screen.width}},getCurrentValue:function(){return j},value:we});let xe={name:"liebao",0:{offset:{x:0,y:0,width:0,height:4},fix:{height:24}},90:{offset:{x:0,y:0,width:0,height:4},fix:{height:24}},"-90":{offset:{x:0,y:0,width:0,height:4},fix:{height:24}},180:{offset:{x:0,y:0,width:0,height:4},fix:{height:24}}},Le=null;var Ce=Object.freeze({__proto__:null,checkFullscreen:function(e){Le&&Le.fix&&(globalThis.innerHeight>=e.screenHeight-Le.fix.height?e.isFullscreen=!0:e.isFullscreen=!1)},eventOrientation:function(e){let t=xe.state;switch(Le=xe[e],D(Le),e){case 0:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!0,t.isLandscape=!1),t.screenHeight=screen.height,t.screenWidth=screen.width;break;case-90:case 90:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!1,t.isLandscape=!0),screen.width<screen.height?(t.screenHeight=screen.width,t.screenWidth=screen.height):(t.screenHeight=screen.height,t.screenWidth=screen.width);break;case 180:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!0,t.isLandscape=!1),t.screenHeight=screen.height,t.screenWidth=screen.width}},getCurrentValue:function(){return j},value:xe});let Te={name:"unknown",0:{offset:{x:0,y:0,width:0,height:4},fix:{height:0}},90:{offset:{x:0,y:0,width:0,height:4},fix:{height:0}},"-90":{offset:{x:0,y:0,width:0,height:4},fix:{height:0}},180:{offset:{x:0,y:0,width:0,height:4},fix:{height:0}}},Ee=null;var ke=Object.freeze({__proto__:null,checkFullscreen:function(e){Ee&&Ee.fix&&(globalThis.innerHeight>=e.screenHeight-Ee.fix.height?e.isFullscreen=!0:e.isFullscreen=!1),e.isFullscreen=!0},eventOrientation:function(e){let t=Te.state;switch(Ee=Te[e],D(Ee),e){case 0:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!0,t.isLandscape=!1),t.screenHeight=screen.height,t.screenWidth=screen.width;break;case-90:case 90:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!1,t.isLandscape=!0),screen.width<screen.height?(t.screenHeight=screen.width,t.screenWidth=screen.height):(t.screenHeight=screen.height,t.screenWidth=screen.width);break;case 180:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!0,t.isLandscape=!1),t.screenHeight=screen.height,t.screenWidth=screen.width}},getCurrentValue:function(){return j},value:Te});function Re(e){let t=!1;return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement?(t=!0,e&&(e.isFullscreen=!0)):(t=!1,e&&(e.isFullscreen=!1)),t}async function Oe(e){if(!document.fullscreenEnabled)return Promise.reject();let t=!1;document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement?(e&&(e.isFullscreen=!1),document.exitFullscreen?(await document.exitFullscreen(),t=!0):document.msExitFullscreen?(await document.msExitFullscreen(),t=!0):document.mozCancelFullScreen?(await document.mozCancelFullScreen(),t=!0):document.webkitExitFullscreen&&(await document.webkitExitFullscreen(),t=!0),t&&e&&(e.isFullscreen=!1)):(document.documentElement.requestFullscreen?(await document.documentElement.requestFullscreen(),t=!0):document.documentElement.msRequestFullscreen?(await document.documentElement.msRequestFullscreen(),t=!0):document.documentElement.mozRequestFullScreen?(await document.documentElement.mozRequestFullScreen(),t=!0):document.documentElement.webkitRequestFullscreen&&(await document.documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT),t=!0),t&&(e&&(e.isFullscreen=!0),Ae.useOrientation&&globalThis.screen&&globalThis.screen.orientation&&globalThis.screen.orientation.lock&&await globalThis.screen.orientation.lock(Ae.orientation.name)))}let Ie=!0,$e=!1;let Ue={oninit(e){let t=this,i=e.attrs;t.onclick=i.onclick,t.style=i.style,t.config=i.config},onbeforeremove(){},view(){let e=this,t=e.config;return d(".pointer",{style:{width:"4%",height:"10%",borderRadius:"4px 8px 8px 4px",backgroundColor:"#000",opacity:.6,position:"absolute",left:e.style.left,top:e.style.top,zIndex:900},onclick(){t&&(t.isMenu=!0,t.visible=!1),e.onclick&&e.onclick()}},d.trust('<img src="data/sys/4021bb29611b24c4.svg" class="w-100 h-100 dropshadow">'))}},Me={oninit(e){let t=e.attrs,i=this;i.event=t.event,i.tray=t.tray,i.info=t.info,i.config=t.config,i.isLeave=!1,i.config||(i.config={isMenu:$e,visible:Ie,flags:{fullscreen:!0,lock:!0,sound:!0,music:!0}}),i.config.flags||(i.config.flags={}),i.info||(i.info={logo:"logo.png",gameName:"test game",version:"0.0.0",mode:" test mode",token:"token"}),i.tray||(i.tray={state:{visible:!0},sound:{isMute:!1},music:{isMute:!1},screen:{isAutoScale:!0,isLock:!1},isLock:!1,isFullscreen:!1},Object.defineProperty(i.tray,"visible",{get:()=>i.tray.state.visible,set(e){i.tray.state.visible=e}}))},onbeforeremove:e=>(["animate__fadeOutLeft","animate__animated"].forEach((t=>{e.dom.classList.add(t)})),new Promise((e=>{m.updateManager.setTimeout((()=>{e()}),.4)}))),onremove(){},view(){let e=this,t=e.tray,n=e.event,s=e.info,a=e.config,r=a.flags,o=i.menu||[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0];return d(".animate__fadeInLeft animate__animated",{onclick(){e.isLeave?(a.isMenu=!1,a.visible=!1,t.visible=!1):(a.visible=!1,t.visible=!0)},style:{zIndex:900,position:"absolute",left:"0%",top:"0%",width:"100%",height:"100%"}},d(".pv2.ph2.bg-black.[id='panel']",[d(".fl.bb.b--gray.mb2.dib.pb2.mb2.w-100.rwdPanelHeader",[d("table.pa2.ml4.dib.br2.bg-black.white.rwdAppInfo",d("tbody.rwd-lh",[d("tr",[d("td",p("gameName")),d("td"," : "),d("td.blue",s.gameName)]),d("tr",[d("td",p("version")),d("td"," : "),d("td.blue",s.version)]),o[8]?d("tr",[d("td",p("gameMode")),d("td"," : "),d("td.blue",s.mode)]):null]))]),o[0]&&r.fullscreen&&!Ae.ios?d(".",[d(".fl.w-70.pa1.ma1.rwdOpt",d(".no-underline.near-white.inline-flex",[d("img.dib.fl.mv1.rwdOptIcon.dropshadow",{alt:"FULL SCREEN",src:"data/sys/f512613ddcb62054.png"}),d(".ml3.white.mv3.f4.rwdPanelFont",p("fullscreen"))])),d(".fr.w-20.pt2.mv2.mr2.rwdToggle",{onclick(){t.isFullscreen=!t.isFullscreen,d.redraw(),Oe(t).then((()=>{n&&n.fullscreen&&n.fullscreen(t.isFullscreen)}))}},d("label.switch",[d("input[name='toggle'][type='checkbox'][value='fullscreen']",{disabled:!0,checked:t.isFullscreen}),d("span.slider.round")]))]):d("."),o[1]&&r.lock?d(".",[d(".fl.w-70.pa1.ma1.rwdOpt",d(".no-underline.near-white.inline-flex",[d("img.dib.fl.mv1.rwdOptIcon.dropshadow",{alt:"LOCK SCALE",src:"data/sys/8920df5ffd5c25b0.png"}),d(".ml3.white.mv3.f4.rwdPanelFont",p("lock"))])),d(".fr.w-20.pt2.mv2.mr2.rwdToggle",{onclick(){t.isLock=!t.isLock,t.update&&t.update(t),d.redraw(),n&&n.lock&&n.lock(t.isLock)}},d("label.switch",[d("input[name='toggle'][type='checkbox'][value='lock']",{disabled:!0,checked:t.isLock}),d("span.slider.round")]))]):d("."),o[2]&&r.music?d(".",[d(".fl.w-70.pa1.ma1.rwdOpt",d(".no-underline.near-white.inline-flex",[d("img.h-100.dib.fl.mv1.rwdOptIcon.dropshadow[alt='MUSIC'][src='data/sys/ddb7103e5eca70e6.png']"),d(".ml3.white.mv3.f4.rwdPanelFont",p("music"))])),d(".fr.w-20.pt2.mv2.mr2.rwdToggle",{onclick(){t.music.isMute=!t.music.isMute,d.redraw(),n&&n.music&&n.music(t.music)}},d("label.switch",[d("input[name='toggle'][type='checkbox'][value='music']",{disabled:!0,checked:!t.music.isMute}),d("span.slider.round")]))]):d("."),o[3]&&r.sound?d(".",[d(".fl.w-70.pa1.ma1.rwdOpt",d(".no-underline.near-white.inline-flex",[d("img.dib.fl.mv1.rwdOptIcon.dropshadow[alt='SOUND'][src='data/sys/ddb7103e5eca70e6.png']"),d(".ml3.white.mv3.f4.rwdPanelFont",p("sound"))])),d(".fr.w-20.pt2.mv2.mr2.rwdToggle",d("label.switch",[d("input[name='toggle'][type='checkbox'][value='sound']",{checked:!t.sound.isMute,onclick(){t.sound.isMute=!t.sound.isMute,n&&n.sound&&n.sound(t.sound)}}),d("span.slider.round")]))]):d("."),o[4]?d(".fl.w-100.pa2.pt3.bt.b--gray.mt2.rwdBtn",{onclick(){Ae.useFocus=!0}},d(".w-100 no-underline near-white bg-animate bg-near-black hover-bg-gray inline-flex items-center ma1 tc br1 pa1 border-box pointer",[d("img.dib h2 w2[src='data/sys/35b95e6d1d3ebf48.png']"),d(".w-100.f3.white.mv1.dib.noselect.rwdPanelFont",p("history"))])):d("."),o[5]?d(".fl.w-100.pa2",{onclick(){Ae.useFocus=!0}},d(".w-100 no-underline near-white bg-animate bg-near-black hover-bg-gray inline-flex items-center ma1 tc br1 pa1 border-box pointer",[d("img.dib h2 w2[src='data/sys/2357769f78f010b1.png']"),d(".w-100.f3.white.mv1.dib.noselect",p("deposit"))])):d("."),o[6]?d(".fl.w-100.pa2",{onclick(){globalThis.Howler&&(globalThis.Howler.mute(!0),globalThis.Howler.unload()),Ae.useFocus=!0}},d(".w-100 no-underline near-white bg-animate bg-near-black hover-bg-gray inline-flex items-center ma1 tc br1 pa1 border-box pointer",[d("img.dib h2 w2[src='data/sys/94615eed5b8c0616.png']"),d(".w-100.f3.white.mv1.dib.noselect",p("back"))])):d("."),o[7]?d(".fl.w-100.pa2",{onclick(){if(Ae.useFocus=!0,e.isLeave=!0,s.iframe){let e=s.iframe.contentDocument||s.iframe.contentglobalThis.document;e?(e.open(),e.write(""),e.close()):s.iframe.srcdoc="about:blank"}globalThis.Howler&&(globalThis.Howler.mute(!0),globalThis.Howler.unload())}},d(".w-100 no-underline near-white bg-animate bg-near-black hover-bg-gray inline-flex items-center ma1 tc br1 pa1 border-box pointer",[d("img.dib h2 w2[src='data/sys/fe342b264ea95dbb.png']"),d(".w-100.f3.white.mv1.dib.noselect",p("lobby"))])):d("."),d(".")]))}};function _e(e,t){return null!=e?e:t()}function Pe(e){let t,i=e[0],n=1;for(;n<e.length;){const s=e[n],a=e[n+1];if(n+=2,("optionalAccess"===s||"optionalCall"===s)&&null==i)return;"access"===s||"optionalAccess"===s?(t=i,i=a(i)):"call"!==s&&"optionalCall"!==s||(i=a(((...e)=>i.call(t,...e))),t=void 0)}return i}let Ae={},Fe={resizeTimer:null,timer:null,eventDelay:260},Be=null,Ne={name:null,angle:0,isTrigger:!1},Se=null;function ze(e){switch(Se&&Se.setCurrentValue&&Se.setCurrentValue(e),e){case 0:(Ae.usePortrait||Ae.useLandscape)&&(Ae.isPortrait=!0,Ae.isLandscape=!1),Ae.screenHeight=screen.height,Ae.screenWidth=screen.width;break;case 270:case-90:case-270:case 90:(Ae.usePortrait||Ae.useLandscape)&&(Ae.isPortrait=!1,Ae.isLandscape=!0),screen.width<screen.height?(Ae.screenHeight=screen.width,Ae.screenWidth=screen.height):(Ae.screenHeight=screen.height,Ae.screenWidth=screen.width);break;case-180:case 180:(Ae.usePortrait||Ae.useLandscape)&&(Ae.isPortrait=!0,Ae.isLandscape=!1),Ae.screenHeight=screen.height,Ae.screenWidth=screen.width}globalThis.parent===window&&globalThis.scrollTo(0,Ae.currentY)}function He(){Ae.isPortrait=!1,Ae.isLandscape=!1;let e=0;e=window.matchMedia("(orientation: portrait)").matches?0:90,0===e&&(e=globalThis.screen.orientation&&"number"==typeof globalThis.screen.orientation.angle?globalThis.screen.orientation.angle:parseInt(globalThis.orientation)),Ne.angle=e,Be?Be(e):Se&&Se.eventOrientation?Se.eventOrientation(e):ze(e),globalThis.parent===window&&globalThis.scrollTo(0,Ae.currentY)}function Ve(e){Fe.timer&&(m.updateManager.remove(Fe.timer),Fe.timer=null),Ne.isTrigger=!0,d.redraw(),Fe.timer=m.updateManager.setTimeout((()=>{Ne.isTrigger=!1,He(),We()}),.001*Fe.eventDelay)}function je(e){if(Ae.isMobile&&!e.isChild&&Se&&Se.getCurrentValue){let t=Se.getCurrentValue();if(t){let i=t.offset;e.left=0,e.top=0,e.width=globalThis.innerWidth,e.height=globalThis.innerHeight,"number"==typeof i?e.height=globalThis.innerHeight-i:i&&("number"==typeof i.x&&(e.left=i.x),"number"==typeof i.y&&(e.top=i.y),"number"==typeof i.width&&(e.width=globalThis.innerWidth-i.width),"number"==typeof i.height&&(e.height=globalThis.innerHeight-i.height))}else e.left=0,e.top=0,e.width=globalThis.innerWidth,e.height=globalThis.innerHeight;e.left+="px",e.top+="px",e.width+="px",e.height+="px"}}function De(e){let t=e.game,i={x:1,y:1},n=screen.width,s=screen.height;Ae.isMobile?(n=globalThis.innerWidth,s=globalThis.innerHeight,Ae.useFullscreen||(n=globalThis.innerWidth,s=globalThis.innerHeight),Ae.ios&&(s=globalThis.innerHeight,n=globalThis.innerWidth)):(n=globalThis.innerWidth,s=globalThis.innerHeight),t.portrait&&t.landscape&&(n>s?(t.width=t.landscape.width||512,t.height=t.landscape.height||512):(t.width=t.portrait.width||512,t.height=t.portrait.height||512)),e.fix&&(n=parseInt(e.fix.width),s=parseInt(e.fix.height));let a={x:0,y:0};e.left=0,e.top=0;let r=e.reference;r&&(a.x=r.left*n,a.y=r.top*s,n*=r.width,s*=r.height),n-t.width<0?(e.width=n,i.x=n/t.width):e.width=t.width,s-t.height<0?(e.height=s,i.y=s/t.height):e.height=t.height,i.x<i.y?e.height=t.height*i.x:i.x>i.y&&(e.width=t.width*i.y);let o=e.anchor;if(o){let t=(n-e.width)*_e(o.x,(()=>.5)),i=(s-e.height)*_e(o.y,(()=>.5));e.left=a.x+t,e.top=a.y+i}if(e.useCenter){let t=0,i=0;"boolean"==typeof e.useCenter?(i=.5*(s-e.height),i<0&&(i=0),t=.5*(n-e.width),t<0&&(t=0)):(e.useCenter.vertical&&(i=.5*(s-e.height),i<0&&(i=0)),(e.useCenter.horizontal||e.useCenter.left)&&(t=.5*(n-e.width),t<0&&(t=0))),e.left=a.x+t,e.top=a.y+i}e.absPos&&("number"==typeof e.absPos.top?e.top=e.absPos.top:"number"==typeof e.absPos.bottom&&(e.top=s+e.absPos.bottom),"number"==typeof e.absPos.left?e.left=e.absPos.left:"number"==typeof e.absPos.right&&(e.left=n+e.absPos.right)),t.eventResize&&t.eventResize({left:e.left,top:e.top,width:e.width,height:e.height}),e.eventResize&&e.eventResize({width:globalThis.innerWidth,height:globalThis.innerHeight}),e.left+="px",e.top+="px",e.width+="px",e.height+="px"}function We(e){if(!Ne.isTrigger&&!Ae.disableResize){if(!e)return!!Ne.isTrigger||void(Fe.resizeTimer||(Ae.isResize=!0,d.redraw(),Fe.resizeTimer=m.updateManager.setTimeout((()=>{m.updateManager.remove(Fe.resizeTimer),Fe.resizeTimer=null,t()}),.3)));t()}function t(){Ae.isMobile&&globalThis.parent===window&&globalThis.scrollTo(0,Ae.currentY),m.updateManager.setTimeout((()=>{Se&&Se.checkFullscreen&&Ae.useFullscreen&&Se.checkFullscreen(Ae);let e=globalThis.scene;if(Ae.settingList.forEach((t=>{if(t){if(!t.isLock)return je(t),d.redraw(),!0;if(De(t),e){let i=e[t.id];if(i){let e=i.localEvent;if(e&&e.resize){let i={isMobile:Ae.isMobile};i.width=globalThis.innerWidth,i.height=globalThis.innerHeight,i.setting=t,e.resize(i)}}}d.redraw()}})),e){Object.getOwnPropertyNames(e).forEach((t=>{let i=e[t];if(i){let e=i.localEvent;if(e&&e.resize){let t={isMobile:Ae.isMobile};t.width=globalThis.innerWidth,t.height=globalThis.innerHeight,4!==i.state&&5!==i.state||e.resize(t)}}}))}Ae.isResize=!1,d.redraw()}),.01)}}function Ge(e){if(Pe([e,"optionalAccess",e=>e.index])>=0)return-1;let t=-1;for(let i=0;i<Ae.settingList.length;i+=1){Ae.settingList[i]||(t=i,Ae.settingList[i]=e)}return t<0&&(t=Ae.settingList.length,Ae.settingList.push(e)),e.isLock&&De(e),e.index=t,t}function Ye(e){if(Pe([e,"optionalAccess",e=>e.index])>=0){let t=e.index;t<Ae.settingList.length&&(Ae.settingList[t]=null),delete e.index}}function qe(e){Ae.disableResize=e}function Xe(){Ae.settingList=[]}Ae.ios=!1,Ae.useOrientation=!1,Ae.usePortrait=!1,Ae.useLandscape=!1,Ae.isMobile=!1,Ae.mobileReady=null,Ae.useFullscreen=!1,Ae.isFullscreen=!1,Ae.isPortrait=!1,Ae.isLandscape=!1,Ae.isTouchOnce=!1,Ae.isResize=!1,Ae.currentY=0,Ae.screenWidth=screen.width,Ae.screenHeight=screen.height,Ae.screenUnit="px",Ae.orientation=Ne,Ae.isTouchDown=!1,Ae.useFocus=!1,Ae.disableResize=!1,Ae.settingList=[];let Ke=!1;async function Je(e){if(Ae.currentY=0,document){let e=globalThis.scene;document.onfullscreenchange=document.onwebkitfullscreenchange=()=>{Ae.settingList.forEach((t=>{if(t&&e){let i=e[t.id];if(i){let e=i.game&&i.game.sysTray;Re(e);let t=i.localEvent;if(t&&t.fullscreen){let i=e&&e.isFullscreen;t.fullscreen(i)}}}})),d.redraw()},document.onfullscreenerror=document.onwebkitfullscreenerror=()=>{Ae.settingList.forEach((t=>{if(t&&e){let i=e[t.id];if(i){let e=i.game&&i.game.sysTray;Re(e);let t=i.localEvent;if(t&&t.fullscreen){let i=e&&e.isFullscreen;t.fullscreen(i)}}}})),d.redraw()}}if(!i.isCheckGameCDN&&V.any()?(Ke||(screen&&screen.orientation&&screen.orientation.addEventListener?screen.orientation.addEventListener("change",Ve):globalThis.addEventListener("orientationchange",Ve)),Ae.isMobile=!0,Be=ze,V.iOS()?(globalThis.parent===window&&(Ae.currentY=200),Ae.ios=!0,Be=null):V.Android()&&(globalThis.parent===window&&(Ae.currentY=200),Be=null)):Ae.isMobile=!1,e&&(Ae.useOrientation=!1,Ae.usePortrait=!1,Ae.useLandscape=!1,Ae.isMobile&&("string"==typeof e.orientation&&("portrait"===e.orientation?(Ae.usePortrait=!0,Ae.orientation.name="portrait"):(Ae.useLandscape=!0,Ae.orientation.name="landscape"),Ae.useOrientation=!0),Se=null,Ae.useFullscreen=!1,V.iOS()?navigator.userAgent.match(/baidu/i)?(Se=ve,Ae.screenUnit="px",Ae.useFullscreen=!1):navigator.userAgent.match(/CriOS/i)?(Se=le,Ae.screenUnit="px",Ae.useFullscreen=!1):navigator.userAgent.match(/LieBao|ACHEETAHI/i)?(Se=Ce,Ae.screenUnit="px",Ae.useFullscreen=!1):navigator.userAgent.match(/FxiOS/i)?(Se=ge,Ae.screenUnit="px",Ae.useFullscreen=!1):navigator.userAgent.match(/Safari/i)?(Se=be,Ae.screenUnit="px",Ae.useFullscreen=!1):navigator.userAgent.match(/UCB/i)?(Se=me,Ae.screenUnit="px",Ae.useFullscreen=!1):Se=ke:V.Android()&&(navigator.userAgent.match(/OPR/i)?(Se=J,Ae.screenUnit="px",Ae.useFullscreen=!1,navigator.userAgent.match(/baidu/i)?Se=te:navigator.userAgent.match(/LieBao|ACHEETAHI/i)&&(Se=ne,Ae.screenUnit="px",Ae.useFullscreen=!1)):navigator.userAgent.match(/baidu/i)?(Se=te,Ae.screenUnit="px",Ae.useFullscreen=!1):navigator.userAgent.match(/LieBao|ACHEETAHI/i)?(Se=ne,Ae.screenUnit="px",Ae.useFullscreen=!1):navigator.userAgent.match(/Firefox/i)?(Se=X,Ae.screenUnit="px",Ae.useFullscreen=!1):navigator.userAgent.match(/UCB/i)?(Se=Z,Ae.screenUnit="px",Ae.useFullscreen=!1):navigator.userAgent.match(/Chrome/i)?(Ae.useFullscreen=!1,Ae.screenUnit="px",Se=Y):Se=ae),navigator.userAgent.match(/(UBiOS|Pad|Tablet|KFAUW|Mb2345|ME173X|NRD90M|VIE|N2G47H)/i)&&(Ae.useFullscreen=!1,Ae.screenUnit="px"),Se&&(Se.value.state=Ae),Ke||globalThis.addEventListener("focus",(()=>{Ae.useFocus&&(Ae.isTouchOnce=!0,Ae.useFocus=!1,We(!0))}),!0),He(),We(!0),Ae.settingList.forEach((e=>{if(e)return e.isLock?void De(e):(je(e),!0)})),Ae.isFullscreen=!0,Ae.isTouchDown=!1,Ae.isTouchOnce=!0)),i.mobileMode){let e=i.mobileMode;parseInt(e)>0&&(Ae.isFullscreen=!0,Ae.isTouchDown=!1,Ae.isTouchOnce=!0)}document.body.onscroll=()=>{!Ae.isMobile||Ae.orientation.isTrigger||Ae.isResize||Ae.disableResize||globalThis.parent===window&&Ae.isMobile&&(Ae.currentY=globalThis.pageYOffset,globalThis.scrollTo(0,Ae.currentY),d.redraw())},Ke||globalThis.addEventListener("resize",We),Ke=!0}var Qe=Object.freeze({__proto__:null,__unload:()=>{screen&&screen.orientation&&screen.orientation.removeEventListener?screen.orientation.removeEventListener("change",Ve):globalThis.removeEventListener("orientationchange",Ve),globalThis.removeEventListener("resize",We)},addSetting:Ge,decSetting:Ye,eventResize:We,init:Je,orientationChangeHandler:Ve,removeAllSetting:Xe,setDisableResize:qe,state:Ae});let Ze={oninit(e){let t=e.attrs;this.url=t.url,this.manager=t.manager,this.setting={id:"children",isLock:!1,useCenter:!1,left:"0%",top:"0%",width:"100%",height:"100%",game:{width:1024,height:1024},reference:{left:0,top:0,width:1,height:1}},Ge(this.setting)},oncreate(e){let t=e.instance.children[0].dom;m.updateManager.setTimeout((()=>{qe(!0),t.focus()}),.2)},view(){let e=this,t=e.setting;return d(".rwdPanelHeader",{style:{position:"absolute",left:t.left,top:t.top,backgroundColor:"rgba(0,0,0,1)",zIndex:950,opacity:1,width:t.width,height:t.height}},d("iframe",{src:e.url,scrolling:"yes",frameborder:0,style:{position:"absolute",left:"0%",top:"0%",width:"100%",height:"100%"}}),d(".fl.tc.pv4.bg-black.hover-bg-gray",{style:{position:"absolute",left:"5%",top:"0%",width:"90%",height:"10%",opacity:.75,cursor:"pointer"},onclick(){qe(!1),e.manager.childrenVisible=!1,e.url=""}},d(".inline-flex.white.border-box.pointer",`${p("close")}`)))}},et={engine:null},tt={engine:null},it={engine:null},nt=!1;function st(e){let t,i,n={},s=e;return i=a.PIXI.Renderer?new a.PIXI.Renderer(s):new a.PIXI.WebGLRenderer(s),t=new a.PIXI.Container,n.stage=t,n.overlay=new a.PIXI.Container,n.foreground=new a.PIXI.Container,n.main=new a.PIXI.Container,n.background=new a.PIXI.Container,t.addChildAt(n.overlay,0),t.addChildAt(n.foreground,0),t.addChildAt(n.main,0),t.addChildAt(n.background,0),{renderer:i,stage:t,layer:n,render(){i.render(t)}}}function at(e){let t,i=e[0],n=1;for(;n<e.length;){const s=e[n],a=e[n+1];if(n+=2,("optionalAccess"===s||"optionalCall"===s)&&null==i)return;"access"===s||"optionalAccess"===s?(t=i,i=a(i)):"call"!==s&&"optionalCall"!==s||(i=a(((...e)=>i.call(t,...e))),t=void 0)}return i}const rt=0,ot=6,lt=1,ct=3,ht=4,gt=5;let ut={oninit(){this.options={}},oncreate(n){let s=this;s.isIframeLoaded=!1,s.isIframeInit=!1;let l,c=Math.round(performance.now());s.timestamp=c,s.checkItem=null;let h={isFirstTime:!0,useVideo:!1,isCheckData:!1,isChild:!1,isGame:!0,isCreate:!1,isBusy:!0,rendered:null,disable:!0,sysTray:null,trayVisible:!1,childrenVisible:!1,currentUrl:"",useCenter:!0,position:"absolute",left:"25%",top:"25%",width:"50%",height:"50%"},g={state:{visible:!0},sound:{isMute:!1},music:{isMute:!1},screen:{isAutoScale:!0,isLock:!1},isLock:!1,isFullscreen:!1};Object.prototype.hasOwnProperty.call(g,"visible")||Object.defineProperty(g,"visible",{get:()=>g.state.visible,set(e){h.mode!==r.DEMO&&(g.state.visible=e,h.sysTray&&(e?(h.sysTray.isMenu=!1,h.sysTray.visible=!0):(h.sysTray.isMenu=!1,h.sysTray.visible=!1),d.redraw()))}});let u=s.options,w=n.attrs;if(s.currentBaseURL=null,w&&(s.checkItem=w.checkItem,s.currentBaseURL=w.currentBaseURL,h.left=w.left||"25%",h.top=w.top||"25%",h.width=w.width||"50%",h.height=w.height||"50%",h.reference=w.reference,h.fix=w.fix,h.isChild=w.isChild,h.isCheckData=w.isCheckData,w.sysTray?h.sysTray={visible:!0,isMenu:!1,flags:w.sysTray.flags,style:{left:w.sysTray.left||"0px",top:w.sysTray.top||"0px"}}:h.sysTray=null,l=w.config,s.ctrlEvent=w.ctrlEvent),g.visible=!1,!l)return;let v=f();if(h.isCreate=l.isCreate,h.templateVersion=l.scene.templateVersion,"slot.2.1"===h.templateVersion&&"en-us"===f()&&(v="en"),h.id=l.id,h.mode=l.mode,h.name=l.scene.name[v],h.group=l.scene.group||"game",h.appName=l.scene.app,h.appHash=l.scene.appHash,h.appConfig=l.scene.appConfig,h.devMode=l.scene.devMode,h.dependence=l.scene.dependence,h.background=null,h.backgroundCSS=null,s.appTimeout=t?null:m.updateManager.setTimeout((()=>{u.initGame=null,s.appTimeout=null,d.redraw(),m.updateManager.setTimeout((()=>{i.requestReload=!1,i.isReload=!0,ti({url:s.currentBaseURL,group:h.group,game:h.appConfig})}),.1)}),10),!it.engine){let e={id:"game",width:512,height:512,resolution:1,antialias:!1,transparent:!0};e.view=it.canvas,it.engine=st(e),it.game.setEngine(it.engine)}let x=`${h.group}${h.appConfig}`,L={category:"遊戲程式 "+(s.currentBaseURL||"主網址"),getLabel:()=>x},C={category:"遊戲場景 "+(s.currentBaseURL||"主網址"),getLabel:()=>x},T={category:"建立遊戲 "+(s.currentBaseURL||"主網址"),getLabel:()=>x};i.isCheckGameCDN||(e.loadBegin(T),e.loadBegin(L)),h.anim={element:null,isPlay:!1},h.display="inline",h.opacity=0,h.zIndex=1,w.updateStyle&&w.updateStyle(h);let E=l.scene.images;i.useAvif?E.v2&&(E=E.v2):E.v1&&(E=E.v1),h.game={id:l.id,group:l.scene.group,mode:l.mode,decimal:l.decimal,name:h.name,logo:E&&E.logo,theOther:l.scene.theOther,version:l.scene.version,baseURL:l.scene.baseURL||"",langID:v},E&&Object.prototype.hasOwnProperty.call(E,"useBackground")&&E.background&&(h.isCheckData||(h.background=`${h.game.baseURL}${E.background}`),"string"==typeof E.useBackground?h.backgroundCSS=`${E.useBackground}`:(E.useBackground,h.backgroundCSS=null)),l.scene.theOther&&l.scene.theOther.id&&(h.game.theOther=l.scene.theOther.id),l.scene.screen&&(h.isLock=l.scene.screen.isLock,h.game.width=l.scene.screen.width||640,h.game.height=l.scene.screen.height||960,h.game.portrait=l.scene.screen.portrait,h.game.landscape=l.scene.screen.landscape,Ae.isMobile,g.isLock=h.isLock),h.images=E,h.isCheckData||Ge(h);let k=null,R=l.loadingEvent,O=di(),I=null,$=O.scene[h.id]={templateVersion:h.templateVersion,state:rt,event:{create:null,play:null,pause:null,enter:null,leave:null,focus:null,blur:null,lock:null,fullscreen:null,resize:null,music:null,sound:null},info:{isChild:h.isChild,baseURL:h.game.baseURL||"",id:h.game.id,name:h.game.name,group:h.game.group,theOther:h.game.theOther,width:h.game.width,height:h.game.height,decimal:h.game.decimal,mode:h.game.mode,langID:h.game.langID},gamecard:l.scene,loadingEvent:{title:h.name,start(){i.isCheckGameCDN||e.loadBegin(C),R.start&&R.start()},resBegin(e){R.resBegin&&R.resBegin(e)},resEnd(e){R.resEnd&&R.resEnd(e)},sceneResBegin(e){R.sceneResBegin&&R.sceneResBegin(e)},sceneResLoading(e){R.sceneResLoading&&R.sceneResLoading(e)},sceneResEnd(e){R.sceneResEnd&&R.sceneResEnd(e)},finish(){$.state=ht,i.isCheckGameCDN||(e.loadEnd(C),e.log({label:x,category:"遊戲場景 "+(s.currentBaseURL||"主網址")}),e.loadEnd(T)),R.finish&&R.finish($)}},callWeb(e){"string"==typeof e?O.document&&O.document.location&&O.document.location.replace?O.document.location.replace(e||"about:blank"):O.location.href=e||"about:blank":ii(e)},open(e){h.childrenVisible=!0,h.currentUrl=e,d.redraw()},setDisableResize(e){qe(e)},createTheOther(e,t=0){Pt(e,t)},destroyTheOther(e){At(e),O.scene[e]=null},callTheOther(e,t){let i,n=!1,s=O.scene[e];return s&&s.state===ht&&($.game.debug=!1,$.state=ht,$.info.isChild?($.localEvent.pause(),$.localEvent.hide()):$.localEvent.pause(),i=t||{what:" is this ?"},i.from=$.info.id,n=!0,s.localEvent.pause(),s.state=gt,s.templateVersion,s.setting.background=t&&t.background||"rgba(0,0,0,0)",s.localEvent.show(),s.localEvent.play(i)),n},checkTheOther(e){let t=!1,i=O.scene[e];return i&&i.state===ht&&(t=!0),t},getTheOther:e=>O.scene[e],reload(e){if(i.isReload)return;ni(),i.isReload=!0;let t=e;t||(t={game:h.appConfig,group:h.group}),$.game.stop(),$.game.reset();Ft(),m.updateManager.setTimeout((()=>{for(let e=0;e<globalThis.frames.length;e+=1){let t=globalThis.frames[e];if(t){let e=t.document;e&&(e.documentElement.innerHTML="")}}u.initGame=null,$.game=null,s.ctrlEvent&&s.ctrlEvent.reload&&s.ctrlEvent.reload(),d.redraw(),m.updateManager.setTimeout((()=>{Mt().then((()=>{B(t.game,t.group,s.currentBaseURL,t.version).then((i=>{i&&i.gameCard&&(i.gameCard.reloadConfig=e,_t({gameCard:i.gameCard,id:t.game,group:t.group}))}))}))}),.01)}),.05)},leave(e){},setMode(e){let t=r;o.mode=e,o.mode===t.REAL?u.info.mode=p("gameModeReal"):u.info.mode=p("gameModeDemo"),d.redraw()},async fullscreen(e){if(e||!Re())try{return await Oe(g)}catch(e){}},ready(n){if(!$.game&&n&&($.game=n),s.appTimeout&&(m.updateManager.remove(s.appTimeout),s.appTimeout=null),i.isCheckGameCDN||(e.loadEnd(L),e.log({label:x,category:"遊戲程式 "+(s.currentBaseURL||"主網址")})),s.checkItem){let e=s.checkItem,t=Math.round(performance.now());e.timeInit=t-s.timestamp,s.timestamp=t,e.state="app",e.timeReady=t-e.timestamp,e.timestamp=t,d.redraw(),e.ready&&e.ready(e)}I($.game).then((()=>{if($.game){let t={error(t){e.error({label:x,category:t})},log(t){"string"==typeof t?e.log({label:x,category:t}):t&&(t.label=x,e.log(t))},serviceBegin(t){if(t){if(t.getLabel=()=>x,!t.category)return;e.serviceBegin(t)}},serviceEnd(t){if(t){if(t.getLabel=()=>x,!t.category)return;e.serviceEnd(t)}},loadBegin(t){if(t){if(t.getLabel=()=>x,!t.category)return;e.loadBegin(t)}},loadEnd(t){if(t){if(t.getLabel=()=>x,!t.category)return;e.loadEnd(t)}}};$.game.report=t,$.game.localforage=y}h.isBusy=!1,h.isCreate&&$.event&&$.event.create?(t&&($.info.console=console),$.info.setting=i,$.event.create($.info),$.state=lt):$.state=ct}))},graphReady(){$.ready()},setOverviewVisible(e){$.gamecard.manual&&$.gamecard.manual.overview&&(kt.overview.visible=e,d.redraw())},setEvent(e){let t=$.event;t.create=e.create||t.create,t.play=e.play||t.play,t.pause=e.pause||t.pause,t.enter=e.enter||t.enter,t.leave=e.leave||t.leave,t.focus=e.focus||t.focus,t.blur=e.blur||t.blur,t.lock=e.lock||t.lock,t.fullscreen=e.fullscreen||t.fullscreen,t.resize=e.resize||t.resize,t.music=e.music||t.music,t.sound=e.sound||t.sound}};$.state=ot;let U=!1,M=null,_=null,P=null;async function F(e){if(P={imports:{},scopes:{}},e){let e=null;importShim&&(e=importShim.getImportMap()),e&&(P.imports.nuts=e.imports.nuts,P.imports.mithril=e.imports.mithril,P.imports.tweenjs=e.imports.tweenjs,P.imports["pixi.js"]=e.imports["pixi.js"],P.imports["pixi-spine"]=e.imports["pixi-spine"],P.imports["apng-js"]=e.imports["apng-js"],P.imports["video/domains"]=e.imports["video/domains"],P.imports["video/photos"]=e.imports["video/photos"])}if(t){M=`${i.projectURL}${h.group}/${h.appConfig}/`,_=`${h.group}/${h.appConfig}`;let e=await import("js-yaml");e.default&&(e=e.default);let t=`${M}system.set.yml`,n=await fetch(t);if(n.ok){let t=await n.text(),s=e.load(t);if(s.package.skipRollup&&(U=!0),U){P.imports[_]=`${h.game.baseURL}${s.package.main}`;let e=Object.getOwnPropertyNames(s.config.paths),t={};e.forEach((e=>{let n=s.config.paths[e];"/"===n[0]?t[e]=n:t[e]=`${i.projectURL}${n}`})),P.scopes[M]=t}}}}I=async e=>{let n=globalThis.location.origin;s.currentBaseURL&&(n=s.currentBaseURL),h.game.baseURL.length>0&&(n=h.game.baseURL);let r=n;r.length>0&&"/"===r[r.length-1]&&(r=r.substring(0,r.length-1));let o=h.appName;if("object"==typeof o&&(o=h.appName[h.game.langID],o||(o=h.appName[b.EN_US])),o){let e=o.split("/"),t=e.length-1;r=t>2?`${r}/${e[t-1]}/${e[t]}`:`${r}/${o}`}if(e.PIXI=a.PIXI,e.spine=a.spine,await F(),"game.6.0"===h.templateVersion){if(e.getRenderer){let t=$.gamecard.pixiConfig;e.getRenderer().resize(t.width,t.height)}let n;if(e.layer.overlay.removeChildren(),e.layer.foreground.removeChildren(),e.layer.main.removeChildren(),e.layer.background.removeChildren(),e.play(),e.scene=$,t&&P&&importShim){importShim.addImportMap(P);importShim.getImportMap()}if(t&&U)try{let e=import.meta.resolve(_);n=await import(e)}catch(e){n=await import(r)}else n=await import(r);let s=await n.scene.init({setting:i,baseURL:$.info.baseURL,isChild:$.info.isChild,langID:$.info.langID,gamecard:$.gamecard,game:e,nuts:m}),a={create(t){O.lobby&&(e.currentUser=O.lobby.currentUser,e.command=O.lobby.net.gameCommand,e.lobby={setEvent:O.lobby.setEvent,setCommand:O.lobby.net.setLobbyCommand,CMD:O.lobby.net.CMD}),s.create&&(t.game=e,t.setting=i,s.create(t))},play(t){e.play(),s.play&&(t.game=e,t.setting=i,s.play(t))},pause(t){e.pause(),s.pause&&(t.game=e,t.setting=i,s.pause(t))},enter(t){s.enter&&(t.game=e,t.setting=i,s.enter(t))},leave(t){s.leave&&(t.game=e,t.setting=i,s.leave(t))},focus(){s.focus&&s.focus()},blur(){s.blur&&s.blur()},lock(e){s.lock&&s.lock(e)},fullscreen(e){s.fullscreen&&s.fullscreen(e)},resize(e){s.resize&&s.resize(e)},music(e){s.music&&s.music(e)},sound(e){s.sound&&s.sound(e)}};$.setEvent(a),$.game=e}else if("game.5.0"===h.templateVersion){let n;if(Object.defineProperty(e,"scene",{get:()=>$}),t&&P&&importShim){importShim.addImportMap(P);importShim.getImportMap()}if(t&&U)try{let e=import.meta.resolve(_);n=await import(e)}catch(e){n=await import(r)}else n=await import(r);let s=await n.scene.init({setting:i,baseURL:$.info.baseURL,isChild:$.info.isChild,langID:$.info.langID,gamecard:$.gamecard,game:e,nuts:m}),a={create(t){O.lobby&&(e.currentUser=O.lobby.currentUser,e.command=O.lobby.net.gameCommand,e.lobby={setEvent:O.lobby.setEvent,setCommand:O.lobby.net.setLobbyCommand,CMD:O.lobby.net.CMD}),s.create&&(t.game=e,t.setting=i,s.create(t))},play(t){e.play(),s.play&&(t.game=e,t.setting=i,s.play(t))},pause(t){e.pause(),s.pause&&(t.game=e,t.setting=i,s.pause(t))},enter(t){s.enter&&(t.game=e,t.setting=i,s.enter(t))},leave(t){s.leave&&(t.game=e,t.setting=i,s.leave(t))},focus(){s.focus&&s.focus()},blur(){s.blur&&s.blur()},lock(e){s.lock&&s.lock(e)},fullscreen(e){s.fullscreen&&s.fullscreen(e)},resize(e){s.resize&&s.resize(e)},music(e){s.music&&s.music(e)},sound(e){s.sound&&s.sound(e)}};$.setEvent(a),$.game=e}};let N={isActive:!0,create(e){e.isCreate&&at([$,"access",e=>e.event,"optionalAccess",e=>e.create])&&(t&&($.info.console=console),$.info.setting=i,$.event.create($.info),$.state=lt)},async enter(t){let n=t||{};n.from||(n.from=$.info.id),n.id||(n.id=h.game.id),n.game||(n.game=$.game),i.isInGame=!0,Ae.isMobile&&(h.isChild||globalThis.scrollTo(0,Ae.currentY)),h.isFirstTime&&(h.isFirstTime=!1),$.game&&(O.lobby&&($.game.command=O.lobby.net.gameCommand,$.game.table=O.lobby.table[n.id],$.game.currentUser=O.lobby.currentUser),$.game.sysTray=g,$.game.getLCS=async function(){return null},$.game.scanLCS=async function(e){let t={name:"串流服務",category:"檢測串流",getLabel:()=>x},i=await import("./agent.9248e0f0.js");return await i.scan(e,t)},$.game.getProject=async function(e,t){const i=await import("./agent.afb5b5c1.js");return await i.getProject(e,t)},$.game.getPlayer=async function(){let e=await import("./agent.af20a91c.js");return await e.getLib(),e.player},$.game.getIP=e.getIP),N.show({finish(){at([$,"access",e=>e.event,"optionalAccess",e=>e.enter])&&(n.setting=i,$.event.enter(n)),N.blur&&N.blur(),We(!0);let e=null,t=O.scene[$.info.theOther];if($.info.isChild||t||!$.info.theOther||($.info.theOther,$.info.theOther.length>0?e={id:$.info.theOther,group:$.info.group}:"object"==typeof $.info.theOther&&(e={id:$.info.theOther.id,group:$.info.theOther.group})),null!==e){let t={style:{position:"absolute",left:"0%",top:"0%",width:"100%",height:"100%"},reference:{left:0,top:0,width:1,height:1},groupName:e.group,id:e.id,sceneID:e.id,loadingEvent:{start(){},resBegin(){},resEnd(){},sceneResBegin(){},sceneResLoading(){},sceneResEnd(){},finish(e){e.localEvent.pause(),e.localEvent.hide()}}};$.createTheOther(t)}}})},leave(e){let t=e||{};t.from||(t.from=$.info.id),t.game||(t.game=$.game),at([$,"access",e=>e.event,"optionalAccess",e=>e.leave])&&(t.setting=i,$.event.leave(t))},play(e){let t=e||{};t.from||(t.from=$.info.id),t.game||(t.game=$.game),at([$,"access",e=>e.event,"optionalAccess",e=>e.play])&&(t.setting=i,$.event.play(t)),$.state=gt,We(!0)},pause(e){let t=e||{};t.from||(t.from=$.info.id),t.game||(t.game=$.game),at([$,"access",e=>e.event,"optionalAccess",e=>e.pause])&&(t.setting=i,$.event.pause(t)),$.state=ht},focus(){N.isActive||(N.isActive=!0,at([$,"access",e=>e.event,"optionalAccess",e=>e.focus])&&$.event.focus())},blur(){N.isActive&&(N.isActive=!1,at([$,"access",e=>e.event,"optionalAccess",e=>e.blur])&&$.event.blur())},updateBlur(e){e&&e!==N&&N.blur();let t=w.objList;t&&Array.isArray(t)&&t.forEach((t=>{if(t){let i=t.attrs.localEvent;e!==i&&i&&i.blur&&i.blur()}}))},lock(e){h.isLock=e,h.left=w.left||"25%",h.top=w.top||"25%",h.width=w.width||"50%",h.height=w.height||"50%";let t=O.scene[$.info.theOther];t&&t.localEvent.lock(e),We(!0),at([$,"access",e=>e.event,"optionalAccess",e=>e.lock])&&$.event.lock(e)},fullscreen(e){at([$,"access",e=>e.event,"optionalAccess",e=>e.fullscreen])&&$.event.fullscreen(e)},resize(e){at([$,"access",e=>e.event,"optionalAccess",e=>e.resize])&&$.event.resize(e)},music(e){at([$,"access",e=>e.event,"optionalAccess",e=>e.music])&&$.event.music(e);let t=O.scene[$.info.theOther];t&&t.localEvent.music(e)},sound(e){at([$,"access",e=>e.event,"optionalAccess",e=>e.sound])&&$.event.sound(e);let t=O.scene[$.info.theOther];t&&t.localEvent.sound(e)},show(e){let t=h.anim;if(t.element){if(t.isPlay&&(t.isPlay=!1),h.display="inline",h.disable=!1,h.zIndex=4,h.opacity=1,e){if(e.style){let t=e.style;h.zIndex=t.zIndex||4}e.finish&&e.finish()}w.updateStyle&&w.updateStyle(h),d.redraw()}},hide(e){let t=h.anim;if(t.element){if(t.isPlay&&(t.isPlay=!1),h.disable=!0,h.display="none",h.zIndex=2,h.opacity=0,e){if(e.style){let t=e.style;h.zIndex=t.zIndex||2}e.finish&&e.finish()}w.updateStyle&&w.updateStyle(h),d.redraw()}}};$.localEvent=N,$.setting=h,u.onfocus=onfocus,u.initGame=async function(e){h.anim.element=e.dom},u.event=N,u.setting=h,u.tray=g,u.objList=w.objList,u.updateStyle=w.updateStyle;let S=d(".");var z;"game.6.0"===h.templateVersion?$.gamecard.pixiConfig&&(S=d({oninit(){},oncreate(e){e.dom.appendChild(it.canvas),$.ready&&$.ready(it.game)},onremove(e){e.dom.removeChild(it.canvas)},view:()=>d(".",{style:{position:"absolute",left:"0px",top:"0px",width:"100%",height:"100%"}})})):"game.5.0"===h.templateVersion?$.gamecard.pixiConfig&&(S=[d(m.components.game.pixi,{id:h.id,style:{position:"absolute",left:"0px",top:"0px",width:"100%",height:"100%"},config:$.gamecard.pixiConfig,ready:$.ready})]):S=[d("iframe",{style:{position:"absolute",left:"0px",top:"0px",width:"100%",height:"100%"},scrolling:"no",frameborder:0,oncreate:async function(e){await F(!0),k=e.dom,k.scrolling="no",k.frameborder=0;let n=k.style;if(n.width="100%",n.height="100%",n.left="0%",n.top="0%",n.position="absolute",h.isChild||(n.zIndex=2,n.display="inline"),s.isIframeInit)return;s.isIframeInit=!0,u.info.iframe=k;let r=h.id,o=h.name,l=h.group,c=h.appName,g=h.appConfig||r,p=h.devMode,f=h.background,w=h.dependence,y=null;if("object"==typeof c&&(c=h.appName[h.game.langID],c||(c=h.appName[b.EN_US])),"game.4.0"===h.templateVersion){let e=globalThis.location.origin;if(s.currentBaseURL&&(e=s.currentBaseURL),h.game.baseURL.length>0&&(e=h.game.baseURL),y={importmapName(){let e=`"${this.key}": "${this.value}"`;return this.isLast||(e+=","),e},scopemapName(){let e=`"${this.key}": "${this.value}"`;return this.isLast||(e+=","),e},appName(){let i=e;if(i.length>0&&"/"===i[i.length-1]&&(i=i.substring(0,i.length-1)),c){let e=c.split("/"),t=e.length-1;i=t>2?`${i}/${e[t-1]}/${e[t]}`:`${i}/${c}`}return t&&U&&(i=_),i},appIntegrity:"",id:r,name:o,group:l,jsName(){let e,t=globalThis.location.origin;return s.currentBaseURL&&(t=s.currentBaseURL),t&&t.length>0&&"/"===t[t.length-1]&&(t=t.substring(0,t.length-1)),e=`<script src="${t}${this.pathname}"  crossorigin><\/script>`,e},background:f},w){let e=[],t=w;Object.getOwnPropertyNames(t).forEach((i=>{let n=t[i],s={};"string"==typeof n?(s.key=i,s.pathname=n):(s.key=i,s.pathname=n.pathname,s.integrity=n.integrity),e.push(s)})),e.length>0&&(e[e.length-1].isLast=!0),y.globalmap=e}if(P){let e,t=[];e=Object.getOwnPropertyNames(P.imports),e.forEach((e=>{let i={},n=P.imports[e];i.key=e,i.value=n,t.push(i)})),t.length>0&&(t[t.length-1].isLast=!0),y.importmap=t,y.scopeName=M,t=[];let i=P.scopes[M];i&&(e=Object.getOwnPropertyNames(i),e.forEach((e=>{let n={},s=i[e];n.key=e,n.value=s,t.push(n)})),t.length>0&&(t[t.length-1].isLast=!0)),y.scopemap=t}y.jsImportShim='<script async src="/systemjs/es-module-shims.wasm.1.7.3.js"><\/script>',t&&U?(y.moduleType="-shim",y.shimOptions="\n<script  crossorigin=\"anonymous\">\nwindow.esmsInitOptions = {\nshimMode: true, // default false\nnoLoadEventRetriggers: true, // default false\nmapOverrides: true, // default false\n\n// -- Hooks --\n// Module load error\nonerror (e) {  \n  console.log('[shims] onerror', e);\n},\n\n// resolve (id, parentUrl, resolve) {\n//   console.log('[shims] resolve ', id, parentUrl);\n//   resolve(id, parentUrl);\n// },\n\nfetch (url, options) {\n  let str = url;\n  let index = url.lastIndexOf('/');\n  let filename = url.substring(index+1);\n  index = filename.lastIndexOf('.');\n  if(index < 0) {\n    url = url + '.js';\n    filename += '.js';\n  } else {\n    let ext = filename.substring(index+1);\n    // console.log(index, ext);\n  }\n  console.log('[shims] filename', filename);\n  return fetch(url, options);\n},\n\n// meta (meta, url) {\n//   console.log('[shims] meta', meta, url);\n// },\n// onimport (url, options, parentUrl) {\n//   console.log('[shims] onimport', url, options, parentUrl);\n// }\n}\n\n<\/script>\n"):y.moduleType="-shim",h.rendered=a.Mustache.render(ci(h.templateVersion),y)}else if("game.3.0"===h.templateVersion){let e=globalThis.location.origin;s.currentBaseURL&&(e=s.currentBaseURL);let t=e;if(t&&t.length>0&&"/"===t[t.length-1]&&(t=t.substring(0,t.length-1)),y={appName(){let e=t;return e="debug"===p?`${e}/${c}`:`${e}/${i.projectURL}${c}`,e},appIntegrity:"",id:r,name:o,group:l,jsName(){let e,i=`${t}${this.pathname}`,n="";return this.integrity&&(n=`integrity="${this.integrity}"`),this.isLast,e=`<script src="${i}" ${n} crossorigin><\/script>`,e},background:f},w){let e=[],t=w;Object.getOwnPropertyNames(t).forEach((i=>{let n=t[i],s={};"string"==typeof n?(s.key=i,s.pathname=n):(s.key=i,s.pathname=n.pathname,s.integrity=n.integrity),e.push(s)})),e.length>0&&(e[e.length-1].isLast=!0),y.importmap=e}h.rendered=a.Mustache.render(ci(h.templateVersion),y)}else if("game.2.0"===h.templateVersion){let e=globalThis.location.origin;s.currentBaseURL&&(e=s.currentBaseURL);let t=e;t&&t.length>0&&"/"===t[t.length-1]&&(t=t.substring(0,t.length-1)),y={appName:c,id:r,name:o,group:l,importmapName(){let e=t;s.currentBaseURL&&(this.pathname=this.pathname.replace(i.projectURL,"/"));let n,a=`${e}${this.pathname}`;return n=`"${this.key}": "${a}"`,this.isLast||(n+=","),n},systemjsURL(){let e=`${t}/`;return e=s.currentBaseURL?`${e}systemjs/6.14.1/system.min.js`:"/systemjs/6.14.1/system.min.js",e},background:f};let n=[];if(y.importmap=n,w){let e=w;Object.getOwnPropertyNames(e).forEach((t=>{let a=e[t],r={};"string"==typeof a?(r.key=t,r.pathname=a):(r.key=t,s.currentBaseURL?r.pathname=a.pathname.replace(i.projectURL,"/"):r.pathname=a.pathname,r.integrity=a.integrity),n.push(r)}))}if(y.appName=`${l}-${r}`,"debug"===p){n.push({key:`${l}-${r}`,pathname:`${c}`});let t=e;t&&t.length>0&&"/"===t[t.length-1]&&(t=t.substring(0,t.length-1)),y.appName=`${t}${c}`}else{let t=e;s.currentBaseURL?(n.push({key:`${l}-${r}`,pathname:`/${c}`}),y.appName=`${t}${c}`):(n.push({key:`${l}-${r}`,pathname:`${i.projectURL}${c}`}),y.appName=`${t}${i.projectURL}${c}`)}n.length>0&&(n[n.length-1].isLast=!0),h.rendered=a.Mustache.render(ci(h.templateVersion),y)}else if("slot.2.1"===h.templateVersion){let e="";s.currentBaseURL&&(e=s.currentBaseURL);let t=e;t&&t.length>0&&"/"===t[t.length-1]&&(t=t.substring(0,t.length-1));let n="";y={appName(){let e=t;return e=""===t?`${c}`:s.currentBaseURL?`${e}/${c}`:`${e}${i.projectURL}${c}`,e},systemjsURL(){let e=`${t}/`;return e=`${e}systemjs/system.js`,e},appConfig:()=>n,id:r,name:o,group:l,background:f},$.info.langID=h.game.langID;let u=i.projectURL;s.currentBaseURL&&(u="/");let p=`${t}${u}config/${l}/${g}/browser.config.js`;""===t&&(p=`config/${l}/${g}/browser.config.js`),fetch(p,{headers:{"Content-Type":"text/plain"}}).then((e=>e.ok?e.text():null)).then((e=>{if(!e)return null;if(n=new String(e),""!==t){let e=`${t}/dependence/`;s.currentBaseURL&&(e=`${s.currentBaseURL}dependence/`),n=n.replace("dependence/",e)}h.rendered=a.Mustache.render(ci(h.templateVersion),y),k.src="data/template/9ef1c941a7edfbb9.html",k.addEventListener("load",(()=>{if(!s.isIframeLoaded&&(s.isIframeLoaded=!0,m.updateManager.setTimeout((()=>{let e=k.contentDocument||k.contentWindow.document;e.open(),e.write(h.rendered||"!!!! unknown template !!!!"),e.close()}),.05),s.checkItem)){let e=s.checkItem,t=Math.round(performance.now());e.timeOnload=t-s.timestamp,s.timestamp=t,e.state="web",d.redraw()}}),{capture:!0,once:!0})}))}if("slot.2.1"!==h.templateVersion){k.src="data/template/9ef1c941a7edfbb9.html";const e=()=>{if(!s.isIframeLoaded&&(s.isIframeLoaded=!0,m.updateManager.setTimeout((()=>{let e=k.contentDocument||k.contentWindow.document;e.open(),e.write(h.rendered||"!!!! unknown template !!!!"),e.close()}),.05),s.checkItem)){let e=s.checkItem,t=Math.round(performance.now());e.timeOnload=t-s.timestamp,s.timestamp=t,e.state="web",d.redraw()}};k.addEventListener("load",e,{capture:!0,once:!0})}}})],u.gamePage=S,u.info={iframe:{},token:o.info.token,gameName:h.game.name,logo:h.game.baseURL+h.game.logo,version:h.game.version||"0.9.9",open(e){h.childrenVisible=!0,h.currentUrl=e,d.redraw()}},z=$.gamecard,A=z;let H=r;o.mode===H.REAL?u.info.mode=p("gameModeReal"):u.info.mode=p("gameModeDemo"),d.redraw()},onremove(){Ye(this.options.setting)},view(){let e,t=this.options,n=t.setting,s=t.objList||[];if(t.info&&t.info.iframe&&Ae.isMobile){t.info.iframe.style||(t.info.iframe.style={});let e=t.info.iframe.style;e.width=n.width,e.height=n.height}if(t.initGame){e=!n.isChild&&Ae.isMobile?(Ae.useFullscreen,{position:"absolute",left:"0px",top:Ae.currentY+"px",width:"100%",height:"100%",backgroundColor:"rgba(0,0,0,0)"}):{position:"absolute",left:"0px",top:"0px",width:"100%",height:"100%",backgroundColor:"rgba(0,0,0,0)"},n.isCheckData&&(e={left:"0%",top:"0%",width:"100%",height:"100%",backgroundColor:"rgba(0,0,0,0)"});let a="";return n.images.useBackground&&(a=n.background),d(".",{style:e},n.isChild?null:d(".center",{style:{overflowY:"hidden",position:"absolute",zIndex:1,top:"0%",left:"0%",width:`${globalThis.innerWidth}px`,height:`${globalThis.innerHeight}px`}},d(".aspect-ratio--object cover",{style:{background:`url(${a}) center`}})),d(".",{oncreate:t.initGame,style:{position:n.position,boxShadow:n.backgroundCSS,left:n.left,top:n.top,width:n.width,height:n.height,zIndex:n.zIndex||2,opacity:n.opacity,display:n.display}},t.gamePage,s.map((e=>e?(e.attrs.fix=n,e.attrs.updateBlur=t.event.updateBlur,d(e.com,e.attrs)):null)),n.sysTray&&n.sysTray.visible?d(Ue,{style:n.sysTray.style,config:n.sysTray}):null,n.sysTray&&n.sysTray.isMenu?d(Me,{tray:t.tray,event:t.event,info:t.info,config:n.sysTray}):null),n.childrenVisible?d(Ze,{url:n.currentUrl,manager:n}):null,i.msg.length>0?d(".",{style:{position:"absolute",color:"#fff",left:"50%",top:"0%",width:"64px",height:"16px",zIndex:900}},i.msg):null)}return d(".")}},dt={oninit(e){let t=e.attrs;this.options=t.options,this.saveConfig={}},oncreate(){},view(){let e=this.options,t=e.scene.pixiConfig,i=this.saveConfig;return d("article.pa4.white",d("form",[d("fieldset.ba.b--transparent.ph0.mh0",[d("legend.ph0.mh0.fw6.white","遊戲場景設定"),d(".mt3",d("label.db.fw4.lh-copy.f6","寬"),d("input.pa2.input-reset.ba.bg-transparent.w-40.red",{id:"width",name:"width",oninput(e){let n=e.target.value;i.width=parseInt(n),t.width=n},value:t&&t.width})),d(".mt3",d("label.db.fw4.lh-copy.f6","高"),d("input.b.pa2.input-reset.ba.bg-transparent.w-40.red",{id:"height",name:"height",oninput(e){let n=e.target.value;i.height=parseInt(n),t.height=n},value:t&&t.height})),d(".mt3",d("label.db.fw4.lh-copy.f6","解析度"),d("input.b.pa2.input-reset.ba.bg-transparent.w-40.red",{id:"resolution",name:"resolution",oninput(e){let n=e.target.value;i.resolution=parseFloat(n),t.resolution=n},value:t&&t.resolution})),d(".mt3",d("label.db.fw4.lh-copy.f6","是否反鋸齒"),d("input.b.pa2.input-reset.ba.bg-transparent.w-40.red",{id:"antialias",name:"antialias",oninput(e){let n=e.target.value;i.antialias=!1,"true"===n&&(i.antialias=!0),t.antialias=n},value:t&&t.antialias})),d(".mt3",d("label.db.fw4.lh-copy.f6","是否透明"),d("input.b.pa2.input-reset.ba.bg-transparent.w-40.red",{id:"transparent",name:"transparent",oninput(e){let n=e.target.value;i.transparent=!1,"true"===n&&(i.transparent=!0),t.transparent=n},value:t&&t.transparent})),d(".mt3",d("input.b.ph3.pv2.input-reset.ba.b--black.bg-transparent.grow.pointer.f6 white",{onclick(){Object.getOwnPropertyNames(i).forEach((e=>{t[e]=i[e]})),e&&e.ready&&(e.visible=!1,e.ready())},value:"確定"}))])]))}},mt=null,pt=null,ft={oninit(e){let t=this,r=e.attrs;t.style=r.style,t.options=r.options,t.resource=r.resource,t.timeout=null,t.isLeave=!1;let o={start(){},resBegin(){},resEnd(){},sceneResBegin(){},sceneResLoading(){t.timeout&&(m.updateManager.remove(t.timeout),t.timeout=null),t.isLeave||(t.timeout=m.updateManager.setTimeout((()=>{t.isLeave=!0,t.game&&(t.game.stop(),t.game=null),t.options&&t.options.ready&&t.options.ready();let e=s;n[e.OVERVIEW_ANIMATION]=!1,n[e.OVERVIEW_PROGRESS]=!0,d.redraw(),t.timeout=null}),5))},sceneResEnd(){},finish(){t.timeout&&(m.updateManager.remove(t.timeout),t.timeout=null)}};!async function(){if(!mt)try{let e=import.meta.resolve("scenes/loading");pt=e.substring(0,e.indexOf("scenes/loading")),pt+="scenes/loading",mt=await import(e)}catch(e){t.options&&t.options.ready&&t.options.ready();let i=s;return n[i.OVERVIEW_ANIMATION]=!1,n[i.OVERVIEW_PROGRESS]=!0,void d.redraw()}let e;try{e=await mt.scene.init({app:a,resName:"base",langID:f(),baseURL:pt,useAvif:i.useAvif})}catch(e){}e&&(t.resource.setting=e,Ge(e),t.pixiConfig=mt.scene.pixiConfig,et.engine||(t.pixiConfig.view=et.canvas,et.engine=st(t.pixiConfig),et.game.setEngine(et.engine))),async function(e){e.resource=r.resource,e.play(),t.game=e;try{t.scene=await mt.scene.create(e,o,m)}catch(i){t.resource.setting&&Ye(t.resource.setting),e.stop(),t.options&&t.options.ready&&t.options.ready();let a=s;return n[a.OVERVIEW_ANIMATION]=!1,n[a.OVERVIEW_PROGRESS]=!0,void d.redraw()}t.options&&t.options.ready&&t.options.ready()}(et.game)}()},async oncreate(e){let t=this,i=e.dom;et.game&&et.game.layer&&(et.game.layer.background.removeChildren(),await et.game.idle(.01)),i.appendChild(et.canvas),t.resource.setting&&Ge(t.resource.setting)},onremove(e){let t=this;e.dom.removeChild(et.canvas),t.resource.setting&&Ye(t.resource.setting);let i=t.game;i&&i.stop()},view(){let e=this;return e.pixiConfig?d(".",{id:"loading9999",style:e.style}):d(".")}};function bt(e){let t,i=e[0],n=1;for(;n<e.length;){const s=e[n],a=e[n+1];if(n+=2,("optionalAccess"===s||"optionalCall"===s)&&null==i)return;"access"===s||"optionalAccess"===s?(t=i,i=a(i)):"call"!==s&&"optionalCall"!==s||(i=a(((...e)=>i.call(t,...e))),t=void 0)}return i}let wt,yt=s,vt={oninit(e){let s=this,a=e.attrs,r=a.setUpdateEvent;s.scene=a.scene,s.ready=a.ready,s.serve=a.serve,s.finish=a.finish,s.manager=a.manager;let h=n;if(!i.useOptions){let e=s.scene.options;if(e){h[yt.OVERVIEW_LOGO]=!1,//!!overview.logo;
l.isCheckGameCDN?h[yt.OVERVIEW_ANIMATION]=!1:h[yt.OVERVIEW_ANIMATION]=!0,h[yt.OVERVIEW_BACKGROUND]=!0,h[yt.OVERVIEW_PROGRESS]=!1;let t=e.game;t&&(h[yt.GAME_SCENE_CUSTOM]=!!t.custom,h[yt.GAME_PERFORMANCE_FPS]=!!t.fps,h[yt.GAME_DEBUG_MODE]=!!t.debug,h[yt.GAME_DIALOG_CUSTOM]=!!t.useDialog)}}s.elementLogo=null,s.progress=0,s.progressValue=0,s.baseURL=s.scene.baseURL||"",Je(s.scene.screen),Xe(),h[yt.OVERVIEW_LOGO]&&(s.setting={id:"logo",isLock:!0,useCenter:!0,left:"25%",top:"25%",width:"50%",height:"50%",game:{width:512,height:512},reference:{left:.25,top:.25,width:.5,height:.5}});s.settingBackground={id:"background",isLock:!1,left:"0%",top:"0%",width:"100%",height:"100%",game:{width:10240,height:10240},reference:{left:0,top:1,width:1,height:1}},s.message="建立預覽",s.display="inline",s.isFinish=!1,s.options={scene:s.scene,visible:!0,ready:s.ready},s.scene.pixiConfig||(n[yt.GAME_SCENE_CUSTOM]=!1);let g=l;s.manager.show=()=>{kt.overview.visible=!0,d.redraw()},s.manager.hide=()=>{kt.overview.visible=!1,d.redraw()},s.leave=function(){if(!l.isCheckGameCDN)if(s.isFinish=!0,g.isFinish=!0,i.isReload=!1,d.redraw(),i.disableNet){if(!kt.manual.overview){let e=kt.overview.manager;e.hide&&e.hide()}let e=di(),t={id:s.scene.id},i=e.scene[t.id];i&&i.localEvent&&i.localEvent.enter(t)}else s.title=p("connecting"),s.message=p("start"),o.isKickOut||(c.isLogin?(Nt(),St()):s.serve&&gi(s.serve).then((()=>{s.title=p("quickPlay"),d.redraw()})))},s.timeout=null;let u={start(){s.message="開始讀取遊戲資料",d.redraw(),bt([g,"optionalAccess",e=>e.loadingEvent,"optionalAccess",e=>e.start,"call",e=>e()])},resBegin(e){bt([g,"optionalAccess",e=>e.loadingEvent,"optionalAccess",e=>e.resBegin,"call",t=>t(e)])},resEnd(e){bt([g,"optionalAccess",e=>e.loadingEvent,"optionalAccess",e=>e.resEnd,"call",t=>t(e)])},sceneResBegin(e){bt([g,"optionalAccess",e=>e.loadingEvent,"optionalAccess",e=>e.sceneResBegin,"call",t=>t(e)])},sceneResLoading(e){let a=0;if(Object.prototype.hasOwnProperty.call(e,"totalProgress")){let t=e.state,i=e.totalProgress;if(t){i=(t.currentIndex-1)/t.totals*100+i/t.totals}a=i.toFixed(0),s.progress=a,s.progressValue=.01*i}else{let t=e.current/e.length;a=(100*t).toFixed(0),s.progress=a,s.progressValue=t}s.isFinish||(s.timeout&&(m.updateManager.remove(s.timeout),s.timeout=null),t||(s.timeout=m.updateManager.setTimeout((()=>{i.isReload=!0,ti({url:s.baseURL,group:s.scene.group,game:s.scene.appConfig}),s.timeout=null}),5))),n[yt.OVERVIEW_PROGRESS]&&d.redraw(),bt([g,"optionalAccess",e=>e.loadingEvent,"optionalAccess",e=>e.sceneResLoading,"call",e=>e(a)])},sceneResEnd(e){bt([g,"optionalAccess",e=>e.loadingEvent,"optionalAccess",e=>e.sceneResEnd,"call",t=>t(e)])},async finish(){if(s.timeout&&(m.updateManager.remove(s.timeout),s.timeout=null),i.requestReload)return;let e=i.store;if(e)try{await e.setItem("baseURL",globalThis.BASE_URL)}catch(e){}n[yt.OVERVIEW_ANIMATION]&&s.animationLeave?s.animationLeave():s.leave(),bt([g,"optionalAccess",e=>e.loadingEvent,"optionalAccess",e=>e.finish,"call",e=>e()])}};r&&r(u)},oncreate(){let e=this;e.setting&&Ge(e.setting),e.settingBackground&&Ge(e.settingBackground),We(!0),i.requestReload&&(i.requestReload=!1),n[yt.GAME_SCENE_CUSTOM]||n[yt.OVERVIEW_ANIMATION]||e.options.ready&&e.options.ready()},onremove(){self.setting&&Ye(self.setting),self.settingBackground&&Ye(self.settingBackground)},onbeforeremove:e=>(["animate__animated","animate__fadeOut","animate__faster"].forEach((t=>{e.dom.classList.add(t)})),new Promise((function(t){e.dom.addEventListener("animationend",t)}))),view(){let e=this,t=l.setting,s=e.settingBackground,a=e.setting,r=e.options;e.display,t||(t={left:"0%",top:"0%",width:"0%",height:"0%"}),Ae.isMobile&&Ae.currentY;let o="",c=i.images;return c&&(o=globalThis.innerHeight>globalThis.innerWidth?c.background[`${i.agent}Portrait`]:c.background[`${i.agent}Landscape`]),globalThis.BASE_URL&&(o=globalThis.BASE_URL+"agent/"+o),d(".",{style:{display:e.display,position:"absolute",zIndex:100,left:s.left,top:`${Ae.currentY+parseInt(s.top)}px`,width:s.width,height:s.height}},d(".",{style:{position:"absolute",left:"0%",top:"0%",width:"100%",height:"100%"}},d(".aspect-ratio--object cover",{style:{zIndex:0,background:`url(${o}) center`}})),n[yt.OVERVIEW_ANIMATION]?d(".",{style:{position:"absolute",left:t.left,top:t.top,width:t.width,height:t.height}},d(ft,{style:{position:"absolute",left:"0%",top:"0%",width:"100%",height:"100%"},options:r,resource:l})):null,!i.isReload&&n[yt.OVERVIEW_LOGO]?d(".",{style:{position:"absolute",left:"25%",top:"25%",width:"50%",height:"50%"}},d("img",{oncreate(t){e.elementLogo=t.dom},src:i.logo,onload(){["animate__animated","animate__fadeIn"].forEach((t=>{e.elementLogo.classList.add(t)}))},style:{opacity:0,zIndex:700,position:"absolute",left:a.left,top:a.top,width:a.width,height:a.height}})):null,n[yt.GAME_SCENE_CUSTOM]&&r.visible?d(".",{style:{position:"absolute",zIndex:300,left:"0%",top:"0%",width:"100%",height:"100%"}},d(".pv2 mb2 white bg-dark-green o-20",{style:{position:"absolute",left:"0%",top:"0%",width:"100%",height:"100%"}}),d(".",{style:{position:"absolute",left:"0%",top:"0%",width:"100%",height:"100%"}},d(dt,{options:r}))):null,n[yt.OVERVIEW_PROGRESS]&&!e.isFinish?d(".",{style:{zIndex:100,position:"absolute",left:"10%",top:"90%",width:"80%",height:"4%"}},d("progress.progress",{style:{position:"absolute",left:"0%",top:"0%",width:"100%",height:"40%"},max:"100",value:`${e.progress}`}),d(".tc",{style:{position:"absolute",left:"0%",top:"30%",width:"100%",height:"60%",color:"#a0cdff"}},d("p.v-btm",`${p("loading")} ${e.progress}%`))):null)}},xt={fatal(e){},high(e){},middle(e){},low(e){}},Lt={disableDialog:!1,handle(){let e=s;if(c.state="未連線",i.isInGame&&globalThis.scene){Object.getOwnPropertyNames(globalThis.scene).forEach((e=>{let t=globalThis.scene[e];t&&t.game&&t.game.disconnect&&t.game.disconnect()}))}Lt.disableDialog||n[e.GAME_DIALOG_CUSTOM]&&(c.isError||m.updateManager.setTimeout((()=>{c.isError||k({title:"errorLow",msg:"disconnect"})}),2))}},Ct={handle(t){let i=di();c.state="遊戲中",Lt.disableDialog=!0,e.serviceEnd(Ct.report),e.log({label:"net",category:"進入遊戲"});let n={id:t.gid};R();let s=i.scene[n.id];s&&s.localEvent&&s.localEvent.enter(n)},report:{time:0,category:"進入遊戲",getLabel:()=>"net"},error:xt.low};let Tt={position:"absolute",left:"0%",top:"0%",width:"100%",height:"100%",backgroundColor:"rgba(0,0,0,0)"},Et=[{style:{zIndex:10,position:"absolute",left:"5%",top:"5%",width:"30%",height:"85%"},reference:{left:.05,top:.05,width:.3,height:.85}},{style:{zIndex:10,position:"absolute",left:"35%",top:"5%",width:"30%",height:"85%"},reference:{left:.35,top:.05,width:.3,height:.85}},{style:{zIndex:10,position:"absolute",left:"65%",top:"5%",width:"30%",height:"85%"},reference:{left:.65,top:.05,width:.3,height:.85}}],kt={overview:{visible:!0,manager:{}},packet:null,gid:null,manual:{overview:!1}},Rt={visible:!1},Ot="",It=[],$t={oninit(e){let t=e.attrs,i=this;i.isLoading=!1;let n=t.loadingEvent,s=o,a={id:t.id,decimal:0,mode:s.mode,isCreate:!0,scene:t.scene,loadingEvent:{start(){i.isLoading=!0,n&&n.start&&n.start()},resBegin(e){n&&n.resBegin&&n.resBegin(e)},resEnd(e){n&&n.resEnd&&n.resEnd(e)},sceneResBegin(e){n&&n.sceneResBegin&&n.sceneResBegin(e)},sceneResLoading(e){n&&n.sceneResLoading&&n.sceneResLoading(e)},sceneResEnd(e){n&&n.sceneResEnd&&n.sceneResEnd(e)},finish(e){e&&e.localEvent&&(t.localEvent=e.localEvent),i.isLoading=!1,t.finish&&t.finish(e),n&&n.finish&&n.finish(e)}}};i.config=a,i.style=t.style,i.reference=t.reference,i.fix=t.fix,i.absPos=t.absPos,i.updateBlur=t.updateBlur,i.isChild=t.isChild},view(){let e=this;return d(".",{style:e.style},d(ut,{updateStyle(t){if(t){let i=e.style;i.display=t.display||i.display,Object.prototype.hasOwnProperty.call(t,"opacity")&&(i.opacity=t.opacity),Object.prototype.hasOwnProperty.call(t,"zIndex")&&(i.zIndex=t.zIndex)}},config:e.config,currentBaseURL:globalThis.BASE_URL,left:"0%",top:"0%",width:"100%",height:"100%",reference:e.reference,updateBlur:e.updateBlur,fix:e.fix,isChild:e.isChild,absPos:e.absPos}))}},Ut={oninit(e){let t=e.attrs,i=this,n=t.sceneInfo;i.objList=t.objList,i.serve=t.serve,i.isReady=!1;let s={reload(){i.isReady=!1}},a={};let r=o,l={id:n.id,decimal:0,mode:r.mode,isCreate:!0,scene:n,loadingEvent:{start(){a.start&&a.start()},resBegin(e){a.resBegin&&a.resBegin(e)},resEnd(e){a.resEnd&&a.resEnd(e)},sceneResBegin(e){a.sceneResBegin&&a.sceneResBegin(e)},sceneResLoading(e){a.sceneResLoading&&a.sceneResLoading(e)},sceneResEnd(e){a.sceneResEnd&&a.sceneResEnd(e)},finish(){a.finish&&a.finish()}}};kt.packet=null,kt.gid=n.id||i.serve.id,i.setUpdateEvent=function(e){a=e},i.gameConf=l,i.sceneInfo=n,i.ctrlEvent=s,i.event={ready:function(){i.isReady=!0,d.redraw()},finish:function(){let e=ui();const t=m.Lobby.CMD;e&&e.setLobbyCommand(t.IN_GAME,{packet:null,gid:n.id||i.serve.id})}}},view(){let e=this,t=e.objList,i=e.gameConf,n=e.event;return d(".",{style:Tt},Rt.visible&&e.isReady?d(ut,{currentBaseURL:globalThis.BASE_URL,sysTray:e.sceneInfo.sysTray,ctrlEvent:e.ctrlEvent,config:e.gameConf,zIndex:4,left:"0%",top:"0%",width:"100%",height:"100%",objList:t}):null,d(".",kt.overview.visible?d(vt,{manager:kt.overview.manager,serve:e.serve,scene:i.scene,setUpdateEvent:e.setUpdateEvent,ready(){n.ready()},finish(){n.finish()}}):null))}};async function Mt(){return new Promise((e=>{Object.getOwnPropertyNames(globalThis.scene).forEach((e=>{let t=globalThis.scene[e];t&&(delete t.event,delete t.loadingEvent),delete globalThis.scene[e]})),globalThis.scene={},oi({oncreate(){e()},view:()=>null})}))}function _t(t){wt=i.langID,i.serve=t.serve,kt.manual={overview:!1},kt.overview.visible=!0,function(t){let n=null;if(t.gameCard)n=t.gameCard;else{let e;e=F(t.group),n=e[t.id]}if(!n)return;n.manual&&(kt.manual=n.manual,n.manual.disableNet&&(i.disableNet=!0)),e.report.name=`${n.group}/${n.appConfig}`,Ot=n.group;let s=n.baseURL||"",a=n.images;if(i.useAvif?a.v2&&(a=a.v2):a.v1&&(a=a.v1),a.icon){let e=document.getElementsByTagName("link");if(e){let t=e[0];if(t)if(t.setAttribute("crossorigin","icon"),t.setAttribute("rel","icon"),t.setAttribute("type","image/png"),"kc"===i.agent){let e="data/img/logo/kc/87faada2e433ffce.ico";t.setAttribute("href",e)}else t.setAttribute("href",s+a.icon)}}let r=n.app;"object"==typeof r&&(r=r[wt]),n.name[wt]?document.title=n.name[wt]:document.title=n.name[b.EN],Rt.objList=It,Rt.sceneInfo=n,Rt.serve=t.serve,Rt.visible=!0,oi(Ut,Rt)}(t)}function Pt(e,t=0){let n=e,s=t;"number"==typeof e&&(n=t,s=e);let a=n.groupName||Ot;return B(n.sceneID,a,globalThis.BASE_URL).then((e=>{let t=Et[s],a=e.gameCard;if(!a)return;n.reloadConfig&&(a.reloadConfig=n.reloadConfig),t||(t={style:Tt,reference:{left:0,top:0,width:1,height:1}});let r={com:$t,attrs:{loadingEvent:n.loadingEvent,index:s,style:n.style||t.style,reference:n.reference||t.reference,absPos:n.absPos||t.absPos,id:n.id,scene:a,isChild:!0,finish:function(e){i.isReload||n.finish&&n.finish(e)}}};i.isReload||(null!==It[s]?(It[s]=null,d.redraw(),m.updateManager.setTimeout((()=>{It[s]=r,d.redraw()}),.1)):(It[s]=r,d.redraw()))}))}function At(e){It[e]=null,d.redraw()}function Ft(){It=[],Rt.visible=!0,d.redraw()}let Bt=!1;function Nt(){Bt=!1}function St(){let t=ui();const n=m.Lobby.CMD;let s=kt;if(Bt)return!0;let a=i,r=c;if(m.updateManager.setTimeout((()=>{"遊戲中"!==r.state&&(globalThis.Howler&&(globalThis.Howler.mute(!0),globalThis.Howler.unload()),k({title:"connecting",msg:"disconnect"}))}),.001*h),a.module?import("./agent.49e39545.js").then((e=>{e.ingame({name:o.game,group:o.group,gid:s.gid})})):(t&&t.setLobbyCommand(n.IN_GAME,{packet:s.packet,gid:s.gid}),e.serviceBegin(Ct.report)),Bt=!0,!s.manual.overview){let e=s.overview.manager;e.hide&&e.hide()}return!0}var zt=Object.freeze({__proto__:null,clean:Ft,create:Pt,currentGame:kt,destroy:At,enterGame:St,imgWaiting:function(){return'<svg class="hourglass" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 120 206" preserveAspectRatio="none">\n  <path class="middle" d="M120 0H0v206h120V0zM77.1 133.2C87.5 140.9 92 145 92 152.6V178H28v-25.4c0-7.6 4.5-11.7 14.9-19.4 6-4.5 13-9.6 17.1-17 4.1 7.4 11.1 12.6 17.1 17zM60 89.7c-4.1-7.3-11.1-12.5-17.1-17C32.5 65.1 28 61 28 53.4V28h64v25.4c0 7.6-4.5 11.7-14.9 19.4-6 4.4-13 9.6-17.1 16.9z"/>\n  <path class="outer" d="M93.7 95.3c10.5-7.7 26.3-19.4 26.3-41.9V0H0v53.4c0 22.5 15.8 34.2 26.3 41.9 3 2.2 7.9 5.8 9 7.7-1.1 1.9-6 5.5-9 7.7C15.8 118.4 0 130.1 0 152.6V206h120v-53.4c0-22.5-15.8-34.2-26.3-41.9-3-2.2-7.9-5.8-9-7.7 1.1-2 6-5.5 9-7.7zM70.6 103c0 18 35.4 21.8 35.4 49.6V192H14v-39.4c0-27.9 35.4-31.6 35.4-49.6S14 81.2 14 53.4V14h92v39.4C106 81.2 70.6 85 70.6 103z"/>\n</svg>'},init:_t,get isInGame(){return Bt},reload:Mt,reset:Nt});let Ht={oninit(e){let t=e.attrs,i=t.strings,n=t.dspScreen,s=t.gameManager;this.strings=i,this.dspScreen=n,t.yesno||s.clean(),this.title=t.title,this.msg=t.msg,this.setting={id:"dialog",isLock:!1,useCenter:!1,left:"0%",top:"0%",width:"100%",height:"100%",game:{width:1024,height:1024},reference:{left:0,top:0,width:1,height:1}},n.addSetting(this.setting)},oncreate(){},view(){let e=this,t=e.setting,i=null,n=e.strings,s=e.dspScreen;return i=s.state.isMobile?{position:"absolute",left:t.left,top:s.state.currentY+"px",backgroundColor:"rgba(0,0,0,1)",zIndex:990,opacity:1,width:t.width,height:t.height}:{position:"absolute",left:t.left,top:t.top,backgroundColor:"rgba(0,0,0,1)",zIndex:990,opacity:1,width:t.width,height:t.height},d(".",{style:i},d(".bg-moon-gray ba bw1",{style:{position:"absolute",left:"10%",top:"10%",width:"80%",height:"75%"}},d(".bg-near-black white f4 fw6 pa4",{style:{position:"absolute",left:"0%",top:"0%",width:"100%",height:"20%"}},d(".tc",n.get(e.title)||"title")),d(".tc pa5",{style:{position:"absolute",left:"0%",top:"20%",width:"100%",height:"50%"}},d.trust(n.get(e.msg))||"body message")))}},Vt={oninit(){let e=this;e.timeValue=-1,e.touchmoveOnce=!1,e.fields=["一","二","三","四","五","六","七","八","九","十","一","二","三","四","五","六","七","八","九","十"],e.pageY=0,e.imgRotate={id:"rotate",isLock:!0,useCenter:!0,left:"10%",top:"10",width:"80%",height:"80%",game:{width:5120,height:5120},reference:{left:0,top:0,width:1,height:1}},e.imgFullscreen={id:"screen",isLock:!0,useCenter:!0,left:"10%",top:"10",width:"80%",height:"80%",game:{width:5120,height:5120},reference:{left:0,top:0,width:1,height:1}}},view(){let e=this,t=Ae,i=t.orientation,n=globalThis.innerWidth,s=globalThis.innerHeight;return i.isTrigger&&(n*=2.5,s*=2.5),t.isMobile&&t.currentY,[t.isTouchOnce&&t.isFullscreen?null:d(".",{style:{zIndex:850,position:"absolute",left:"0%",top:t.currentY+"px",width:(n||t.screenWidth)+"px",height:(s||t.screenHeight)+"px",backgroundColor:"rgba(0,0,0,1)"},ontouchmove(e){Ae.isMobile&&!Ae.ios&&e.preventDefault()},ontouchend(){if(globalThis.Howl){let e=new globalThis.Howl({src:["data/f82550ea2e80cd97.wav"]});e&&(e.volume(.001),e.play())}if(t.isFullscreen=!0,t.isTouchDown=!1,t.isTouchOnce=!0,Ae.ios){let e=globalThis.scene;t.settingList.forEach((t=>{if(e){let i=e[t.id];if(i){(i.game&&i.game.sysTray).isFullscreen=!1}}})),d.redraw(),We(),t.mobileReady&&t.mobileReady()}else Oe().then((()=>{let e=globalThis.scene;t.settingList.forEach((t=>{if(e){let i=e[t.id];if(i){(i.game&&i.game.sysTray).isFullscreen=!0}}})),d.redraw(),We(),t.mobileReady&&t.mobileReady()})).catch((()=>{let e=globalThis.scene;t.settingList.forEach((t=>{if(e){let i=e[t.id];if(i){(i.game&&i.game.sysTray).isFullscreen=!1}}})),d.redraw(),We(),t.mobileReady&&t.mobileReady()}))},ontouchstart(i){if(globalThis.Howl){let e=new globalThis.Howl({src:["data/f82550ea2e80cd97.wav"]});e.volume(.001),e.play()}if(t.isTouchDown)return;t.isTouchDown=!0;let n=i.changedTouches||i.originalEvent.touches;if(n){let t=n[0];e.pageY=t.pageY}}},d(".",{oncreate(){Ge(e.imgFullscreen)},onremove(){Ye(e.imgFullscreen)},style:{position:"absolute",left:"10%",top:"10%",width:"80%",height:"80%"}},d("img",{src:"data/img/c7aecda7af142624.png",style:{position:"absolute",zIndex:850,left:e.imgFullscreen.left,top:e.imgFullscreen.top,width:e.imgFullscreen.width,height:e.imgFullscreen.height}}))),!i.isTrigger&&t.useOrientation&&t.usePortrait&&!t.isPortrait?d(".",{oncreate(){Ge(e.imgRotate),We(!0)},onremove(){Ye(e.imgRotate)},style:{zIndex:800,position:"absolute",left:"0px",top:globalThis.pageYOffset+"px",width:(globalThis.innerWidth||t.screenWidth)+"px",height:(globalThis.innerHeight||t.screenHeight)+"px",backgroundColor:"rgba(0,0,0,1)"}},d("img",{src:"data/img/f14a0482453bcc34.png",style:{position:"absolute",left:e.imgRotate.left,top:e.imgRotate.top,width:e.imgRotate.width,height:e.imgRotate.height}})):null,!i.isTrigger&&t.useOrientation&&t.useLandscape&&!t.isLandscape?d(".",{oncreate(){Ge(e.imgRotate),We(!0)},onremove(){Ye(e.imgRotate)},style:{zIndex:800,position:"absolute",left:"0px",top:globalThis.pageYOffset+"px",width:(globalThis.innerWidth||t.screenWidth)+"px",height:(globalThis.innerHeight||t.screenHeight)+"px",backgroundColor:"rgba(0,0,0,1)"}},d("img",{src:"data/img/b4c0d11274ffa254.gif",style:{position:"absolute",left:e.imgRotate.left,top:e.imgRotate.top,width:e.imgRotate.width,height:e.imgRotate.height}})):null]}},jt={"game.2.0":'<!DOCTYPE html>\n<html>\n<head>\n  <meta charset="UTF-8" />\n  <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0" />\n  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />\n  <title>game 2.0 {{{name}}}</title>\n\n  <script type="systemjs-importmap" crossorigin="anonymous">\n    {\n      "imports": {\n      {{#importmap}}\n        {{{importmapName}}}\n      {{/importmap}}\n      }\n    }\n  <\/script>\n\n</head>\n<body id="{{{id}}}" style="height:100%;width:100%;overflow-x:hidden;overflow-y:hidden">\n<script crossorigin="anonymous">\n  if(!window.globalThis) {\n    window.globalThis = window;\n  }\n\n  let isInitCache = false;\n  function initCache () {\n    if(isInitCache) {\n      return;\n    }\n    isInitCache = true;\n    let isLoaded = false;\n    let registration = null;\n    function loadScript() {\n      if(isLoaded) {\n        return;\n      }\n      isLoaded = true;\n      let script = document.createElement(\'script\');\n      script.onload = function() {\n        System.import("{{{appName}}}");\n      };\n      script.src = "{{{systemjsURL}}}";\n      document.getElementsByTagName(\'head\')[0].appendChild(script);\n    }\n    loadScript();\n  }\n  initCache();\n\n<\/script>\n</body>\n</html>\n',"game.3.0":'<!DOCTYPE html>\n<html>\n<head>\n  <meta charset="UTF-8" />\n  <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0" />\n  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />\n  <title>game 3.0 {{{name}}}</title>\n\n  {{#importmap}}\n  {{{jsName}}}\n  {{/importmap}}\n\n</head>\n<body id="{{{id}}}" style="height:100%;width:100%;overflow-x:hidden;overflow-y:hidden">\n<script crossorigin="anonymous">\n  if(!window.globalThis) {\n    window.globalThis = window;\n  }\n\n  let isInitCache = false;\n  function initCache () {\n    if(isInitCache) {\n      return;\n    }\n    isInitCache = true;\n    let isLoaded = false;\n    let registration = null;\n    function loadScript() {\n      if(isLoaded) {\n        return;\n      }\n      isLoaded = true;\n      let script = document.createElement(\'script\');\n      script.onload = function() {\n      };\n      script.src = "{{{appName}}}";\n      script.crossorigin = "anonymous";\n      document.getElementsByTagName(\'head\')[0].appendChild(script);\n    }\n    loadScript();\n  }\n\n  initCache();\n<\/script>\n</body>\n</html>\n',"game.4.0":'<!DOCTYPE html>\n<html>\n<head>\n  <meta charset="UTF-8" />\n  <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0" />\n  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />\n  <title>game 4.0 {{{name}}}</title>\n\n  {{{shimOptions}}}\n  {{{jsImportShim}}}\n\n  <script type="importmap{{{moduleType}}}">\n  {\n    "imports": {\n      {{#importmap}}\n      {{{importmapName}}}\n      {{/importmap}}\n    },\n    "scopes": {\n      "{{{scopeName}}}": {\n        {{#scopemap}}\n        {{{scopemapName}}}\n        {{/scopemap}}\n      }\n    }\n  }\n  <\/script>\n\n  {{#globalmap}}\n  {{{jsName}}}\n  {{/globalmap}}\n\n\n  <script crossorigin="anonymous">\n  if(!window.globalThis) {\n    window.globalThis = window;\n  }\n  <\/script>\n\n</head>\n<body id="{{{id}}}" style="height:100%;width:100%;overflow-x:hidden;overflow-y:hidden">\n  <script crossorigin="anonymous" type="module{{{moduleType}}}">\n    import "{{{appName}}}";\n  <\/script>\n</body>\n</html>\n',"slot.2.1":'<!DOCTYPE html>\n<html>\n  <head>\n  <meta charset="UTF-8" />\n  <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0" />\n  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />\n  <title>slot.2.1 {{{name}}}</title>\n  </head>\n  <body id="{{{id}}}" style="height:100%;width:100%;overflow-x:hidden;overflow-y:hidden">\n  <script crossorigin="anonymous">\n  if(!window.globalThis) {\n    window.globalThis = window;\n  }\n\n  let isInitCache = false;\n  function initCache () {\n    if(isInitCache) {\n      return;\n    }\n    isInitCache = true;\n    let isLoaded = false;\n    let registration = null;\n    function loadScript() {\n      if(isLoaded) {\n        return;\n      }\n      isLoaded = true;\n      let script = document.createElement(\'script\');\n      script.onload = function() {\n        {{{appConfig}}}\n        ;System.import(\'{{{appName}}}\');\n\n      };\n      script.src = "{{{systemjsURL}}}";\n      script.crossorigin = "anonymous";\n      document.getElementsByTagName(\'head\')[0].appendChild(script);\n    }\n    loadScript();\n  }\n\n  initCache();\n  <\/script>  \n  </body>\n</html>\n'};let Dt={oninit(t){let n=this,s=t.attrs,a={category:"測試CDN 主網址",getLabel:()=>"common"};e.loadBegin(a),n.cdnList=i.cdnList,n.server=o,n.ready=s.ready;let r=[];n.gamecdnFields=r,n.isFinish=!1;let l=0,c=n.cdnList.length;function h(e){l+=1,l>=c&&(n.server.cdn.errorCounts+=1,n.server.cdn.errorCounts<3?(i.requestReload=!1,i.isReload=!0,ti({url:e.target,group:e.group,game:e.appConfig||e.game})):(i.hasCDN=!1,k({yesno:!1,title:"service",msg:"errorCDN"})))}function g(t){n.isFinish||(n.isFinish=!0,t.isLight=!0,i.isCheckGameCDN=!1,n.server.cdn.errorCounts=0,e.loadEnd(a),e.log({label:"common",category:"測試CDN 主網址"}),n.ready&&n.ready(t.target))}i.isCheckGameCDN=!0,n.cdnList.forEach(((e,t)=>{let s={};s.index=t,s.isLight=!1,s.id=e.id,s.url=e.url,s.target=e.target,s.timestamp=Math.round(performance.now()),s.timeOnload=0,s.timeInit=0,s.timeScene=0,s.timeReady=9999,s.gamecard=null,s.icon="",s.isIconLoaded=!1,s.downloadEnabled=!1,s.loadingEvent={},s.ready=g,s.error=h,s.useTest=!0,r.push(s),async function(e,t,n){let s="",a=null,r=null,o=t.target,l=!1,c=f(),h=(new Date).getTime();t.group=e.group,t.game=e.game;try{if(s=e.version?`${o}${e.group}/${e.game}/config/v${e.version}`:`${o}${e.group}/${e.game}/config/gamecard.txt?v=${h}`,a=await fetch(s,{headers:{"Content-Type":"text/plain"}}),!n&&!i.isCheckGameCDN)return null;a.ok&&(r=await a.text())}catch(e){}if(!r)try{if(s=`${o}config/${e.group}/${e.game}/gamecard.txt?v=${h}`,a=await fetch(s,{headers:{"Content-Type":"text/plain"}}),!n&&!i.isCheckGameCDN)return null;a.ok&&(r=await a.text(),l=!0)}catch(e){}let g=null;if(r){g=JSON.parse(r);let s=g.images;i.useAvif?s.v2&&(s=s.v2):s.v1&&(s=s.v1);let h=null;l?(g.templateVersion="slot.2.1",h=`${o}${s.icon}`):h=`${o}${e.group}/${e.game}/${s.icon}`;let u="";"string"==typeof g.name?u+=g.name+" ":u+=g.name[c]+" ";let d=null;if("string"==typeof g.app?(d=`${o}${g.app}`,u+=g.app):(d=`${o}${g.app[c]}`,u+=g.app[c]),t.app=u,t.version=g.version,t.icon=h,t.downloadEnabled=!0,t.appConfig=g.appConfig,t.gamecard=g,t.useTest){if(d){if(a=await fetch(d),!n&&!i.isCheckGameCDN)return null;if(!a.ok)return t.error&&t.error(t),null}if(h){if(a=await fetch(h),!n&&!i.isCheckGameCDN)return null;if(!a.ok)return t.error&&t.error(t),null}t.timeReady=Math.round(performance.now()-t.timestamp),t.ready&&t.ready(t)}}else t.app="",t.version="",t.gamecard=null,t.error&&t.error(t);d.redraw()}(n.server,s)}))},oncreate(){},view:()=>d(".",{left:"0%",right:"0%",width:"100%",height:"100%",position:"absolute",zIndex:0},d(".tmp",d(".cssload-loader",d.trust('<svg class="cssload-logo" height="200" width="200"><text x="49%" y="56%" dominant-baseline="middle" text-anchor="middle" fill="#1375ff">Loading</text></svg>'),d(".cssload-inner cssload-one"),d(".cssload-inner cssload-two"),d(".cssload-inner cssload-three"))),d(".",{style:{opacity:0,left:"0%",right:"0%",width:"1px",height:"1px",position:"absolute",zIndex:0}},d("article.dt.w-100.bb.b--black-05.pb2.mt2",d("div.dtc.v-mid.pl3",d("h1.f6.f5-ns.fw6.lh-title.white.mv1.tc","檢測服務線路"),d("h2.f6.fw4.mt1.mb1.green.tc","使用的線路")))))},Wt=!1,Gt=["一","二","三","四","五","六","七","八","九","十","一","二","三","四","五","六","七","八","九","十"],Yt=!0,qt=null,Xt=null,Kt=null,Jt=!1,Qt=null,Zt=null,ei=null;async function ti(t){if(!i.requestReload){let n={eventName:`CDN ${t.url}`,category:"服務線路錯誤",label:`${t.group}${t.game}`};e.error(n),globalThis.scene={},i.requestReload=!0,i.cdnList=[],i.hasCDN=!1,i.selectCDN=!1,Xt=null,d.redraw();let s=async function(){ei&&(await ei(),0===i.cdnList.length?hi({element:document.body}):d.redraw())};m.updateManager.setTimeout((()=>{s()}),.1)}}async function ii(e){Jt=!0,Qt=e||{},Zt=await import("./agent.569c6d6c.js"),d.redraw()}function ni(){Jt=!1,d.redraw()}let si={ready(t){globalThis.BASE_URL=t,e.report.currentURL=t,i.selectCDN=!0,globalThis.scene={},d.redraw();let n=o;B(n.game,n.group,t).then((e=>{e&&e.gameCard&&_t({gameCard:e.gameCard,serve:n,id:n.game,group:n.group})}))}},ai={context:null,view:()=>Yt?i.hasCDN&&!i.selectCDN?d(".basic",d(Dt,si)):d(".basic",Ae.isMobile?d(".",{style:{zIndex:0,position:"absolute",left:"0%",top:"0%",width:"100%",height:"100%"}},Ae.orientation.isTrigger?null:Gt.map((()=>d(".ba h-25 black tc",{style:{opacity:0}},"")))):null,Xt?d(Xt,Kt):null,Ae.isMobile?d(Vt):null,x()?d(Ht,{strings:w,dspScreen:Qe,gameManager:zt,title:C(),msg:E()}):null,Jt&&Zt?d(Zt.Component,Qt):null):i.hasCDN&&!i.selectCDN?d(".basic#root",d(Dt,si)):d(".basic#root",[Ae.isMobile?d(".",{style:{zIndex:0,position:"absolute",left:"0%",top:"0%",width:"100%",height:"100%"}},Ae.orientation.isTrigger?null:Gt.map((()=>d(".ba h-25 black tc",{style:{opacity:0}},"")))):null,Xt?d(Xt,Kt):null,Ae.isMobile?d(Vt):null,x()?d(Ht,{strings:w,dspScreen:Qe,gameManager:zt,title:C(),msg:E()}):null,Jt&&Zt?d(Zt.Component,Qt):null])};function ri(e){Yt=e}function oi(e,t){Xt=e,Kt=t,d.redraw()}let li={};function ci(e){return li[e]}async function hi(e){let n=o;ei=e.checkCDN;let s=globalThis;s.addEventListener&&(s.addEventListener("beforeunload",(e=>{})),s.addEventListener("unload",(()=>{}))),s.scene={},s.game={},li["game.2.0"]=jt["game.2.0"],li["game.3.0"]=jt["game.3.0"],li["game.4.0"]=jt["game.4.0"],li["slot.2.1"]=jt["slot.2.1"],function(){if(nt)return;nt=!0;let e="position: absolute; left: 0%; top: 0%; width: 100%; height: 100%;";et.canvas=document.createElement("canvas"),et.canvas.style=e,et.game=new m.GameBase.Base,et.game.init({view:et.canvas}),tt.canvas=document.createElement("canvas"),tt.canvas.style=e,tt.game=new m.GameBase.Base,tt.game.init({view:tt.canvas}),it.canvas=document.createElement("canvas"),it.canvas.style=e,it.game=new m.GameBase.Base,it.game.init({view:it.canvas})}();let l={game:n.game,group:n.group};if(n.group&&n.game||!u){if(ri(!1),!i.hasCDN){let e=globalThis.BASE_URL,t=i.version;B(l.game,l.group,e,t).then((e=>{e&&e.gameCard&&_t({gameCard:e.gameCard,serve:l,id:l.game,group:l.group})}))}}else Xt=H;let c=r;if(n.mode===c.DEMO){let e=840;m.updateManager.setTimeout((()=>{globalThis.Howler&&(globalThis.Howler.mute(!0),globalThis.Howler.unload()),k({title:"gameModeDemo",msg:"demoTimeout"})}),e)}if(d.mount(e.element,ai),!t)try{let e=(0,a.decode)(o.key);Date.now()-1e3*e.exp>0&&(o.isKickOut=!0,k({title:"exitGame",msg:"kickOut"}))}catch(e){}}function gi(e){let t=o;if(Wt){return new Promise((e=>{let i=t.info;qt&&(qt.login(i),e(qt))}))}return Wt=!0,e&&(t.game=e.game||t.game,t.group=e.group||t.group,t.host=e.host||t.host),new Promise((e=>{let n=globalThis;n.lobby={currentUser:{},table:{},net:{}},i.module?import("./agent.02f2e4c0.js").then((i=>{let s=i.create();n.lobby.net.gameCommand=s;(()=>{t.host.indexOf("://")<0&&(t.host=`wss://${t.host}`);let i=t.info,n=t.host,s=t.protocol,a=t.gameFormat,r={hostname:n};import("./agent.49e39545.js").then((t=>{t.init({gameFormat:a,protocol:s}).then((()=>{t.connect(r).then((()=>{(async function(e){try{let t=await import("./agent.49e39545.js");return await t.login(e)}catch(e){}})(i).then((()=>{e(null)}))}))}))}))})()})):(qt=new m.Lobby({},"/"+t.namespace),qt.init(),import("./agent.9fb4e8bd.js").then((i=>{let n=globalThis,s=c,a=i.getCommandList(g);qt.setEventMap(a),qt.setSendEvent(i.getSendEvent()),s.state="連線中",d.redraw();let r={};r.send=qt.setGameCommand,r.registerGameEvent=qt.registerGameEvent,r.unregisterGameEvent=qt.unregisterGameEvent,n.lobby.net.gameCommand=r,n.lobby.net.setLobbyCommand=qt.setLobbyCommand,n.lobby.net.CMD=m.Lobby.CMD,n.lobby.setEvent=i.setEvent,t.host&&qt.setHost(t.host);let o=m.updateManager.setTimeout((()=>{"連線中"===s.state&&(globalThis.Howler&&(globalThis.Howler.mute(!0),globalThis.Howler.unload()),k({title:"connecting",msg:"disconnect"}))}),.001*h);qt.connect({connect(){o&&(m.updateManager.remove(o),o=null),e(qt)},disconnect(){o&&(m.updateManager.remove(o),o=null)}})})))}))}function ui(){return qt}function di(){return globalThis}var mi=Object.freeze({__proto__:null,autoLogin:gi,getCurrentContext:function(){return Xt},getGameTemplate:ci,getLobby:ui,getManager:di,hideInfo:ni,reload:ti,resetCache:function(){if(i.useCache){let e=i.registration;if(e&&e.active&&navigator.serviceWorker.controller){let e={reset:"games"};navigator.serviceWorker.controller.postMessage(e)}}},run:hi,setAccountVisible:ri,setCurrentContext:oi,setKey:function(e){o.key=e},showGameList:function(){Xt=H},showInfo:ii});export{Ct as C,Ge as a,k as b,O as c,Ye as d,We as e,R as f,St as g,ni as h,di as i,ui as j,xt as k,Lt as l,mi as m,Ae as s};
