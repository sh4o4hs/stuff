import e from"mithril";import{h as n,i as r,b as o,j as a,C as t,k as i}from"./agent.b830886d.js";import*as c from"nuts";import{r as l,c as d,a as s,h as g}from"./agent.33a941c4.js";import{C as m,a as h}from"./agent.a39c36f6.js";import"localforage";let G=!0,p={handle(){if(!G)return;G=!1;let a=g;a.state="已連線",e.redraw(),n(),l.serviceBegin(m.report);let t=r(),i=d.info;t.login(i),c.updateManager.setTimeout((function(){a.isError||a.isLogin||o({title:"errorLow",msg:"disconnect"})}),s.commandTimeout)}},f={handle(){}},u={handle(e){}},w={handle(){},error:a.low},b={handle(e){},error:a.low},x={},M=null,j=!0,T={game(){}};function k(e){x.connect=e.connect||x.connect,x.disconnect=e.disconnect||x.disconnect,x.disconnectMsg=e.disconnectMsg||x.disconnectMsg,x.reconnect=e.reconnect||x.reconnect,x.broadcast=e.broadcast||x.broadcast,x.login=e.login||x.login,x.relogin=e.relogin||x.relogin,x.inGame=e.inGame||x.inGame,x.toGame=e.toGame||x.toGame,x.exitGame=e.exitGame||x.exitGame}function v(n){return M||(M={connect:{handle(e){p.handle(e),x.connect&&x.connect.handle(e)}},login:{handle(e){m.handle(e),x.login&&x.login.handle(e)},error:m.error},relogin:{handle(e){m.handle(e),x.relogin&&x.relogin.handle(e)},error:m.error},inGame:{handle(e){t.handle(e),x.inGame&&x.inGame.handle(e)},error:t.error},toGame:{handle(e){x.toGame&&x.toGame.handle(e)},error:w.error},exitGame:{handle(e){b.handle(e),x.exitGame&&x.exitGame.handle(e)},error:b.error},broadcast:{handle(e){h.handle(e),x.broadcast&&x.broadcast.handle(e)}},ping:{handle(){},error:a.low},pong:{handle(r){n.setting.ping?(n.server.ping=r,n.setting.msg="ping:"+r,e.redraw()):n.setting.msg=""},error:a.low},reconnect:{handle(e){f.handle(e),x.reconnect&&x.reconnect.handle(e)},error:a.low},disconnectMsg:{handle(r){n.setting.ping&&(n.setting.msg="disconnect:"+(new Date).toTimeString(),e.redraw()),u.handle(r),x.disconnectMsg&&x.disconnectMsg.handle(r)}},disconnect:{handle(e){i.handle(e),x.disconnect&&x.disconnect.handle(e)}}}),M}function C(){return T}export{v as getCommandList,C as getSendEvent,j as isFirst,k as setEvent};
