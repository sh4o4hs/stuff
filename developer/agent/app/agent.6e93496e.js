const e={SINGLE:"single",MULTI:"multi"},t={REAL:"real",DEMO:"demo"},n={OVERVIEW_LOGO:0,OVERVIEW_ANIMATION:1,OVERVIEW_BACKGROUND:2,OVERVIEW_PROGRESS:3,GAME_SCENE_CUSTOM:4,GAME_PERFORMANCE_FPS:5,GAME_DIALOG_CUSTOM:6,GAME_DEBUG_MODE:7},r={PROTOCOL:0,GAME_FORMAT:1},a=45e3;let o=!0,i=!0,s={info:{},group:null,game:null,room:null,host:null,key:null,mode:null,namespace:"develop",currency:null,protocol:null,gameFormat:null,cdn:{errorCounts:0},ping:0},l=[];l[n.OVERVIEW_LOGO]=1,l[n.OVERVIEW_ANIMATION]=1,l[n.OVERVIEW_BACKGROUND]=1,l[n.OVERVIEW_PROGRESS]=0,l[n.GAME_SCENE_CUSTOM]=1,l[n.GAME_PERFORMANCE_FPS]=1,l[n.GAME_DEBUG_MODE]=1,l[n.GAME_DIALOG_CUSTOM]=1;let c={isCheckGameCDN:!1,setting:null,isFinish:!1,loadingEvent:null},u={currentURL:"",isReload:!1,hasCDN:!1,selectCDN:!1,cdnList:[],useCache:!1,hasCache:!1,isCheckGameCDN:!1,disableNet:!1,lobbyName:"",mobileMode:"0",projectURL:"/project/",systemjsURL:"",useOptions:!1,msg:"",ping:!1,isInGame:!1,commandTimeout:15,isManual:!1,gtiLobbyUrl:"",launch:null,logo:"",agent:"bg",module:null,langID:"en-us",pattern:e.MULTI,version:"1.0.0"},d={URLs:null,isLogin:!1,state:""};var f=Object.freeze({__proto__:null,PATTERN:e,GAME_MODE:t,OPTIONS:n,MODULE:r,TIME_OUT:45e3,get isDeveloper(){return o},displayLobby:true,server:s,options:l,resource:c,setting:u,account:d,useRelease:function(){o=!1}});let h={EN:"en",JA_JP:"ja-jp",TH_TH:"th-th",VI_VN:"vi-vn",EN_US:"en-us",ZH_TW:"zh-tw",ZH_CN:"zh-cn"},m={"en-us":"en-us","en-US":"en-us","ja-jp":"ja-jp","ja-JP":"ja-jp","zh-tw":"zh-tw","zh-TW":"zh-tw","th-th":"th-th","th-TH":"th-th","vi-vn":"vi-vn","vi-VN":"vi-vn","zh-cn":"zh-cn","zh-CN":"zh-cn",en:"en-us"},p=null,g=h.EN_US;function v(e){let t;return p&&(t=p.get(e)),t}async function y(e){g=m[e],g||(g=h.EN_US),p=await function(e){switch(e){case"./locales/en-us.js":return import("./agent.d27cd103.js");case"./locales/ja-jp.js":return import("./agent.ef6f1cfa.js");case"./locales/th-th.js":return import("./agent.d4a29d83.js");case"./locales/vi-vn.js":return import("./agent.d66423cf.js");case"./locales/zh-cn.js":return import("./agent.49ccca1d.js");case"./locales/zh-tw.js":return import("./agent.aa4b3949.js");default:return new Promise((function(t,n){("function"==typeof queueMicrotask?queueMicrotask:setTimeout)(n.bind(null,new Error("Unknown variable dynamic import: "+e)))}))}}(`./locales/${g}.js`)}function b(){return g}async function x(){if(globalThis.BASE_URL)return new Promise((e=>{let t=!1;u.cdnList=[],u.hasCDN=!1,u.selectCDN=!1;let n=[];if(Array.isArray(globalThis.DISABLE_AUTO_CDN))n=globalThis.DISABLE_AUTO_CDN;else if(globalThis.DISABLE_AUTO_CDN)return;let r=globalThis.BASE_URL.indexOf("/",9),a=globalThis.BASE_URL.substring(r+1);function o(e){u.cdnList.push(e),u.hasCDN||(u.hasCDN=!0)}setTimeout((function(){e(),t=!0}),500),function(){let r=[];globalThis.CDN_LIST&&Array.isArray(globalThis.CDN_LIST)&&globalThis.CDN_LIST.forEach((e=>{if(e&&e.url){let t=e.url;t.lastIndexOf(".jpg")<0&&(e.target=`${t}${a}`,e.url=`${t}webedit/it.jpg`),u.isReload?e.target!==globalThis.BASE_URL&&r.push(e):r.push(e)}})),0===r.length&&(r=[]);let i=[],s=0,l=0,c=0;r.forEach(((r,a)=>{if(n[a])return;let d=Math.round(performance.now());i[a]=99999;let f=r.url;s+=1,fetch(f,{credentials:"omit"}).then((e=>e.ok?e.arrayBuffer():null)).then((n=>{if(!t)if(n){if(d=Math.round(performance.now()-d),i[a]=d,c>=8)return void e();u.isReload?r.target!==globalThis.BASE_URL&&(o(r),c+=1):(o(r),c+=1),l+=1,l>=s&&e()}else l+=1,l>=s&&e()})).catch((t=>{l+=1,l>=s&&e()}))})),0===s&&e()}()}))}var w="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function E(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}function I(e,t,n,r,a,o){return{tag:e,key:t,attrs:n,children:r,text:a,dom:o,domSize:void 0,state:void 0,events:void 0,instance:void 0}}I.normalize=function(e){return Array.isArray(e)?I("[",void 0,void 0,I.normalizeChildren(e),void 0,void 0):null==e||"boolean"==typeof e?null:"object"==typeof e?e:I("#",void 0,void 0,String(e),void 0,void 0)},I.normalizeChildren=function(e){var t=[];if(e.length){for(var n=null!=e[0]&&null!=e[0].key,r=1;r<e.length;r++)if((null!=e[r]&&null!=e[r].key)!==n)throw new TypeError("Vnodes must either always have keys or never have keys!");for(r=0;r<e.length;r++)t[r]=I.normalize(e[r])}return t};var T=I,S=T,_=function(){var e,t=arguments[this],n=this+1;if(null==t?t={}:("object"!=typeof t||null!=t.tag||Array.isArray(t))&&(t={},n=this),arguments.length===n+1)e=arguments[n],Array.isArray(e)||(e=[e]);else for(e=[];n<arguments.length;)e.push(arguments[n++]);return S("",t.key,t,e)},N=T,P=_,R=/(?:(^|#|\.)([^#\.\[\]]+))|(\[(.+?)(?:\s*=\s*("|'|)((?:\\["'\]]|.)*?)\5)?\])/g,C={},L={}.hasOwnProperty;function j(e){for(var t in e)if(L.call(e,t))return!1;return!0}function O(e){for(var t,n="div",r=[],a={};t=R.exec(e);){var o=t[1],i=t[2];if(""===o&&""!==i)n=i;else if("#"===o)a.id=i;else if("."===o)r.push(i);else if("["===t[3][0]){var s=t[6];s&&(s=s.replace(/\\(["'])/g,"$1").replace(/\\\\/g,"\\")),"class"===t[4]?r.push(s):a[t[4]]=""===s?s:s||!0}}return r.length>0&&(a.className=r.join(" ")),C[e]={tag:n,attrs:a}}function A(e,t){var n=t.attrs,r=N.normalizeChildren(t.children),a=L.call(n,"class"),o=a?n.class:n.className;if(t.tag=e.tag,t.attrs=null,t.children=void 0,!j(e.attrs)&&!j(n)){var i={};for(var s in n)L.call(n,s)&&(i[s]=n[s]);n=i}for(var s in e.attrs)L.call(e.attrs,s)&&"className"!==s&&!L.call(n,s)&&(n[s]=e.attrs[s]);for(var s in null==o&&null==e.attrs.className||(n.className=null!=o?null!=e.attrs.className?String(e.attrs.className)+" "+String(o):o:null!=e.attrs.className?e.attrs.className:null),a&&(n.class=null),n)if(L.call(n,s)&&"key"!==s){t.attrs=n;break}return Array.isArray(r)&&1===r.length&&null!=r[0]&&"#"===r[0].tag?t.text=r[0].children:t.children=r,t}var k=function(e){if(null==e||"string"!=typeof e&&"function"!=typeof e&&"function"!=typeof e.view)throw Error("The selector must be either a string or a component.");var t=P.apply(1,arguments);return"string"==typeof e&&(t.children=N.normalizeChildren(t.children),"["!==e)?A(C[e]||O(e),t):(t.tag=e,t)},M=T,D=T,B=_,F=k;F.trust=function(e){return null==e&&(e=""),M("<",void 0,void 0,e,void 0,void 0)},F.fragment=function(){var e=B.apply(0,arguments);return e.tag="[",e.children=D.normalizeChildren(e.children),e};var U=F,G={exports:{}},V=function(e){if(!(this instanceof V))throw new Error("Promise must be called with `new`");if("function"!=typeof e)throw new TypeError("executor must be a function");var t=this,n=[],r=[],a=l(n,!0),o=l(r,!1),i=t._instance={resolvers:n,rejectors:r},s="function"==typeof setImmediate?setImmediate:setTimeout;function l(e,a){return function l(u){var d;try{if(!a||null==u||"object"!=typeof u&&"function"!=typeof u||"function"!=typeof(d=u.then))s((function(){!a&&e.length;for(var t=0;t<e.length;t++)e[t](u);n.length=0,r.length=0,i.state=a,i.retry=function(){l(u)}}));else{if(u===t)throw new TypeError("Promise can't be resolved w/ itself");c(d.bind(u))}}catch(e){o(e)}}}function c(e){var t=0;function n(e){return function(n){t++>0||e(n)}}var r=n(o);try{e(n(a),r)}catch(e){r(e)}}c(e)};V.prototype.then=function(e,t){var n,r,a=this._instance;function o(e,t,o,i){t.push((function(t){if("function"!=typeof e)o(t);else try{n(e(t))}catch(e){r&&r(e)}})),"function"==typeof a.retry&&i===a.state&&a.retry()}var i=new V((function(e,t){n=e,r=t}));return o(e,a.resolvers,n,!0),o(t,a.rejectors,r,!1),i},V.prototype.catch=function(e){return this.then(null,e)},V.prototype.finally=function(e){return this.then((function(t){return V.resolve(e()).then((function(){return t}))}),(function(t){return V.resolve(e()).then((function(){return V.reject(t)}))}))},V.resolve=function(e){return e instanceof V?e:new V((function(t){t(e)}))},V.reject=function(e){return new V((function(t,n){n(e)}))},V.all=function(e){return new V((function(t,n){var r=e.length,a=0,o=[];if(0===e.length)t([]);else for(var i=0;i<e.length;i++)!function(i){function s(e){a++,o[i]=e,a===r&&t(o)}null==e[i]||"object"!=typeof e[i]&&"function"!=typeof e[i]||"function"!=typeof e[i].then?s(e[i]):e[i].then(s,n)}(i)}))},V.race=function(e){return new V((function(t,n){for(var r=0;r<e.length;r++)e[r].then(t,n)}))};var z=V,X=z;"undefined"!=typeof window?(void 0===window.Promise?window.Promise=X:window.Promise.prototype.finally||(window.Promise.prototype.finally=X.prototype.finally),G.exports=window.Promise):void 0!==w?(void 0===w.Promise?w.Promise=X:w.Promise.prototype.finally||(w.Promise.prototype.finally=X.prototype.finally),G.exports=w.Promise):G.exports=X;var Y=T,H=function(e){var t,n=e&&e.document,r={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"};function a(e){return e.attrs&&e.attrs.xmlns||r[e.tag]}function o(e,t){if(e.state!==t)throw new Error("`vnode.state` must not be modified")}function i(e){var t=e.state;try{return this.apply(t,arguments)}finally{o(e,t)}}function s(){try{return n.activeElement}catch(e){return null}}function l(e,t,n,r,a,o,i){for(var s=n;s<r;s++){var l=t[s];null!=l&&c(e,l,a,i,o)}}function c(e,t,r,o,s){var u=t.tag;if("string"==typeof u)switch(t.state={},null!=t.attrs&&M(t.attrs,t,r),u){case"#":!function(e,t,r){t.dom=n.createTextNode(t.children),b(e,t.dom,r)}(e,t,s);break;case"<":d(e,t,o,s);break;case"[":!function(e,t,r,a,o){var i=n.createDocumentFragment();if(null!=t.children){var s=t.children;l(i,s,0,s.length,r,null,a)}t.dom=i.firstChild,t.domSize=i.childNodes.length,b(e,i,o)}(e,t,r,o,s);break;default:!function(e,t,r,o,i){var s=t.tag,c=t.attrs,u=c&&c.is,d=(o=a(t)||o)?u?n.createElementNS(o,s,{is:u}):n.createElementNS(o,s):u?n.createElement(s,{is:u}):n.createElement(s);t.dom=d,null!=c&&function(e,t,n){for(var r in t)_(e,r,null,t[r],n)}(t,c,o);if(b(e,d,i),!x(t)&&(null!=t.text&&(""!==t.text?d.textContent=t.text:t.children=[Y("#",void 0,void 0,t.text,void 0,void 0)]),null!=t.children)){var f=t.children;l(d,f,0,f.length,r,null,o),"select"===t.tag&&null!=c&&function(e,t){if("value"in t)if(null===t.value)-1!==e.dom.selectedIndex&&(e.dom.value=null);else{var n=""+t.value;e.dom.value===n&&-1!==e.dom.selectedIndex||(e.dom.value=n)}"selectedIndex"in t&&_(e,"selectedIndex",null,t.selectedIndex,void 0)}(t,c)}}(e,t,r,o,s)}else!function(e,t,n,r,a){(function(e,t){var n;if("function"==typeof e.tag.view){if(e.state=Object.create(e.tag),null!=(n=e.state.view).$$reentrantLock$$)return;n.$$reentrantLock$$=!0}else{if(e.state=void 0,null!=(n=e.tag).$$reentrantLock$$)return;n.$$reentrantLock$$=!0,e.state=null!=e.tag.prototype&&"function"==typeof e.tag.prototype.view?new e.tag(e):e.tag(e)}M(e.state,e,t),null!=e.attrs&&M(e.attrs,e,t);if(e.instance=Y.normalize(i.call(e.state.view,e)),e.instance===e)throw Error("A view cannot return the vnode it received as argument");n.$$reentrantLock$$=null})(t,n),null!=t.instance?(c(e,t.instance,n,r,a),t.dom=t.instance.dom,t.domSize=null!=t.dom?t.instance.domSize:0):t.domSize=0}(e,t,r,o,s)}var u={caption:"table",thead:"table",tbody:"table",tfoot:"table",tr:"tbody",th:"tr",td:"tr",colgroup:"table",col:"colgroup"};function d(e,t,r,a){var o=t.children.match(/^\s*?<(\w+)/im)||[],i=n.createElement(u[o[1]]||"div");"http://www.w3.org/2000/svg"===r?(i.innerHTML='<svg xmlns="http://www.w3.org/2000/svg">'+t.children+"</svg>",i=i.firstChild):i.innerHTML=t.children,t.dom=i.firstChild,t.domSize=i.childNodes.length,t.instance=[];for(var s,l=n.createDocumentFragment();s=i.firstChild;)t.instance.push(s),l.appendChild(s);b(e,l,a)}function f(e,t,n,r,a,o){if(t!==n&&(null!=t||null!=n))if(null==t||0===t.length)l(e,n,0,n.length,r,a,o);else if(null==n||0===n.length)w(e,t,0,t.length);else{var i=null!=t[0]&&null!=t[0].key,s=null!=n[0]&&null!=n[0].key,u=0,d=0;if(!i)for(;d<t.length&&null==t[d];)d++;if(!s)for(;u<n.length&&null==n[u];)u++;if(null===s&&null==i)return;if(i!==s)w(e,t,d,t.length),l(e,n,u,n.length,r,a,o);else if(s){for(var f,y,b,x,I,T=t.length-1,S=n.length-1;T>=d&&S>=u&&(b=t[T],x=n[S],b.key===x.key);)b!==x&&h(e,b,x,r,a,o),null!=x.dom&&(a=x.dom),T--,S--;for(;T>=d&&S>=u&&(f=t[d],y=n[u],f.key===y.key);)d++,u++,f!==y&&h(e,f,y,r,g(t,d,a),o);for(;T>=d&&S>=u&&u!==S&&f.key===x.key&&b.key===y.key;)v(e,b,I=g(t,d,a)),b!==y&&h(e,b,y,r,I,o),++u<=--S&&v(e,f,a),f!==x&&h(e,f,x,r,a,o),null!=x.dom&&(a=x.dom),d++,b=t[--T],x=n[S],f=t[d],y=n[u];for(;T>=d&&S>=u&&b.key===x.key;)b!==x&&h(e,b,x,r,a,o),null!=x.dom&&(a=x.dom),S--,b=t[--T],x=n[S];if(u>S)w(e,t,d,T+1);else if(d>T)l(e,n,u,S+1,r,a,o);else{var _,N,P=a,R=S-u+1,C=new Array(R),L=0,j=0,O=2147483647,A=0;for(j=0;j<R;j++)C[j]=-1;for(j=S;j>=u;j--){null==_&&(_=m(t,d,T+1));var k=_[(x=n[j]).key];null!=k&&(O=k<O?k:-1,C[j-u]=k,b=t[k],t[k]=null,b!==x&&h(e,b,x,r,a,o),null!=x.dom&&(a=x.dom),A++)}if(a=P,A!==T-d+1&&w(e,t,d,T+1),0===A)l(e,n,u,S+1,r,a,o);else if(-1===O)for(L=(N=function(e){var t=[0],n=0,r=0,a=0,o=p.length=e.length;for(a=0;a<o;a++)p[a]=e[a];for(a=0;a<o;++a)if(-1!==e[a]){var i=t[t.length-1];if(e[i]<e[a])p[a]=i,t.push(a);else{for(n=0,r=t.length-1;n<r;){var s=(n>>>1)+(r>>>1)+(n&r&1);e[t[s]]<e[a]?n=s+1:r=s}e[a]<e[t[n]]&&(n>0&&(p[a]=t[n-1]),t[n]=a)}}n=t.length,r=t[n-1];for(;n-- >0;)t[n]=r,r=p[r];return p.length=0,t}(C)).length-1,j=S;j>=u;j--)y=n[j],-1===C[j-u]?c(e,y,r,o,a):N[L]===j-u?L--:v(e,y,a),null!=y.dom&&(a=n[j].dom);else for(j=S;j>=u;j--)y=n[j],-1===C[j-u]&&c(e,y,r,o,a),null!=y.dom&&(a=n[j].dom)}}else{var M=t.length<n.length?t.length:n.length;for(u=u<d?u:d;u<M;u++)(f=t[u])===(y=n[u])||null==f&&null==y||(null==f?c(e,y,r,o,g(t,u+1,a)):null==y?E(e,f):h(e,f,y,r,g(t,u+1,a),o));t.length>M&&w(e,t,u,t.length),n.length>M&&l(e,n,u,n.length,r,a,o)}}}function h(e,t,n,r,o,s){var l=t.tag;if(l===n.tag){if(n.state=t.state,n.events=t.events,function(e,t){do{var n;if(null!=e.attrs&&"function"==typeof e.attrs.onbeforeupdate)if(void 0!==(n=i.call(e.attrs.onbeforeupdate,e,t))&&!n)break;if("string"!=typeof e.tag&&"function"==typeof e.state.onbeforeupdate)if(void 0!==(n=i.call(e.state.onbeforeupdate,e,t))&&!n)break;return!1}while(0);return e.dom=t.dom,e.domSize=t.domSize,e.instance=t.instance,e.attrs=t.attrs,e.children=t.children,e.text=t.text,!0}(n,t))return;if("string"==typeof l)switch(null!=n.attrs&&D(n.attrs,n,r),l){case"#":!function(e,t){e.children.toString()!==t.children.toString()&&(e.dom.nodeValue=t.children);t.dom=e.dom}(t,n);break;case"<":!function(e,t,n,r,a){t.children!==n.children?(I(e,t),d(e,n,r,a)):(n.dom=t.dom,n.domSize=t.domSize,n.instance=t.instance)}(e,t,n,s,o);break;case"[":!function(e,t,n,r,a,o){f(e,t.children,n.children,r,a,o);var i=0,s=n.children;if(n.dom=null,null!=s){for(var l=0;l<s.length;l++){var c=s[l];null!=c&&null!=c.dom&&(null==n.dom&&(n.dom=c.dom),i+=c.domSize||1)}1!==i&&(n.domSize=i)}}(e,t,n,r,o,s);break;default:!function(e,t,n,r){var o=t.dom=e.dom;r=a(t)||r,"textarea"===t.tag&&(null==t.attrs&&(t.attrs={}),null!=t.text&&(t.attrs.value=t.text,t.text=void 0));(function(e,t,n,r){if(null!=n)for(var a in n)_(e,a,t&&t[a],n[a],r);var o;if(null!=t)for(var a in t)null==(o=t[a])||null!=n&&null!=n[a]||N(e,a,o,r)})(t,e.attrs,t.attrs,r),x(t)||(null!=e.text&&null!=t.text&&""!==t.text?e.text.toString()!==t.text.toString()&&(e.dom.firstChild.nodeValue=t.text):(null!=e.text&&(e.children=[Y("#",void 0,void 0,e.text,void 0,e.dom.firstChild)]),null!=t.text&&(t.children=[Y("#",void 0,void 0,t.text,void 0,void 0)]),f(o,e.children,t.children,n,null,r)))}(t,n,r,s)}else!function(e,t,n,r,a,o){if(n.instance=Y.normalize(i.call(n.state.view,n)),n.instance===n)throw Error("A view cannot return the vnode it received as argument");D(n.state,n,r),null!=n.attrs&&D(n.attrs,n,r);null!=n.instance?(null==t.instance?c(e,n.instance,r,o,a):h(e,t.instance,n.instance,r,a,o),n.dom=n.instance.dom,n.domSize=n.instance.domSize):null!=t.instance?(E(e,t.instance),n.dom=void 0,n.domSize=0):(n.dom=t.dom,n.domSize=t.domSize)}(e,t,n,r,o,s)}else E(e,t),c(e,n,r,s,o)}function m(e,t,n){for(var r=Object.create(null);t<n;t++){var a=e[t];if(null!=a){var o=a.key;null!=o&&(r[o]=t)}}return r}var p=[];function g(e,t,n){for(;t<e.length;t++)if(null!=e[t]&&null!=e[t].dom)return e[t].dom;return n}function v(e,t,r){var a=n.createDocumentFragment();y(e,a,t),b(e,a,r)}function y(e,t,n){for(;null!=n.dom&&n.dom.parentNode===e;){if("string"!=typeof n.tag){if(null!=(n=n.instance))continue}else if("<"===n.tag)for(var r=0;r<n.instance.length;r++)t.appendChild(n.instance[r]);else if("["!==n.tag)t.appendChild(n.dom);else if(1===n.children.length){if(null!=(n=n.children[0]))continue}else for(r=0;r<n.children.length;r++){var a=n.children[r];null!=a&&y(e,t,a)}break}}function b(e,t,n){null!=n?e.insertBefore(t,n):e.appendChild(t)}function x(e){if(null==e.attrs||null==e.attrs.contenteditable&&null==e.attrs.contentEditable)return!1;var t=e.children;if(null!=t&&1===t.length&&"<"===t[0].tag){var n=t[0].children;e.dom.innerHTML!==n&&(e.dom.innerHTML=n)}else if(null!=e.text||null!=t&&0!==t.length)throw new Error("Child node of a contenteditable must be trusted");return!0}function w(e,t,n,r){for(var a=n;a<r;a++){var o=t[a];null!=o&&E(e,o)}}function E(e,t){var n,r,a,s=0,l=t.state;"string"!=typeof t.tag&&"function"==typeof t.state.onbeforeremove&&(null!=(a=i.call(t.state.onbeforeremove,t))&&"function"==typeof a.then&&(s=1,n=a));t.attrs&&"function"==typeof t.attrs.onbeforeremove&&(null!=(a=i.call(t.attrs.onbeforeremove,t))&&"function"==typeof a.then&&(s|=2,r=a));if(o(t,l),s){if(null!=n){var c=function(){1&s&&((s&=2)||u())};n.then(c,c)}if(null!=r){c=function(){2&s&&((s&=1)||u())};r.then(c,c)}}else S(t),T(e,t);function u(){o(t,l),S(t),T(e,t)}}function I(e,t){for(var n=0;n<t.instance.length;n++)e.removeChild(t.instance[n])}function T(e,t){for(;null!=t.dom&&t.dom.parentNode===e;){if("string"!=typeof t.tag){if(null!=(t=t.instance))continue}else if("<"===t.tag)I(e,t);else{if("["!==t.tag&&(e.removeChild(t.dom),!Array.isArray(t.children)))break;if(1===t.children.length){if(null!=(t=t.children[0]))continue}else for(var n=0;n<t.children.length;n++){var r=t.children[n];null!=r&&T(e,r)}}break}}function S(e){if("string"!=typeof e.tag&&"function"==typeof e.state.onremove&&i.call(e.state.onremove,e),e.attrs&&"function"==typeof e.attrs.onremove&&i.call(e.attrs.onremove,e),"string"!=typeof e.tag)null!=e.instance&&S(e.instance);else{var t=e.children;if(Array.isArray(t))for(var n=0;n<t.length;n++){var r=t[n];null!=r&&S(r)}}}function _(e,t,r,a,o){if("key"!==t&&"is"!==t&&null!=a&&!P(t)&&(r!==a||function(e,t){return"value"===t||"checked"===t||"selectedIndex"===t||"selected"===t&&e.dom===s()||"option"===e.tag&&e.dom.parentNode===n.activeElement}(e,t)||"object"==typeof a)){if("o"===t[0]&&"n"===t[1])return k(e,t,a);if("xlink:"===t.slice(0,6))e.dom.setAttributeNS("http://www.w3.org/1999/xlink",t.slice(6),a);else if("style"===t)O(e.dom,r,a);else if(R(e,t,o)){if("value"===t){if(("input"===e.tag||"textarea"===e.tag)&&e.dom.value===""+a&&e.dom===s())return;if("select"===e.tag&&null!==r&&e.dom.value===""+a)return;if("option"===e.tag&&null!==r&&e.dom.value===""+a)return}"input"===e.tag&&"type"===t?e.dom.setAttribute(t,a):e.dom[t]=a}else"boolean"==typeof a?a?e.dom.setAttribute(t,""):e.dom.removeAttribute(t):e.dom.setAttribute("className"===t?"class":t,a)}}function N(e,t,n,r){if("key"!==t&&"is"!==t&&null!=n&&!P(t))if("o"!==t[0]||"n"!==t[1]||P(t))if("style"===t)O(e.dom,n,null);else if(!R(e,t,r)||"className"===t||"value"===t&&("option"===e.tag||"select"===e.tag&&-1===e.dom.selectedIndex&&e.dom===s())||"input"===e.tag&&"type"===t){var a=t.indexOf(":");-1!==a&&(t=t.slice(a+1)),!1!==n&&e.dom.removeAttribute("className"===t?"class":t)}else e.dom[t]=null;else k(e,t,void 0)}function P(e){return"oninit"===e||"oncreate"===e||"onupdate"===e||"onremove"===e||"onbeforeremove"===e||"onbeforeupdate"===e}function R(e,t,n){return void 0===n&&(e.tag.indexOf("-")>-1||null!=e.attrs&&e.attrs.is||"href"!==t&&"list"!==t&&"form"!==t&&"width"!==t&&"height"!==t)&&t in e.dom}var C=/[A-Z]/g;function L(e){return"-"+e.toLowerCase()}function j(e){return"-"===e[0]&&"-"===e[1]?e:"cssFloat"===e?"float":e.replace(C,L)}function O(e,t,n){if(t===n);else if(null==n)e.style.cssText="";else if("object"!=typeof n)e.style.cssText=n;else if(null==t||"object"!=typeof t)for(var r in e.style.cssText="",n){null!=(a=n[r])&&e.style.setProperty(j(r),String(a))}else{for(var r in n){var a;null!=(a=n[r])&&(a=String(a))!==String(t[r])&&e.style.setProperty(j(r),a)}for(var r in t)null!=t[r]&&null==n[r]&&e.style.removeProperty(j(r))}}function A(){this._=t}function k(e,t,n){if(null!=e.events){if(e.events[t]===n)return;null==n||"function"!=typeof n&&"object"!=typeof n?(null!=e.events[t]&&e.dom.removeEventListener(t.slice(2),e.events,!1),e.events[t]=void 0):(null==e.events[t]&&e.dom.addEventListener(t.slice(2),e.events,!1),e.events[t]=n)}else null==n||"function"!=typeof n&&"object"!=typeof n||(e.events=new A,e.dom.addEventListener(t.slice(2),e.events,!1),e.events[t]=n)}function M(e,t,n){"function"==typeof e.oninit&&i.call(e.oninit,t),"function"==typeof e.oncreate&&n.push(i.bind(e.oncreate,t))}function D(e,t,n){"function"==typeof e.onupdate&&n.push(i.bind(e.onupdate,t))}return A.prototype=Object.create(null),A.prototype.handleEvent=function(e){var t,n=this["on"+e.type];"function"==typeof n?t=n.call(e.currentTarget,e):"function"==typeof n.handleEvent&&n.handleEvent(e),this._&&!1!==e.redraw&&(0,this._)(),!1===t&&(e.preventDefault(),e.stopPropagation())},function(e,n,r){if(!e)throw new TypeError("Ensure the DOM element being passed to m.route/m.mount/m.render is not undefined.");var a=[],o=s(),i=e.namespaceURI;null==e.vnodes&&(e.textContent=""),n=Y.normalizeChildren(Array.isArray(n)?n:[n]);var l=t;try{t="function"==typeof r?r:void 0,f(e,e.vnodes,n,a,null,"http://www.w3.org/1999/xhtml"===i?void 0:i)}finally{t=l}e.vnodes=n,null!=o&&s()!==o&&"function"==typeof o.focus&&o.focus();for(var c=0;c<a.length;c++)a[c]()}}(window),W=T,q=function(e,t,n){var r=[],a=!1,o=!1;function i(){if(a)throw new Error("Nested m.redraw.sync() call");a=!0;for(var t=0;t<r.length;t+=2)try{e(r[t],W(r[t+1]),s)}catch(e){n.error(e)}a=!1}function s(){o||(o=!0,t((function(){o=!1,i()})))}return s.sync=i,{mount:function(t,n){if(null!=n&&null==n.view&&"function"!=typeof n)throw new TypeError("m.mount(element, component) expects a component, not a vnode");var a=r.indexOf(t);a>=0&&(r.splice(a,2),e(t,[],s)),null!=n&&(r.push(t,n),e(t,W(n),s))},redraw:s}}(H,requestAnimationFrame,console),$=function(e){if("[object Object]"!==Object.prototype.toString.call(e))return"";var t=[];for(var n in e)r(n,e[n]);return t.join("&");function r(e,n){if(Array.isArray(n))for(var a=0;a<n.length;a++)r(e+"["+a+"]",n[a]);else if("[object Object]"===Object.prototype.toString.call(n))for(var a in n)r(e+"["+a+"]",n[a]);else t.push(encodeURIComponent(e)+(null!=n&&""!==n?"="+encodeURIComponent(n):""))}},K=Object.assign||function(e,t){t&&Object.keys(t).forEach((function(n){e[n]=t[n]}))},J=$,Q=K,Z=function(e,t){if(/:([^\/\.-]+)(\.{3})?:/.test(e))throw new SyntaxError("Template parameter names *must* be separated");if(null==t)return e;var n=e.indexOf("?"),r=e.indexOf("#"),a=r<0?e.length:r,o=n<0?a:n,i=e.slice(0,o),s={};Q(s,t);var l=i.replace(/:([^\/\.-]+)(\.{3})?/g,(function(e,n,r){return delete s[n],null==t[n]?e:r?t[n]:encodeURIComponent(String(t[n]))})),c=l.indexOf("?"),u=l.indexOf("#"),d=u<0?l.length:u,f=c<0?d:c,h=l.slice(0,f);n>=0&&(h+=e.slice(n,a)),c>=0&&(h+=(n<0?"?":"&")+l.slice(c,d));var m=J(s);return m&&(h+=(n<0&&c<0?"?":"&")+m),r>=0&&(h+=e.slice(r)),u>=0&&(h+=(r<0?"":"&")+l.slice(u)),h},ee=Z,te=G.exports,ne=function(e,t,n){var r=0;function a(e){return new t(e)}function o(e){return function(r,o){"string"!=typeof r?(o=r,r=r.url):null==o&&(o={});var i=new t((function(t,n){e(ee(r,o.params),o,(function(e){if("function"==typeof o.type)if(Array.isArray(e))for(var n=0;n<e.length;n++)e[n]=new o.type(e[n]);else e=new o.type(e);t(e)}),n)}));if(!0===o.background)return i;var s=0;function l(){0==--s&&"function"==typeof n&&n()}return function e(t){var n=t.then;return t.constructor=a,t.then=function(){s++;var r=n.apply(t,arguments);return r.then(l,(function(e){if(l(),0===s)throw e})),e(r)},t}(i)}}function i(e,t){for(var n in e.headers)if({}.hasOwnProperty.call(e.headers,n)&&t.test(n))return!0;return!1}return a.prototype=t.prototype,a.__proto__=t,{request:o((function(t,n,r,a){var o,s=null!=n.method?n.method.toUpperCase():"GET",l=n.body,c=!(null!=n.serialize&&n.serialize!==JSON.serialize||l instanceof e.FormData),u=n.responseType||("function"==typeof n.extract?"":"json"),d=new e.XMLHttpRequest,f=!1,h=d,m=d.abort;for(var p in d.abort=function(){f=!0,m.call(this)},d.open(s,t,!1!==n.async,"string"==typeof n.user?n.user:void 0,"string"==typeof n.password?n.password:void 0),c&&null!=l&&!i(n,/^content-type$/i)&&d.setRequestHeader("Content-Type","application/json; charset=utf-8"),"function"==typeof n.deserialize||i(n,/^accept$/i)||d.setRequestHeader("Accept","application/json, text/*"),n.withCredentials&&(d.withCredentials=n.withCredentials),n.timeout&&(d.timeout=n.timeout),d.responseType=u,n.headers)({}).hasOwnProperty.call(n.headers,p)&&d.setRequestHeader(p,n.headers[p]);d.onreadystatechange=function(e){if(!f&&4===e.target.readyState)try{var o,i=e.target.status>=200&&e.target.status<300||304===e.target.status||/^file:\/\//i.test(t),s=e.target.response;if("json"===u?e.target.responseType||"function"==typeof n.extract||(s=JSON.parse(e.target.responseText)):u&&"text"!==u||null==s&&(s=e.target.responseText),"function"==typeof n.extract?(s=n.extract(e.target,n),i=!0):"function"==typeof n.deserialize&&(s=n.deserialize(s)),i)r(s);else{try{o=e.target.responseText}catch(e){o=s}var l=new Error(o);l.code=e.target.status,l.response=s,a(l)}}catch(e){a(e)}},"function"==typeof n.config&&(d=n.config(d,n,t)||d)!==h&&(o=d.abort,d.abort=function(){f=!0,o.call(this)}),null==l?d.send():"function"==typeof n.serialize?d.send(n.serialize(l)):l instanceof e.FormData?d.send(l):d.send(JSON.stringify(l))})),jsonp:o((function(t,n,a,o){var i=n.callbackName||"_mithril_"+Math.round(1e16*Math.random())+"_"+r++,s=e.document.createElement("script");e[i]=function(t){delete e[i],s.parentNode.removeChild(s),a(t)},s.onerror=function(){delete e[i],s.parentNode.removeChild(s),o(new Error("JSONP request failed"))},s.src=t+(t.indexOf("?")<0?"?":"&")+encodeURIComponent(n.callbackKey||"callback")+"="+encodeURIComponent(i),e.document.documentElement.appendChild(s)}))}}(window,te,q.redraw),re=function(e){if(""===e||null==e)return{};"?"===e.charAt(0)&&(e=e.slice(1));for(var t=e.split("&"),n={},r={},a=0;a<t.length;a++){var o=t[a].split("="),i=decodeURIComponent(o[0]),s=2===o.length?decodeURIComponent(o[1]):"";"true"===s?s=!0:"false"===s&&(s=!1);var l=i.split(/\]\[?|\[/),c=r;i.indexOf("[")>-1&&l.pop();for(var u=0;u<l.length;u++){var d=l[u],f=l[u+1],h=""==f||!isNaN(parseInt(f,10));if(""===d)null==n[i=l.slice(0,u).join()]&&(n[i]=Array.isArray(c)?c.length:0),d=n[i]++;else if("__proto__"===d)break;if(u===l.length-1)c[d]=s;else{var m=Object.getOwnPropertyDescriptor(c,d);null!=m&&(m=m.value),null==m&&(c[d]=m=h?[]:{}),c=m}}}return r},ae=re,oe=function(e){var t=e.indexOf("?"),n=e.indexOf("#"),r=n<0?e.length:n,a=t<0?r:t,o=e.slice(0,a).replace(/\/{2,}/g,"/");return o?("/"!==o[0]&&(o="/"+o),o.length>1&&"/"===o[o.length-1]&&(o=o.slice(0,-1))):o="/",{path:o,params:t<0?{}:ae(e.slice(t+1,r))}},ie=oe,se=T,le=k,ce=G.exports,ue=Z,de=oe,fe=function(e){var t=ie(e),n=Object.keys(t.params),r=[],a=new RegExp("^"+t.path.replace(/:([^\/.-]+)(\.{3}|\.(?!\.)|-)?|[\\^$*+.()|\[\]{}]/g,(function(e,t,n){return null==t?"\\"+e:(r.push({k:t,r:"..."===n}),"..."===n?"(.*)":"."===n?"([^/]+)\\.":"([^/]+)"+(n||""))}))+"$");return function(e){for(var o=0;o<n.length;o++)if(t.params[n[o]]!==e.params[n[o]])return!1;if(!r.length)return a.test(e.path);var i=a.exec(e.path);if(null==i)return!1;for(o=0;o<r.length;o++)e.params[r[o].k]=r[o].r?i[o+1]:decodeURIComponent(i[o+1]);return!0}},he=K,me={},pe=function(e,t){var n;function r(t,r,a){if(t=ue(t,r),null!=n){n();var o=a?a.state:null,i=a?a.title:null;a&&a.replace?e.history.replaceState(o,i,u.prefix+t):e.history.pushState(o,i,u.prefix+t)}else e.location.href=u.prefix+t}var a,o,i,s,l=me,c=u.SKIP={};function u(d,f,h){if(null==d)throw new Error("Ensure the DOM element that was passed to `m.route` is not undefined");var m,p=0,g=Object.keys(h).map((function(e){if("/"!==e[0])throw new SyntaxError("Routes must start with a `/`");if(/:([^\/\.-]+)(\.{3})?:/.test(e))throw new SyntaxError("Route parameter names must be separated with either `/`, `.`, or `-`");return{route:e,component:h[e],check:fe(e)}})),v="function"==typeof setImmediate?setImmediate:setTimeout,y=ce.resolve(),b=!1;if(n=null,null!=f){var x=de(f);if(!g.some((function(e){return e.check(x)})))throw new ReferenceError("Default route doesn't match any known routes")}function w(){b=!1;var n=e.location.hash;"#"!==u.prefix[0]&&(n=e.location.search+n,"?"!==u.prefix[0]&&"/"!==(n=e.location.pathname+n)[0]&&(n="/"+n));var d=n.concat().replace(/(?:%[a-f89][a-f0-9])+/gim,decodeURIComponent).slice(u.prefix.length),h=de(d);function m(){if(d===f)throw new Error("Could not resolve default route "+f);r(f,null,{replace:!0})}he(h.params,e.history.state),function e(n){for(;n<g.length;n++)if(g[n].check(h)){var r=g[n].component,u=g[n].route,f=r,v=s=function(u){if(v===s){if(u===c)return e(n+1);a=null==u||"function"!=typeof u.view&&"function"!=typeof u?"div":u,o=h.params,i=d,s=null,l=r.render?r:null,2===p?t.redraw():(p=2,t.redraw.sync())}};return void(r.view||"function"==typeof r?(r={},v(f)):r.onmatch?y.then((function(){return r.onmatch(h.params,d,u)})).then(v,m):v("div"))}m()}(0)}return n=function(){b||(b=!0,v(w))},"function"==typeof e.history.pushState?(m=function(){e.removeEventListener("popstate",n,!1)},e.addEventListener("popstate",n,!1)):"#"===u.prefix[0]&&(n=null,m=function(){e.removeEventListener("hashchange",w,!1)},e.addEventListener("hashchange",w,!1)),t.mount(d,{onbeforeupdate:function(){return!(!(p=p?2:1)||me===l)},oncreate:w,onremove:m,view:function(){if(p&&me!==l){var e=[se(a,o.key,o)];return l&&(e=l.render(e[0])),e}}})}return u.set=function(e,t,n){null!=s&&((n=n||{}).replace=!0),s=null,r(e,t,n)},u.get=function(){return i},u.prefix="#!",u.Link={view:function(e){var t,n,r=e.attrs.options,a={};he(a,e.attrs),a.selector=a.options=a.key=a.oninit=a.oncreate=a.onbeforeupdate=a.onupdate=a.onbeforeremove=a.onremove=null;var o=le(e.attrs.selector||"a",a,e.children);return(o.attrs.disabled=Boolean(o.attrs.disabled))?(o.attrs.href=null,o.attrs["aria-disabled"]="true",o.attrs.onclick=null):(t=o.attrs.onclick,n=o.attrs.href,o.attrs.href=u.prefix+n,o.attrs.onclick=function(e){var a;"function"==typeof t?a=t.call(e.currentTarget,e):null==t||"object"!=typeof t||"function"==typeof t.handleEvent&&t.handleEvent(e),!1===a||e.defaultPrevented||0!==e.button&&0!==e.which&&1!==e.which||e.currentTarget.target&&"_self"!==e.currentTarget.target||e.ctrlKey||e.metaKey||e.shiftKey||e.altKey||(e.preventDefault(),e.redraw=!1,u.set(n,null,r))}),o}},u.param=function(e){return o&&null!=e?o[e]:o},u}(window,q),ge=U,ve=ne,ye=q,be=function(){return ge.apply(this,arguments)};be.m=ge,be.trust=ge.trust,be.fragment=ge.fragment,be.mount=ye.mount,be.route=pe,be.render=H,be.redraw=ye.redraw,be.request=ve.request,be.jsonp=ve.jsonp,be.parseQueryString=re,be.buildQueryString=$,be.parsePathname=oe,be.buildPathname=Z,be.vnode=T,be.PromisePolyfill=z;var xe=be;let we=null;function Ee(e){we=e.io}class Ie{constructor(e,t=""){let n={event:e&&e.event,socket:null,cmdList:e&&e.commandList,isConnect:!1,host:e&&e.host,roomName:t};this.isConnect=()=>n.isConnect,this.setHost=e=>n.host=e,this.setCommandList=e=>n.cmdList=e,this.registerCommand=(e,t)=>{let r=n.socket;r&&r.on(e,t)},this.sendCommand=(e,t)=>{let r=n.socket;r&&r.compress(!0).emit(e,t)},this.setEvent=e=>{n.event=e},this.connect=e=>{let t,r=n.cmdList;if(n.socket)return!1;t=we(n.host+n.roomName,{transports:["websocket"]});let a={};if(e?(n.event=e,a.connect=e.connect,a.disconnect=e.disconnect):n.event&&(a.connect=n.event.connect,a.disconnect=n.event.disconnect),n.socket=t,t.on("connect",(()=>{n.isConnect=!0,a.connect&&(a.connect(),a.connect=null)})),t.on("disconnect",(()=>{n.isConnect=!1,a.disconnect&&(a.disconnect(),a.disconnect=null)})),r){Object.getOwnPropertyNames(r).forEach((e=>{t.on(e,r[e])}))}return!0},this.disconnect=()=>{let e=n.socket;e&&e.disconnect()}}}var Te=Object.freeze({__proto__:null,init:Ee,Network:Ie});let Se,_e,Ne;class Pe{static init(e){Se=e.CMD,_e=e.RESULT,Ne=e.STATE}static create(e){let t,n=e.lobbyBuffer,r=e.gameBuffer,a=null,o={cmdList:null,gameProc:null,setEventMap(e){a=e}};t=(e=>{let t={},i=e.gameEvent;return t.checkData=(e,t,n,r)=>{let a=Ne.OK;return t.resultCode!==_e.OK?(a=Ne.ERROR,r&&r.error&&r.error(t)):r&&r.handle&&r.handle(t),a},t.gameProc=e=>{let t=i[e.gid];t&&t.recvGameData&&t.recvGameData(e.packet)},t.broadcastProc=e=>{Object.getOwnPropertyNames(i).forEach((t=>{let n=i[t];n&&n.recvBroadcast&&n.recvBroadcast(e)}))},o.gameProc=t.gameProc,{connect(e){let t=a&&a.connect;t&&t.handle&&t.handle(e)},reconnect(e){let t=a&&a.reconnect;t&&t.handle&&t.handle(e)},login(r){let o=a&&a.login;t.checkData(Se.LOGIN,r,n,o)&&(e.connectionToken=r.connectionToken)},relogin(r){let o=a&&a.relogin;t.checkData(Se.RELOGIN,r,n,o)&&(e.connectionToken=r.connectionToken)},inGame(e){let r=a&&a.inGame;t.checkData(Se.IN_GAME,e,n,r)},exitGame(e){let r=a&&a.exitGame;t.checkData(Se.EXIT_GAME,e,n,r)},toGame(e){let n=a&&a.toGame;t.checkData(Se.TO_GAME,e,r,n),t.gameProc(e)},broadCastMsg(e){let n=a&&a.broadcast;n&&n.handle&&n.handle(e),t.broadcastProc(e)},ping(e){let t=a&&a.ping;t&&t.handle&&t.handle(e)},pong(e){let t=a&&a.pong;t&&t.handle&&t.handle(e)},disconnectMsg(e){let t=a&&a.disconnectMsg;t&&t.handle&&t.handle(e)},disconnect(e){let t=a&&a.disconnect;t&&t.handle&&t.handle(e)}}})(e),o.cmdList=t,e.commandManager=o}}let Re=null,Ce=[],Le=[],je=!1;function Oe(e){let t=!1;return e&&e.update&&(Object.prototype.hasOwnProperty.call(e,"__updateIndex")||(e.__updateIndex=Ce.length,Ce.push(e),t=!0)),t}function Ae(e){let t,n,r=Ce.length;if("number"==typeof e.__updateIndex){if(t=e.__updateIndex,t>=0&&t<r){let e=r-1;n=Ce[e],Ce[t]=n,n.__updateIndex=t,Ce.splice(e,1)}delete e.__updateIndex}}function ke(e,t){let n={currentTime:0,func:e,update:e=>{n.currentTime>=t&&(Ae(n),n.func&&n.func(n.currentTime)),n.currentTime+=e}};return Oe(n),n}function Me(e,t){let n={currentTime:0,func:e,update:e=>{n.currentTime+=e,n.currentTime>=t&&(n.func&&n.func(n.currentTime),n.currentTime=0)}};return Oe(n),n}function De(e){e&&e.update&&(Le.push(e),je=!0)}function Be(){Ce.forEach((e=>{delete e.__updateIndex})),Ce=[]}let Fe=-1;function Ue(e){let t,n=.001*performance.now();e.paused||(Fe<0?(t=0,Fe=n):(t=n-Fe,Fe=n),function(e){je&&(Le.forEach((t=>{t.update(e),t.pause&&t.pause()})),Le=[],je=!1),Ce.forEach((t=>{t.update(e)}))}(t))}let Ge=!1,Ve=!1;function ze(){Ve||(Ve=!0,Re=globalThis.createjs.Ticker,Re.timingMode=Re.TIMEOUT,Re.interval=1e3/60,Re.addEventListener("tick",Ue),Be())}function Xe(){Ge||(Ge=!0,Fe=-1,Re.paused=!1)}var Ye=Object.freeze({__proto__:null,add:Oe,remove:Ae,setTimeout:ke,idle:function(e){return new Promise((t=>{ke((function(){t()}),e)}))},setInterval:Me,clearInterval:function(e){Ae(e)},once:De,reset:Be,init:ze,play:Xe,pause:function(){Ge&&(Ge=!1,Re.paused=!0)}});const He={ERROR:"error",CONNECT:"connect",RECONNECT:"reconnect",LOGIN:"login",RELOGIN:"relogin",IN_GAME:"inGame",EXIT_GAME:"exitGame",TO_GAME:"toGame",BROADCAST:"broadCastMsg",DISCONNECT_MSG:"disconnectMsg",DISCONNECT:"disconnect"},We={ERROR:0,OK:1},qe={SEND_LOCK:-3,CONNECT_TIMEOUT:-2,BUFFER_FULL:-1,ERROR:0,OK:1,LOGIN:3,ROOM:4,CONNECT:2};class $e extends Ie{constructor(e,t){let n={gameEvent:{},sendEvent:{},commandManager:null,connectionToken:null,timer:null,login:null,game:{configMap:{},template:null},lobbyBuffer:{sendCommandList:[],token:null},gameBuffer:{sendCommandList:[],token:null}},r=e.Loader;super(e,t);let a=this;Pe.init({CMD:He,RESULT:We,STATE:qe}),n.timer||(n.timer=Me((function(){let e,t=n.lobbyBuffer,r=n.gameBuffer,o=t.sendCommandList;o.length>0&&(e=o.shift(),a.sendLobbyCommand(e)),o=r.sendCommandList,o.length>0&&(e=o.shift(),a.sendGameCommand(e))}),.1)),this.init=(e,t)=>{let o={},i="login",s="gamelist",l=new r;if(Pe.create(n),a.setCommandList(n.commandManager.cmdList),e){if(e.gameTemplate){Object.getOwnPropertyNames(e.gameTemplate).forEach((t=>{l.add(t,e.gameTemplate[t]),o[t]=!0}))}e.login&&l.add(i,e.login),e.gameList&&l.add(s,e.gameList),l.load(((e,r)=>{if(r){if(n.game.template={},Object.getOwnPropertyNames(o).forEach((e=>{r[e]&&(n.game.template[e]=r[e].data)})),r.login&&(n.login=JSON.parse(r.login.data)),r.gamelist){JSON.parse(r.gamelist.data).forEach((e=>{n.game.configMap[e.id]=e}))}}n.login&&n.login.server&&n.login.server.host&&a.setHost(n.login.server.host),t&&t({login:n.login})}))}else t&&t({login:null})},this.getGame=()=>n.game,this.getCommandManager=()=>n.commandManager,this.gameProc=e=>{n.commandManager&&n.commandManager.gameProc(e)},this.setEventMap=e=>{n.commandManager&&n.commandManager.setEventMap(e)},this.setSendEvent=e=>{n.sendEvent.game=e.game},this.login=e=>{let t=e;a.sendCommand("login",t)},this.relogin=()=>{let e={connectionToken:n.connectionToken};a.sendCommand("relogin",e)},this.registerGameEvent=(e,t)=>{t&&(n.gameEvent[t]=e)},this.unregisterGameEvent=e=>{n.gameEvent[e]=null},this.setLobbyCommand=(e,t)=>(n.lobbyBuffer.sendCommandList.push({name:e,data:t}),qe.OK),this.sendLobbyCommand=e=>{a.sendCommand(e.name,e.data)},this.setGameCommand=(e,t)=>(n.gameBuffer.sendCommandList.push({gid:t,packet:e}),qe.OK),this.sendGameCommand=e=>{let t={gid:e.gid,packet:e.packet};a.sendCommand("toGame",t),n.sendEvent.game&&n.sendEvent.game(e.gid)}}static get STATE(){return qe}static get CMD(){return He}static get RESULT(){return We}}function Ke(e,t){let n=e;if(n){let r=t&&t.split(".");r&&r.every((e=>{let t=n[e];return t?(n=t,!0):(n=null,!1)})),n===e&&(n=null)}return n}function Je(e){return class extends e{constructor(e){super(e,!1),this.cloneIndex=0}clone(){this.cloneIndex+=1}addToScene(e){e.addChild(this)}removeFromScene(){this.parent&&this.parent.removeChild(this)}reload(){let e=this,t=e._game.textures,n=e.conf.resource,r=Ke(t,n.group);r&&(e.texture=r[n.name]||PIXI.Texture.EMPTY)}}}var Qe=Object.freeze({__proto__:null,debug:function(e,t){let n=e.getBounds(),r=e.graphics;if(!r){let a=e.anchor;r=new t.Graphics,e.graphics=r,e.addChild(r),r.x=0,r.y=0,r.lineStyle(1,16777215,1),r.beginFill(65280,.15),r.drawRect(-n.width*a.x,-n.height*a.y,n.width,n.height),r.endFill()}},getTextureGroup:Ke,make:Je,default:class{constructor(){this.cloneIndex=0}clone(){this.cloneIndex+=1}addToScene(e){e.addChild(this)}removeFromScene(){let e=this;e.parent&&e.parent.removeChild(e)}}});let Ze=null;let et=null;let tt=null;let nt=null;let rt=null;let at=null,ot=null;const it={CHAR_MAP:["0","1","2","3","4","5","6","7","8","9","."],DISPLAY:{TRANSVERSE:1,STRAIGHT:2},ALIGN_TYPE:{POS:1,RECT:2},OFFSET_TYPE:{STATIC:1,DYNAMIC:2},HORI_ALIGN:{LEFT:1,CENTER:2,RIGHT:3},VERTI_ALIGN:{TOP:1,CENTER:2,BOTTOM:3}};let st=null;let lt=null;let ct=null;let ut={demo:{alpha:{start:1,end:0},scale:{start:.1,end:1.5},color:{start:"ffffff",end:"ffffff"},speed:{start:600,end:200},startRotation:{min:0,max:360},rotationSpeed:{min:0,max:20},lifetime:{min:.5,max:.7},blendMode:"normal",frequency:16e-6,emitterLifetime:-1,maxParticles:100,pos:{x:0,y:0},addAtBack:!1,spawnType:"point"}},dt=null;function ft(e){let t,n,r,a,o=e.lastIndexOf("/");return o>0&&(o+=1,t=e.slice(0,o),n=e.slice(o)),o=n.lastIndexOf("."),o>0&&(a=n.slice(0,o),o+=1,r=n.slice(o)),{dir:t,base:n,name:a,ext:r}}var ht=Object.freeze({__proto__:null,filenameInfo:ft,handleData:function(e,t,n){let r=null;r=n||(e=>e);let a,o=(e,t,n)=>{e.forEach((e=>{t.push(n(e))}))},i=(e,t,n)=>{let r;Object.getOwnPropertyNames(e).forEach((a=>{let s=e[a];"string"==typeof s?t[a]=n(s):Array.isArray(s)?(r=[],o(s,r,n),t[a]=r):"object"==typeof s&&(r={},i(s,r,n),t[a]=r)}))};a=Object.getOwnPropertyNames(e),a.forEach((n=>{let a,s=t[n];a=e[n],Array.isArray(a)?s?o(a,s,r):(s=[],o(a,s,r),t[n]=s):"object"==typeof a?s?i(a,s,r):(s={},i(a,s,r),t[n]=s):"string"==typeof a&&(t[n]=r(a))}))}});let mt=null,pt=null,gt=null;const vt={INFO:"info",GROUP:"group",SCROLLBAR:"scrollbar",BACKGROUND:"background",PARTICLE:"particle",TEXT:"text",IMAGE:"image",SPINE:"spine",BONE:"bone",ANMIMATION:"animation",NUMBER:"number",BUTTON:"button"};let yt={event:{resBegin:null,resEnd:null,sceneResBegin:null,SceneResLoading:null,SceneResEnd:null},state:null,game:null,baseURL:"",base:0,baseProgress:0,baseIndex:0,baseMax:0,objectFactory:{},isBusy:!1,textures:null,spines:null,sounds:null,bonesFactory:null,soundMapList:[]},bt=Ke,xt=e=>{let t={};return t.conf=e,t.name=e.name,t.objName=e.objName,t};function wt(e,t,n="#000000"){return PIXI.Texture.Draw((e=>{t?(e.width=t.width||140,e.height=t.height||40):(e.width=100,e.height=24);let r=e.getContext("2d");r.strokeStyle=n,r.strokeRect(0,0,e.width,e.height),r.fillStyle="#FFFFFF",r.fillRect(0,0,2,2),r.fillRect(e.width-2,0,2,2),r.fillRect(0,e.height-2,2,2),r.fillRect(e.width-2,e.height-2,2,2),r.beginPath(),r.lineCap="round",r.moveTo(0,0),r.lineTo(e.width,e.height),r.moveTo(e.width,0),r.lineTo(0,e.height),r.stroke(),r.fillStyle="#FFFFFF";let a=e.width/2,o=e.height/2;r.fillRect(a,o,2,2)}))}let Et=(e,t)=>{let n=null,r=e.resource.group,a=e.resource.name,o=e.pos||{x:0,y:0},i=bt(yt.textures,r),s=i&&i[a],l=dt.getConfig(e.config.name);if(s&&l){if(e.debug){let t=wt(e.name,e);Array.isArray(s)||(s=[s]),s.push(t)}n=new dt({game:t,conf:e,name:e.name,objName:e.objName,isInScene:e.isInScene,setting:{type:e.type,config:l,art:s,useParticleContainer:e.useParticleContainer},pos:o})}return n},It=(e,t)=>{let n=null,r=e.pos||{x:0,y:0},a=(e=>{let t=yt.spines,n=e&&e.split(".");return t&&n&&n.every((e=>{let n=t[e];return!!n&&(t=n,!0)})),t})(e.resource.spineData),o=bt(yt.textures,e.resource.texture);return a&&(n=new rt({game:t,conf:e,name:e.name,objName:e.objName,isInScene:e.isInScene,spineDataGroup:a,textureGroup:o,pos:r})),n},Tt=(e,t)=>{let n,r=e.pos||{x:0,y:0},a={},o={timeScale:1};return e.resource&&"string"==typeof e.resource.name&&(a.name=e.resource.name),e.animation&&(o.name=e.animation.name,o.timeScale=e.animation.timeScale),n=new ot({game:t,conf:e,name:e.name,objName:e.objName,resource:a,animation:o,isInScene:e.isInScene,pos:r}),n},St=(e,t)=>{let n,r=e.pos||{x:0,y:0},a=yt.objectFactory;return n=new tt({game:t,conf:e,name:e.name,objName:e.objName,isInScene:e.isInScene,pivot:e.pivot,pos:r}),e.childList&&e.childList.forEach((e=>{let r,o=a[e.type];o&&(r=o(e,t),r&&(e.isInScene&&r&&n.addChild(r),n.childList.push(r)))})),n},_t=(e,t)=>{let n,r=e.pos||{x:0,y:0},a=e.anchor||{x:0,y:0};return n=new ct({game:t,conf:e,name:e.name,objName:e.objName,isInScene:e.isInScene,pos:r,anchor:a,text:e.text||"文字訊息"}),n},Nt=(e,t)=>{let n,r=e.resource,a=r.group,o=bt(yt.textures,a),i=PIXI.Texture.EMPTY,s=PIXI.Texture.EMPTY;return e.debug?s=wt(e.name,e):o&&(i=o[r.slider]||i,s=o[r.background]||s),n=new lt({game:t,conf:e,name:e.name,objName:e.objName,isInScene:e.isInScene,pos:e.pos,anchor:e.anchor,slider:i,background:s}),n},Pt=(e,t)=>{let n,r=e.resource.group,a=e.resource.name,o=e.pos||{x:0,y:0},i=e.anchor||{x:0,y:0},s=bt(yt.textures,r);"number"==typeof a&&a<0&&(a=0);let l=s&&s[a]||PIXI.Texture.EMPTY;return e.debug&&(l=wt(e.name,e)),n=new nt({game:t,conf:e,name:e.name,objName:e.objName,isInScene:e.isInScene,pos:o,anchor:i,texture:l}),n},Rt=(e,t)=>{let n,r=e.resource.group,a=e.resource.name,o=e.pos||{x:0,y:0},i=e.anchor||{x:0,y:0},s=bt(yt.textures,r),l=e.blend;"number"==typeof a&&a<0&&(a=0);let c=s&&s[a]||PIXI.Texture.EMPTY;return"number"==typeof l?l<0&&(l=0):l=0,e.debug&&(c=wt(e.name,e)),n=new nt({game:t,conf:e,name:e.name,objName:e.objName,isInScene:e.isInScene,pos:o,anchor:i,alpha:e.alpha||1,texture:c}),n.blendMode=l,n},Ct=(e,t)=>{let n,r=e.resource.group,a=e.resource.name,o=e.pos||{x:0,y:0},i=e.anchor||{x:0,y:0},s=e.speed||.33,l=e.loop,c=bt(yt.textures,r),u=c&&c[a]||[PIXI.Texture.EMPTY];return e.debug&&(u=[wt(e.name,e)]),n=new Ze({game:t,conf:e,name:e.name,objName:e.objName,isInScene:e.isInScene,speed:s,loop:l,pos:o,anchor:i,textures:u}),n},Lt=(e,t)=>{let n,r=e.resource,a=e.resource.texture,o=bt(yt.textures,r.group),i=e.numCounts||4,s=e.offset,l=e.symbolOffset,c=e.charMap,u=e.autoHide,d={pos:{x:0,y:0},width:e.width,height:e.height},f=o&&o[e.resource.background]||PIXI.Texture.EMPTY;return e.debug&&(f=wt(e.name,e)),n=new st({game:t,conf:e,name:e.name,objName:e.objName,isInScene:e.isInScene,autoHide:u,fixVal:e.fixVal,useComma:e.useComma,useDash:e.useDash,useMoney:e.useMoney,pos:e.pos,anchor:e.anchor,pivot:e.pivot,rect:d,textureName:a,background:f,numCounts:i,charMap:c,symbolOffset:l,offset:s}),n},jt=(e,t)=>{let n,r,a=e.resource,o=a.group,i=a.name,s=bt(yt.textures,o),l={enter:PIXI.Texture.EMPTY,press:PIXI.Texture.EMPTY,leave:PIXI.Texture.EMPTY,disable:PIXI.Texture.EMPTY};return e.debug?(l.enter=wt(e.name,e),l.press=l.enter,l.leave=l.enter,l.disable=l.enter):(n=s&&s[i],n&&(l.enter=n[a.enter]||l.enter,l.press=n[a.press]||l.press,l.leave=n[a.leave]||l.leave,l.disable=n[a.disable]||l.disable)),r=new et({game:t,conf:e,name:e.name,objName:e.objName,isInScene:e.isInScene,pos:e.pos,anchor:e.anchor,texture:l}),r};function Ot(e){yt.objectFactory[vt.INFO]=xt,yt.objectFactory[vt.GROUP]=St,yt.objectFactory[vt.SCROLLBAR]=Nt,yt.objectFactory[vt.BACKGROUND]=Pt,yt.objectFactory[vt.TEXT]=_t,yt.objectFactory[vt.IMAGE]=Rt,yt.objectFactory[vt.ANMIMATION]=Ct,yt.objectFactory[vt.NUMBER]=Lt,yt.objectFactory[vt.BUTTON]=jt,yt.objectFactory[vt.SPINE]=It,yt.objectFactory[vt.PARTICLE]=Et,gt=e.jsyaml,pt=e.Loader,mt=e.dragon,mt&&(yt.objectFactory[vt.BONE]=Tt)}function At(e){let t,n,r=yt.event;if(yt.isBusy)return!1;yt.isBusy=!0,yt.game=e.game;let a=e.filename,o=e.proc,i=e.callback,s=e.finish,l=[],c=0,u=e=>{let a=i[c];a&&a(e),r.resEnd&&r.resEnd(c),c+=1,c<l.length?(r.resBegin&&r.resBegin(c),n()):t()};if(t=()=>{yt.isBusy=!1,s&&s()},n=()=>{let e,t,n;e=o[c],t=l[c];try{n=gt.load(t),e&&(yt.baseIndex+=1,yt.baseProgress=yt.baseIndex/yt.baseMax*100,e(n,u))}catch(e){}},!Array.isArray(a))return!1;if(!Array.isArray(o))return!1;if(!Array.isArray(i))return!1;if(a.length!==o.length)return!1;return function(){r.sceneResBegin&&r.sceneResBegin("config"),yt.baseIndex=0,yt.baseProgress=0,yt.baseMax=1+a.length,yt.baseProgress=yt.baseIndex/yt.baseMax*100,yt.base=1/yt.baseMax;let e=new pt(yt.baseURL,50);a.forEach(((t,n)=>{e.add(n.toString(),t)})),e.onProgress.once((e=>{let t=e.progress;t>100&&(t=100);let n=yt.baseProgress+t*yt.base;r.sceneResLoading&&r.sceneResLoading({currentProgress:t,currentLength:a.length,totalProgress:n,state:yt.state})})),e.load(((e,t)=>{Object.getOwnPropertyNames(t).forEach((e=>{let n=parseInt(e);l[n]=t[e].data})),r.sceneResEnd&&r.sceneResEnd("config"),c=0,n()}))}(),!0}function kt(e){let t,n,r=yt.event;if(yt.isBusy)return!1;yt.isBusy=!0,yt.game=e.game;let a=e.objData,o=e.proc,i=e.callback,s=e.finish,l=0,c=e=>{let o=i[l];o&&o(e),r.resEnd&&r.resEnd(l),l+=1,l<a.length?(r.resBegin&&r.resBegin(l),n(l)):t()};if(t=()=>{yt.isBusy=!1,s&&s()},n=e=>{let t,n;t=o[e],n=a[e],yt.baseIndex=e,yt.baseProgress=yt.baseIndex/yt.baseMax*100,t&&n&&t(n,c)},!Array.isArray(a))return!1;if(!Array.isArray(o))return!1;if(!Array.isArray(i))return!1;if(a.length!==o.length)return!1;return yt.baseIndex=0,yt.baseProgress=0,yt.baseMax=a.length,yt.base=1/yt.baseMax,l=0,n(l),!0}function Mt(e){let t=yt.event;e?(t.resBegin=e.resBegin||t.resBegin,t.resEnd=e.resEnd||t.resEnd,t.sceneResBegin=e.sceneResBegin||t.sceneResBegin,t.sceneResLoading=e.sceneResLoading||t.sceneResLoading,t.sceneResEnd=e.sceneResEnd||t.sceneResEnd):(t.resBegin=null,t.resEnd=null,t.sceneResBegin=null,t.sceneResLoading=null,t.sceneResEnd=null)}function Dt(e){yt.state=e}function Bt(e,t){"object"==typeof e.particle&&dt.setConfigMap(e.particle),t(e)}function Ft(e,t){let n=yt.event,r=0,a={},o=t,i=e=>{let t=e.progress;t>100&&(t=100);let r={currentProgress:t,totalProgress:yt.baseProgress+t*yt.base,state:yt.state};n.sceneResLoading&&n.sceneResLoading(r)},s=t=>{let r={};if(!t||!t.resources)return void o(r);let a=t.resources,i=e=>{let t=null;return a[e]&&a[e].spineData&&(t=a[e].spineData),t},s=(e,t,n)=>{let r;Object.getOwnPropertyNames(e).forEach((a=>{let o=e[a];"string"==typeof o?t[a]=n(o):Array.isArray(o)?(r=[],((e,t,n)=>{e.forEach((e=>{t.push(n(e))}))})(o,r,n),t[a]=r):"object"==typeof o&&(r={},s(o,r,n),t[a]=r)}))};e&&e.spines&&e.atlas&&e.spineDataMap?s(e.spineDataMap.spines,r,i):e&&e.spines&&s(e.spines,r,i),n.sceneResEnd&&n.sceneResEnd("spine"),yt.spines=r,o(r)},l=e=>{a[e]=e},c=(e,t)=>{Object.getOwnPropertyNames(e).forEach((n=>{let r=e[n];"string"==typeof r?t(r):Array.isArray(r)?((e,t)=>{e.forEach((e=>{t(e)}))})(r,t):"object"==typeof r&&c(r,t)}))};(()=>{n.sceneResBegin&&n.sceneResBegin("spine");let t=function(){function e(e){this.index=0,this.lines=e.split(/\r\n|\r|\n/)}return e.prototype.readLine=function(){return this.index>=this.lines.length?null:this.lines[this.index++]},e.prototype.readValue=function(){var e=this.readLine(),t=e.indexOf(":");if(-1===t)throw new Error("Invalid line: "+e);return e.substring(t+1).trim()},e.prototype.readTuple=function(e){var t=this.readLine(),n=t.indexOf(":");if(-1===n)throw new Error("Invalid line: "+t);for(var r=0,a=n+1;r<3;r++){var o=t.indexOf(",",a);if(-1===o)break;e[r]=t.substr(a,o-a).trim(),a=o+1}return e[r]=t.substring(a).trim(),r+1},e}();if(e&&e.spines&&e.atlas){let n={},r={},a=e.atlas,o=Object.getOwnPropertyNames(a);o.forEach((e=>{let n=a[e],o=ft(e);if(!n)return;let i=new t(n);!function(){let e=!0;for(;;){let t=i.readLine();if(null===t)return;if(0!==t.length){if(t.length<=2&&t.indexOf(" ")>=0)e=!0;else if(e){e=!1;let n=o.dir+t;r[n]=1}}else e=!0}}()}));let l=Object.getOwnPropertyNames(r),c=null;c=PIXI.Loader?PIXI.Loader:PIXI.loaders.Loader;let u=new c(yt.baseURL,50);u.onProgress.add(i),u.add(l),u.load((t=>{let r=PIXI.spine.TextureAtlas||PIXI.spine.core.TextureAtlas,i=PIXI.spine.AtlasAttachmentLoader||PIXI.spine.core.AtlasAttachmentLoader,l=PIXI.spine.SkeletonJson||PIXI.spine.core.SkeletonJson;o.forEach((o=>{let s=a[o],c=ft(o);if(!s)return;let u=new r(s,((e,n)=>{let r,a=c.dir+e,o=t.resources[a];r=o?o.texture:PIXI.Texture.EMPTY,n(r.baseTexture)})),d=new i(u),f=new l(d),h=`${c.dir}${c.name}.json`,m=e.spines[h];if(m){let e=f.readSkeletonData(m);n[h]={spineData:e}}})),s({resources:n})}))}else if(e&&e.spines){c(e.spines,l);let t=Object.getOwnPropertyNames(a);if(r=t.length,0===r)s();else{let e=null;e=PIXI.Loader?PIXI.Loader:PIXI.loaders.Loader;let n=new e(yt.baseURL,50);t.forEach((e=>{n.add(e,e)})),n.onProgress.add(i),n.load(s)}}else s()})()}function Ut(e,t){let n=yt.event,r={},a=t,o=e=>{let t=e.progress;t>100&&(t=100),t=yt.baseProgress+t*yt.base,n.sceneResLoading&&n.sceneResLoading({current:t,length:100,state:yt.state})},i=t=>{let r=null;if(mt&&(r=new mt.dragonBones.PixiFactory),!t)return void a(r);let o=t.resources,i=(e,t,n)=>{e.forEach((e=>{t.push(n(e))}))};i(e.bones.data,[],(e=>{let t=o[e].data;return r&&r.parseDragonBonesData(t),t}));i(e.bones.resource,[],(e=>{let t=o[e.atlas]&&o[e.atlas].data;if(t=JSON.parse(t),r){let n=bt(yt.textures,e.texture.group),a=n&&n[e.texture.name];a&&r.parseTextureAtlasData(t,a)}return t})),n.sceneResEnd&&n.sceneResEnd("bones"),yt.bonesFactory=r,ot.setFactory(r),a(r)},s=e=>{r[e]=e},l=e=>{r[e.atlas]=e.atlas},c=(e,t)=>{e.forEach((e=>{t(e)}))},u=(e,t)=>{Object.getOwnPropertyNames(e).forEach((n=>{let r=e[n];"string"==typeof r?t(r):Array.isArray(r)?c(r,t):"object"==typeof r&&u(r,t)}))};(()=>{if(n.sceneResBegin&&n.sceneResBegin("bones"),e&&e.bones&&e.bones.data){u(e.bones.data,s),c(e.bones.resource,l);let t=Object.getOwnPropertyNames(r);if(0===t.length)i();else{let e=null;e=PIXI.Loader?PIXI.Loader:PIXI.loaders.Loader;let n=new e(yt.baseURL,50);t.forEach((e=>{n.add(e,e)})),n.onProgress.add(o),n.load(i)}}else i()})()}function Gt(e,t){let n,r=e.objects,a=yt.objectFactory,o=[],i=0,s=0,l=yt.event,c=[];l.sceneResBegin&&l.sceneResBegin("object"),s=r.length,r.forEach((e=>{let t=a[e.type];t?(n=t(e,yt.game),n&&o.push(n)):c.push(e),i+=1;let r=i/s*100,u={currentProgress:r,totalProgress:yt.baseProgress+r*yt.base,state:yt.state};l.sceneResLoading&&l.sceneResLoading(u)})),l.sceneResEnd&&l.sceneResEnd("object"),t&&t(o,c)}function Vt(e,t){let n={},r=!1,a={},o=yt.event,i={};yt.textures=null;let s=0,l={currentProgress:0,totalProgress:yt.baseProgress,state:yt.state};o.sceneResLoading&&o.sceneResLoading(l);let c=e=>{let t=e.progress;t>100&&(t=100);let n=0;n=s>0?100*s+yt.baseProgress+t*s:yt.baseProgress+t*yt.base;let r={currentProgress:t,totalProgress:n,state:yt.state};o.sceneResLoading&&o.sceneResLoading(r)},u=r=>{let a,i=r.resources,s=e=>i[e].texture,l=(e,t,n)=>{e.forEach((e=>{t.push(n(e))}))},c=(e,t,n)=>{let r;Object.getOwnPropertyNames(e).forEach((a=>{let o=e[a];"string"==typeof o?t[a]=n(o):Array.isArray(o)?(r=[],l(o,r,n),t[a]=r):"object"==typeof o&&(r={},c(o,r,n),t[a]=r)}))};a=Object.getOwnPropertyNames(e.images),a.forEach((t=>{let r,a=n[t];r=e.images[t],Array.isArray(r)?a?l(r,a,s):(a=[],l(r,a,s),n[t]=a):"object"==typeof r?a?c(r,a,s):(a={},c(r,a,s),n[t]=a):"string"==typeof r&&(n[t]=s(r))})),o.sceneResEnd&&o.sceneResEnd("texture"),yt.textures=n,t&&t(n)},d=e=>{let t=e.progress;t>100&&(t=100);let n=0;n=s>0?yt.baseProgress+t*s:yt.baseProgress+t*yt.base;let r={currentProgress:t,totalProgress:n,state:yt.state};o.sceneResLoading&&o.sceneResLoading(r)},f=null,h=()=>{o.sceneResEnd&&o.sceneResEnd("asset"),f(e)},m=t=>{let n=t.resources,r=t.assetNames,a=e.assets;r.forEach((e=>{let t=a[e],r=n[t.meta.filename].texture;if(r&&t){new PIXI.Spritesheet(r.baseTexture,t).parse((()=>{}))}})),o.sceneResEnd&&o.sceneResEnd("asset"),f(e)},p=e=>{a[e]=e},g=(e,t)=>{e.forEach((e=>{t(e)}))},v=(e,t)=>{if(!e)return;Object.getOwnPropertyNames(e).forEach((n=>{let r=e[n];"string"==typeof r?t(r):Array.isArray(r)?g(r,t):"object"==typeof r&&v(r,t)}))},y=e=>PIXI.utils.TextureCache[e],b=(e,t,n)=>{e.forEach((e=>{t.push(n(e))}))},x=(e,t,n)=>{Object.getOwnPropertyNames(e).forEach((r=>{let a=e[r],o=[];"string"==typeof a?t[r]=n(a):Array.isArray(a)?(b(a,o,n),t[r]=o):"object"==typeof a&&(t[r]=o,x(a,o,n))}))};if(f=e=>{let i,s,l;if(e.images){i=Object.getOwnPropertyNames(e.images),i.forEach((t=>{let n;n=e.images[t],Array.isArray(n)?g(n,p):"object"==typeof n?v(n,p):"string"==typeof n&&p(n)})),s=Object.getOwnPropertyNames(a),o.sceneResBegin&&o.sceneResBegin("texture");let t=null;t=PIXI.Loader?PIXI.Loader:PIXI.loaders.Loader;let n=new t(yt.baseURL,50);s.forEach((e=>{n.add(e,e)})),n.onProgress.add(c),n.load(u)}else r=!0;e.frames&&(l=Object.getOwnPropertyNames(e.frames),l.forEach((t=>{let r,a=n[t];r=e.frames[t],Array.isArray(r)?a?b(r,a,y):(a=[],b(r,a,y),n[t]=a):"object"==typeof r?a?x(r,a,y):(a=[],x(r,a,y),n[t]=a):"string"==typeof r&&(n[t]=y(r))}))),r&&(yt.textures=n,t&&t(n))},e&&e.assets){e.images&&(s=.5*yt.base);let t=e.assets;if(Array.isArray(t)){o.sceneResBegin&&o.sceneResBegin("asset");let e=null;e=PIXI.Loader?PIXI.Loader:PIXI.loaders.Loader;let n=new e(yt.baseURL,50);t.forEach((e=>{n.add(e)})),n.onProgress.add(d),n.load(h)}else if("object"==typeof t){let e=null;e=PIXI.Loader?PIXI.Loader:PIXI.loaders.Loader;let n=new e(yt.baseURL,50),r=Object.getOwnPropertyNames(t);n.assetNames=r,r.forEach((e=>{let r,a,o,i=e.lastIndexOf("/");i>0&&(i+=1,r=e.slice(0,i),a=e.slice(i)),i=a.lastIndexOf("."),i>0&&(i+=1,o=a.slice(i));let s=t[e];a=r+(s.meta&&s.meta.image),s.meta.filename=a,n.add(a)})),n.onProgress.add(d),n.load(m)}}else f(e),i.textures=n;return i}function zt(e){yt.textures=e}function Xt(e){yt.spines=e}function Yt(e,t){let n,r,a,o=0,i=0,s=yt.event,l={},c=yt.soundMapList;if(!globalThis.Howl||!e.sounds)return t&&t(null),!1;r=Object.getOwnPropertyNames(e.sounds),s.sceneResBegin&&s.sceneResBegin("sound");let u=0,d=0;o=0;let f=yt.baseURL;return r.forEach((t=>{let r={};a=e.sounds[t],i=a.length,d+=i,a.forEach((e=>{let t=e.config.src;if(Array.isArray(e.config.src)){let t=[];e.config.src.forEach((e=>{t.push(f+e)})),e.config.src=t}n=new Howl(e.config),e.config.src=t,r[e.objName]=n,o+=1,u=o/d*100;let a=yt.baseProgress+u*yt.base,i={currentProgress:u,totalProgress:a,state:yt.state};s.sceneResLoading&&s.sceneResLoading(i)})),a.length>0?l[t]=r:l[t]=null})),s.sceneResEnd&&s.sceneResEnd("sound"),c.push(l),t&&t(l),!0}function Ht(e){Object.getOwnPropertyNames(e).forEach((t=>{let n=e[t];n&&n.stop?(n.stop(),n.unload()):Ht(n),delete e[t]}))}class Wt{constructor(e){this.game=e,this.isInScene=!1}show(e){let t=this,n=t.game;t.isInScene||(t.isInScene=!0,e||(e=n.layer.main),t.objs&&t.objs.forEach((t=>{t&&(t._game=n,t.isInScene&&(t.addToScene?t.addToScene(e):e.addChild(t)))})))}hide(){let e=this;e.isInScene&&(e.isInScene=!1,e.objs&&e.objs.forEach((e=>{e&&(e.removeFromScene?e.removeFromScene():e.parent&&e.parent.removeChild(e))})))}init(e){let t={};function n(e){e.childList.forEach((t=>{if(t){let r=t.conf;if(r.objName){e[r.objName]=t;t.objName;vt.GROUP===t.type&&n(t)}}}))}this.entity=t,e.forEach((e=>{let r="";e&&e.objName&&(t[e.objName]=e,r='set entity name"'+e.objName+'"',vt.GROUP===e.type&&n(e))}))}}var qt=Object.freeze({__proto__:null,OBJ_TYPE:vt,createDebugTxeture:wt,createGroup:St,init:Ot,registerFactory:function(e){yt.objectFactory[e.type]=e.create},loadScene:At,loadSceneEx:kt,setEvent:Mt,setState:Dt,createRawData:Bt,createSpineData:Ft,createBonesData:Ut,createObject:Gt,createTexture:Vt,setTextures:zt,setSpineData:Xt,setBaseURL:function(e){yt.baseURL=e||""},getBaseURL:function(){return yt.baseURL},getTextures:function(e,t){let n,r=e;return t.split(".").every((function(e){return n=r[e],!!n&&(r=n,!0)})),r},createSound:Yt,destroySound:Ht,destroyAllSound:function(){yt.soundMapList.forEach((e=>{Object.getOwnPropertyNames(e).forEach((t=>{Ht(e[t]),delete e[t]}))}))},createScene:function(e,t){return new Promise(((n,r)=>{if(yt.isBusy)return void r("忙碌中");let a=e.game,o=e.infoList,i=e.loading,s=e.loadingEvent,l=new Wt(a),c={data:{proc:Bt,callback(e){l.data=e,t&&t.eventRawData&&t.eventRawData(e)}},sound:{proc:Yt,callback(e){l.sounds=e,t&&t.eventSound&&t.eventSound(e)}},texture:{proc:Vt,callback(e){l.textures=e,t&&t.eventTexture&&t.eventTexture(e)}},spine:{proc:Ft,callback(e){l.spines=e,t&&t.eventSpine&&t.eventSpine(e)}},object:{proc:Gt,callback(e){l.objs?e.forEach((e=>{l.objs.push(e)})):l.objs=e,l.init(e),t&&t.eventObject&&t.eventObject(e)}}};s&&s.start&&s.start();let u={game:a,objData:[],proc:[],callback:[],finish:function(){i&&i.setState(!0),t&&t.finish&&t.finish(l),s&&s.finish&&s.finish(l),n(l)}};o&&Array.isArray(o)&&o.forEach((e=>{let t=c[e.eventName];t&&e.obj&&t.proc&&(u.objData.push(e.obj),u.proc.push(t.proc)),u.callback.push(t.callback)})),i?i.go({loadingEvent:s,game:a,layer:a.layer&&a.layer.overlay,load(){kt(u)}}):kt(u)}))}});let $t={isBusy:!1,game:null,loading:null,useLobbyState:!1,state:{currentIndex:0,totals:0}};var Kt=Object.freeze({__proto__:null,go:function(e,t){if($t.isBusy||!$t.game||!Array.isArray(e))return!1;let n,r,a=$t.game,o=$t.loading,i=0,s=e.length,l=t,c=e;return Dt($t.state),n=()=>{if(!(i<s))return $t.isBusy=!1,$t.useLobbyState||o&&o.setState(!0),l&&l(),!1;{let e=c[i].scene;if(i+=1,e)return r(e);n()}},r=e=>{$t.state.currentIndex=i,$t.state.totals=s;let t=!1;return!e.isCreate()&&e.createScene?(t=!0,e.createScene(n)):n(),t},$t.isBusy=!0,$t.useLobbyState?n():o.go({game:a,layer:a.layer&&a.layer.overlay,load(){n()}}),!0},setUseLobbyState:function(e){$t.useLobbyState=e,e&&$t.game&&$t.game.scene?Mt($t.game.scene.loadingEvent):($t.useLobbyState=!1,Mt(null))},setGame:function(e){$t.game=e},setDisplayLoading:function(e){$t.loading=e}});let Jt={init:null,release:null,resource:null,eventResBegin:null,eventResCheck:null,eventResEnd:null,eventStart:null,eventEnter:null,eventLeave:null},Qt=null,Zt=null;function en(e){Qt&&Qt(e)}class tn{static resCreate(e){Jt.resource&&Jt.resource(e)}static frameStart(e){Jt.eventStart&&Jt.eventStart(e),Qt=tn.frameEnter}static frameFinish(e){Jt.release&&Jt.release(e),Qt=null,Zt&&(Zt(),Zt=null)}static frameEnter(e){let t=!0;Jt.eventEnter&&(t=Jt.eventEnter(e)),t&&(Qt=tn.resBegin)}static frameLeave(e){let t=!0;Jt.eventLeave&&(t=Jt.eventLeave(e)),t&&(Qt=tn.frameFinish)}static resBegin(e){Jt.eventResBegin&&Jt.eventResBegin(e),tn.resCreate(),Qt=tn.resLoading}static resLoading(e){Jt.eventResCheck?Jt.eventResCheck(e)&&(Qt=tn.resEnd):Qt=tn.resEnd}static resEnd(e){Jt.eventResEnd&&Jt.eventResEnd(e),Qt=tn.frameLeave}}function nn(e){return Qt||("object"==typeof e&&(Jt.init=e.init,Jt.release=e.release,Jt.resource=e.resource,Jt.eventResBegin=e.resBegin,Jt.eventResCheck=e.resCheck,Jt.eventResEnd=e.resEnd,Jt.eventStart=e.start,Jt.eventEnter=e.enter,Jt.eventLeave=e.leave,Zt=e.finish),Jt.init&&Jt.init(),Qt=tn.frameStart),!0}var rn=Object.freeze({__proto__:null,refresh:en,go:nn});let an={event:null,scene:{anim:null,message:null,percent:null},isInit:!1,strings:null,resList:null,state:!1},on=null;var sn=Object.freeze({__proto__:null,init:function(){},setState:function(e){an.state=e},setStrings:function(e){an.strings=e},setPosition:function(e){let t=an.scene.anim;t&&(t.x=e.x,t.y=e.y),an.pos?(an.pos.x=e.x,an.pos.y=e.y):an.pos={x:e.x,y:e.y}},setScene:function(e){an.resList=e,an.isInit=!1},go:function(e){if(!globalThis.PIXI)return!1;let t=globalThis.PIXI,n=e.loadingEvent||{},r=e.game,a=an.strings;on={resBegin(e){n.resBegin&&n.resBegin(e)},resEnd(e){n.resEnd&&n.resEnd(e)},sceneResBegin(e){let t=e;a&&a.get&&(t=a.get(e)),n.sceneResBegin&&n.sceneResBegin(e)},sceneResLoading(e){let t=e.state,r=e.totalProgress;if(t){r=(t.currentIndex-1)/t.totals*100+r/t.totals}let a=r.toFixed(0)+"%";n.sceneResLoading&&n.sceneResLoading(e),an.percent&&(an.percent.text=a)},sceneResEnd(e){let t=e;a&&a.get&&(t=a.get(e)),n.sceneResEnd&&n.sceneResEnd(e)}},Mt(on);let o={name:"loading",screen:{width:r.screen&&r.screen.width||1024,height:r.screen&&r.screen.height||768},movieClip:null,layer:e.layer||null,load:e.load,init:()=>{if(!an.isInit){an.isInit=!0;let e,n=an.resList,r=[];n.forEach((n=>{e=t.Texture.from(n),r.push(e)}));let a=null;a=t.AnimatedSprite?new t.AnimatedSprite(r):new t.extras.AnimatedSprite(r),a.animationSpeed=.33,a.anchor.x=.5,a.anchor.y=.5,an.scene.anim=a;let i=new t.Text("message");i.style.fill="#FFFFFF",i.style.stroke="#006600",i.style.strokeThickness=1,i.anchor.x=.5,i.anchor.y=.5,i.x=0,i.y=-44,an.message=i;let s=new t.Text("init");s.style.fill="#FFFFFF",s.style.stroke="#aa0000",s.style.strokeThickness=1,s.anchor.x=.5,s.anchor.y=.5,s.x=0,s.y=24,an.percent=s,a.addChild(i),a.addChild(s),an.pos||(an.pos={x:o.screen.width/2,y:o.screen.height/2}),an.anchor=new t.Point(.5,.5)}r.addRefresh(o.name,en)},release:()=>{null!==o.layer&&null!==an.scene.anim&&o.layer.removeChild(an.scene.anim),r.removeRefresh(o.name)},resource:()=>{o.load&&o.load()},resBegin:()=>{},resCheck:()=>an.state,resEnd:()=>{},start:()=>{if(null!==o.layer&&null!==an.scene.anim){an.percent&&(an.percent.text="start");let e=an.scene.anim;e.x=an.pos.x,e.y=an.pos.y,e.anchor.x=an.anchor.x,e.anchor.y=an.anchor.y,e.alpha=0,e.gotoAndPlay(0),o.layer.addChild(e)}},enter:()=>{let e=!1,t=an.scene.anim;return null!==t?t.alpha>=1?(t.alpha=1,e=!0):t.alpha+=.05:e=!0,e},leave:()=>{let e=!1,t=an.scene.anim;return null!==t?(t.alpha<=0&&(t.alpha=0,e=!0),t.alpha-=.05,t.alpha<=0&&(t.alpha=0)):e=!0,e},finish:()=>{}};return an.event=o,an.state=!1,nn(an.event)}});class ln{constructor(){let e=this,t=null,n={autoUpdate:!0,debug:!1,timeBase:1,currentTime:-1,renderer:null,pause:!0,isInit:!1},r=null,a=[],o=[],i={};e.custom={},e.setEngine=e=>{r=e},e.setElement=e=>{n.element=e},e.getElement=()=>n.element,e.getCanvas=()=>n.canvas,e.update=e=>{n.debug&&t&&t.begin(),n.currentTime<0&&(e=0,n.currentTime=1),e*=n.timeBase,a.forEach((t=>{let n=i[t];n.update?n.update(e):n(e)})),o.forEach((t=>{t.update&&t.update(e)})),n.autoUpdate&&r&&r.render(e),n.debug&&t&&t.end()},n.debug=!1,e.addRefresh=(e,t)=>{i[e]=t,a=Object.getOwnPropertyNames(i)},e.removeRefresh=e=>{Object.prototype.hasOwnProperty.call(i,e)&&(delete i[e],a=Object.getOwnPropertyNames(i))},e.addUpdate=e=>{let t=!1;return e&&e.update&&!Object.prototype.hasOwnProperty.call(e,"__updateIndex")&&(e.__updateIndex=o.length,o[e.__updateIndex]=e,t=!0),t},e.removeUpdate=e=>{let t,n,r=o.length;if("number"==typeof e.__updateIndex){if(t=e.__updateIndex,t>=0&&t<r){let e=r-1;n=o[e],o[t]=n,n.__updateIndex=t,o.splice(e,1)}delete e.__updateIndex}},e.resetUpdate=()=>{o.forEach((e=>{delete e.__updateIndex})),o=[]},e.setTimeout=(t,n)=>{let r={currentTime:0,func:t,update:t=>{r.currentTime.toFixed(2)>=n&&(e.removeUpdate(r),r.func&&r.func(r.currentTime)),r.currentTime+=t}};return e.addUpdate(r),r},e.idle=t=>new Promise((n=>{e.setTimeout((function(){n()}),t)})),e.setInterval=(t,n)=>{let r=0,a={func:t,update:e=>{r+=e,r.toFixed(2)>=n&&(a.func&&a.func(r),r=0)}};return e.addUpdate(a),a},e.clearInterval=t=>{e.removeUpdate(t)},e.isPause=()=>n.pause,e.play=()=>{n.pause&&(n.pause=!1,n.currentTime=-1,Oe(e))},e.once=()=>{n.pause=!1,n.currentTime=-1,De(e)},e.pause=()=>{n.pause||(n.pause=!0,Ae(e))},e.stop=()=>{n.pause=!0,Ae(e),e.resetUpdate()},e.add=e=>{n.timeBase<1&&(n.timeBase=1),n.timeBase+=e,n.timeBase>4&&(n.timeBase=4)},e.dec=e=>{n.timeBase>1&&(n.timeBase=1),n.timeBase-=e,n.timeBase<.1&&(n.timeBase=.1)},e.reset=()=>{n.timeBase=1},e.getTimeBase=()=>n.timeBase,e.setTimeBase=e=>{n.timeBase=e,n.timeBase<.1?n.timeBase=.1:n.timeBase>4&&(n.timeBase=4)},e.init=t=>{if(n.isInit)return!1;n.isInit=!0,n.element=t.element,n.canvas=t.view,n.currentTime=-1;let r={width:t.width,height:t.height};return e.pause(),e.screen=r,!0},e.getRenderer=()=>r&&r.renderer,e.setAutoUpdate=e=>{n.autoUpdate=e},Object.defineProperty(e,"layer",{get:()=>r&&r.layer}),Object.defineProperty(e,"debug",{set(r){t||ln.Stats&&(t=new ln.Stats,e.stats=t),r?t&&n.element&&(t.dom.style.position="absolute",n.element.appendChild(t.dom)):t&&n.element&&t.dom.parentElement&&n.element.removeChild(t.dom),n.debug=r},get:()=>n.debug}),e.stats=null}}ln.Stats=null,ln.isInitial=!1;let cn=!1;let un=null;function dn(e){un=e.m,function(){if(cn)return;cn=!0;let e=globalThis.PIXI;e&&(e.Texture.Draw=t=>{let n=document.createElement("canvas");return"function"==typeof t&&t(n),e.Texture.fromCanvas(n)})}()}let fn={position:"absolute",left:"0%",top:"0%",width:"100%",height:"100%"},hn={zIndex:10,position:"absolute",left:"0%",top:"0%",width:"100%",height:"100%"},mn={oninit(e){let t=this,n=e.attrs,r=e.attrs.config;t.config=r,t.game=r.game,t.style=n.style||hn,t.ready=n.ready},oncreate(e){let t=this,n=t.config;n.view=e.instance.children[0].dom,n.element=e.dom;let r=t.game;r||(r=new ln,t.game=r),r.init(n);let a=function(e){if(!globalThis.PIXI)return null;let t,n,r={},a=e,o=globalThis.PIXI;return n=o.Renderer?new o.Renderer(a):new o.WebGLRenderer(a),t=new o.Container,r.stage=t,r.overlay=new o.Container,r.foreground=new o.Container,r.main=new o.Container,r.background=new o.Container,t.addChildAt(r.overlay,0),t.addChildAt(r.foreground,0),t.addChildAt(r.main,0),t.addChildAt(r.background,0),{renderer:n,stage:t,layer:r,render(){n.render(t)}}}(n);r.setEngine(a),n&&n.ready&&n.ready(r),t.ready&&t.ready(r)},onremove(){let e=this.game;e&&e.stop()},view(){return un(".",{style:this.style},un("canvas",{style:fn}))}};function pn(e){!function(e){!ln.isInitial&&(e.Stats&&(ln.Stats=e.Stats.default||e.Stats),ln.isInitial=!0)}(e),dn(e)}var gn=Object.freeze({__proto__:null,init:pn,run:function(e){let t;if(t=new ln,window.parent&&window.parent!==window){let n,r;if(window.Howl=window.parent.Howl,window.Howler=window.parent.Howler,window.parent.scene){let a=e.id,o=e.event||{};n=window.parent.scene[a],Object.defineProperty(t,"scene",{get:()=>n}),n&&n.event&&(r={create(e){window.parent.lobby&&(t.table=window.parent.lobby.table[e.id],t.currentUser=window.parent.lobby.currentUser,t.command=window.parent.lobby.net.gameCommand,t.lobby={setEvent:window.parent.lobby.setEvent,setCommand:window.parent.lobby.net.setLobbyCommand,CMD:window.parent.lobby.net.CMD}),o.create&&(e.game=t,o.create(e))},play(e){t.play(),o.play&&(e.game=t,o.play(e))},pause(e){t.pause(),o.pause&&(e.game=t,o.pause(e))},enter(e){o.enter&&(e.game=t,o.enter(e))},leave(e){o.leave&&(e.game=t,o.leave(e))},focus(){o.focus&&o.focus()},blur(){o.blur&&o.blur()},lock(e){o.lock&&o.lock(e)},fullscreen(e){o.fullscreen&&o.fullscreen(e)},resize(e){o.resize&&o.resize(e)},music(e){o.music&&o.music(e)},sound(e){o.sound&&o.sound(e)}},n.setEvent(r),n.game=t)}}return t}});let vn={utils:ht,Base:class{constructor(e){let t=this,n={name:e,root:null,game:null,center:{entity:{}},initMap:null,currentTime:0,isCreate:!1,isInScene:!1};t.properties=n,Object.defineProperty(t,"center",{get:()=>n.center}),Object.defineProperty(t,"entity",{get:()=>n.center.entity})}getName(){return this.properties.name}getGame(){return this.properties.game}isCreate(){return this.properties.isCreate}isInScene(){return this.properties.isInScene}getCurrentTime(){return this.properties.currentTime}getCenter(){return this.properties.center}getRoot(){return this.properties.root}setRoot(e){let t=this.properties;t.root=e,t.center=e.center}setInitMap(e){this.properties.initMap=e}setLayer(e){this.properties.center.layer=e}getLayer(){return this.properties.center.layer}getRawData(){return this.properties.center.rawdata}getSound(e){let t=this.properties.center.sounds;return t&&"string"==typeof e&&(t=t[e]),t}mute(e,t){let n=this.properties.center.sounds[e];if(n){Object.getOwnPropertyNames(n).forEach((e=>{n[e].mute(t)}))}}getTexture(e){let t=this.properties.center.textures;return t&&"string"==typeof e&&(t=t[e]),t}getObject(){return this.properties.center.objs}getEntity(){return this.properties.center.entity}eventFinish(){let e=this,t=e.properties,n=t.center;n.textures&&zt(n.textures),n.spines&&Xt(n.spines),t.initMap&&t.initMap(e)}eventRawData(e){}eventSound(e){}eventTexture(e){}eventSpine(e){}eventBones(e){}eventObject(e){}refresh(e){let t=this.getCenter();t&&t.update&&t.update(e)}setGame(e,t){let n=this.properties;n.game=e,e.layer&&t&&Object.prototype.hasOwnProperty.call(e.layer,t)&&(n.center.layer=e.layer[t])}addToScene(e){let t=this,n=t.properties;if(n.isInScene)return!1;n.isInScene=!0;let r=n.center;n.currentTime=-1,n.game=e||n.game,n.game&&n.game.addRefresh(n.name,(function(e){n.currentTime<0?(n.currentTime=0,e=0):t.currentTime+=e,t.refresh(e)}));let a=r.layer;return!r||!r.objs||(r.objs.forEach((e=>{e&&(e._game=n.game||e._game,e.isInScene&&(e.addToScene?e.addToScene(a):a.addChild(e)))})),!0)}removeFromScene(){let e=this.properties;if(!e.isInScene)return!1;e.isInScene=!1,e.game&&e.game.removeRefresh(e.name);let t=e.center;return!t||!t.objs||(t.objs.forEach((e=>{e&&(e.removeFromScene?e.removeFromScene():e.parent&&e.parent.removeChild(e))})),!0)}init(e){let t=this.properties,n=t.center;const r=vt;if(!n||!n.objs)return;let a=n.entity,o={},i=e=>{e.childList.forEach((n=>{if(n){n._game=t.game||n._game;let a=n.conf;if(a.objName){e[a.objName]=n;n.objName}r.GROUP===n.type&&i(n)}}))};if(n.objs.forEach((e=>{let n="";e&&(e._game=t.game||e._game,e.objName&&(a[e.objName]=e,n='set entity name"'+e.objName+'"'),r.GROUP===e.type&&i(e))})),!e)return;o=e.set||{};o.setupGroup=o.setupGroup||(e=>{e.childList.forEach((e=>{if(e){let t=e.conf;r.GROUP===e.type&&o.setupGroup(e),t&&Object.prototype.hasOwnProperty.call(o,t.init)&&o[t.init](e)}}))}),n.objs.forEach((e=>{let t,n="";e&&(t=e.conf,r.GROUP===e.type&&o.setupGroup(e),t&&Object.prototype.hasOwnProperty.call(o,t.init)&&(n=(e.name||e.objName)+" init : "+t.init,o[t.init](e,t)))}))}createScene(e,t){let n=this,r=n.properties;if(r.isCreate)return e&&e(),!1;let a=t.infoList,o=r.center,i={data:{proc:Bt,callback:e=>{o&&(o.rawdata=e),n.eventRawData(e)}},sound:{proc:Yt,callback:e=>{o&&(o.sounds=e),n.eventSound(e)}},texture:{proc:Vt,callback:e=>{o&&(o.textures=e),n.eventTexture(e)}},spine:{proc:Ft,callback:e=>{o&&(o.spines=e),n.eventSpine(e)}},bone:{proc:Ut,callback:e=>{o&&(o.bonesFactory=e),n.eventBones(e)}},object:{proc:Gt,callback:e=>{o&&(o.objs?e.forEach((e=>{o.objs.push(e)})):o.objs=e),n.eventObject(e)}}};function s(){r.isCreate=!0,o&&o.createFinish&&o.createFinish()}if(o&&(o.createFinish=e),t.isObject){let e={game:r.game,objData:[],proc:[],callback:[],finish:s};a&&Array.isArray(a)&&a.forEach((t=>{let n=i[t.eventName];n&&t.obj&&n.proc&&(e.objData.push(t.obj),e.proc.push(n.proc)),e.callback.push(n.callback)})),kt(e)}else{let e={game:r.game,filename:[],proc:[],callback:[],finish:s};a&&Array.isArray(a)&&a.forEach((t=>{let n=i[t.eventName];n&&t.filename&&e.filename.push(t.filename),e.proc.push(n.proc),e.callback.push(n.callback)})),At(e)}return!0}destroyScene(){this.removeFromScene();let e=this.properties,t=e.center;if(!e.isCreate)return!1;if(t&&(t.bonesFactory&&(t.bonesFactory.clear(),t.bonesFactory=null),t.sounds)){Ht(t.sounds)}return t.objs&&(t.objs.forEach(((e,n)=>{e&&delete t.objs[n]})),t.objs=null),e.isCreate=!1,!0}},sceneManager:qt,loadingManager:Kt,loading:rn,set:e=>{let t=vt,n=e.game,r=e.scene,a=e.set;a.setupGroup=a.setupGroup||(e=>{e.childList.forEach((e=>{if(e){e._game=n;let r=e.conf;t.GROUP===e.type&&a.setupGroup(e),r&&Object.prototype.hasOwnProperty.call(a,r.init)&&a[r.init](e)}}))}),r.objs.forEach((e=>{let r,o="";e&&(e._game=n,r=e.conf,t.GROUP===e.type&&a.setupGroup(e),r&&Object.prototype.hasOwnProperty.call(a,r.init)&&(o=(e.name||e.objName)+" init : "+r.init,a[r.init](e,r)))}))}},yn={loading:sn,base:Qe},bn={game:{pixi:mn}},xn=!1;var wn=Object.freeze({__proto__:null,Lobby:$e,client:Te,components:bn,game:gn,init:function(e){let t=e||{},n=t.plugin||[];return Array.isArray(n)||(n=[]),!globalThis.PIXI&&e.PIXI&&(globalThis.PIXI=e.PIXI),new Promise((e=>{xn&&e("!! init finish again !!"),function r(a){if(a&&a.Spine&&globalThis.PIXI&&(globalThis.PIXI.spine=a),n.length>0){let e=n.shift();window.System?System.import(e).then(r):r()}else t.sceneManager=qt,globalThis.PIXI&&(!function(){let e=globalThis.PIXI,t=null;t=e.AnimatedSprite?e.AnimatedSprite:e.extras.AnimatedSprite,Ze=class extends(Je(t)){static get TYPE(){return"animation"}constructor(t){super(t.textures||[e.Texture.EMPTY],!1);let n=this;n._game=t.game,n.conf=t.conf,n.type="animation",n.name=t.name,n.objName=t.objName||null,n.isInScene=t.isInScene,t.pos&&(n.x=t.pos.x,n.y=t.pos.y),t.anchor&&(n.anchor.x=t.anchor.x||0,n.anchor.y=t.anchor.y||0),n.loop=t.loop,"number"==typeof t.speed&&(n.animationSpeed=t.speed)}clone(e){super.clone();let t={game:e||this._game,conf:this.conf,isInScene:this.isInScene,name:this.name+".clone."+this.cloneIndex,loop:this.loop,speed:this.animationSpeed,pos:this.position,anchor:this.anchor,textures:this.textures};return new Ze(t)}removeFromScene(){super.removeFromScene(),this._game&&this._game.removeUpdate(this)}addToScene(e){e.addChild(this),this.playing&&this._game&&this._game.addUpdate(this)}play(){this._game&&this._game.addUpdate(this),super.play()}stop(){this._game&&this._game.removeUpdate(this),super.stop()}update(e){super.update(60*e)}reload(){let t=this._game.textures,n=this.conf,r=this.conf.resource,a=Ke(t,r.group);a&&(this.textures=a[r.name]||[e.Texture.EMPTY]),n.loop&&this.play()}}}(),function(){let e=globalThis.PIXI;et=class extends(Je(e.Sprite)){static get TYPE(){return"button"}constructor(t){super(t.texture&&t.texture.leave||e.Texture.EMPTY);let n=this;n._game=t.game,n.type="button",n.conf=t.conf,n.objName=t.objName||null,n.name=t.name,n.isInScene=t.isInScene,t.pos&&(n.x=t.pos.x,n.y=t.pos.y),t.anchor&&(n.anchor.x=t.anchor.x||0,n.anchor.y=t.anchor.y||0),n.scale.x=1,n.buttonMode=!0,n.interactive=!0;let r={};n.custom=r,r.texture=t.texture||{enter:e.Texture.EMPTY,leave:e.Texture.EMPTY,press:e.Texture.EMPTY,disable:e.Texture.EMPTY},r.isPress=!1,r.flagDrag=!1,r.canMove=!1,r.timer=null,r.obj=null,n.touchstart=n.mousedown=e=>{r.flagDrag&&r.timer&&(n.dragEvent&&(n.dragEvent.curTimes=n.dragEvent.times,n.dragEvent.reset&&n.dragEvent.reset()),r.timer.restart()),n.eventPress(e)},n.touchend=n.mouseup=e=>{r.canMove=!1,r.flagDrag&&n.dragEvent&&n.dragEvent.reset&&n.dragEvent.reset(),n.eventRelease(e)},n.mouseover=e=>{r.flagDrag&&n.dragEvent&&n.dragEvent.reset&&n.dragEvent.reset(),n.eventEnter(e)},n.mouseout=e=>{r.canMove=!1,r.flagDrag&&n.dragEvent&&n.dragEvent.reset&&n.dragEvent.reset(),n.eventLeave(e)},n.touchendoutside=n.mouseupoutside=e=>{r.flagDrag&&n.dragEvent&&n.dragEvent.reset&&n.dragEvent.reset(),n.eventLeave(e)}}clone(e){super.clone();let t={game:e||this._game,conf:this.conf,isInScene:this.isInScene,name:this.name+".clone."+this.cloneIndex,pos:this.position,anchor:this.anchor,texture:this.custom.texture};return new et(t)}setTextures(t){let n=this.custom.texture;t&&(n.enter=t.enter||e.Texture.EMPTY,n.leave=t.leave||e.Texture.EMPTY,n.press=t.press||e.Texture.EMPTY,n.disable=t.disable||e.Texture.EMPTY),this.update()}setTexture(e){this.setTextures(e)}setClick(e,t){this.eventClick=e,this.obj=t}eventPress(){let e=this,t=e.custom.texture;e.texture=t.press,e.custom.isPress=!0}eventRelease(){let e=this,t=e.custom.texture;e.custom.isPress?(e.texture=t.leave,"function"==typeof e.eventClick&&e.eventClick(e,e.obj)):e.texture=t.leave,e.custom.isPress=!1}eventEnter(){let e=this,t=e.custom.texture;e.custom.isPress?e.texture=t.press:e.texture=t.enter}eventLeave(){let e=this,t=e.custom.texture;e.texture=t.leave,e.custom.isPress=!1}setDragEnable(e){let t=this,n=t.custom;n.flagDrag=!0,t.mousemove=t.touchmove=e=>{if(n.canMove){n.isPress=!1;let r={x:parseInt(e.data.global.x),y:parseInt(e.data.global.y)};t.x=r.x,t.y=r.y}},t.dragEvent=e,t.dragEvent||(t.dragEvent={},t.dragEvent.times=10),t.dragEvent.curTimes=t.dragEvent.times}setDragDisable(){let e=this;e.custom.flagDrag=!1,e.mousemove=e.touchmove=null}setEnable(e,t){e?this.enable(t):this.disable(t)}enable(e){this.interactive=!0;let t=this.custom.texture;e&&(this.texture=t.leave)}isEnabled(){return this.interactive}disable(e){this.interactive=!1;let t=this.custom.texture;e&&(this.texture=t.disable)}update(){let e=this.custom.texture;this.interactive?this.texture=e.leave:this.texture=e.disable}reload(){let e=this._game.textures,t=this.conf.resource,n=Ke(e,t.group);n&&this.setTextures(n[t.name])}}}(),function(e){let t=globalThis.PIXI,n=e.sceneManager;tt=class extends(Je(t.Container)){static get TYPE(){return"group"}constructor(e){super();let t=this;t._game=e.game,t.conf=e.conf,t.type="group",t.name=e.name,t.objName=e.objName||null,t.isInScene=e.isInScene,t.childList=[],e.pos&&(t.x=e.pos.x||0,t.y=e.pos.y||0),e.pivot&&(t.pivot.x=e.pivot.x||0,t.pivot.y=e.pivot.y||0)}clone(e){super.clone();let t=null;this.conf&&this.conf.childList&&(t=this.conf.childList);let r={game:e||this._game,childList:t,isInScene:this.isInScene,name:this.name+".clone."+this.cloneIndex,pivot:this.pivot,pos:this.position};return n.createGroup(r,this._game)}removeFromScene(){super.removeFromScene(),this.stop()}stop(){this.childList.forEach((e=>{e.stop&&e.stop()}))}reload(){this.childList.forEach((e=>{e.reload&&e.reload()}))}}}(t),function(){let e=globalThis.PIXI;nt=class extends(Je(e.Sprite)){static get TYPE(){return"image"}constructor(t){super(t.texture||e.Texture.EMPTY);let n=this;n._game=t.game,n.conf=t.conf,n.type="image",n.name=t.name,n.objName=t.objName,n.isInScene=t.isInScene,t.pos&&(n.x=t.pos.x,n.y=t.pos.y),t.anchor&&(n.anchor.x=t.anchor.x||0,n.anchor.y=t.anchor.y||0)}clone(e){super.clone();let t={game:e||this._game,conf:this.conf,isInScene:this.isInScene,name:this.name+".clone."+this.cloneIndex,pos:this.position,anchor:this.anchor,alpha:this.alpha,texture:this.texture};return new nt(t)}}}(),function(){let e=globalThis.PIXI;st=class extends(Je(e.Sprite)){static get TYPE(){return"digit"}static get NUM(){return it}constructor(t){super(t.background||e.Texture.EMPTY);let n,r=this;r._game=t.game,r.conf=t.conf,r.type="digit",r.name=t.name,r.objName=t.objName,r.isInScene=t.isInScene;let a,o,i,s,l,c,u,d={},f={};for(d.rect=f,d.event={},r.custom=d,f.pos=new e.Point(0,0),f.anchor=new e.Point(0,0),f.width=t.width||64,f.height=t.height||16,t.rect&&(t.rect.pos&&(f.x=t.rect.pos.x,f.y=t.rect.pos.y),t.rect.anchor&&(f.anchor.x=t.rect.anchor.x,f.anchor.y=t.rect.anchor.y),f.width=t.rect.width||f.width,f.height=t.rect.height||f.height),d.textureName=t.textureName||"",d.numCounts=t.numCounts||4,d.charMap=t.charMap||it.CHAR_MAP,d.shift=1,"number"==typeof t.shift&&(d.shift=t.shift),d.enable=!1,d.display=t.display||it.DISPLAY.TRANSVERSE,d.alignType=t.alignType||it.ALIGN_TYPE.RECT,d.offsetType=t.offsetType||it.OFFSET_TYPE.STATIC,d.horiType=t.horiType||it.HORI_ALIGN.LEFT,d.vertiType=t.vertiType||it.VERTI_ALIGN.TOP,d.alpha=1,d.anchor={x:0,y:0},t.anchor&&(d.anchor.x=t.anchor.x,d.anchor.y=t.anchor.y),d.lastCnt=0,d.value=0,d.currentValue=0,d.targetValue=0,d.offsetValue=0,d.background=t.background||e.Texture.EMPTY,d.autoHide=t.autoHide,d.useComma=t.useComma,d.useMoney=t.useMoney,d.useDash=t.useDash,"number"==typeof t.fixVal?d.fixVal=t.fixVal:d.fixVal=0,t.pos&&(r.x=t.pos.x,r.y=t.pos.y),t.pivot&&(r.pivot.x=t.pivot.x,r.pivot.y=t.pivot.y),d.numTe={},d.numSprite=[],u=d.charMap.length,a=0;a<u;a+=1)c=d.charMap[a],o=d.textureName+c,d.numTe[c]=e.utils.TextureCache[o]||e.Texture.EMPTY;for(i=d.numTe[d.charMap[0]],s=i.frame,d.offset=t.offset||s.width,d.symbolOffset=-1,"number"==typeof t.symbolOffset&&(d.symbolOffset=t.symbolOffset),u=d.numCounts,a=0;a<u;a+=1)n=new e.Texture(i.baseTexture,s.clone()),l=new e.Sprite(n),l.anchor.x=d.anchor.x,l.anchor.y=d.anchor.y,d.numSprite[a]=l;r._eventUpdate=r._animChange}clone(e){super.clone();let t=this.custom,n={game:e||this._game,conf:this.conf,isInScene:this.isInScene,name:this.name+".clone."+this.cloneIndex,pos:this.position,pivot:this.pivot,anchor:t.anchor,rect:t.rect,display:t.display,alignType:t.alignType,offsetType:t.offsetType,horiType:t.horiType,vertiType:t.vertiType,textureName:t.textureName,numCounts:t.numCounts,charMap:t.charMap,offset:t.offset,symbolOffset:t.symbolOffset,shift:t.shift,background:t.background,autoHide:t.autoHide,fixVal:t.fixVal,useComma:t.useComma,useDash:t.useDash,useMoney:t.useMoney};return new st(n)}removeFromScene(){super.removeFromScene(),this._game.removeUpdate(this)}transverse(){this.setDisplay(it.DISPLAY.TRANSVERSE)}straight(){this.setDisplay(it.DISPLAY.TRANSVERSE)}setDisplay(e){if(e===it.DISPLAY.TRANSVERSE)this.display=e;else{if(e!==it.DISPLAY.STRAIGHT)return;this.display=e}this.setAlign(this.horiType,this.vertiType)}setBackground(e){this.texture=e}setAnchor(e){if(!e)return;let t,n=this.custom,r=n.anchor,a=n.numSprite.length;for(r.x=e.x,r.y=e.y,t=0;t<a;t+=1)r=n.numSprite[t].anchor,r.x=e.x,r.y=e.y}setAlign(e,t){let n=this.custom;n.alignType=it.ALIGN_TYPE.RECT;let r,a,o=n.rect.pos,i={x:o.x,y:o.y},s=n.anchor,l=n.rect.width,c=n.rect.height,u=n.offset,d={w:0,h:0},f=this.children,h=f.length;if(n.lastCnt===h&&n.horiType===e&&n.vertiType===t)return;switch(n.lastCnt=h,n.horiType=e,n.vertiType=t,f.forEach((e=>{let t=e.texture.frame;"."===e.ch||","===e.ch?(d.w-=u,d.h-=u,a&&(d.w+=a.width,d.h+=a.height),d.w+=t.width,d.h+=t.height,d.w+=2*n.symbolOffset):(d.w+=u,d.h+=u),a=t})),n.horiType){case it.HORI_ALIGN.LEFT:n.display,it.DISPLAY.TRANSVERSE,i.x=o.x;break;case it.HORI_ALIGN.CENTER:n.display===it.DISPLAY.TRANSVERSE?i.x=o.x+.5*l-.5*d.w:i.x=o.x+.5*l;break;case it.HORI_ALIGN.RIGHT:n.display===it.DISPLAY.TRANSVERSE?i.x=o.x+l-d.w:i.x=o.x+l}switch(n.vertiType){case it.VERTI_ALIGN.TOP:i.y=o.y;break;case it.VERTI_ALIGN.CENTER:n.display===it.DISPLAY.TRANSVERSE?i.y=o.y+.5*c:i.y=o.y+.5*c-.5*d.h;break;case it.VERTI_ALIGN.BOTTOM:n.display===it.DISPLAY.TRANSVERSE?i.y=o.y+c:i.y=o.y+c-d.h}let m=0,p={width:0,height:0};for(r=h-1;r>=0;r-=1){let e=f[r],t=e.position,o=e.texture.frame;n.display===it.DISPLAY.TRANSVERSE?(t.x=m+i.x,t.y=i.y):(t.y=m+i.y,t.x=i.x),"."===e.ch||","===e.ch?n.display===it.DISPLAY.TRANSVERSE?(m-=u,m+=p.width,t.x=m+i.x-p.width*s.x+o.width*s.x,m+=o.width+2*n.symbolOffset,t.x+=n.symbolOffset):m+=o.height:m+=u,a=o,p=o}}setAlpha(e){this.children.forEach((t=>{t.alpha=e})),this.custom.alpha=e}set shift(e){this.custom.shift=e}get shift(){return this.custom.shift}set fixVal(e){this.custom.fixVal=e}get fixVal(){return this.custom.fixVal}getValue(){return this.custom.value}setValue(e,t){let n=this,r=n.custom,a=r.event;if(r.currentValue=r.value,r.value=e||0,r.targetValue=e||0,r.currentValue<r.targetValue?r.offsetValue=r.shift:r.currentValue>r.targetValue&&(r.offsetValue=-r.shift),a.begin&&a.begin(n),t)return void n.enable();r.currentValue=r.value;let o,i,s=n,l=n.fixValueString(r.currentValue),c=l.length,u=r.alpha,d=r.numSprite.length-1,f=r.numTe[0].frame;for(;d>=0;){c-=1;let e=r.numSprite[d];c>=0?(i=l[c],o=r.numTe[i],e.ch=i,e.alpha=u,o&&e.texture.width>1&&e.texture.height>1&&(e.texture.frame=o.frame.clone()),s.addChild(e)):(e.ch="0",r.autoHide?s.removeChild(e):(e.texture.width>1&&e.texture.height>1&&(e.texture.frame=f.clone()),e.alpha=u,s.addChild(e))),d-=1}n.setAlign(r.horiType,r.vertiType)}setEvent(e){let t=this.custom.event;t.begin=e.begin||t.begin,t.end=e.end||t.end,t.changeString=e.changeString||t.changeString}_animChange(e){let t=this,n=t.custom,r=n.event,a=n.offsetValue*e*1e3;a<0?n.currentValue<=n.targetValue?(n.currentValue=n.targetValue,t.disable(),r.end&&r.end(t)):n.currentValue=n.currentValue+a:n.currentValue>=n.targetValue?(n.currentValue=n.targetValue,t.disable(),r.end&&r.end(t)):n.currentValue=n.currentValue+a;let o,i,s=t,l=t.fixValueString(n.currentValue),c=n.alpha,u=l.length,d=n.numSprite.length-1,f=n.numTe[0].frame;for(;d>=0;){u-=1;let e=n.numSprite[d];u>=0?(o=l[u],i=n.numTe[o],e.ch=o,e.alpha=c,i&&e.texture.width>1&&e.texture.height>1&&(e.texture.frame=i.frame.clone()),s.addChild(e)):(e.ch="0",n.autoHide?s.removeChild(e):(e.texture.width>1&&e.texture.height>1&&(e.texture.frame=f.clone()),e.alpha=c,s.addChild(e))),d-=1}t.setAlign(n.horiType,n.vertiType)}fixValueString(e){let t=this.custom,n=t.event,r=e.toString(),a=r.lastIndexOf(".");a<0&&t.fixVal>0?(r+=".",a=r.length):a>=0&&0===t.fixVal&&(a=r.lastIndexOf("."),r=r.substr(0,a),a=r.length);for(let e=a+1;e<=a+t.fixVal;e+=1)e>=r.length&&(r=r.concat("0"));let o=r;t.fixVal>0&&r.length>a+t.fixVal&&(o=r.substr(0,a+t.fixVal+1));let i,s,l,c,u=null,d=o.length,f=Math.floor(e);return t.fixVal>0&&(c=o.substr(d-(t.fixVal+1),t.fixVal+1),o=f.toString(),d=o.length),t.useComma?d>6?(i=o.substr(0,d-6),s=o.substr(d-6,3),l=o.substr(d-3,3),u=i+","+s+","+l):d>3?(i=o.substr(0,d-3),s=o.substr(d-3,3),u=i+","+s):u=o:u=o,t.useMoney&&(u="$"+u),t.useDash&&0===t.fixVal&&(u+="_"),t.fixVal>0&&(u+=c),n.changeString&&(u=n.changeString(u)),u}setTexture(e){this.setTextures(e)}setTextures(t){let n=this,r=n.custom;if(r.textureName!==t){let n,a,o,i,s;for(r.textureName=t,n=0,s=r.charMap.length;n<s;n++)i=r.charMap[n],a=r.textureName+i,r.numTe[i]=e.utils.TextureCache[a]||e.Texture.EMPTY;for(o=r.numTe[r.charMap[0]],n=0,s=r.numCounts;n<s;n++){let t=r.numSprite[n];t.texture=new e.Texture(o.baseTexture,o.frame.clone()),t.anchor.x=r.anchor.x,t.anchor.y=r.anchor.y}}r.lastCnt=0,n.setValue(n.custom.currentValue,!1)}enable(){let e=this,t=e.custom;t.enable||(t.enable=!0,e._game.addUpdate(e))}disable(){let e=this,t=e.custom;t.enable&&(t.enable=!1,e._game.removeUpdate(e))}stop(){this.disable()}update(e){this._eventUpdate&&this._eventUpdate(e)}reload(){let t=this,n=t._game.textures,r=t.conf.resource;if(t.custom.textureName="",this.setTextures(r.texture),r.group){let a=Ke(n,r.group);a&&(t.texture=a[r.background]||e.Texture.EMPTY)}}}}(),function(){let e=globalThis.PIXI;lt=class extends(Je(e.Sprite)){static get TYPE(){return"scrollbar"}constructor(t){super(t.background||e.Texture.EMPTY);let n=this;n._game=t.game,n.conf=t.conf,n.type="scrollbar",n.name=t.name,n.objName=t.objName,n.isInScene=t.isInScene,n.value={current:1,offset:1,min:1,max:10,range:9},n.value.range=n.value.max-n.value.min,n.eventScroll=null,n.slider=new e.Sprite(t.slider),n.slider.anchor.x=.5,n.addChild(n.slider),t.pos&&(n.x=t.pos.x||0,n.y=t.pos.y||0),t.anchor&&(n.anchor.x=t.anchor.x||0,n.anchor.y=t.anchor.y||0),n.limit={offset:0,min:.5*n.conf.slider.width,max:n.conf.width-.5*n.conf.slider.width},n.limit.length=n.limit.max-n.limit.min,n.slider.x=n.limit.min,n.slider.value=0,n.limit.offset=n.limit.length/n.value.range,n.hasMove=!1,n.buttonMode=!0,n.interactive=!0,n.obj=null,n.touchstart=n.mousedown=e=>{let t=parseInt(e.data.global.x);parseInt(e.data.global.y),n.hasMove=!0,n.slider.x=t-n.x,n.slider.x<n.limit.min?n.slider.x=n.limit.min:n.slider.x>=n.limit.max&&(n.slider.x=n.limit.max),n.slider.value=n.slider.x-n.limit.min,n.value.current=n.value.min+n.value.offset*parseInt(n.slider.value/n.limit.offset),n.eventScroll&&n.eventScroll(n.value.current,n)},n.touchend=n.mouseup=e=>{parseInt(e.data.global.x),parseInt(e.data.global.y),n.hasMove=!1},n.slider.buttonMode=!0,n.slider.interactive=!0,n.slider.mousedown=n.slider.touchstart=()=>{n.hasMove=!0},n.slider.mouseup=n.slider.mouseupoutside=n.slider.touchend=n.slider.touchendoutside=()=>{n.hasMove=!1},n.slider.mousemove=n.slider.touchmove=e=>{if(0===e.which&&(n.hasMove=!1),n.hasMove){let t={x:parseInt(e.data.global.x),y:parseInt(e.data.global.y)};n.slider.x=t.x-n.x,n.slider.x<n.limit.min?n.slider.x=n.limit.min:n.slider.x>=n.limit.max&&(n.slider.x=n.limit.max),n.slider.value=n.slider.x-n.limit.min,n.value.current=n.value.min+n.value.offset*parseInt(n.slider.value/n.limit.offset),n.eventScroll&&n.eventScroll(n.value.current,n)}}}clone(){return null}setBindScrollEvent(e){this.eventScroll=e}reset(){this.hasMove=!1}setRange(e){"number"==typeof e.current&&(this.value.current=e.current),"number"==typeof e.offset&&(this.value.offset=e.offset),"number"==typeof e.min&&(this.value.min=e.min),"number"==typeof e.max&&(this.value.max=e.max),"number"==typeof e.range&&(this.value.range=e.range),this.value.current<this.value.min?this.value.current=this.value.min:this.value.current>this.value.max&&(this.value.current=this.value.max),this.value.offset=(this.value.max-this.value.min)/this.value.range,this.limit.offset=this.limit.length/this.value.range,this.slider.value=this.limit.offset*(this.value.current-this.value.min),this.slider.x=this.limit.min+this.slider.value,this.eventScroll&&this.eventScroll(this.value.current,this)}setValue(e){e>=this.value.min&&e<=this.value.max&&(this.value.current=e,this.slider.value=this.limit.offset*((this.value.current-this.value.min)/this.value.range),this.slider.x=this.limit.min+this.slider.value,this.eventScroll&&this.eventScroll(this.value.current,this))}getValue(){return this.value.current}}}(),function(){let e=globalThis.PIXI;rt=class extends(Je(e.Container)){static get TYPE(){return"spine"}static getChild(e,t){let n=null,r=e.spineData.slots,a=-1;return r.some(((e,n)=>e.name===t&&(a=n,!0))),a>=0&&(n=e.children[a],n&&n.children[0]&&(n=n.children[0])),n}static getRect(t,n){let r=t.getBounds();if(n){let n=new e.Graphics;t.addChild(n),n.x=0,n.y=0,n.lineStyle(1,255,.75),n.beginFill(65291,.15),n.drawRect(.5*-r.width,.5*-r.height,r.width,r.height),n.endFill(),n.lineStyle(1,0),n.moveTo(0,0),n.lineTo(r.width,r.height),n.moveTo(r.width,0),n.lineTo(0,r.height)}return r}constructor(t){super();let n=this,r=t.spineDataGroup,a=t.textureGroup;n._game=t.game,n.conf=t.conf,n.type="spine",n.name=t.name,n.objName=t.objName||null,n.isInScene=t.isInScene;let o={};n.custom=o,o.childList=[],o.spineAnimList=[],o.group={},o.spineDataGroup=r,o.textureGroup=a,o.configList=t.configList||t.conf&&t.conf.configList,t.pos&&(n.x=t.pos.x||0,n.y=t.pos.y||0),e.spine&&(o.configList.forEach(((t,n)=>{let a,i,s,l;if(i=new e.Sprite(e.Texture.EMPTY),a=new e.spine.Spine(r[t.dataName]),s={x:0,y:0},l=a.getLocalBounds(),a.skeleton.setToSetupPose(),a.autoUpdate=!1,a.state.timeScale=0,a.x=.01,a.y=.01,a.childMap={},a.getChild=e=>a.childMap[e],a.spineData.slots.forEach(((e,t)=>{let n=a.children[t];n&&n.children&&(n=n.children[0],a.childMap[e.name]=n)})),i.name=t.name,i.addChild(a),o.childList[n]=i,t.anchor&&(a.x=-a.width*t.anchor.x+.01,a.y=-a.height*t.anchor.y+.01),s.x=l.x,s.y=l.y,t.fixPosition){let e=t.fixPosition,n=e.offset||{x:0,y:0},r=null;e.childName&&(r=a.getChild(e.childName)),r||(r=a.children[e.childIndex||0].children[0]),l=r.getBounds(),a.x=-l.x+.5*-l.width,a.y=-l.y+.5*-l.height,s.x=a.x+l.x,s.y=a.y+l.y,a.x=a.x+n.x,a.y=a.y+n.y}if(t.debug){let t=new e.Graphics;i.addChild(t),t.x=0,t.y=0,t.lineStyle(1,16711680,.9),t.beginFill(16740363,.1),t.drawRect(a.x+l.x,a.y+l.y,l.width,l.height),t.endFill(),t.lineStyle(0),t.beginFill(0,1),t.drawCircle(s.x,s.y,3),t.endFill(),t.beginFill(16777215,1),t.drawCircle(s.x,s.y,1),t.endFill(),a.children.forEach((t=>{let n=t.children[0];if(n&&n.getBounds||(n=t),n&&n.getBounds){let t=n.getBounds(),r=new e.Graphics;n.addChild(r),r.x=0,r.y=0,r.lineStyle(1,65280,.75),r.beginFill(786288,.15),r.drawRect(.5*-t.width,.5*-t.height,t.width,t.height),r.endFill(),r.lineStyle(0),r.beginFill(0,1),r.drawCircle(0,0,3),r.endFill(),r.beginFill(16777215,1),r.drawCircle(0,0,1),r.endFill()}}))}t.name&&(o.group[t.name]={sprite:i,spine:a,entry:null,animConfig:{animationName:t.animationName,timeScale:t.timeScale,loop:t.loop}}),o.spineAnimList.push(a)})),o.configList.forEach((t=>{let n=o.group[t.name].spine;if(n&&t.mask){let r=e.Texture.EMPTY;a&&(r=a[t.mask.name]||e.Texture.EMPTY);let i=new e.Sprite(r),s=n;if(n.mask=i,t.mask.follow&&(s=o.group[t.mask.follow]),s){let e=s.getLocalBounds();t.mask.local?(i.x=e.x,i.y=e.y):(i.x=0,i.y=0),s.addChild(i)}let l=t.mask.fixPosition;if(l&&s){let e,t=l.offset||{x:0,y:0};l.childName&&(e=s.getChild(l.childName)),e||(e=s.children[l.childIndex||0].children[0]);let n=e.getBounds(),r=s.getBounds(),a=s.getLocalBounds();i.x=a.x+(n.x-r.x)+t.y,i.y=a.y+(n.y-r.y)+t.y}if(t.mask.debug){let t=new e.Graphics,n={x:0,y:0};s&&(n.x=s.x,n.y=s.y,s.parent.addChild(t)),t.x=n.x+i.x,t.y=n.y+i.y,t.lineStyle(1,255,.75),t.beginFill(16740363,.15),t.drawRect(0,0,i.width,i.height),t.endFill(),t.lineStyle(1,0),t.moveTo(0,0),t.lineTo(i.width,i.height),t.moveTo(i.width,0),t.lineTo(0,i.height)}}n&&t.maskList&&t.maskList.forEach((t=>{let r,o,i=e.Texture.EMPTY;a&&(i=a[t.name]||e.Texture.EMPTY);let s=new e.Sprite(i),l=null;t.followName&&(l=n.getChild(t.followName)),l||(l=n.children[t.follow]&&n.children[t.follow].children[0]),r=l,l=null,t.targetName&&(l=n.getChild(t.targetName)),l||(l=n.children[t.target]&&n.children[t.target].children[0]),o=l,o&&(o.mask=s),r&&(s.x=-r.width/2,s.y=-r.height/2,r.addChild(s))}))})))}clone(e){super.clone();let t=this.custom,n={game:e||this._game,conf:this.conf,isInScene:this.isInScene,name:this.name+".clone."+this.cloneIndex,textureGroup:t.textureGroup,spineDataGroup:t.spineDataGroup,configList:t.configList,pos:this.position};return new rt(n)}removeFromScene(){this.parent&&this.parent.removeChild(this),this._game.removeUpdate(this)}getGroup(e){return this.custom.group[e]}getSpine(e){let t,n=this.custom.group[e];return n&&(t=n.spine),t}getEntry(e){let t,n=this.custom.group[e];return n&&(t=n.entry),t}getAnimConfig(e){let t,n=this.custom.group[e];return n&&(t=n.animConfig),t}play(e){let t=this,n=t.custom,r=[];e&&Array.isArray(e)?(n.childList.forEach((e=>{t.removeChild(e)})),e.forEach((e=>{let a=n.group[e.name];if(a){let n=a.spine,o=a.sprite,i=a.animConfig;n&&(a.entry=n.state.setAnimation(0,e.animationName||i.animationName,e.loop),n.update(0),n.state.timeScale=e.timeScale||i.timeScale,r.push(n)),t.addChild(o)}}))):Object.getOwnPropertyNames(n.group).forEach((e=>{let a=n.group[e];if(a){let e=a.spine,n=a.sprite,o=a.animConfig;e&&(a.entry=e.state.setAnimation(0,o.animationName,o.loop),e.update(0),e.state.timeScale=o.timeScale,r.push(e)),t.addChild(n)}})),n.spineAnimList=r,t._game.addUpdate(t)}pause(){let e=this.custom;Object.getOwnPropertyNames(e.group).forEach((t=>{let n=e.group[t].spine;n&&(n.state.timeScale=0)}))}resume(){let e=this.custom;Object.getOwnPropertyNames(e.group).forEach((t=>{let n=e.group[t],r=n.spine,a=n.animConfig;r&&(r.state.timeScale=a.timeScale)}))}stop(e){let t=this,n=t.custom;e&&Array.isArray(e)?e.forEach((e=>{let t=n.group[e.name],r=t.spine,a=t.animConfig;a.animationName=e.animationName||a.animationName,r&&(r.state.timeScale=0)})):(Object.getOwnPropertyNames(n.group).forEach((e=>{let t=n.group[e].spine;t&&(t.state.timeScale=0)})),t._game.removeUpdate(t))}update(e){this.custom.spineAnimList.forEach((t=>{t.update(e)}))}reload(){}}}(),function(){let e=globalThis.PIXI;ot=class extends(Je(e.Sprite)){static get TYPE(){return"bone"}static setFactory(e){at=e}static getFactory(){return at}constructor(t){super(e.Texture.EMPTY);let n=this;n._game=t.game,n.conf=t.conf,n.type="bone",n.name=t.name,n.objName=t.objName||null,n.resource={},n.animation={timeScale:1},n.isInScene=t.isInScene,n.isUpdate=!1,t.animation&&(n.animation.name=t.animation.name,n.animation.timeScale=t.animation.timeScale),t.resource&&(n.resource.name=t.resource.name),t.pos&&(n.x=t.pos.x||0,n.y=t.pos.y||0),t.anchor&&(n.anchor.x=t.anchor.x||.5,n.anchor.y=t.anchor.y||.5);let r=at&&at.buildArmature(n.resource.name);if(r){let e=r.display;e.scale.set(1,1),n.addChild(e)}n.armature=r,n.state=null}clone(e){super.clone();let t=this.cloneIndex,n={game:e||this._game,conf:this.conf,isInScene:this.isInScene,resource:this.resource,animation:this.animation,name:this.name+".clone."+t,pos:this.sprite.position};return new ot(n)}removeFromScene(){let e=this;e.parent&&e.parent.removeChild(e),e.stop()}play(e){let t=this.armature,n=this.animation;t&&(n.name=e||n.name,this.state=t.animation.play(n.name),this.state&&(this.state.timeScale=n.timeScale),this.isUpdate||(this.isUpdate=!0,this._game.addUpdate(this)))}stop(){this.armature&&this.isUpdate&&(this.isUpdate=!1,this._game.removeUpdate(this))}set timeScale(e){this.animation.timeScale=e,this.state&&(this.state.timeScale=e)}get timeScale(){return this.animation.timeScale}update(e){let t=this.armature;t&&t.advanceTime(e)}reload(){}}}(),function(){let e=globalThis.PIXI;ct=class extends(Je(e.Text)){static get TYPE(){return"text"}constructor(e){super(e.text||"test used");let t=this;t._game=e.game,t.conf=e.conf,t.type="text",t.name=e.name,t.objName=e.objName,t.isInScene=e.isInScene;let n={fill:"#FFFFFF",stroke:"#000000",strokeThickness:0};e.style&&(n.fill=e.style.fill||"#FFFFFF",n.stroke=e.style.stroke||"#000000",n.strokeThickness=e.style.strokeThickness||0),t.style=n,e.pos&&(t.x=e.pos.x,t.y=e.pos.y),e.anchor&&(t.anchor.x=e.anchor.x||0,t.anchor.y=e.anchor.y||0)}clone(e){super.clone();let t={game:e||this._game,conf:this.conf,isInScene:this.isInScene,name:this.name+".clone."+this.cloneIndex,pos:this.position,anchor:this.anchor,style:this.style,text:this.text};return new ct(t)}reload(){}}}(),function(){let e=globalThis.PIXI,t=null;e.ParticleContainer?t=e.ParticleContainer:e.particles&&e.particles.ParticleContainer&&(t=e.particles.ParticleContainer),t&&(dt=class extends(Je(t)){static get TYPE(){return"particle"}static setConfigMap(e){ut=e||ut}static getConfig(e){return ut[e]}constructor(t){super();let n,r=this,a={};r.custom=a,r._game=t.game,r.conf=t.conf,r.type="particle",r.name=t.name,r.objName=t.objName,r.isInScene=t.isInScene;let o=t.setting;a.type=o.type,a.config=o.config,a.art=o.art,a.ownerPos=new e.Point(0,0),r.setProperties({scale:!0,position:!0,rotation:!0,uvs:!0,alpha:!0}),e.particles&&e.particles.Emitter&&(n=new e.particles.Emitter(r,a.art,a.config)),n&&("path"===a.type?n.particleConstructor=e.particles.PathParticle:"anim"===a.type&&(n.particleConstructor=e.particles.AnimatedParticle)),t.pos&&(r.x=t.pos.x,r.y=t.pos.y),r.emitter=n}clone(e){super.clone();let t=this.cloneIndex,n=this.custom,r={game:e||this._game,conf:this.conf,isInScene:this.isInScene,name:this.name+".clone."+t,pos:this.position,setting:{type:n.type,config:n.config,art:n.art}};return new dt(r)}removeFromScene(){super.removeFromScene(),this._game.removeUpdate(this)}play(e,t=0){let n=this,r=n.emitter,a=e||n.custom.ownerPos;r&&(r.emit=!0,r.resetPositionTracking(),r.updateOwnerPos(a.x,a.y),r.update(t),n._game.addUpdate(n))}stop(){this._game.removeUpdate(this)}update(e){this.emitter.update(e)}reload(){}})}(),yn.Animation=Ze,yn.Button=et,yn.Group=tt,yn.Image=nt,yn.Number=st,yn.Scrollbar=lt,yn.Spine=rt,yn.Bone=ot,yn.Text=ct,yn.Particle=dt,Ot(t)),pn(t),ze(),Xe(),Ee(t),xn=!0,e("!! init finish !!")}(null)}))},scene:vn,ui:yn,updateManager:Ye});let En={name:"",currentURL:""},In={logList:[]},Tn={client:{eventList:[],errorList:[]}},Sn=!0;async function _n(){if(Tn.client.id)return;const e=(await import("./agent.bc427a91.js").then((function(e){return e.f}))).default;let t=(await e.getPromise({excludes:{webglVendorAndRenderer:!0,language:!0,canvas:!0,hasLiedOs:!0,hasLiedBrowser:!0,availableScreenResolution:!0,webdriver:!0,deviceMemory:!0,hardwareConcurrency:!0,timezoneOffset:!0,timezone:!0,sessionStorage:!0,localStorage:!0,indexedDb:!0,addBehavior:!0,openDatabase:!0,cpuClass:!0,platform:!0,doNotTrack:!0,plugins:!0,adBlock:!0,hasLiedLanguages:!0,hasLiedResolution:!0,fonts:!0,fontsFlash:!0,audio:!0,enumerateDevices:!0}})).map((e=>e.value)),n=e.x64hash128(t.join(""),31),r=Tn.client;r.id=n,r.group=s.group,r.game=s.game}async function Nn(){try{if(!Tn.ip){let e=await xe.request({method:"GET",url:"//pro.ip-api.com/json?key=5SgCadGS9fH36ub",responseType:"json",params:{v:Date.now()}});Tn.ip=e}}catch(e){}return Tn.ip}let Pn=1;var Rn={getIP:Nn,statistic:Tn,send:async function(){if(o)return;let e=s,t=[],n=[];if(Sn){let{getGameCard:r}=await import("./agent.e9dbd906.js").then((function(e){return e.n}));Array.isArray(globalThis.CDN_LIST)&&globalThis.CDN_LIST.forEach((t=>{let a={};a.id=t.id,a.url=t.url,a.target=t.target,a.timestamp=Math.round(performance.now()),a.timeOnload=0,a.timeInit=0,a.timeScene=0,a.timeReady=9999,a.gamecard=null,a.icon="",a.useTest=!0;let o=new Promise((t=>{a.timeout=Ye.setTimeout((()=>{a.timeout=null,t(a)}),5),r(e,a,!0).then((()=>{a.timeout&&(Ye.remove(a.timeout),a.timeout=null),t(a)}))}));n.push(o)}));let a=await Promise.all(n);await Nn(),a.forEach((e=>{let n={id:e.id,target:e.target,responseTimeList:[e.timeReady]};t.push(n)})),Tn.cdnList=t}Tn.url=globalThis.BASE_URL||"",Tn.timestamp=Date.now(),Tn.recordIndex="<client-detection-web_{now/d}>",Tn.recordType="_doc",Tn.deviceType="web",await _n(),Tn.client.eventList.forEach((e=>{e.label=En.name})),await xe.request({method:"POST",url:"//gti-itapi.gamesoft-tech.com/v1/record/Record",body:Tn}),Tn.cdnList=[],Tn.client.eventList=[],Tn.client.errorList=[],Tn.ip=null,Sn=!1},sendVideo:async function(){if(o)return;In.timestamp=Date.now(),In.recordIndex="<client-detection-web_{now/d}>",In.recordType="_doc",In.deviceType="web",await _n(),In.id=Tn.client.id,In.group=s.group,In.game=s.game,await xe.request({method:"POST",url:"//gti-itapi.gamesoft-tech.com/v1/record/StreamingInfo",body:In}),In.logList=[]},error:function(e){e&&globalThis.gtag&&gtag("event",e.eventName||"錯誤",{event_category:e.category,event_label:e.label,value:e.value||-1,non_interaction:!0})},report:En,serviceBegin:function(e){e.time=Math.round(performance.now())},serviceEnd:function(e,t){t||(e.time=Math.round(performance.now())-e.time),globalThis.gtag&&gtag("event","timing_complete",{name:e.name||"後台服務",value:e.time,event_category:e.category,event_label:e.getLabel()});let n={name:e.name||"後台服務",label:e.getLabel(),category:e.category,value:e.time};Tn.client.eventList.push(n)},loadBegin:function(e){e.time=Math.round(performance.now())},loadEnd:function(e){e.time=Math.round(performance.now())-e.time,globalThis.gtag&&gtag("event","timing_complete",{name:e.name||"加載服務",value:e.time,event_category:e.category,event_label:e.getLabel()});let t={name:e.name||"加載服務",label:e.getLabel(),category:e.category,value:e.time};Tn.client.eventList.push(t)},log0:function(e,t=!1){e&&t&&In.logList.push(e)},log:function(e,t=!1){e&&(globalThis.gtag&&gtag("event",e.eventName||"歷程",{event_category:e.category,event_label:`${e.label}`,value:e.value||-1,non_interaction:!0}),Pn+=1,t&&In.logList.push(e))}},Cn={exports:{}},Ln=Cn.exports=function e(t,n,r){function a(i,s){if(!n[i]){if(!t[i]){if(!s&&E)return E(i);if(o)return o(i,!0);var l=new Error("Cannot find module '"+i+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[i]={exports:{}};t[i][0].call(c.exports,(function(e){var n=t[i][1][e];return a(n||e)}),c,c.exports,e,t,n,r)}return n[i].exports}for(var o=E,i=0;i<r.length;i++)a(r[i]);return a}({1:[function(e,t,n){(function(e){var n,r,a=e.MutationObserver||e.WebKitMutationObserver;if(a){var o=0,i=new a(u),s=e.document.createTextNode("");i.observe(s,{characterData:!0}),n=function(){s.data=o=++o%2}}else if(e.setImmediate||void 0===e.MessageChannel)n="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){u(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(u,0)};else{var l=new e.MessageChannel;l.port1.onmessage=u,n=function(){l.port2.postMessage(0)}}var c=[];function u(){var e,t;r=!0;for(var n=c.length;n;){for(t=c,c=[],e=-1;++e<n;)t[e]();n=c.length}r=!1}function d(e){1!==c.push(e)||r||n()}t.exports=d}).call(this,void 0!==w?w:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,n){var r=e(1);function a(){}var o={},i=["REJECTED"],s=["FULFILLED"],l=["PENDING"];function c(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=l,this.queue=[],this.outcome=void 0,e!==a&&h(this,e)}function u(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function d(e,t,n){r((function(){var r;try{r=t(n)}catch(t){return o.reject(e,t)}r===e?o.reject(e,new TypeError("Cannot resolve promise with itself")):o.resolve(e,r)}))}function f(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function h(e,t){var n=!1;function r(t){n||(n=!0,o.reject(e,t))}function a(t){n||(n=!0,o.resolve(e,t))}function i(){t(a,r)}var s=m(i);"error"===s.status&&r(s.value)}function m(e,t){var n={};try{n.value=e(t),n.status="success"}catch(e){n.status="error",n.value=e}return n}function p(e){return e instanceof this?e:o.resolve(new this(a),e)}function g(e){var t=new this(a);return o.reject(t,e)}function v(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return this.resolve([]);for(var i=new Array(n),s=0,l=-1,c=new this(a);++l<n;)u(e[l],l);return c;function u(e,a){function l(e){i[a]=e,++s!==n||r||(r=!0,o.resolve(c,i))}t.resolve(e).then(l,(function(e){r||(r=!0,o.reject(c,e))}))}}function y(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return this.resolve([]);for(var i=-1,s=new this(a);++i<n;)l(e[i]);return s;function l(e){t.resolve(e).then((function(e){r||(r=!0,o.resolve(s,e))}),(function(e){r||(r=!0,o.reject(s,e))}))}}t.exports=c,c.prototype.catch=function(e){return this.then(null,e)},c.prototype.then=function(e,t){if("function"!=typeof e&&this.state===s||"function"!=typeof t&&this.state===i)return this;var n=new this.constructor(a);return this.state!==l?d(n,this.state===s?e:t,this.outcome):this.queue.push(new u(n,e,t)),n},u.prototype.callFulfilled=function(e){o.resolve(this.promise,e)},u.prototype.otherCallFulfilled=function(e){d(this.promise,this.onFulfilled,e)},u.prototype.callRejected=function(e){o.reject(this.promise,e)},u.prototype.otherCallRejected=function(e){d(this.promise,this.onRejected,e)},o.resolve=function(e,t){var n=m(f,t);if("error"===n.status)return o.reject(e,n.value);var r=n.value;if(r)h(e,r);else{e.state=s,e.outcome=t;for(var a=-1,i=e.queue.length;++a<i;)e.queue[a].callFulfilled(t)}return e},o.reject=function(e,t){e.state=i,e.outcome=t;for(var n=-1,r=e.queue.length;++n<r;)e.queue[n].callRejected(t);return e},c.resolve=p,c.reject=g,c.all=v,c.race=y},{1:1}],3:[function(e,t,n){(function(t){"function"!=typeof t.Promise&&(t.Promise=e(2))}).call(this,void 0!==w?w:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(e,t,n){var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(e){return}}var i=o();function s(){try{if(!i||!i.open)return!1;var e="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),t="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!e||t)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(e){return!1}}function l(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(a){if("TypeError"!==a.name)throw a;for(var n=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),r=0;r<e.length;r+=1)n.append(e[r]);return n.getBlob(t.type)}}"undefined"==typeof Promise&&e(3);var c=Promise;function u(e,t){t&&e.then((function(e){t(null,e)}),(function(e){t(e)}))}function d(e,t,n){"function"==typeof t&&e.then(t),"function"==typeof n&&e.catch(n)}function f(e){return"string"!=typeof e&&(e=String(e)),e}function h(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var m="local-forage-detect-blob-support",p=void 0,g={},v=Object.prototype.toString,y="readonly",b="readwrite";function x(e){for(var t=e.length,n=new ArrayBuffer(t),r=new Uint8Array(n),a=0;a<t;a++)r[a]=e.charCodeAt(a);return n}function w(e){return new c((function(t){var n=e.transaction(m,b),r=l([""]);n.objectStore(m).put(r,"key"),n.onabort=function(e){e.preventDefault(),e.stopPropagation(),t(!1)},n.oncomplete=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/),n=navigator.userAgent.match(/Edge\//);t(n||!e||parseInt(e[1],10)>=43)}})).catch((function(){return!1}))}function E(e){return"boolean"==typeof p?c.resolve(p):w(e).then((function(e){return p=e}))}function I(e){var t=g[e.name],n={};n.promise=new c((function(e,t){n.resolve=e,n.reject=t})),t.deferredOperations.push(n),t.dbReady?t.dbReady=t.dbReady.then((function(){return n.promise})):t.dbReady=n.promise}function T(e){var t=g[e.name].deferredOperations.pop();if(t)return t.resolve(),t.promise}function S(e,t){var n=g[e.name].deferredOperations.pop();if(n)return n.reject(t),n.promise}function _(e,t){return new c((function(n,r){if(g[e.name]=g[e.name]||M(),e.db){if(!t)return n(e.db);I(e),e.db.close()}var a=[e.name];t&&a.push(e.version);var o=i.open.apply(i,a);t&&(o.onupgradeneeded=function(t){var n=o.result;try{n.createObjectStore(e.storeName),t.oldVersion<=1&&n.createObjectStore(m)}catch(e){if("ConstraintError"!==e.name)throw e}}),o.onerror=function(e){e.preventDefault(),r(o.error)},o.onsuccess=function(){n(o.result),T(e)}}))}function N(e){return _(e,!1)}function P(e){return _(e,!0)}function R(e,t){if(!e.db)return!0;var n=!e.db.objectStoreNames.contains(e.storeName),r=e.version<e.db.version,a=e.version>e.db.version;if(r&&(e.version,e.version=e.db.version),a||n){if(n){var o=e.db.version+1;o>e.version&&(e.version=o)}return!0}return!1}function C(e){return new c((function(t,n){var r=new FileReader;r.onerror=n,r.onloadend=function(n){var r=btoa(n.target.result||"");t({__local_forage_encoded_blob:!0,data:r,type:e.type})},r.readAsBinaryString(e)}))}function L(e){return l([x(atob(e.data))],{type:e.type})}function j(e){return e&&e.__local_forage_encoded_blob}function O(e){var t=this,n=t._initReady().then((function(){var e=g[t._dbInfo.name];if(e&&e.dbReady)return e.dbReady}));return d(n,e,e),n}function A(e){I(e);for(var t=g[e.name],n=t.forages,r=0;r<n.length;r++){var a=n[r];a._dbInfo.db&&(a._dbInfo.db.close(),a._dbInfo.db=null)}return e.db=null,N(e).then((function(t){return e.db=t,R(e)?P(e):t})).then((function(r){e.db=t.db=r;for(var a=0;a<n.length;a++)n[a]._dbInfo.db=r})).catch((function(t){throw S(e,t),t}))}function k(e,t,n,r){void 0===r&&(r=1);try{var a=e.db.transaction(e.storeName,t);n(null,a)}catch(a){if(r>0&&(!e.db||"InvalidStateError"===a.name||"NotFoundError"===a.name))return c.resolve().then((function(){if(!e.db||"NotFoundError"===a.name&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),P(e)})).then((function(){return A(e).then((function(){k(e,t,n,r-1)}))})).catch(n);n(a)}}function M(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function D(e){var t=this,n={db:null};if(e)for(var r in e)n[r]=e[r];var a=g[n.name];a||(a=M(),g[n.name]=a),a.forages.push(t),t._initReady||(t._initReady=t.ready,t.ready=O);var o=[];function i(){return c.resolve()}for(var s=0;s<a.forages.length;s++){var l=a.forages[s];l!==t&&o.push(l._initReady().catch(i))}var u=a.forages.slice(0);return c.all(o).then((function(){return n.db=a.db,N(n)})).then((function(e){return n.db=e,R(n,t._defaultConfig.version)?P(n):e})).then((function(e){n.db=a.db=e,t._dbInfo=n;for(var r=0;r<u.length;r++){var o=u[r];o!==t&&(o._dbInfo.db=n.db,o._dbInfo.version=n.version)}}))}function B(e,t){var n=this;e=f(e);var r=new c((function(t,r){n.ready().then((function(){k(n._dbInfo,y,(function(a,o){if(a)return r(a);try{var i=o.objectStore(n._dbInfo.storeName).get(e);i.onsuccess=function(){var e=i.result;void 0===e&&(e=null),j(e)&&(e=L(e)),t(e)},i.onerror=function(){r(i.error)}}catch(e){r(e)}}))})).catch(r)}));return u(r,t),r}function F(e,t){var n=this,r=new c((function(t,r){n.ready().then((function(){k(n._dbInfo,y,(function(a,o){if(a)return r(a);try{var i=o.objectStore(n._dbInfo.storeName).openCursor(),s=1;i.onsuccess=function(){var n=i.result;if(n){var r=n.value;j(r)&&(r=L(r));var a=e(r,n.key,s++);void 0!==a?t(a):n.continue()}else t()},i.onerror=function(){r(i.error)}}catch(e){r(e)}}))})).catch(r)}));return u(r,t),r}function U(e,t,n){var r=this;e=f(e);var a=new c((function(n,a){var o;r.ready().then((function(){return o=r._dbInfo,"[object Blob]"===v.call(t)?E(o.db).then((function(e){return e?t:C(t)})):t})).then((function(t){k(r._dbInfo,b,(function(o,i){if(o)return a(o);try{var s=i.objectStore(r._dbInfo.storeName);null===t&&(t=void 0);var l=s.put(t,e);i.oncomplete=function(){void 0===t&&(t=null),n(t)},i.onabort=i.onerror=function(){var e=l.error?l.error:l.transaction.error;a(e)}}catch(e){a(e)}}))})).catch(a)}));return u(a,n),a}function G(e,t){var n=this;e=f(e);var r=new c((function(t,r){n.ready().then((function(){k(n._dbInfo,b,(function(a,o){if(a)return r(a);try{var i=o.objectStore(n._dbInfo.storeName).delete(e);o.oncomplete=function(){t()},o.onerror=function(){r(i.error)},o.onabort=function(){var e=i.error?i.error:i.transaction.error;r(e)}}catch(e){r(e)}}))})).catch(r)}));return u(r,t),r}function V(e){var t=this,n=new c((function(e,n){t.ready().then((function(){k(t._dbInfo,b,(function(r,a){if(r)return n(r);try{var o=a.objectStore(t._dbInfo.storeName).clear();a.oncomplete=function(){e()},a.onabort=a.onerror=function(){var e=o.error?o.error:o.transaction.error;n(e)}}catch(e){n(e)}}))})).catch(n)}));return u(n,e),n}function z(e){var t=this,n=new c((function(e,n){t.ready().then((function(){k(t._dbInfo,y,(function(r,a){if(r)return n(r);try{var o=a.objectStore(t._dbInfo.storeName).count();o.onsuccess=function(){e(o.result)},o.onerror=function(){n(o.error)}}catch(e){n(e)}}))})).catch(n)}));return u(n,e),n}function X(e,t){var n=this,r=new c((function(t,r){e<0?t(null):n.ready().then((function(){k(n._dbInfo,y,(function(a,o){if(a)return r(a);try{var i=o.objectStore(n._dbInfo.storeName),s=!1,l=i.openKeyCursor();l.onsuccess=function(){var n=l.result;n?0===e||s?t(n.key):(s=!0,n.advance(e)):t(null)},l.onerror=function(){r(l.error)}}catch(e){r(e)}}))})).catch(r)}));return u(r,t),r}function Y(e){var t=this,n=new c((function(e,n){t.ready().then((function(){k(t._dbInfo,y,(function(r,a){if(r)return n(r);try{var o=a.objectStore(t._dbInfo.storeName).openKeyCursor(),i=[];o.onsuccess=function(){var t=o.result;t?(i.push(t.key),t.continue()):e(i)},o.onerror=function(){n(o.error)}}catch(e){n(e)}}))})).catch(n)}));return u(n,e),n}function H(e,t){t=h.apply(this,arguments);var n=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||n.name,e.storeName=e.storeName||n.storeName);var r,a=this;if(e.name){var o=e.name===n.name&&a._dbInfo.db?c.resolve(a._dbInfo.db):N(e).then((function(t){var n=g[e.name],r=n.forages;n.db=t;for(var a=0;a<r.length;a++)r[a]._dbInfo.db=t;return t}));r=e.storeName?o.then((function(t){if(t.objectStoreNames.contains(e.storeName)){var n=t.version+1;I(e);var r=g[e.name],a=r.forages;t.close();for(var o=0;o<a.length;o++){var s=a[o];s._dbInfo.db=null,s._dbInfo.version=n}return new c((function(t,r){var a=i.open(e.name,n);a.onerror=function(e){a.result.close(),r(e)},a.onupgradeneeded=function(){a.result.deleteObjectStore(e.storeName)},a.onsuccess=function(){var e=a.result;e.close(),t(e)}})).then((function(e){r.db=e;for(var t=0;t<a.length;t++){var n=a[t];n._dbInfo.db=e,T(n._dbInfo)}})).catch((function(t){throw(S(e,t)||c.resolve()).catch((function(){})),t}))}})):o.then((function(t){I(e);var n=g[e.name],r=n.forages;t.close();for(var a=0;a<r.length;a++)r[a]._dbInfo.db=null;return new c((function(t,n){var r=i.deleteDatabase(e.name);r.onerror=r.onblocked=function(e){var t=r.result;t&&t.close(),n(e)},r.onsuccess=function(){var e=r.result;e&&e.close(),t(e)}})).then((function(e){n.db=e;for(var t=0;t<r.length;t++)T(r[t]._dbInfo)})).catch((function(t){throw(S(e,t)||c.resolve()).catch((function(){})),t}))}))}else r=c.reject("Invalid arguments");return u(r,t),r}var W={_driver:"asyncStorage",_initStorage:D,_support:s(),iterate:F,getItem:B,setItem:U,removeItem:G,clear:V,length:z,key:X,keys:Y,dropInstance:H};function q(){return"function"==typeof openDatabase}var $="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",K="~~local_forage_type~",J=/^~~local_forage_type~([^~]+)~/,Q="__lfsc__:",Z=Q.length,ee="arbf",te="blob",ne="si08",re="ui08",ae="uic8",oe="si16",ie="si32",se="ur16",le="ui32",ce="fl32",ue="fl64",de=Z+ee.length,fe=Object.prototype.toString;function he(e){var t,n,r,a,o,i=.75*e.length,s=e.length,l=0;"="===e[e.length-1]&&(i--,"="===e[e.length-2]&&i--);var c=new ArrayBuffer(i),u=new Uint8Array(c);for(t=0;t<s;t+=4)n=$.indexOf(e[t]),r=$.indexOf(e[t+1]),a=$.indexOf(e[t+2]),o=$.indexOf(e[t+3]),u[l++]=n<<2|r>>4,u[l++]=(15&r)<<4|a>>2,u[l++]=(3&a)<<6|63&o;return c}function me(e){var t,n=new Uint8Array(e),r="";for(t=0;t<n.length;t+=3)r+=$[n[t]>>2],r+=$[(3&n[t])<<4|n[t+1]>>4],r+=$[(15&n[t+1])<<2|n[t+2]>>6],r+=$[63&n[t+2]];return n.length%3==2?r=r.substring(0,r.length-1)+"=":n.length%3==1&&(r=r.substring(0,r.length-2)+"=="),r}function pe(e,t){var n="";if(e&&(n=fe.call(e)),e&&("[object ArrayBuffer]"===n||e.buffer&&"[object ArrayBuffer]"===fe.call(e.buffer))){var r,a=Q;e instanceof ArrayBuffer?(r=e,a+=ee):(r=e.buffer,"[object Int8Array]"===n?a+=ne:"[object Uint8Array]"===n?a+=re:"[object Uint8ClampedArray]"===n?a+=ae:"[object Int16Array]"===n?a+=oe:"[object Uint16Array]"===n?a+=se:"[object Int32Array]"===n?a+=ie:"[object Uint32Array]"===n?a+=le:"[object Float32Array]"===n?a+=ce:"[object Float64Array]"===n?a+=ue:t(new Error("Failed to get type for BinaryArray"))),t(a+me(r))}else if("[object Blob]"===n){var o=new FileReader;o.onload=function(){var n=K+e.type+"~"+me(this.result);t(Q+te+n)},o.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(e){t(null,e)}}function ge(e){if(e.substring(0,Z)!==Q)return JSON.parse(e);var t,n=e.substring(de),r=e.substring(Z,de);if(r===te&&J.test(n)){var a=n.match(J);t=a[1],n=n.substring(a[0].length)}var o=he(n);switch(r){case ee:return o;case te:return l([o],{type:t});case ne:return new Int8Array(o);case re:return new Uint8Array(o);case ae:return new Uint8ClampedArray(o);case oe:return new Int16Array(o);case se:return new Uint16Array(o);case ie:return new Int32Array(o);case le:return new Uint32Array(o);case ce:return new Float32Array(o);case ue:return new Float64Array(o);default:throw new Error("Unkown type: "+r)}}var ve={serialize:pe,deserialize:ge,stringToBuffer:he,bufferToString:me};function ye(e,t,n,r){e.executeSql("CREATE TABLE IF NOT EXISTS "+t.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],n,r)}function be(e){var t=this,n={db:null};if(e)for(var r in e)n[r]="string"!=typeof e[r]?e[r].toString():e[r];var a=new c((function(e,r){try{n.db=openDatabase(n.name,String(n.version),n.description,n.size)}catch(e){return r(e)}n.db.transaction((function(a){ye(a,n,(function(){t._dbInfo=n,e()}),(function(e,t){r(t)}))}),r)}));return n.serializer=ve,a}function xe(e,t,n,r,a,o){e.executeSql(n,r,a,(function(e,i){i.code===i.SYNTAX_ERR?e.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[t.storeName],(function(e,s){s.rows.length?o(e,i):ye(e,t,(function(){e.executeSql(n,r,a,o)}),o)}),o):o(e,i)}),o)}function we(e,t){var n=this;e=f(e);var r=new c((function(t,r){n.ready().then((function(){var a=n._dbInfo;a.db.transaction((function(n){xe(n,a,"SELECT * FROM "+a.storeName+" WHERE key = ? LIMIT 1",[e],(function(e,n){var r=n.rows.length?n.rows.item(0).value:null;r&&(r=a.serializer.deserialize(r)),t(r)}),(function(e,t){r(t)}))}))})).catch(r)}));return u(r,t),r}function Ee(e,t){var n=this,r=new c((function(t,r){n.ready().then((function(){var a=n._dbInfo;a.db.transaction((function(n){xe(n,a,"SELECT * FROM "+a.storeName,[],(function(n,r){for(var o=r.rows,i=o.length,s=0;s<i;s++){var l=o.item(s),c=l.value;if(c&&(c=a.serializer.deserialize(c)),void 0!==(c=e(c,l.key,s+1)))return void t(c)}t()}),(function(e,t){r(t)}))}))})).catch(r)}));return u(r,t),r}function Ie(e,t,n,r){var a=this;e=f(e);var o=new c((function(o,i){a.ready().then((function(){void 0===t&&(t=null);var s=t,l=a._dbInfo;l.serializer.serialize(t,(function(t,c){c?i(c):l.db.transaction((function(n){xe(n,l,"INSERT OR REPLACE INTO "+l.storeName+" (key, value) VALUES (?, ?)",[e,t],(function(){o(s)}),(function(e,t){i(t)}))}),(function(t){if(t.code===t.QUOTA_ERR){if(r>0)return void o(Ie.apply(a,[e,s,n,r-1]));i(t)}}))}))})).catch(i)}));return u(o,n),o}function Te(e,t,n){return Ie.apply(this,[e,t,n,1])}function Se(e,t){var n=this;e=f(e);var r=new c((function(t,r){n.ready().then((function(){var a=n._dbInfo;a.db.transaction((function(n){xe(n,a,"DELETE FROM "+a.storeName+" WHERE key = ?",[e],(function(){t()}),(function(e,t){r(t)}))}))})).catch(r)}));return u(r,t),r}function _e(e){var t=this,n=new c((function(e,n){t.ready().then((function(){var r=t._dbInfo;r.db.transaction((function(t){xe(t,r,"DELETE FROM "+r.storeName,[],(function(){e()}),(function(e,t){n(t)}))}))})).catch(n)}));return u(n,e),n}function Ne(e){var t=this,n=new c((function(e,n){t.ready().then((function(){var r=t._dbInfo;r.db.transaction((function(t){xe(t,r,"SELECT COUNT(key) as c FROM "+r.storeName,[],(function(t,n){var r=n.rows.item(0).c;e(r)}),(function(e,t){n(t)}))}))})).catch(n)}));return u(n,e),n}function Pe(e,t){var n=this,r=new c((function(t,r){n.ready().then((function(){var a=n._dbInfo;a.db.transaction((function(n){xe(n,a,"SELECT key FROM "+a.storeName+" WHERE id = ? LIMIT 1",[e+1],(function(e,n){var r=n.rows.length?n.rows.item(0).key:null;t(r)}),(function(e,t){r(t)}))}))})).catch(r)}));return u(r,t),r}function Re(e){var t=this,n=new c((function(e,n){t.ready().then((function(){var r=t._dbInfo;r.db.transaction((function(t){xe(t,r,"SELECT key FROM "+r.storeName,[],(function(t,n){for(var r=[],a=0;a<n.rows.length;a++)r.push(n.rows.item(a).key);e(r)}),(function(e,t){n(t)}))}))})).catch(n)}));return u(n,e),n}function Ce(e){return new c((function(t,n){e.transaction((function(r){r.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],(function(n,r){for(var a=[],o=0;o<r.rows.length;o++)a.push(r.rows.item(o).name);t({db:e,storeNames:a})}),(function(e,t){n(t)}))}),(function(e){n(e)}))}))}function Le(e,t){t=h.apply(this,arguments);var n=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||n.name,e.storeName=e.storeName||n.storeName);var r,a=this;return u(r=e.name?new c((function(t){var r;r=e.name===n.name?a._dbInfo.db:openDatabase(e.name,"","",0),e.storeName?t({db:r,storeNames:[e.storeName]}):t(Ce(r))})).then((function(e){return new c((function(t,n){e.db.transaction((function(r){function a(e){return new c((function(t,n){r.executeSql("DROP TABLE IF EXISTS "+e,[],(function(){t()}),(function(e,t){n(t)}))}))}for(var o=[],i=0,s=e.storeNames.length;i<s;i++)o.push(a(e.storeNames[i]));c.all(o).then((function(){t()})).catch((function(e){n(e)}))}),(function(e){n(e)}))}))})):c.reject("Invalid arguments"),t),r}var je={_driver:"webSQLStorage",_initStorage:be,_support:q(),iterate:Ee,getItem:we,setItem:Te,removeItem:Se,clear:_e,length:Ne,key:Pe,keys:Re,dropInstance:Le};function Oe(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(e){return!1}}function Ae(e,t){var n=e.name+"/";return e.storeName!==t.storeName&&(n+=e.storeName+"/"),n}function ke(){var e="_localforage_support_test";try{return localStorage.setItem(e,!0),localStorage.removeItem(e),!1}catch(e){return!0}}function Me(){return!ke()||localStorage.length>0}function De(e){var t=this,n={};if(e)for(var r in e)n[r]=e[r];return n.keyPrefix=Ae(e,t._defaultConfig),Me()?(t._dbInfo=n,n.serializer=ve,c.resolve()):c.reject()}function Be(e){var t=this,n=t.ready().then((function(){for(var e=t._dbInfo.keyPrefix,n=localStorage.length-1;n>=0;n--){var r=localStorage.key(n);0===r.indexOf(e)&&localStorage.removeItem(r)}}));return u(n,e),n}function Fe(e,t){var n=this;e=f(e);var r=n.ready().then((function(){var t=n._dbInfo,r=localStorage.getItem(t.keyPrefix+e);return r&&(r=t.serializer.deserialize(r)),r}));return u(r,t),r}function Ue(e,t){var n=this,r=n.ready().then((function(){for(var t=n._dbInfo,r=t.keyPrefix,a=r.length,o=localStorage.length,i=1,s=0;s<o;s++){var l=localStorage.key(s);if(0===l.indexOf(r)){var c=localStorage.getItem(l);if(c&&(c=t.serializer.deserialize(c)),void 0!==(c=e(c,l.substring(a),i++)))return c}}}));return u(r,t),r}function Ge(e,t){var n=this,r=n.ready().then((function(){var t,r=n._dbInfo;try{t=localStorage.key(e)}catch(e){t=null}return t&&(t=t.substring(r.keyPrefix.length)),t}));return u(r,t),r}function Ve(e){var t=this,n=t.ready().then((function(){for(var e=t._dbInfo,n=localStorage.length,r=[],a=0;a<n;a++){var o=localStorage.key(a);0===o.indexOf(e.keyPrefix)&&r.push(o.substring(e.keyPrefix.length))}return r}));return u(n,e),n}function ze(e){var t=this.keys().then((function(e){return e.length}));return u(t,e),t}function Xe(e,t){var n=this;e=f(e);var r=n.ready().then((function(){var t=n._dbInfo;localStorage.removeItem(t.keyPrefix+e)}));return u(r,t),r}function Ye(e,t,n){var r=this;e=f(e);var a=r.ready().then((function(){void 0===t&&(t=null);var n=t;return new c((function(a,o){var i=r._dbInfo;i.serializer.serialize(t,(function(t,r){if(r)o(r);else try{localStorage.setItem(i.keyPrefix+e,t),a(n)}catch(e){"QuotaExceededError"!==e.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==e.name||o(e),o(e)}}))}))}));return u(a,n),a}function He(e,t){if(t=h.apply(this,arguments),!(e="function"!=typeof e&&e||{}).name){var n=this.config();e.name=e.name||n.name,e.storeName=e.storeName||n.storeName}var r,a=this;return u(r=e.name?new c((function(t){e.storeName?t(Ae(e,a._defaultConfig)):t(e.name+"/")})).then((function(e){for(var t=localStorage.length-1;t>=0;t--){var n=localStorage.key(t);0===n.indexOf(e)&&localStorage.removeItem(n)}})):c.reject("Invalid arguments"),t),r}var We={_driver:"localStorageWrapper",_initStorage:De,_support:Oe(),iterate:Ue,getItem:Fe,setItem:Ye,removeItem:Xe,clear:Be,length:ze,key:Ge,keys:Ve,dropInstance:He},qe=function(e,t){return e===t||"number"==typeof e&&"number"==typeof t&&isNaN(e)&&isNaN(t)},$e=function(e,t){for(var n=e.length,r=0;r<n;){if(qe(e[r],t))return!0;r++}return!1},Ke=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},Je={},Qe={},Ze={INDEXEDDB:W,WEBSQL:je,LOCALSTORAGE:We},et=[Ze.INDEXEDDB._driver,Ze.WEBSQL._driver,Ze.LOCALSTORAGE._driver],tt=["dropInstance"],nt=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(tt),rt={description:"",driver:et.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function at(e,t){e[t]=function(){var n=arguments;return e.ready().then((function(){return e[t].apply(e,n)}))}}function ot(){for(var e=1;e<arguments.length;e++){var t=arguments[e];if(t)for(var n in t)t.hasOwnProperty(n)&&(Ke(t[n])?arguments[0][n]=t[n].slice():arguments[0][n]=t[n])}return arguments[0]}var it=new(function(){function e(t){for(var n in a(this,e),Ze)if(Ze.hasOwnProperty(n)){var r=Ze[n],o=r._driver;this[n]=o,Je[o]||this.defineDriver(r)}this._defaultConfig=ot({},rt),this._config=ot({},this._defaultConfig,t),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch((function(){}))}return e.prototype.config=function(e){if("object"===(void 0===e?"undefined":r(e))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var t in e){if("storeName"===t&&(e[t]=e[t].replace(/\W/g,"_")),"version"===t&&"number"!=typeof e[t])return new Error("Database version must be a number.");this._config[t]=e[t]}return!("driver"in e)||!e.driver||this.setDriver(this._config.driver)}return"string"==typeof e?this._config[e]:this._config},e.prototype.defineDriver=function(e,t,n){var r=new c((function(t,n){try{var r=e._driver,a=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!e._driver)return void n(a);for(var o=nt.concat("_initStorage"),i=0,s=o.length;i<s;i++){var l=o[i];if((!$e(tt,l)||e[l])&&"function"!=typeof e[l])return void n(a)}!function(){for(var t=function(e){return function(){var t=new Error("Method "+e+" is not implemented by the current driver"),n=c.reject(t);return u(n,arguments[arguments.length-1]),n}},n=0,r=tt.length;n<r;n++){var a=tt[n];e[a]||(e[a]=t(a))}}();var d=function(n){Je[r],Je[r]=e,Qe[r]=n,t()};"_support"in e?e._support&&"function"==typeof e._support?e._support().then(d,n):d(!!e._support):d(!0)}catch(e){n(e)}}));return d(r,t,n),r},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(e,t,n){var r=Je[e]?c.resolve(Je[e]):c.reject(new Error("Driver not found."));return d(r,t,n),r},e.prototype.getSerializer=function(e){var t=c.resolve(ve);return d(t,e),t},e.prototype.ready=function(e){var t=this,n=t._driverSet.then((function(){return null===t._ready&&(t._ready=t._initDriver()),t._ready}));return d(n,e,e),n},e.prototype.setDriver=function(e,t,n){var r=this;Ke(e)||(e=[e]);var a=this._getSupportedDrivers(e);function o(){r._config.driver=r.driver()}function i(e){return r._extend(e),o(),r._ready=r._initStorage(r._config),r._ready}function s(e){return function(){var t=0;function n(){for(;t<e.length;){var a=e[t];return t++,r._dbInfo=null,r._ready=null,r.getDriver(a).then(i).catch(n)}o();var s=new Error("No available storage method found.");return r._driverSet=c.reject(s),r._driverSet}return n()}}var l=null!==this._driverSet?this._driverSet.catch((function(){return c.resolve()})):c.resolve();return this._driverSet=l.then((function(){var e=a[0];return r._dbInfo=null,r._ready=null,r.getDriver(e).then((function(e){r._driver=e._driver,o(),r._wrapLibraryMethodsWithReady(),r._initDriver=s(a)}))})).catch((function(){o();var e=new Error("No available storage method found.");return r._driverSet=c.reject(e),r._driverSet})),d(this._driverSet,t,n),this._driverSet},e.prototype.supports=function(e){return!!Qe[e]},e.prototype._extend=function(e){ot(this,e)},e.prototype._getSupportedDrivers=function(e){for(var t=[],n=0,r=e.length;n<r;n++){var a=e[n];this.supports(a)&&t.push(a)}return t},e.prototype._wrapLibraryMethodsWithReady=function(){for(var e=0,t=nt.length;e<t;e++)at(this,nt[e])},e.prototype.createInstance=function(t){return new e(t)},e}());t.exports=it},{3:3}]},{},[4])(4);globalThis.setLobbyName=e=>{u.lobbyName=e},globalThis.disableNetwork=()=>{u.disableNet=!0},globalThis.setLoadingEvent=e=>{c.loadingEvent=e},globalThis.setBaseURL=e=>{globalThis.BASE_URL=e};let jn=!1;async function On(){function e(t){globalThis.setCheckGameEvent?(globalThis.setCheckGameEvent({getIP:Rn.getIP,setLoadingEvent:globalThis.setLoadingEvent,setBaseURL:globalThis.setBaseURL}),globalThis.parent.isCheckGameCDN&&(globalThis.disableNetwork(),globalThis.CDN_LIST=[]),t()):setTimeout((()=>{e(t)}),100)}if(globalThis.parent!==globalThis)return u.isCheckGameCDN=globalThis.parent.isCheckGameCDN,c.isCheckGameCDN=u.isCheckGameCDN,new Promise((t=>{globalThis.parent.isCheckGameCDN||globalThis.parent.isGameManager?e(t):t()}))}!async function(){await async function(){let e,n=s,a=u,i=t,c=globalThis.location.search.substring(1),d=null,f={module:e=>a.module=e,lang:e=>a.langID=e,launchId:e=>a.launch=e,launch:e=>a.launch=e,pattern:e=>a.pattern=e,logo:e=>{e.indexOf("//")>=0?a.logo=e:a.logo="data/img/"+e},agent:e=>{"megahot"===e?a.agent="bg":"jigtp"===e?a.agent="tp":"gatest"===e&&(a.agent="bg")},hostname:e=>n.host=e,key:e=>n.key=e,group:e=>n.group=e,game:e=>n.game=e,room:e=>n.room=e,currency:e=>n.currency=e,mode:e=>n.mode=e,namespace:e=>n.namespace=e,tablekey:e=>n.tablekey=e,menu:e=>a.menu=e,options:e=>d=e,lobbyName:e=>a.lobbyName=e,mobileMode:e=>a.mobileMode=e,ping:()=>a.ping=!0,gtiLobbyUrl:e=>a.gtiLobbyUrl=e,gtiBetTracerUrl:e=>a.gtiBetTracerUrl=e,version:e=>a.version=e};e=c.split("&",25),e.forEach((e=>{let t=e.split("=",2),n=f[t[0]];n&&n(t[1])}));let h=a.gtiLobbyUrl.split(",",2);if(h.length>0&&(a.gtiLobbyUrl=h[0]),a.launch&&a.launch.length>0&&(n.game=a.launch),a.menu&&a.menu.length>0){let e=[];for(let t=0;t<a.menu.length;t+=1)e[t]=parseInt(a.menu[t]);a.menu=e}let p=l;if(d&&d.length>0){a.useOptions=!0;for(let e=0;e<d.length;e+=1)p[e]=parseInt(d[e])}n.host&&0===n.host.length&&(n.host=null),o||n.host||(n.host=globalThis.location.hostname+":"+globalThis.location.port),(!n.mode||n.mode.length<=1)&&(n.mode=i.REAL);let g=n.info;if(n.room&&(g.roomID=n.room),g.token=n.key,n.tablekey&&(g.tablekey=n.tablekey),a.langID||(a.langID="en-us"),a.langID=m[a.langID],y(a.langID),a.module)if(0===a.module.length)a.module=null;else{let e=r,t=a.module[e.PROTOCOL];"p"===t?n.protocol="protobuf":"a"===t&&(n.protocol="avro"),t=a.module[e.GAME_FORMAT],n.gameFormat="gti","g"===t?n.gameFormat="gti":"v"===t&&(n.gameFormat="video")}let v=new Date;u.version=v.getTime()}();let e=u,n="common";Rn.log({label:n,category:"啟動程式"});let a={category:"初始化 主網址",getLabel:()=>"common"};if(Rn.loadBegin(a),"check"===e.lobbyName)try{await On()}catch(e){}try{await async function(){let e=null;if(u.useCache){if(navigator.serviceWorker&&navigator.serviceWorker.register)return e=await navigator.serviceWorker.register("/lib.sw.js",{scope:"/"}),u.registration=e,u.hasCache=!0,e.addEventListener("updatefound",(function(){e.update();let t=e.installing;t.addEventListener("statechange",(()=>{"installed"===t.state&&globalThis.location.reload()}))})),navigator.serviceWorker.addEventListener("message",(e=>{})),new Promise((t=>{!function(){if(e&&e.active&&navigator.serviceWorker.controller){let e={};e.config={BASE_URL:globalThis.BASE_URL,CDN_LIST:globalThis.CDN_LIST},navigator.serviceWorker.controller.postMessage(e),t()}else t()}()}))}else navigator.serviceWorker&&navigator.serviceWorker.register&&(e=await navigator.serviceWorker.register("/lib.sw.js?v=2.0.0",{scope:"/"}),e&&e.unregister&&await e.unregister())}()}catch(e){}Rn.log({eventName:u.hasCache?"使用":"不使用",label:n,category:"確認快取功能"});let i=null,c=null;try{await Ln.setDriver(Ln.LOCALSTORAGE),c=Ln.createInstance({name:"mygames",storeName:"agent"}),c&&(u.isCheckGameCDN||o||(i=await c.getItem("baseURL"))),u.store=c}catch(e){}if(i)globalThis.BASE_URL=i,Rn.report.currentURL=i,u.selectCDN=!0;else if(!u.hasCache)try{await x()}catch(e){}Rn.log({eventName:u.hasCDN?"使用":"不使用",label:n,category:"確認服務線路"});try{const{Howl:e,Howler:t,IsMobile:n,m:r,nuts:a,component:o,load:s}=await import("./agent.d688bc1b.js");await s(),globalThis.Howl=e,globalThis.Howler=t,globalThis.isMobile=n(globalThis.navigator.userAgent);let l=[],c={PIXI:globalThis.PIXI,m:r,io:globalThis.io,Stats:null,plugin:l};await a.init(c);let u=a.ui.loading,d=i;d=d?`${i}agent/`:"";let f=[d+"data/loading/5194d92e22d8f036.png",d+"data/loading/18ce551957f56e22.png",d+"data/loading/ff13b3ff9fd7990b.png",d+"data/loading/5be33c170a708391.png",d+"data/loading/20898c6ca3eed211.png",d+"data/loading/6a8620a546ad4363.png",d+"data/loading/1aa8deaac39b5da0.png",d+"data/loading/535839ce0bed8517.png",d+"data/loading/4474841b72c56deb.png",d+"data/loading/40ee4fadb2a8f3be.png",d+"data/loading/dc2dc25760fa8491.png",d+"data/loading/c3bfd5f259340831.png"];if(u.setScene(f),jn)return;jn=!0;let h=globalThis.createjs.Ticker;h.timingMode=h.TIMEOUT,o.run({element:document.body})}catch(e){}Rn.loadEnd(a),Rn.log({label:n,category:"初始化 主網址"})}();export{t as G,h as I,$e as L,r as M,n as O,e as P,a as T,u as a,d as b,w as c,b as d,s as e,bn as f,v as g,c as h,o as i,x as j,i as k,Ln as l,xe as m,wn as n,l as o,Rn as r,f as s,Ye as u};
