import{r as e,g as t,b as i,a as n,e as s,o as a,O as r,G as o,d as l,c,I as h,f as g,h as d,T as u,j as m,k as p}from"./agent.3e740e2d.js";import f from"mithril";import*as b from"nuts";import w from"localforage";let y=!1;function v(){return y}let x="title";function L(){return x}let C="message";function T(){return C}function E(e){x=e.title,C=e.msg,y=!0,f.redraw()}function k(){y=!1,f.redraw()}var R=Object.freeze({__proto__:null,getMessage:T,getTitle:L,hide:k,isVisible:v,show:E});let O=null,I={oninit(e){let t=e.attrs;this.style=t.style,this.complete=t.complete,this.logo=null},async oncreate(e){let t=this,i=e.attrs,n=e.dom,s=i.url,a=await fetch(s);if(a&&a.ok){let e=await a.blob();const i=URL.createObjectURL(e);n.src=i,f.redraw(),t.complete&&t.complete()}},view(){return f("img",{style:this.style})}},M={timeBase:1,oninit(e){let t=e.attrs;this.class=t.class||"ba b--light-blue animate__animated animate__bounceIn",this.style=t.style||{left:"0%",top:"0%",width:"100%",height:"100%"},this.info=t.info,this.serve=t.serve,this.config=t.config||{width:300,height:200,resolution:1,antialias:!1,transparent:!0},this.id=t.id,this.group=t.group,this.title=t.title||"標題",this.logo=t.logo,this.game=null,this.eventClass={current:"ba b--dotted bw1 white-50",onmouseenter:"ba b--dotted bw2 white-50",onmouseleave:"ba b--dotted bw1 white-50"}},onbeforeremove(e){let t=this;return t.game&&t.game.pause(),["animate__animated","animate__lightSpeedOut"].forEach((t=>{e.dom.classList.add(t)})),new Promise((e=>{b.updateManager.setTimeout(e,.4)}))},view(){let i=this,n=i.eventClass;return f(".",{class:i.class,style:i.style},[f(".game-card-title",i.title),f(I,{class:"game-card-view ba b--light-gray",style:{zValue:0,position:"absolute",left:"0%",top:"0%",width:"100%",height:"100%"},url:i.logo,complete(){}}),f(".",{onclick(){globalThis.Howl&&(O||(O=new globalThis.Howl({src:["data/f82550ea2e80cd97.wav"]}),O.volume(.01)),O.play()),gi(!1),Ft({serve:i.serve,id:i.id,group:i.group})},onmouseenter(){n.current=n.onmouseenter,f.redraw()},onmouseleave(){n.current=n.onmouseleave,f.redraw()},class:n.current,style:{position:"absolute",left:"10%",top:"10%",width:"80%",height:"75%"}}),f(".game-card-download",{onclick(){E({yesno:!1,title:"connecting",msg:"disconnect"})}},[f.trust(`<div class="no-underline near-white bg-animate bg-near-black hover-bg-gray inline-flex items-center ma2 tc br2 pa2">\n    <svg fill="#77ff77" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">\n    <path d="M19 8l-4 4h3c0 3.31-2.69 6-6 6-1.01 0-1.97-.25-2.8-.7l-1.46 1.46C8.97 19.54 10.43 20 12 20c4.42 0 8-3.58 8-8h3l-4-4zM6 12c0-3.31 2.69-6 6-6 1.01 0 1.97.25 2.8.7l1.46-1.46C15.03 4.46 13.57 4 12 4c-4.42 0-8 3.58-8 8H1l4 4 4-4H6z"/>\n    <path d="M0 0h24v24H0z" fill="none"/>\n</svg>\n    <span class="f6 ml3 pr2">${t("download")}</span>\n  </div>`)]),f(".game-card-stop",{onclick(){e.getIP().then((e=>{}))}},[f.trust(`<div class="no-underline near-white bg-animate bg-near-black hover-bg-gray inline-flex items-center ma2 tc br2 pa2">\n    <svg fill="#77ff77" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">\n    <path d="M0 0h24v24H0z" fill="none"/>\n    <path d="M14.59 8L12 10.59 9.41 8 8 9.41 10.59 12 8 14.59 9.41 16 12 13.41 14.59 16 16 14.59 13.41 12 16 9.41 14.59 8zM12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"/>\n</svg>\n    <span class="f6 ml3 pr2">${t("stop")}</span>\n  </div>`)])])}},$={left:"0px",top:"0px",width:"300px",height:"200px"},U={},_={},P=null;function A(e){return U[e]||(U[e]={}),_=U[e],_}function F(e,t,i,s){let o={};function l(){let e=n.registration;e&&e.active&&navigator.serviceWorker.controller?navigator.serviceWorker.controller.postMessage(o):b.updateManager.setTimeout(l,.05)}if(!n.versionTimestamp){let e=new Date;n.versionTimestamp=e.getTime()}let c=n.versionTimestamp,h=!1,g=null;return g=new Promise((g=>{if(!e||!t)return void g(null);function d(){let s=`config/${t}/${e}/gamecard.txt?v=${c}`,d=`config/${t}/${e}/cache.txt`;if(i){let n=i;"/"===n[n.length-1]&&(n=n.substring(0,n.length-1)),s=`${n}/config/${t}/${e}/gamecard.txt?v=${c}`,d=`${n}/config/${t}/${e}/cache.txt`}else s=`config/${t}/${e}/gamecard.txt?v=${c}`,d=`config/${t}/${e}/cache.txt`;o.cacheName=`${t}${e}`,o.url=d,n.useCache&&l(),fetch(s,{headers:{"Content-Type":"text/plain"}}).then((e=>e.ok?e.text():null)).then((e=>{if(!e)return;let t={},s=new String(e),o=s.indexOf("{");if(o>=0&&o<=9){let e=JSON.parse(s);if(!e.options||!e.options.overview){let e=r;n.useOptions||(a[e.OVERVIEW_LOGO]=1,a[e.OVERVIEW_ANIMATION]=0,a[e.OVERVIEW_BACKGROUND]=0,a[e.OVERVIEW_PROGRESS]=1)}if(e.templateVersion="slot.2.1",t.gameCard=e,i){let e=i;"/"===e[e.length-1]&&(e=e.substring(0,e.length-1)),t.gameCard.baseURL=`${e}/`}h=!0,g(t)}})).catch((e=>{}))}let u,m;if(i){let n=i;"/"===n[n.length-1]&&(n=n.substring(0,n.length-1)),s?u=`${n}/${t}/${e}/config/v${s}.txt`:(u=`${n}/${t}/${e}/config/gamecard.txt?v=${c}`,m=`${n}/${t}/${e}/config/cache.txt`)}else s?u=`${n.projectURL}${t}/${e}/config/v${s}.txt`:(u=`${n.projectURL}${t}/${e}/config/gamecard.txt?v=${c}`,m=`${n.projectURL}${t}/${e}/config/cache.txt`);o.cacheName=`${t}${e}`,o.url=m,n.useCache&&l(),fetch(u,{headers:{"Content-Type":"text/plain"}}).then((e=>e.ok?e.text():(d(),null))).then((e=>{if(!e)return;let t={},s=new String(e),a=s.indexOf("{");if(a>=0&&a<=9){if(t.gameCard=JSON.parse(s),i)if(t.gameCard.baseURL){let e=i;"/"===e[e.length-1]&&(e=e.substring(0,e.length-1)),t.gameCard.baseURL=e+t.gameCard.baseURL.replace(n.projectURL,"/")}else t.gameCard.baseURL=i;else{let e=globalThis.location.origin;t.gameCard.baseURL?t.gameCard.baseURL.indexOf("://")<0&&(t.gameCard.baseURL=e+t.gameCard.baseURL):t.gameCard.baseURL=globalThis.location.origin+"/"}h=!0,g(t)}if(h)return!0;d()})).catch((()=>{d()}))})),g}function B(e,t,n){let s=Date.now(),a="";i&&(a="test/data/gameList.txt?v="+s),t[e]=[],n[e]=0;let r=0;f.request(a).then((i=>{t[e]=i||[],i.forEach((e=>{if(!e)return;e.isSub&&(r+=1);let t=A(e.group);if(globalThis.BASE_URL)if(e.baseURL){let t=globalThis.BASE_URL;"/"===t[t.length-1]&&(t=t.substring(0,t.length-1)),e.baseURL=t+e.baseURL}else e.baseURL=globalThis.BASE_URL;else{let t=globalThis.location.origin;e.baseURL?e.baseURL=t+e.baseURL:e.baseURL=globalThis.location.origin+"/"}t[e.id]=e})),n[e]=i.length-r}))}function N(e){const t=e.key||e.code;if(i)switch(t){case"r":case"R":if(P){globalThis.scene[P.id].reload({game:P.appConfig,group:P.group,id:P.id,tablekey:"abcd1234"})}}}function S(e){e.key||e.code}let z={oninit(){let e={},t={};i?B("test",e,t):(B("slot",e,t),B("video",e,t),B("game",e,t)),this.group=e,this.displayCount=t,globalThis.addEventListener("keydown",N),globalThis.addEventListener("keyup",S)},view(){let e=this;return i?f(".gameCardList",{style:{left:"0%",top:"0%",width:"100%",height:"100%"}},f(".",{style:{position:"absolute",left:"0%",top:"40%",width:"100%",height:"25%"}},"group zzzz",f(".layout",{style:{left:"0%",marginTop:"0px",width:25*e.displayCount.game+"%",height:"100%"}},e.group.test?e.group.test.map((e=>{if(!e||e.isSub)return f(".");let t=e.baseURL||"",i=e.images;return n.useAvif?i.v2&&(i=i.v2):i.v1&&(i=i.v1),f(".",{style:$},[f(M,{id:e.id,group:e.group,serve:{game:e.id,group:e.group},logo:t+i.logo,title:`${e.name[s()]}(${e.appConfig})`})])})):f(".")))):f(".gameCardList",{style:{left:"0%",top:"0%",width:"100%",height:"100%"}},f(".",{style:{position:"absolute",left:"0%",top:"65%",width:"100%",height:"25%",overflowX:"scroll"}},"group game",f(".layout",{style:{left:"0%",marginTop:"0px",width:25*e.displayCount.game+"%",height:"100%"}},e.group.game.map((e=>{if(!e||e.isSub)return f(".");let t=e.baseURL||"";return f(".",{style:{left:"0%",top:"0%",width:"90%",height:"100%"}},f(M,{id:e.id,group:"game",serve:{game:e.id,group:"game"},logo:t+e.images.logo,title:e.name[s()]}))})))),f(".",{style:{position:"absolute",left:"0%",top:"5%",width:"100%",height:"25%",overflowX:"scroll"}},"group slot",f(".layout",{style:{left:"0%",marginTop:"0px",width:25*e.displayCount.slot+"%",height:"100%"}},e.group.slot.map((e=>{if(!e&&e.isSub)return f(".");let t=e.baseURL||"";return f(".",{style:{left:"0%",top:"0%",width:"100%",height:"100%"}},[f(M,{id:e.id,group:"slot",serve:{game:e.id,group:"slot"},logo:t+e.images.logo,title:e.name[s()]})])})))),f(".",{style:{position:"absolute",left:"0%",top:"35%",width:"100%",height:"25%",overflowX:"scroll"}},"group video",f(".layout",{style:{left:"0%",marginTop:"0px",width:25*e.displayCount.video+"%",height:"100%"}},e.group.video.map((e=>{if(!e||e.isSub)return f(".");let t=e.baseURL||"";return f(".",{style:{left:"0%",top:"0%",width:"100%",height:"80%"}},[f(M,{id:e.id,group:"video",serve:{game:e.id,group:"video"},logo:t+e.images.logo,title:e.name[s()]})])})))))}},j={Android:()=>navigator.userAgent.match(/Android/i),BlackBerry:()=>navigator.userAgent.match(/BlackBerry/i),iOS:()=>navigator.userAgent.match(/iPhone|iPad|iPod/i),Opera:()=>navigator.userAgent.match(/Opera Mini/i),Windows:()=>navigator.userAgent.match(/IEMobile/i),any:()=>j.Android()||j.BlackBerry()||j.iOS()||j.Opera()||j.Windows()},H=null;function V(e){H=e}function D(e){H&&H.fix&&(globalThis.innerHeight>=e.screenHeight-H.fix.height?e.isFullscreen=!0:e.isFullscreen=!1)}let W={name:"chrome",0:{offset:{x:0,y:0,width:0,height:0},fix:{height:68}},90:{offset:{x:0,y:0,width:0,height:0},fix:{height:28}},"-90":{offset:{x:0,y:0,width:0,height:0},fix:{height:28}},270:{offset:{x:0,y:0,width:0,height:0},fix:{height:28}},180:{offset:{x:0,y:0,width:0,height:0},fix:{height:68}}};var G=Object.freeze({__proto__:null,checkFullscreen:function(e){D(e)},getCurrentValue:function(){return H},setCurrentValue:function(e){V(W[e])},value:W});let Y={name:"firefox",0:{offset:0,fix:{height:26}},90:{offset:0,fix:{height:26}},"-90":{offset:0,fix:{height:26}},270:{offset:0,fix:{height:26}},180:{offset:0,fix:{height:26}}};var q=Object.freeze({__proto__:null,checkFullscreen:function(e){D(e)},getCurrentValue:function(){return H},setCurrentValue:function(e){V(Y[e])},value:Y});let K={name:"opera",0:{offset:0,fix:{height:114}},90:{offset:0,fix:{height:72}},"-90":{offset:0,fix:{height:72}},270:{offset:0,fix:{height:72}},180:{offset:0,fix:{height:114}}};var X=Object.freeze({__proto__:null,checkFullscreen:function(e){D(e)},getCurrentValue:function(){return H},setCurrentValue:function(e){V(K[e])},value:K});let J={name:"uc",0:{offset:0,fix:{height:0}},90:{offset:0,fix:{height:0}},"-90":{offset:0,fix:{height:0}},270:{offset:0,fix:{height:0}},180:{offset:0,fix:{height:0}}};var Q=Object.freeze({__proto__:null,checkFullscreen:function(e){D(e)},getCurrentValue:function(){return H},setCurrentValue:function(e){V(J[e])},value:J});let Z={name:"baidu",0:{offset:{x:0,y:0,width:0,height:0},fix:{height:87}},90:{offset:0,fix:{height:87}},"-90":{offset:0,fix:{height:87}},270:{offset:0,fix:{height:87}},180:{offset:0,fix:{height:87}}};var ee=Object.freeze({__proto__:null,checkFullscreen:function(e){D(e)},getCurrentValue:function(){return H},setCurrentValue:function(e){V(Z[e])},value:Z});let te={name:"lieao",0:{offset:{x:0,y:0,width:0,height:0},fix:{height:0}},90:{offset:0,fix:{height:0}},"-90":{offset:0,fix:{height:0}},270:{offset:0,fix:{height:0}},180:{offset:0,fix:{height:0}}};var ie=Object.freeze({__proto__:null,checkFullscreen:function(e){D(e)},getCurrentValue:function(){return H},setCurrentValue:function(e){V(te[e])},value:te});let ne={name:"unknown",0:{offset:{x:0,y:0,width:0,height:0},fix:{height:0}},90:{offset:0,fix:{height:0}},"-90":{offset:0,fix:{height:0}},270:{offset:0,fix:{height:0}},180:{offset:0,fix:{height:0}}};var se=Object.freeze({__proto__:null,checkFullscreen:function(e){D(e)},getCurrentValue:function(){return H},setCurrentValue:function(e){V(ne[e])},value:ne});let ae={name:"chrome",0:{offset:{x:0,y:0,width:0,height:4},fix:{height:24}},90:{offset:{x:0,y:0,width:0,height:4},fix:{height:24}},"-90":{offset:{x:0,y:0,width:0,height:4},fix:{height:24}},180:{offset:{x:0,y:0,width:0,height:4},fix:{height:24}}},re=null;var oe=Object.freeze({__proto__:null,checkFullscreen:function(e){re&&re.fix&&(globalThis.innerHeight>=e.screenHeight-re.fix.height?e.isFullscreen=!0:e.isFullscreen=!1)},eventOrientation:function(e){let t=ae.state;switch(re=ae[e],V(re),e){case 0:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!0,t.isLandscape=!1),t.screenHeight=screen.height,t.screenWidth=screen.width;break;case-90:case 90:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!1,t.isLandscape=!0),screen.width<screen.height?(t.screenHeight=screen.width,t.screenWidth=screen.height):(t.screenHeight=screen.height,t.screenWidth=screen.width);break;case 180:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!0,t.isLandscape=!1),t.screenHeight=screen.height,t.screenWidth=screen.width}},getCurrentValue:function(){return H},value:ae});let le={name:"firefox",0:{offset:{x:0,y:0,width:0,height:4},fix:{height:40}},90:{offset:{x:0,y:0,width:0,height:4},fix:{height:8}},"-90":{offset:{x:0,y:0,width:0,height:4},fix:{height:8}},180:{offset:{x:0,y:0,width:0,height:4},fix:{height:40}}},ce=null;var he=Object.freeze({__proto__:null,checkFullscreen:function(e){ce&&ce.fix&&(globalThis.innerHeight>=e.screenHeight-ce.fix.height?e.isFullscreen=!0:e.isFullscreen=!1)},eventOrientation:function(e){let t=le.state;switch(ce=le[e],V(ce),e){case 0:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!0,t.isLandscape=!1),t.screenHeight=screen.height,t.screenWidth=screen.width;break;case-90:case 90:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!1,t.isLandscape=!0),screen.width<screen.height?(t.screenHeight=screen.width,t.screenWidth=screen.height):(t.screenHeight=screen.height,t.screenWidth=screen.width);break;case 180:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!0,t.isLandscape=!1),t.screenHeight=screen.height,t.screenWidth=screen.width}globalThis.outerWidth<globalThis.innerWidth&&(globalThis.outerWidth=globalThis.innerWidth),globalThis.outerHeight<globalThis.innerHeight&&(globalThis.outerHeight=globalThis.innerHeight)},getCurrentValue:function(){return H},value:le});let ge={name:"uc",0:{offset:{x:0,y:0,width:0,height:4},fix:{height:82}},90:{offset:{x:0,y:0,width:0,height:4},fix:{height:100}},"-90":{offset:{x:0,y:0,width:0,height:4},fix:{height:100}},180:{offset:{x:0,y:0,width:0,height:4},fix:{height:82}}},de=null;var ue=Object.freeze({__proto__:null,checkFullscreen:function(e){e.isFullscreen=!0},eventOrientation:function(e){let t=ge.state;switch(de=ge[e],V(de),e){case 0:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!0,t.isLandscape=!1),t.screenHeight=screen.height,t.screenWidth=screen.width;break;case-90:case 90:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!1,t.isLandscape=!0),screen.width<screen.height?(t.screenHeight=screen.width,t.screenWidth=screen.height):(t.screenHeight=screen.height,t.screenWidth=screen.width);break;case 180:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!0,t.isLandscape=!1),t.screenHeight=screen.height,t.screenWidth=screen.width}},getCurrentValue:function(){return H},value:ge});let me={name:"safari",0:{offset:{x:0,y:0,width:0,height:4},fix:{height:32}},90:{offset:{x:0,y:0,width:0,height:4},fix:{height:16}},"-90":{offset:{x:0,y:0,width:0,height:4},fix:{height:16}},180:{offset:{x:0,y:0,width:0,height:4},fix:{height:32}}},pe=null;var fe=Object.freeze({__proto__:null,checkFullscreen:function(e){pe&&pe.fix&&(globalThis.innerHeight>=e.screenHeight-pe.fix.height?e.isFullscreen=!0:e.isFullscreen=!1)},eventOrientation:function(e){let t=me.state;switch(pe=me[e],V(pe),e){case 0:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!0,t.isLandscape=!1),t.screenHeight=screen.height,t.screenWidth=screen.width;break;case-90:case 90:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!1,t.isLandscape=!0),screen.width<screen.height?(t.screenHeight=screen.width,t.screenWidth=screen.height):(t.screenHeight=screen.height,t.screenWidth=screen.width);break;case 180:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!0,t.isLandscape=!1),t.screenHeight=screen.height,t.screenWidth=screen.width}},getCurrentValue:function(){return H},value:me});let be={name:"baidu",0:{offset:{x:0,y:0,width:0,height:4},fix:{height:0}},90:{offset:{x:0,y:0,width:0,height:4},fix:{height:0}},"-90":{offset:{x:0,y:0,width:0,height:4},fix:{height:0}},180:{offset:{x:0,y:0,width:0,height:4},fix:{height:0}}},we=null;var ye=Object.freeze({__proto__:null,checkFullscreen:function(e){we&&we.fix&&(globalThis.innerHeight>=e.screenHeight-we.fix.height?e.isFullscreen=!0:e.isFullscreen=!1)},eventOrientation:function(e){let t=be.state;switch(we=be[e],V(we),e){case 0:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!0,t.isLandscape=!1),t.screenHeight=screen.height,t.screenWidth=screen.width;break;case-90:case 90:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!1,t.isLandscape=!0),screen.width<screen.height?(t.screenHeight=screen.width,t.screenWidth=screen.height):(t.screenHeight=screen.height,t.screenWidth=screen.width);break;case 180:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!0,t.isLandscape=!1),t.screenHeight=screen.height,t.screenWidth=screen.width}},getCurrentValue:function(){return H},value:be});let ve={name:"liebao",0:{offset:{x:0,y:0,width:0,height:4},fix:{height:24}},90:{offset:{x:0,y:0,width:0,height:4},fix:{height:24}},"-90":{offset:{x:0,y:0,width:0,height:4},fix:{height:24}},180:{offset:{x:0,y:0,width:0,height:4},fix:{height:24}}},xe=null;var Le=Object.freeze({__proto__:null,checkFullscreen:function(e){xe&&xe.fix&&(globalThis.innerHeight>=e.screenHeight-xe.fix.height?e.isFullscreen=!0:e.isFullscreen=!1)},eventOrientation:function(e){let t=ve.state;switch(xe=ve[e],V(xe),e){case 0:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!0,t.isLandscape=!1),t.screenHeight=screen.height,t.screenWidth=screen.width;break;case-90:case 90:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!1,t.isLandscape=!0),screen.width<screen.height?(t.screenHeight=screen.width,t.screenWidth=screen.height):(t.screenHeight=screen.height,t.screenWidth=screen.width);break;case 180:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!0,t.isLandscape=!1),t.screenHeight=screen.height,t.screenWidth=screen.width}},getCurrentValue:function(){return H},value:ve});let Ce={name:"unknown",0:{offset:{x:0,y:0,width:0,height:4},fix:{height:0}},90:{offset:{x:0,y:0,width:0,height:4},fix:{height:0}},"-90":{offset:{x:0,y:0,width:0,height:4},fix:{height:0}},180:{offset:{x:0,y:0,width:0,height:4},fix:{height:0}}},Te=null;var Ee=Object.freeze({__proto__:null,checkFullscreen:function(e){Te&&Te.fix&&(globalThis.innerHeight>=e.screenHeight-Te.fix.height?e.isFullscreen=!0:e.isFullscreen=!1),e.isFullscreen=!0},eventOrientation:function(e){let t=Ce.state;switch(Te=Ce[e],V(Te),e){case 0:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!0,t.isLandscape=!1),t.screenHeight=screen.height,t.screenWidth=screen.width;break;case-90:case 90:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!1,t.isLandscape=!0),screen.width<screen.height?(t.screenHeight=screen.width,t.screenWidth=screen.height):(t.screenHeight=screen.height,t.screenWidth=screen.width);break;case 180:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!0,t.isLandscape=!1),t.screenHeight=screen.height,t.screenWidth=screen.width}},getCurrentValue:function(){return H},value:Ce});function ke(e){let t=!1;return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement?(t=!0,e&&(e.isFullscreen=!0)):(t=!1,e&&(e.isFullscreen=!1)),t}async function Re(e){if(!document.fullscreenEnabled)return Promise.reject();let t=!1;document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement?(e&&(e.isFullscreen=!1),document.exitFullscreen?(await document.exitFullscreen(),t=!0):document.msExitFullscreen?(await document.msExitFullscreen(),t=!0):document.mozCancelFullScreen?(await document.mozCancelFullScreen(),t=!0):document.webkitExitFullscreen&&(await document.webkitExitFullscreen(),t=!0),t&&e&&(e.isFullscreen=!1)):(document.documentElement.requestFullscreen?(await document.documentElement.requestFullscreen(),t=!0):document.documentElement.msRequestFullscreen?(await document.documentElement.msRequestFullscreen(),t=!0):document.documentElement.mozRequestFullScreen?(await document.documentElement.mozRequestFullScreen(),t=!0):document.documentElement.webkitRequestFullscreen&&(await document.documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT),t=!0),t&&(e&&(e.isFullscreen=!0),Pe.useOrientation&&globalThis.screen&&globalThis.screen.orientation&&globalThis.screen.orientation.lock&&await globalThis.screen.orientation.lock(Pe.orientation.name)))}let Oe=!0,Ie=!1;let Me={oninit(e){let t=this,i=e.attrs;t.onclick=i.onclick,t.style=i.style,t.config=i.config},onbeforeremove(){},view(){let e=this,t=e.config;return f(".pointer",{style:{width:"4%",height:"10%",borderRadius:"4px 8px 8px 4px",backgroundColor:"#000",opacity:.6,position:"absolute",left:e.style.left,top:e.style.top,zIndex:900},onclick(){t&&(t.isMenu=!0,t.visible=!1),e.onclick&&e.onclick()}},f.trust('<img src="data/sys/4021bb29611b24c4.svg" class="w-100 h-100 dropshadow">'))}},$e={oninit(e){let t=e.attrs,i=this;i.event=t.event,i.tray=t.tray,i.info=t.info,i.config=t.config,i.isLeave=!1,i.config||(i.config={isMenu:Ie,visible:Oe,flags:{fullscreen:!0,lock:!0,sound:!0,music:!0}}),i.config.flags||(i.config.flags={}),i.info||(i.info={logo:"logo.png",gameName:"test game",version:"0.0.0",mode:" test mode",token:"token"}),i.tray||(i.tray={state:{visible:!0},sound:{isMute:!1},music:{isMute:!1},screen:{isAutoScale:!0,isLock:!1},isLock:!1,isFullscreen:!1},Object.defineProperty(i.tray,"visible",{get:()=>i.tray.state.visible,set(e){i.tray.state.visible=e}}))},onbeforeremove:e=>(["animate__fadeOutLeft","animate__animated"].forEach((t=>{e.dom.classList.add(t)})),new Promise((e=>{b.updateManager.setTimeout((()=>{e()}),.4)}))),onremove(){},view(){let e=this,i=e.tray,s=e.event,a=e.info,r=e.config,o=r.flags,l=n.menu||[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0];return f(".animate__fadeInLeft animate__animated",{onclick(){e.isLeave?(r.isMenu=!1,r.visible=!1,i.visible=!1):(r.visible=!1,i.visible=!0)},style:{zIndex:900,position:"absolute",left:"0%",top:"0%",width:"100%",height:"100%"}},f(".pv2.ph2.bg-black.[id='panel']",[f(".fl.bb.b--gray.mb2.dib.pb2.mb2.w-100.rwdPanelHeader",[f("table.pa2.ml4.dib.br2.bg-black.white.rwdAppInfo",f("tbody.rwd-lh",[f("tr",[f("td",t("gameName")),f("td"," : "),f("td.blue",a.gameName)]),f("tr",[f("td",t("version")),f("td"," : "),f("td.blue",a.version)]),l[8]?f("tr",[f("td",t("gameMode")),f("td"," : "),f("td.blue",a.mode)]):null]))]),l[0]&&o.fullscreen&&!Pe.ios?f(".",[f(".fl.w-70.pa1.ma1.rwdOpt",f(".no-underline.near-white.inline-flex",[f("img.dib.fl.mv1.rwdOptIcon.dropshadow",{alt:"FULL SCREEN",src:"data/sys/f512613ddcb62054.png"}),f(".ml3.white.mv3.f4.rwdPanelFont",t("fullscreen"))])),f(".fr.w-20.pt2.mv2.mr2.rwdToggle",{onclick(){i.isFullscreen=!i.isFullscreen,f.redraw(),Re(i).then((()=>{s&&s.fullscreen&&s.fullscreen(i.isFullscreen)}))}},f("label.switch",[f("input[name='toggle'][type='checkbox'][value='fullscreen']",{disabled:!0,checked:i.isFullscreen}),f("span.slider.round")]))]):f("."),l[1]&&o.lock?f(".",[f(".fl.w-70.pa1.ma1.rwdOpt",f(".no-underline.near-white.inline-flex",[f("img.dib.fl.mv1.rwdOptIcon.dropshadow",{alt:"LOCK SCALE",src:"data/sys/8920df5ffd5c25b0.png"}),f(".ml3.white.mv3.f4.rwdPanelFont",t("lock"))])),f(".fr.w-20.pt2.mv2.mr2.rwdToggle",{onclick(){i.isLock=!i.isLock,i.update&&i.update(i),f.redraw(),s&&s.lock&&s.lock(i.isLock)}},f("label.switch",[f("input[name='toggle'][type='checkbox'][value='lock']",{disabled:!0,checked:i.isLock}),f("span.slider.round")]))]):f("."),l[2]&&o.music?f(".",[f(".fl.w-70.pa1.ma1.rwdOpt",f(".no-underline.near-white.inline-flex",[f("img.h-100.dib.fl.mv1.rwdOptIcon.dropshadow[alt='MUSIC'][src='data/sys/ddb7103e5eca70e6.png']"),f(".ml3.white.mv3.f4.rwdPanelFont",t("music"))])),f(".fr.w-20.pt2.mv2.mr2.rwdToggle",{onclick(){i.music.isMute=!i.music.isMute,f.redraw(),s&&s.music&&s.music(i.music)}},f("label.switch",[f("input[name='toggle'][type='checkbox'][value='music']",{disabled:!0,checked:!i.music.isMute}),f("span.slider.round")]))]):f("."),l[3]&&o.sound?f(".",[f(".fl.w-70.pa1.ma1.rwdOpt",f(".no-underline.near-white.inline-flex",[f("img.dib.fl.mv1.rwdOptIcon.dropshadow[alt='SOUND'][src='data/sys/ddb7103e5eca70e6.png']"),f(".ml3.white.mv3.f4.rwdPanelFont",t("sound"))])),f(".fr.w-20.pt2.mv2.mr2.rwdToggle",f("label.switch",[f("input[name='toggle'][type='checkbox'][value='sound']",{checked:!i.sound.isMute,onclick(){i.sound.isMute=!i.sound.isMute,s&&s.sound&&s.sound(i.sound)}}),f("span.slider.round")]))]):f("."),l[4]?f(".fl.w-100.pa2.pt3.bt.b--gray.mt2.rwdBtn",{onclick(){Pe.useFocus=!0}},f(".w-100 no-underline near-white bg-animate bg-near-black hover-bg-gray inline-flex items-center ma1 tc br1 pa1 border-box pointer",[f("img.dib h2 w2[src='data/sys/35b95e6d1d3ebf48.png']"),f(".w-100.f3.white.mv1.dib.noselect.rwdPanelFont",t("history"))])):f("."),l[5]?f(".fl.w-100.pa2",{onclick(){Pe.useFocus=!0}},f(".w-100 no-underline near-white bg-animate bg-near-black hover-bg-gray inline-flex items-center ma1 tc br1 pa1 border-box pointer",[f("img.dib h2 w2[src='data/sys/2357769f78f010b1.png']"),f(".w-100.f3.white.mv1.dib.noselect",t("deposit"))])):f("."),l[6]?f(".fl.w-100.pa2",{onclick(){globalThis.Howler&&(globalThis.Howler.mute(!0),globalThis.Howler.unload()),Pe.useFocus=!0}},f(".w-100 no-underline near-white bg-animate bg-near-black hover-bg-gray inline-flex items-center ma1 tc br1 pa1 border-box pointer",[f("img.dib h2 w2[src='data/sys/94615eed5b8c0616.png']"),f(".w-100.f3.white.mv1.dib.noselect",t("back"))])):f("."),l[7]?f(".fl.w-100.pa2",{onclick(){if(Pe.useFocus=!0,e.isLeave=!0,a.iframe){let e=a.iframe.contentDocument||a.iframe.contentglobalThis.document;e?(e.open(),e.write(""),e.close()):a.iframe.srcdoc="about:blank"}globalThis.Howler&&(globalThis.Howler.mute(!0),globalThis.Howler.unload())}},f(".w-100 no-underline near-white bg-animate bg-near-black hover-bg-gray inline-flex items-center ma1 tc br1 pa1 border-box pointer",[f("img.dib h2 w2[src='data/sys/fe342b264ea95dbb.png']"),f(".w-100.f3.white.mv1.dib.noselect",t("lobby"))])):f("."),f(".")]))}};function Ue(e,t){return null!=e?e:t()}function _e(e){let t,i=e[0],n=1;for(;n<e.length;){const s=e[n],a=e[n+1];if(n+=2,("optionalAccess"===s||"optionalCall"===s)&&null==i)return;"access"===s||"optionalAccess"===s?(t=i,i=a(i)):"call"!==s&&"optionalCall"!==s||(i=a(((...e)=>i.call(t,...e))),t=void 0)}return i}let Pe={},Ae={resizeTimer:null,timer:null,eventDelay:260},Fe=null,Be={name:null,angle:0,isTrigger:!1},Ne=null;function Se(e){switch(Ne&&Ne.setCurrentValue&&Ne.setCurrentValue(e),e){case 0:(Pe.usePortrait||Pe.useLandscape)&&(Pe.isPortrait=!0,Pe.isLandscape=!1),Pe.screenHeight=screen.height,Pe.screenWidth=screen.width;break;case 270:case-90:case-270:case 90:(Pe.usePortrait||Pe.useLandscape)&&(Pe.isPortrait=!1,Pe.isLandscape=!0),screen.width<screen.height?(Pe.screenHeight=screen.width,Pe.screenWidth=screen.height):(Pe.screenHeight=screen.height,Pe.screenWidth=screen.width);break;case-180:case 180:(Pe.usePortrait||Pe.useLandscape)&&(Pe.isPortrait=!0,Pe.isLandscape=!1),Pe.screenHeight=screen.height,Pe.screenWidth=screen.width}globalThis.parent===window&&globalThis.scrollTo(0,Pe.currentY)}function ze(){Pe.isPortrait=!1,Pe.isLandscape=!1;let e=0;e=window.matchMedia("(orientation: portrait)").matches?0:90,0===e&&(e=globalThis.screen.orientation&&"number"==typeof globalThis.screen.orientation.angle?globalThis.screen.orientation.angle:parseInt(globalThis.orientation)),Be.angle=e,Fe?Fe(e):Ne&&Ne.eventOrientation?Ne.eventOrientation(e):Se(e),globalThis.parent===window&&globalThis.scrollTo(0,Pe.currentY)}function je(e){Ae.timer&&(b.updateManager.remove(Ae.timer),Ae.timer=null),Be.isTrigger=!0,f.redraw(),Ae.timer=b.updateManager.setTimeout((()=>{Be.isTrigger=!1,ze(),De()}),.001*Ae.eventDelay)}function He(e){if(Pe.isMobile&&!e.isChild&&Ne&&Ne.getCurrentValue){let t=Ne.getCurrentValue();if(t){let i=t.offset;e.left=0,e.top=0,e.width=globalThis.innerWidth,e.height=globalThis.innerHeight,"number"==typeof i?e.height=globalThis.innerHeight-i:i&&("number"==typeof i.x&&(e.left=i.x),"number"==typeof i.y&&(e.top=i.y),"number"==typeof i.width&&(e.width=globalThis.innerWidth-i.width),"number"==typeof i.height&&(e.height=globalThis.innerHeight-i.height))}else e.left=0,e.top=0,e.width=globalThis.innerWidth,e.height=globalThis.innerHeight;e.left+="px",e.top+="px",e.width+="px",e.height+="px"}}function Ve(e){let t=e.game,i={x:1,y:1},n=screen.width,s=screen.height;Pe.isMobile?(n=globalThis.innerWidth,s=globalThis.innerHeight,Pe.useFullscreen||(n=globalThis.innerWidth,s=globalThis.innerHeight),Pe.ios&&(s=globalThis.innerHeight,n=globalThis.innerWidth)):(n=globalThis.innerWidth,s=globalThis.innerHeight),t.portrait&&t.landscape&&(n>s?(t.width=t.landscape.width||512,t.height=t.landscape.height||512):(t.width=t.portrait.width||512,t.height=t.portrait.height||512)),e.fix&&(n=parseInt(e.fix.width),s=parseInt(e.fix.height));let a={x:0,y:0};e.left=0,e.top=0;let r=e.reference;r&&(a.x=r.left*n,a.y=r.top*s,n*=r.width,s*=r.height),n-t.width<0?(e.width=n,i.x=n/t.width):e.width=t.width,s-t.height<0?(e.height=s,i.y=s/t.height):e.height=t.height,i.x<i.y?e.height=t.height*i.x:i.x>i.y&&(e.width=t.width*i.y);let o=e.anchor;if(o){let t=(n-e.width)*Ue(o.x,(()=>.5)),i=(s-e.height)*Ue(o.y,(()=>.5));e.left=a.x+t,e.top=a.y+i}if(e.useCenter){let t=0,i=0;"boolean"==typeof e.useCenter?(i=.5*(s-e.height),i<0&&(i=0),t=.5*(n-e.width),t<0&&(t=0)):(e.useCenter.vertical&&(i=.5*(s-e.height),i<0&&(i=0)),(e.useCenter.horizontal||e.useCenter.left)&&(t=.5*(n-e.width),t<0&&(t=0))),e.left=a.x+t,e.top=a.y+i}e.absPos&&("number"==typeof e.absPos.top?e.top=e.absPos.top:"number"==typeof e.absPos.bottom&&(e.top=s+e.absPos.bottom),"number"==typeof e.absPos.left?e.left=e.absPos.left:"number"==typeof e.absPos.right&&(e.left=n+e.absPos.right)),t.eventResize&&t.eventResize({left:e.left,top:e.top,width:e.width,height:e.height}),e.eventResize&&e.eventResize({width:globalThis.innerWidth,height:globalThis.innerHeight}),e.left+="px",e.top+="px",e.width+="px",e.height+="px"}function De(e){if(!Be.isTrigger&&!Pe.disableResize){if(!e)return!!Be.isTrigger||void(Ae.resizeTimer||(Pe.isResize=!0,f.redraw(),Ae.resizeTimer=b.updateManager.setTimeout((()=>{b.updateManager.remove(Ae.resizeTimer),Ae.resizeTimer=null,t()}),.3)));t()}function t(){Pe.isMobile&&globalThis.parent===window&&globalThis.scrollTo(0,Pe.currentY),b.updateManager.setTimeout((()=>{Ne&&Ne.checkFullscreen&&Pe.useFullscreen&&Ne.checkFullscreen(Pe);let e=globalThis.scene;if(Pe.settingList.forEach((t=>{if(t){if(!t.isLock)return He(t),f.redraw(),!0;if(Ve(t),e){let i=e[t.id];if(i){let e=i.localEvent;if(e&&e.resize){let i={isMobile:Pe.isMobile};i.width=globalThis.innerWidth,i.height=globalThis.innerHeight,i.setting=t,e.resize(i)}}}f.redraw()}})),e){Object.getOwnPropertyNames(e).forEach((t=>{let i=e[t];if(i){let e=i.localEvent;if(e&&e.resize){let t={isMobile:Pe.isMobile};t.width=globalThis.innerWidth,t.height=globalThis.innerHeight,4!==i.state&&5!==i.state||e.resize(t)}}}))}Pe.isResize=!1,f.redraw()}),.01)}}function We(e){if(_e([e,"optionalAccess",e=>e.index])>=0)return-1;let t=-1;for(let i=0;i<Pe.settingList.length;i+=1){Pe.settingList[i]||(t=i,Pe.settingList[i]=e)}return t<0&&(t=Pe.settingList.length,Pe.settingList.push(e)),e.isLock&&Ve(e),e.index=t,t}function Ge(e){if(_e([e,"optionalAccess",e=>e.index])>=0){let t=e.index;t<Pe.settingList.length&&(Pe.settingList[t]=null),delete e.index}}function Ye(e){Pe.disableResize=e}function qe(){Pe.settingList=[]}Pe.ios=!1,Pe.useOrientation=!1,Pe.usePortrait=!1,Pe.useLandscape=!1,Pe.isMobile=!1,Pe.mobileReady=null,Pe.useFullscreen=!1,Pe.isFullscreen=!1,Pe.isPortrait=!1,Pe.isLandscape=!1,Pe.isTouchOnce=!1,Pe.isResize=!1,Pe.currentY=0,Pe.screenWidth=screen.width,Pe.screenHeight=screen.height,Pe.screenUnit="px",Pe.orientation=Be,Pe.isTouchDown=!1,Pe.useFocus=!1,Pe.disableResize=!1,Pe.settingList=[];let Ke=!1;async function Xe(e){if(Pe.currentY=0,document){let e=globalThis.scene;document.onfullscreenchange=document.onwebkitfullscreenchange=()=>{Pe.settingList.forEach((t=>{if(t&&e){let i=e[t.id];if(i){let e=i.game&&i.game.sysTray;ke(e);let t=i.localEvent;if(t&&t.fullscreen){let i=e&&e.isFullscreen;t.fullscreen(i)}}}})),f.redraw()},document.onfullscreenerror=document.onwebkitfullscreenerror=()=>{Pe.settingList.forEach((t=>{if(t&&e){let i=e[t.id];if(i){let e=i.game&&i.game.sysTray;ke(e);let t=i.localEvent;if(t&&t.fullscreen){let i=e&&e.isFullscreen;t.fullscreen(i)}}}})),f.redraw()}}if(!n.isCheckGameCDN&&j.any()?(Ke||(screen&&screen.orientation&&screen.orientation.addEventListener?screen.orientation.addEventListener("change",je):globalThis.addEventListener("orientationchange",je)),Pe.isMobile=!0,Fe=Se,j.iOS()?(globalThis.parent===window&&(Pe.currentY=200),Pe.ios=!0,Fe=null):j.Android()&&(globalThis.parent===window&&(Pe.currentY=200),Fe=null)):Pe.isMobile=!1,e&&(Pe.useOrientation=!1,Pe.usePortrait=!1,Pe.useLandscape=!1,Pe.isMobile&&("string"==typeof e.orientation&&("portrait"===e.orientation?(Pe.usePortrait=!0,Pe.orientation.name="portrait"):(Pe.useLandscape=!0,Pe.orientation.name="landscape"),Pe.useOrientation=!0),Ne=null,Pe.useFullscreen=!1,j.iOS()?navigator.userAgent.match(/baidu/i)?(Ne=ye,Pe.screenUnit="px",Pe.useFullscreen=!1):navigator.userAgent.match(/CriOS/i)?(Ne=oe,Pe.screenUnit="px",Pe.useFullscreen=!1):navigator.userAgent.match(/LieBao|ACHEETAHI/i)?(Ne=Le,Pe.screenUnit="px",Pe.useFullscreen=!1):navigator.userAgent.match(/FxiOS/i)?(Ne=he,Pe.screenUnit="px",Pe.useFullscreen=!1):navigator.userAgent.match(/Safari/i)?(Ne=fe,Pe.screenUnit="px",Pe.useFullscreen=!1):navigator.userAgent.match(/UCB/i)?(Ne=ue,Pe.screenUnit="px",Pe.useFullscreen=!1):Ne=Ee:j.Android()&&(navigator.userAgent.match(/OPR/i)?(Ne=X,Pe.screenUnit="px",Pe.useFullscreen=!1,navigator.userAgent.match(/baidu/i)?Ne=ee:navigator.userAgent.match(/LieBao|ACHEETAHI/i)&&(Ne=ie,Pe.screenUnit="px",Pe.useFullscreen=!1)):navigator.userAgent.match(/baidu/i)?(Ne=ee,Pe.screenUnit="px",Pe.useFullscreen=!1):navigator.userAgent.match(/LieBao|ACHEETAHI/i)?(Ne=ie,Pe.screenUnit="px",Pe.useFullscreen=!1):navigator.userAgent.match(/Firefox/i)?(Ne=q,Pe.screenUnit="px",Pe.useFullscreen=!1):navigator.userAgent.match(/UCB/i)?(Ne=Q,Pe.screenUnit="px",Pe.useFullscreen=!1):navigator.userAgent.match(/Chrome/i)?(Pe.useFullscreen=!1,Pe.screenUnit="px",Ne=G):Ne=se),navigator.userAgent.match(/(UBiOS|Pad|Tablet|KFAUW|Mb2345|ME173X|NRD90M|VIE|N2G47H)/i)&&(Pe.useFullscreen=!1,Pe.screenUnit="px"),Ne&&(Ne.value.state=Pe),Ke||globalThis.addEventListener("focus",(()=>{Pe.useFocus&&(Pe.isTouchOnce=!0,Pe.useFocus=!1,De(!0))}),!0),ze(),De(!0),Pe.settingList.forEach((e=>{if(e)return e.isLock?void Ve(e):(He(e),!0)})),Pe.isFullscreen=!0,Pe.isTouchDown=!1,Pe.isTouchOnce=!0)),n.mobileMode){let e=n.mobileMode;parseInt(e)>0&&(Pe.isFullscreen=!0,Pe.isTouchDown=!1,Pe.isTouchOnce=!0)}document.body.onscroll=()=>{!Pe.isMobile||Pe.orientation.isTrigger||Pe.isResize||Pe.disableResize||globalThis.parent===window&&Pe.isMobile&&(Pe.currentY=globalThis.pageYOffset,globalThis.scrollTo(0,Pe.currentY),f.redraw())},Ke||globalThis.addEventListener("resize",De),Ke=!0}var Je=Object.freeze({__proto__:null,__unload:()=>{screen&&screen.orientation&&screen.orientation.removeEventListener?screen.orientation.removeEventListener("change",je):globalThis.removeEventListener("orientationchange",je),globalThis.removeEventListener("resize",De)},addSetting:We,decSetting:Ge,eventResize:De,init:Xe,orientationChangeHandler:je,removeAllSetting:qe,setDisableResize:Ye,state:Pe});let Qe={oninit(e){let t=e.attrs;this.url=t.url,this.manager=t.manager,this.setting={id:"children",isLock:!1,useCenter:!1,left:"0%",top:"0%",width:"100%",height:"100%",game:{width:1024,height:1024},reference:{left:0,top:0,width:1,height:1}},We(this.setting)},oncreate(e){let t=e.instance.children[0].dom;b.updateManager.setTimeout((()=>{Ye(!0),t.focus()}),.2)},view(){let e=this,i=e.setting;return f(".rwdPanelHeader",{style:{position:"absolute",left:i.left,top:i.top,backgroundColor:"rgba(0,0,0,1)",zIndex:950,opacity:1,width:i.width,height:i.height}},f("iframe",{src:e.url,scrolling:"yes",frameborder:0,style:{position:"absolute",left:"0%",top:"0%",width:"100%",height:"100%"}}),f(".fl.tc.pv4.bg-black.hover-bg-gray",{style:{position:"absolute",left:"5%",top:"0%",width:"90%",height:"10%",opacity:.75,cursor:"pointer"},onclick(){Ye(!1),e.manager.childrenVisible=!1,e.url=""}},f(".inline-flex.white.border-box.pointer",`${t("close")}`)))}},Ze={engine:null},et={engine:null},tt={engine:null},it=!1;async function nt(e){return new Promise(((t,i)=>{let n=document.createElement("script");n.type="text/javascript",n.src=e,n.onload=()=>{t()},n.onerror=()=>{i()},document.body.appendChild(n)}))}let st=!1;async function at(e){let t,i,s,a,r={},o=e;return e.useModule?(s=await import("pixi.js"),a=await import("pixi-spine")):(await async function(){if(st)return;let e,t="/dependence/";n.selectCDN&&(t=`${globalThis.BASE_URL}dependence/`),e=["pixi/pixi.min.6.5.9.js"];let i=[];for(let n=0;n<e.length;n++){let s=nt(t+e[n]);i.push(s)}await Promise.all(i);let s=["pixi/pixi-spine.2.0.5.js"];i=[];for(let e=0;e<s.length;e++){let n=nt(t+s[e]);i.push(n)}await Promise.all(i),st=!0}(),s=globalThis.PIXI,a=globalThis.PIXI.spine),i=s.Renderer?new s.Renderer(o):new s.WebGLRenderer(o),t=new s.Container,r.stage=t,r.overlay=new s.Container,r.foreground=new s.Container,r.main=new s.Container,r.background=new s.Container,t.addChildAt(r.overlay,0),t.addChildAt(r.foreground,0),t.addChildAt(r.main,0),t.addChildAt(r.background,0),{PIXI:s,spine:a,renderer:i,stage:t,layer:r,render(){i.render(t)}}}function rt(e){let t,i=e[0],n=1;for(;n<e.length;){const s=e[n],a=e[n+1];if(n+=2,("optionalAccess"===s||"optionalCall"===s)&&null==i)return;"access"===s||"optionalAccess"===s?(t=i,i=a(i)):"call"!==s&&"optionalCall"!==s||(i=a(((...e)=>i.call(t,...e))),t=void 0)}return i}const ot=0,lt=6,ct=1,ht=3,gt=4,dt=5;let ut={oninit(){this.options={}},async oncreate(a){let r=this;r.isIframeLoaded=!1,r.isIframeInit=!1;let g,d=Math.round(performance.now());r.timestamp=d,r.checkItem=null;let u={isFirstTime:!0,useVideo:!1,isCheckData:!1,isChild:!1,isGame:!0,isCreate:!1,isBusy:!0,rendered:null,disable:!0,sysTray:null,trayVisible:!1,childrenVisible:!1,currentUrl:"",useCenter:!0,position:"absolute",left:"25%",top:"25%",width:"50%",height:"50%"},m={state:{visible:!0},sound:{isMute:!1},music:{isMute:!1},screen:{isAutoScale:!0,isLock:!1},isLock:!1,isFullscreen:!1};Object.prototype.hasOwnProperty.call(m,"visible")||Object.defineProperty(m,"visible",{get:()=>m.state.visible,set(e){u.mode!==o.DEMO&&(m.state.visible=e,u.sysTray&&(e?(u.sysTray.isMenu=!1,u.sysTray.visible=!0):(u.sysTray.isMenu=!1,u.sysTray.visible=!1),f.redraw()))}});let p=null,y=null,v=r.options,x=a.attrs;if(r.currentBaseURL=null,x&&(p=x.gameManager,r.checkItem=x.checkItem,r.currentBaseURL=x.currentBaseURL,u.left=x.left||"25%",u.top=x.top||"25%",u.width=x.width||"50%",u.height=x.height||"50%",u.reference=x.reference,u.fix=x.fix,u.isChild=x.isChild,u.isCheckData=x.isCheckData,x.sysTray?u.sysTray={visible:!0,isMenu:!1,flags:x.sysTray.flags,style:{left:x.sysTray.left||"0px",top:x.sysTray.top||"0px"}}:u.sysTray=null,g=x.config,r.ctrlEvent=x.ctrlEvent),m.visible=!1,!g)return;let L=s();u.isCreate=g.isCreate,u.templateVersion=g.scene.templateVersion,"slot.2.1"===u.templateVersion&&"en-us"===s()&&(L="en"),u.id=g.id,u.mode=g.mode,u.name=g.scene.name[L],u.group=g.scene.group||"game",u.appName=g.scene.app,u.appHash=g.scene.appHash,u.appConfig=g.scene.appConfig,u.devMode=g.scene.devMode,u.dependence=g.scene.dependence,u.background=null,u.backgroundCSS=null,r.appTimeout=i?null:b.updateManager.setTimeout((()=>{v.initGame=null,r.appTimeout=null,f.redraw(),b.updateManager.setTimeout((()=>{n.requestReload=!1,n.isReload=!0,l.reload({url:r.currentBaseURL,group:u.group,game:u.appConfig})}),.1)}),10);let C=`${u.group}${u.appConfig}`,T={category:"遊戲程式 "+(r.currentBaseURL||"主網址"),getLabel:()=>C},E={category:"遊戲場景 "+(r.currentBaseURL||"主網址"),getLabel:()=>C},k={category:"建立遊戲 "+(r.currentBaseURL||"主網址"),getLabel:()=>C};n.isCheckGameCDN||(e.loadBegin(k),e.loadBegin(T)),u.anim={element:null,isPlay:!1},u.display="inline",u.opacity=0,u.zIndex=1,x.updateStyle&&x.updateStyle(u);let R=g.scene.images;n.useAvif?R.v2&&(R=R.v2):R.v1&&(R=R.v1),u.game={id:g.id,group:g.scene.group,mode:g.mode,decimal:g.decimal,name:u.name,logo:R&&R.logo,theOther:g.scene.theOther,version:g.scene.version,baseURL:g.scene.baseURL||"",langID:L},R&&Object.prototype.hasOwnProperty.call(R,"useBackground")&&R.background&&(u.isCheckData||(u.background=`${u.game.baseURL}${R.background}`),"string"==typeof R.useBackground?u.backgroundCSS=`${R.useBackground}`:(R.useBackground,u.backgroundCSS=null)),g.scene.theOther&&g.scene.theOther.id&&(u.game.theOther=g.scene.theOther.id),g.scene.screen&&(u.isLock=g.scene.screen.isLock,u.game.width=g.scene.screen.width||640,u.game.height=g.scene.screen.height||960,u.game.portrait=g.scene.screen.portrait,u.game.landscape=g.scene.screen.landscape,Pe.isMobile,m.isLock=u.isLock),u.images=R,u.isCheckData||We(u);let O=null,I=g.loadingEvent,M=l.getManager(),$=null,U=M.scene[u.id]={templateVersion:u.templateVersion,state:ot,event:{create:null,play:null,pause:null,enter:null,leave:null,focus:null,blur:null,lock:null,fullscreen:null,resize:null,music:null,sound:null},info:{isChild:u.isChild,baseURL:u.game.baseURL||"",id:u.game.id,name:u.game.name,group:u.game.group,theOther:u.game.theOther,width:u.game.width,height:u.game.height,decimal:u.game.decimal,mode:u.game.mode,langID:u.game.langID},gamecard:g.scene,loadingEvent:{title:u.name,start(){n.isCheckGameCDN||e.loadBegin(E),I.start&&I.start()},resBegin(e){I.resBegin&&I.resBegin(e)},resEnd(e){I.resEnd&&I.resEnd(e)},sceneResBegin(e){I.sceneResBegin&&I.sceneResBegin(e)},sceneResLoading(e){I.sceneResLoading&&I.sceneResLoading(e)},sceneResEnd(e){I.sceneResEnd&&I.sceneResEnd(e)},finish(){U.state=gt,n.isCheckGameCDN||(e.loadEnd(E),e.log({label:C,category:"遊戲場景 "+(r.currentBaseURL||"主網址")}),e.loadEnd(k)),I.finish&&I.finish(U)}},callWeb(e){"string"==typeof e?M.document&&M.document.location&&M.document.location.replace?M.document.location.replace(e||"about:blank"):M.location.href=e||"about:blank":l.showInfo(e)},open(e){u.childrenVisible=!0,u.currentUrl=e,f.redraw()},setDisableResize(e){Ye(e)},createTheOther(e,t=0){p.create(e,t)},destroyTheOther(e){p.destroy(e),M.scene[e]=null},callTheOther(e,t){let i,n=!1,s=M.scene[e];return s&&s.state===gt&&(U.game.debug=!1,U.state=gt,U.info.isChild?(U.localEvent.pause(),U.localEvent.hide()):U.localEvent.pause(),i=t||{what:" is this ?"},i.from=U.info.id,n=!0,s.localEvent.pause(),s.state=dt,s.templateVersion,s.setting.background=t&&t.background||"rgba(0,0,0,0)",s.localEvent.show(),s.localEvent.play(i)),n},checkTheOther(e){let t=!1,i=M.scene[e];return i&&i.state===gt&&(t=!0),t},getTheOther:e=>M.scene[e],reload(e){if(n.isReload)return;l.hideInfo(),n.isReload=!0;let t=e;t||(t={game:u.appConfig,group:u.group}),U.game.stop(),U.game.reset();p.clean(),b.updateManager.setTimeout((()=>{for(let e=0;e<globalThis.frames.length;e+=1){let t=globalThis.frames[e];if(t){let e=t.document;e&&(e.documentElement.innerHTML="")}}v.initGame=null,U.game=null,r.ctrlEvent&&r.ctrlEvent.reload&&r.ctrlEvent.reload(),f.redraw(),b.updateManager.setTimeout((()=>{p.reload().then((()=>{F(t.game,t.group,r.currentBaseURL,t.version).then((i=>{i&&i.gameCard&&(i.gameCard.reloadConfig=e,p.init({gameCard:i.gameCard,id:t.game,group:t.group}))}))}))}),.01)}),.05)},leave(e){},setMode(e){let i=o;c.mode=e,c.mode===i.REAL?v.info.mode=t("gameModeReal"):v.info.mode=t("gameModeDemo"),f.redraw()},async fullscreen(e){if(e||!ke())try{return await Re(m)}catch(e){}},ready(t){if(!U.game&&t&&(U.game=t),r.appTimeout&&(b.updateManager.remove(r.appTimeout),r.appTimeout=null),n.isCheckGameCDN||(e.loadEnd(T),e.log({label:C,category:"遊戲程式 "+(r.currentBaseURL||"主網址")})),r.checkItem){let e=r.checkItem,t=Math.round(performance.now());e.timeInit=t-r.timestamp,r.timestamp=t,e.state="app",e.timeReady=t-e.timestamp,e.timestamp=t,f.redraw(),e.ready&&e.ready(e)}$(U.game).then((()=>{if(U.game){let t={error(t){e.error({label:C,category:t})},log(t){"string"==typeof t?e.log({label:C,category:t}):t&&(t.label=C,e.log(t))},serviceBegin(t){if(t){if(t.getLabel=()=>C,!t.category)return;e.serviceBegin(t)}},serviceEnd(t){if(t){if(t.getLabel=()=>C,!t.category)return;e.serviceEnd(t)}},loadBegin(t){if(t){if(t.getLabel=()=>C,!t.category)return;e.loadBegin(t)}},loadEnd(t){if(t){if(t.getLabel=()=>C,!t.category)return;e.loadEnd(t)}}};U.game.report=t,U.game.localforage=w}u.isBusy=!1,u.isCreate&&U.event&&U.event.create?(i&&(U.info.console=console),U.info.setting=n,U.event.create(U.info),U.state=ct):U.state=ht}))},graphReady(){U.ready()},setOverviewVisible(e){U.gamecard.manual&&U.gamecard.manual.overview&&(p.currentGame.overview.visible=e,f.redraw())},setEvent(e){let t=U.event;t.create=e.create||t.create,t.play=e.play||t.play,t.pause=e.pause||t.pause,t.enter=e.enter||t.enter,t.leave=e.leave||t.leave,t.focus=e.focus||t.focus,t.blur=e.blur||t.blur,t.lock=e.lock||t.lock,t.fullscreen=e.fullscreen||t.fullscreen,t.resize=e.resize||t.resize,t.music=e.music||t.music,t.sound=e.sound||t.sound}};U.state=lt;let _=!1,A=null,B=null,N=null;async function S(e){if(N={imports:{},scopes:{}},e)try{N.imports.nuts=import.meta.resolve("nuts"),N.imports.mithril=import.meta.resolve("mithril"),N.imports.tweenjs=import.meta.resolve("tweenjs"),N.imports["pixi.js"]=import.meta.resolve("pixi.js"),N.imports["pixi-spine"]=import.meta.resolve("pixi-spine"),N.imports["apng-js"]=import.meta.resolve("apng-js"),N.imports["video/domains"]=import.meta.resolve("video/domains"),N.imports["video/photos"]=import.meta.resolve("video/photos")}catch(e){}if(i){A=`${n.projectURL}${u.group}/${u.appConfig}/`,B=`${u.group}/${u.appConfig}`;let e=await import("js-yaml");e.default&&(e=e.default);let t=`${A}system.set.yml`,i=await fetch(t);if(i.ok){let t=await i.text(),s=e.load(t);if(s.package.skipRollup&&(_=!0),_){N.imports[B]=`${u.game.baseURL}${s.package.main}`;let e=Object.getOwnPropertyNames(s.config.paths),t={};e.forEach((e=>{let i=s.config.paths[e];"/"===i[0]?t[e]=i:t[e]=`${n.projectURL}${i}`})),N.scopes[A]=t}}}}$=async e=>{let t=globalThis.location.origin;r.currentBaseURL&&(t=r.currentBaseURL),u.game.baseURL.length>0&&(t=u.game.baseURL);let s=t;s.length>0&&"/"===s[s.length-1]&&(s=s.substring(0,s.length-1));let a=u.appName;if("object"==typeof a&&(a=u.appName[u.game.langID],a||(a=u.appName[h.EN_US])),a){let e=a.split("/"),t=e.length-1;s=t>2?`${s}/${e[t-1]}/${e[t]}`:`${s}/${a}`}if(await S(),"game.6.0"===u.templateVersion){if(e.getRenderer){let t=U.gamecard.pixiConfig;e.getRenderer().resize(t.width,t.height)}let t;if(e.layer.overlay.removeChildren(),e.layer.foreground.removeChildren(),e.layer.main.removeChildren(),e.layer.background.removeChildren(),e.play(),e.scene=U,i&&N&&importShim){importShim.addImportMap(N);importShim.getImportMap()}if(i&&_)try{let e=import.meta.resolve(B);t=await import(e)}catch(e){t=await import(s)}else t=await import(s);let a=await t.scene.init({setting:n,baseURL:U.info.baseURL,isChild:U.info.isChild,langID:U.info.langID,gamecard:U.gamecard,game:e,nuts:b}),r={create(t){M.lobby&&(e.currentUser=M.lobby.currentUser,e.command=M.lobby.net.gameCommand,e.lobby={setEvent:M.lobby.setEvent,setCommand:M.lobby.net.setLobbyCommand,CMD:M.lobby.net.CMD}),a.create&&(t.game=e,t.setting=n,a.create(t))},play(t){e.play(),a.play&&(t.game=e,t.setting=n,a.play(t))},pause(t){e.pause(),a.pause&&(t.game=e,t.setting=n,a.pause(t))},enter(t){a.enter&&(t.game=e,t.setting=n,a.enter(t))},leave(t){a.leave&&(t.game=e,t.setting=n,a.leave(t))},focus(){a.focus&&a.focus()},blur(){a.blur&&a.blur()},lock(e){a.lock&&a.lock(e)},fullscreen(e){a.fullscreen&&a.fullscreen(e)},resize(e){a.resize&&a.resize(e)},music(e){a.music&&a.music(e)},sound(e){a.sound&&a.sound(e)}};U.setEvent(r),U.game=e}else if("game.5.0"===u.templateVersion){let t;if(Object.defineProperty(e,"scene",{get:()=>U}),i&&N&&importShim){importShim.addImportMap(N);importShim.getImportMap()}if(i&&_)try{let e=import.meta.resolve(B);t=await import(e)}catch(e){t=await import(s)}else t=await import(s);let a=await t.scene.init({setting:n,baseURL:U.info.baseURL,isChild:U.info.isChild,langID:U.info.langID,gamecard:U.gamecard,game:e,nuts:b}),r={create(t){M.lobby&&(e.currentUser=M.lobby.currentUser,e.command=M.lobby.net.gameCommand,e.lobby={setEvent:M.lobby.setEvent,setCommand:M.lobby.net.setLobbyCommand,CMD:M.lobby.net.CMD}),a.create&&(t.game=e,t.setting=n,a.create(t))},play(t){e.play(),a.play&&(t.game=e,t.setting=n,a.play(t))},pause(t){e.pause(),a.pause&&(t.game=e,t.setting=n,a.pause(t))},enter(t){a.enter&&(t.game=e,t.setting=n,a.enter(t))},leave(t){a.leave&&(t.game=e,t.setting=n,a.leave(t))},focus(){a.focus&&a.focus()},blur(){a.blur&&a.blur()},lock(e){a.lock&&a.lock(e)},fullscreen(e){a.fullscreen&&a.fullscreen(e)},resize(e){a.resize&&a.resize(e)},music(e){a.music&&a.music(e)},sound(e){a.sound&&a.sound(e)}};U.setEvent(r),U.game=e}};let z={isActive:!0,create(e){e.isCreate&&rt([U,"access",e=>e.event,"optionalAccess",e=>e.create])&&(i&&(U.info.console=console),U.info.setting=n,U.event.create(U.info),U.state=ct)},async enter(t){let i=t||{};i.from||(i.from=U.info.id),i.id||(i.id=u.game.id),i.game||(i.game=U.game),n.isInGame=!0,Pe.isMobile&&(u.isChild||globalThis.scrollTo(0,Pe.currentY)),u.isFirstTime&&(u.isFirstTime=!1),U.game&&(M.lobby&&(U.game.command=M.lobby.net.gameCommand,U.game.table=M.lobby.table[i.id],U.game.currentUser=M.lobby.currentUser),U.game.sysTray=m,U.game.getLCS=async function(){return null},U.game.scanLCS=async function(e){let t={name:"串流服務",category:"檢測串流",getLabel:()=>C},i=await import("./agent.9eaed77d.js");return await i.scan(e,t)},U.game.getProject=async function(e,t){const i=await import("./agent.d2f514a0.js");return await i.getProject(e,t)},U.game.getPlayer=async function(){let e=await import("./agent.af20a91c.js");return await e.getLib(),e.player},U.game.getIP=e.getIP),z.show({finish(){rt([U,"access",e=>e.event,"optionalAccess",e=>e.enter])&&(i.setting=n,U.event.enter(i)),z.blur&&z.blur(),De(!0);let e=null,t=M.scene[U.info.theOther];if(U.info.isChild||t||!U.info.theOther||(U.info.theOther,U.info.theOther.length>0?e={id:U.info.theOther,group:U.info.group}:"object"==typeof U.info.theOther&&(e={id:U.info.theOther.id,group:U.info.theOther.group})),null!==e){let t={style:{position:"absolute",left:"0%",top:"0%",width:"100%",height:"100%"},reference:{left:0,top:0,width:1,height:1},groupName:e.group,id:e.id,sceneID:e.id,loadingEvent:{start(){},resBegin(){},resEnd(){},sceneResBegin(){},sceneResLoading(){},sceneResEnd(){},finish(e){e.localEvent.pause(),e.localEvent.hide()}}};U.createTheOther(t)}}})},leave(e){let t=e||{};t.from||(t.from=U.info.id),t.game||(t.game=U.game),rt([U,"access",e=>e.event,"optionalAccess",e=>e.leave])&&(t.setting=n,U.event.leave(t))},play(e){let t=e||{};t.from||(t.from=U.info.id),t.game||(t.game=U.game),rt([U,"access",e=>e.event,"optionalAccess",e=>e.play])&&(t.setting=n,U.event.play(t)),U.state=dt,De(!0)},pause(e){let t=e||{};t.from||(t.from=U.info.id),t.game||(t.game=U.game),rt([U,"access",e=>e.event,"optionalAccess",e=>e.pause])&&(t.setting=n,U.event.pause(t)),U.state=gt},focus(){z.isActive||(z.isActive=!0,rt([U,"access",e=>e.event,"optionalAccess",e=>e.focus])&&U.event.focus())},blur(){z.isActive&&(z.isActive=!1,rt([U,"access",e=>e.event,"optionalAccess",e=>e.blur])&&U.event.blur())},updateBlur(e){e&&e!==z&&z.blur();let t=x.objList;t&&Array.isArray(t)&&t.forEach((t=>{if(t){let i=t.attrs.localEvent;e!==i&&i&&i.blur&&i.blur()}}))},lock(e){u.isLock=e,u.left=x.left||"25%",u.top=x.top||"25%",u.width=x.width||"50%",u.height=x.height||"50%";let t=M.scene[U.info.theOther];t&&t.localEvent.lock(e),De(!0),rt([U,"access",e=>e.event,"optionalAccess",e=>e.lock])&&U.event.lock(e)},fullscreen(e){rt([U,"access",e=>e.event,"optionalAccess",e=>e.fullscreen])&&U.event.fullscreen(e)},resize(e){rt([U,"access",e=>e.event,"optionalAccess",e=>e.resize])&&U.event.resize(e)},music(e){rt([U,"access",e=>e.event,"optionalAccess",e=>e.music])&&U.event.music(e);let t=M.scene[U.info.theOther];t&&t.localEvent.music(e)},sound(e){rt([U,"access",e=>e.event,"optionalAccess",e=>e.sound])&&U.event.sound(e);let t=M.scene[U.info.theOther];t&&t.localEvent.sound(e)},show(e){let t=u.anim;if(t.element){if(t.isPlay&&(t.isPlay=!1),u.display="inline",u.disable=!1,u.zIndex=4,u.opacity=1,e){if(e.style){let t=e.style;u.zIndex=t.zIndex||4}e.finish&&e.finish()}x.updateStyle&&x.updateStyle(u),f.redraw()}},hide(e){let t=u.anim;if(t.element){if(t.isPlay&&(t.isPlay=!1),u.disable=!0,u.display="none",u.zIndex=2,u.opacity=0,e){if(e.style){let t=e.style;u.zIndex=t.zIndex||2}e.finish&&e.finish()}x.updateStyle&&x.updateStyle(u),f.redraw()}}};U.localEvent=z,U.setting=u,v.onfocus=onfocus,v.initGame=async function(e){u.anim.element=e.dom},v.event=z,v.setting=u,v.tray=m,v.objList=x.objList,v.updateStyle=x.updateStyle;let j=f(".");if("game.6.0"===u.templateVersion){let e=U.gamecard.pixiConfig;e&&(y=e.useModule?et:tt,y.engine||(e.view=y.canvas,y.engine=await at(e),y.game.setEngine(y.engine)),j=f({oninit(){},oncreate(e){e.dom.appendChild(y.canvas),U.ready&&U.ready(y.game)},onremove(e){e.dom.removeChild(y.canvas)},view:()=>f(".",{style:{position:"absolute",left:"0px",top:"0px",width:"100%",height:"100%"}})}))}else"game.5.0"===u.templateVersion?U.gamecard.pixiConfig&&(j=[f(b.components.game.pixi,{id:u.id,style:{position:"absolute",left:"0px",top:"0px",width:"100%",height:"100%"},config:U.gamecard.pixiConfig,ready:U.ready})]):j=[f("iframe",{style:{position:"absolute",left:"0px",top:"0px",width:"100%",height:"100%"},scrolling:"no",frameborder:0,oncreate:async function(e){await S(!0),O=e.dom,O.scrolling="no",O.frameborder=0;let t=O.style;if(t.width="100%",t.height="100%",t.left="0%",t.top="0%",t.position="absolute",u.isChild||(t.zIndex=2,t.display="inline"),r.isIframeInit)return;r.isIframeInit=!0,v.info.iframe=O;let s=u.id,a=u.name,o=u.group,c=u.appName,g=u.appConfig||s,d=u.devMode,m=u.background,p=u.dependence,w=null;if("object"==typeof c&&(c=u.appName[u.game.langID],c||(c=u.appName[h.EN_US])),"game.4.0"===u.templateVersion){let e=globalThis.location.origin;if(r.currentBaseURL&&(e=r.currentBaseURL),u.game.baseURL.length>0&&(e=u.game.baseURL),w={importmapName(){let e=`"${this.key}": "${this.value}"`;return this.isLast||(e+=","),e},scopemapName(){let e=`"${this.key}": "${this.value}"`;return this.isLast||(e+=","),e},appName(){let t=e;if(t.length>0&&"/"===t[t.length-1]&&(t=t.substring(0,t.length-1)),c){let e=c.split("/"),i=e.length-1;t=i>2?`${t}/${e[i-1]}/${e[i]}`:`${t}/${c}`}return i&&_&&(t=B),t},appIntegrity:"",id:s,name:a,group:o,jsName(){let e,t=globalThis.location.origin;return r.currentBaseURL&&(t=r.currentBaseURL),t&&t.length>0&&"/"===t[t.length-1]&&(t=t.substring(0,t.length-1)),e=`<script src="${t}${this.pathname}"  crossorigin><\/script>`,e},background:m},p){let e=[],t=p;Object.getOwnPropertyNames(t).forEach((i=>{let n=t[i],s={};"string"==typeof n?(s.key=i,s.pathname=n):(s.key=i,s.pathname=n.pathname,s.integrity=n.integrity),e.push(s)})),e.length>0&&(e[e.length-1].isLast=!0),w.globalmap=e}if(N){let e,t=[];e=Object.getOwnPropertyNames(N.imports),e.forEach((e=>{let i={},n=N.imports[e];i.key=e,i.value=n,t.push(i)})),t.length>0&&(t[t.length-1].isLast=!0),w.importmap=t,w.scopeName=A,t=[];let i=N.scopes[A];i&&(e=Object.getOwnPropertyNames(i),e.forEach((e=>{let n={},s=i[e];n.key=e,n.value=s,t.push(n)})),t.length>0&&(t[t.length-1].isLast=!0)),w.scopemap=t}w.jsImportShim='<script async src="/systemjs/es-module-shims.wasm.1.7.3.js"><\/script>',i&&_?(w.moduleType="-shim",w.shimOptions="\n<script  crossorigin=\"anonymous\">\nwindow.esmsInitOptions = {\nshimMode: true, // default false\nnoLoadEventRetriggers: true, // default false\nmapOverrides: true, // default false\n\n// -- Hooks --\n// Module load error\nonerror (e) {  \n  console.log('[shims] onerror', e);\n},\n\n// resolve (id, parentUrl, resolve) {\n//   console.log('[shims] resolve ', id, parentUrl);\n//   resolve(id, parentUrl);\n// },\n\nfetch (url, options) {\n  let str = url;\n  let index = url.lastIndexOf('/');\n  let filename = url.substring(index+1);\n  index = filename.lastIndexOf('.');\n  if(index < 0) {\n    url = url + '.js';\n    filename += '.js';\n  } else {\n    let ext = filename.substring(index+1);\n    // console.log(index, ext);\n  }\n  console.log('[shims] filename', filename);\n  return fetch(url, options);\n},\n\n// meta (meta, url) {\n//   console.log('[shims] meta', meta, url);\n// },\n// onimport (url, options, parentUrl) {\n//   console.log('[shims] onimport', url, options, parentUrl);\n// }\n}\n<\/script>\n"):w.moduleType="-shim",u.rendered=l.Mustache.render(l.getGameTemplate(u.templateVersion),w)}else if("game.3.0"===u.templateVersion){let e=globalThis.location.origin;r.currentBaseURL&&(e=r.currentBaseURL);let t=e;if(t&&t.length>0&&"/"===t[t.length-1]&&(t=t.substring(0,t.length-1)),w={appName(){let e=t;return e="debug"===d?`${e}/${c}`:`${e}/${n.projectURL}${c}`,e},appIntegrity:"",id:s,name:a,group:o,jsName(){let e,i=`${t}${this.pathname}`,n="";return this.integrity&&(n=`integrity="${this.integrity}"`),this.isLast,e=`<script src="${i}" ${n} crossorigin><\/script>`,e},background:m},p){let e=[],t=p;Object.getOwnPropertyNames(t).forEach((i=>{let n=t[i],s={};"string"==typeof n?(s.key=i,s.pathname=n):(s.key=i,s.pathname=n.pathname,s.integrity=n.integrity),e.push(s)})),e.length>0&&(e[e.length-1].isLast=!0),w.importmap=e}u.rendered=l.Mustache.render(l.getGameTemplate(u.templateVersion),w)}else if("game.2.0"===u.templateVersion){let e=globalThis.location.origin;r.currentBaseURL&&(e=r.currentBaseURL);let t=e;t&&t.length>0&&"/"===t[t.length-1]&&(t=t.substring(0,t.length-1)),w={appName:c,id:s,name:a,group:o,importmapName(){let e=t;r.currentBaseURL&&(this.pathname=this.pathname.replace(n.projectURL,"/"));let i,s=`${e}${this.pathname}`;return i=`"${this.key}": "${s}"`,this.isLast||(i+=","),i},systemjsURL(){let e=`${t}/`;return e=r.currentBaseURL?`${e}systemjs/6.14.1/system.min.js`:"/systemjs/6.14.1/system.min.js",e},background:m};let i=[];if(w.importmap=i,p){let e=p;Object.getOwnPropertyNames(e).forEach((t=>{let s=e[t],a={};"string"==typeof s?(a.key=t,a.pathname=s):(a.key=t,r.currentBaseURL?a.pathname=s.pathname.replace(n.projectURL,"/"):a.pathname=s.pathname,a.integrity=s.integrity),i.push(a)}))}if(w.appName=`${o}-${s}`,"debug"===d){i.push({key:`${o}-${s}`,pathname:`${c}`});let t=e;t&&t.length>0&&"/"===t[t.length-1]&&(t=t.substring(0,t.length-1)),w.appName=`${t}${c}`}else{let t=e;r.currentBaseURL?(i.push({key:`${o}-${s}`,pathname:`/${c}`}),w.appName=`${t}${c}`):(i.push({key:`${o}-${s}`,pathname:`${n.projectURL}${c}`}),w.appName=`${t}${n.projectURL}${c}`)}i.length>0&&(i[i.length-1].isLast=!0),u.rendered=l.Mustache.render(l.getGameTemplate(u.templateVersion),w)}else if("slot.2.1"===u.templateVersion){let e="";r.currentBaseURL&&(e=r.currentBaseURL);let t=e;t&&t.length>0&&"/"===t[t.length-1]&&(t=t.substring(0,t.length-1));let i="";w={appName(){let e=t;return e=""===t?`${c}`:r.currentBaseURL?`${e}/${c}`:`${e}${n.projectURL}${c}`,e},systemjsURL(){let e=`${t}/`;return e=`${e}systemjs/system.js`,e},appConfig:()=>i,id:s,name:a,group:o,background:m},U.info.langID=u.game.langID;let h=n.projectURL;r.currentBaseURL&&(h="/");let d=`${t}${h}config/${o}/${g}/browser.config.js`;""===t&&(d=`config/${o}/${g}/browser.config.js`),fetch(d,{headers:{"Content-Type":"text/plain"}}).then((e=>e.ok?e.text():null)).then((e=>{if(!e)return null;if(i=new String(e),""!==t){let e=`${t}/dependence/`;r.currentBaseURL&&(e=`${r.currentBaseURL}dependence/`),i=i.replace("dependence/",e)}u.rendered=l.Mustache.render(l.getGameTemplate(u.templateVersion),w),O.src="data/template/9ef1c941a7edfbb9.html",O.addEventListener("load",(()=>{if(!r.isIframeLoaded&&(r.isIframeLoaded=!0,b.updateManager.setTimeout((()=>{let e=O.contentDocument||O.contentWindow.document;e.open(),e.write(u.rendered||"!!!! unknown template !!!!"),e.close()}),.05),r.checkItem)){let e=r.checkItem,t=Math.round(performance.now());e.timeOnload=t-r.timestamp,r.timestamp=t,e.state="web",f.redraw()}}),{capture:!0,once:!0})}))}if("slot.2.1"!==u.templateVersion){O.src="data/template/9ef1c941a7edfbb9.html";const e=()=>{if(!r.isIframeLoaded&&(r.isIframeLoaded=!0,b.updateManager.setTimeout((()=>{let e=O.contentDocument||O.contentWindow.document;e.open(),e.write(u.rendered||"!!!! unknown template !!!!"),e.close()}),.05),r.checkItem)){let e=r.checkItem,t=Math.round(performance.now());e.timeOnload=t-r.timestamp,r.timestamp=t,e.state="web",f.redraw()}};O.addEventListener("load",e,{capture:!0,once:!0})}}})];var H;v.gamePage=j,v.info={iframe:{},token:c.info.token,gameName:u.game.name,logo:u.game.baseURL+u.game.logo,version:u.game.version||"0.9.9",open(e){u.childrenVisible=!0,u.currentUrl=e,f.redraw()}},H=U.gamecard,P=H;let V=o;c.mode===V.REAL?v.info.mode=t("gameModeReal"):v.info.mode=t("gameModeDemo"),f.redraw()},onremove(){Ge(this.options.setting)},view(){let e,t=this.options,i=t.setting,s=t.objList||[];if(t.info&&t.info.iframe&&Pe.isMobile){t.info.iframe.style||(t.info.iframe.style={});let e=t.info.iframe.style;e.width=i.width,e.height=i.height}if(t.initGame){e=!i.isChild&&Pe.isMobile?(Pe.useFullscreen,{position:"absolute",left:"0px",top:Pe.currentY+"px",width:"100%",height:"100%",backgroundColor:"rgba(0,0,0,0)"}):{position:"absolute",left:"0px",top:"0px",width:"100%",height:"100%",backgroundColor:"rgba(0,0,0,0)"},i.isCheckData&&(e={left:"0%",top:"0%",width:"100%",height:"100%",backgroundColor:"rgba(0,0,0,0)"});let a="";return i.images.useBackground&&(a=i.background),f(".",{style:e},i.isChild?null:f(".center",{style:{overflowY:"hidden",position:"absolute",zIndex:1,top:"0%",left:"0%",width:`${globalThis.innerWidth}px`,height:`${globalThis.innerHeight}px`}},f(".aspect-ratio--object cover",{style:{background:`url(${a}) center`}})),f(".",{oncreate:t.initGame,style:{position:i.position,boxShadow:i.backgroundCSS,left:i.left,top:i.top,width:i.width,height:i.height,zIndex:i.zIndex||2,opacity:i.opacity,display:i.display}},t.gamePage,s.map((e=>e?(e.attrs.fix=i,e.attrs.updateBlur=t.event.updateBlur,f(e.com,e.attrs)):null)),i.sysTray&&i.sysTray.visible?f(Me,{style:i.sysTray.style,config:i.sysTray}):null,i.sysTray&&i.sysTray.isMenu?f($e,{tray:t.tray,event:t.event,info:t.info,config:i.sysTray}):null),i.childrenVisible?f(Qe,{url:i.currentUrl,manager:i}):null,n.msg.length>0?f(".",{style:{position:"absolute",color:"#fff",left:"50%",top:"0%",width:"64px",height:"16px",zIndex:900}},n.msg):null)}return f(".")}},mt={oninit(e){let t=e.attrs;this.options=t.options,this.saveConfig={}},oncreate(){},view(){let e=this.options,t=e.scene.pixiConfig,i=this.saveConfig;return f("article.pa4.white",f("form",[f("fieldset.ba.b--transparent.ph0.mh0",[f("legend.ph0.mh0.fw6.white","遊戲場景設定"),f(".mt3",f("label.db.fw4.lh-copy.f6","寬"),f("input.pa2.input-reset.ba.bg-transparent.w-40.red",{id:"width",name:"width",oninput(e){let n=e.target.value;i.width=parseInt(n),t.width=n},value:t&&t.width})),f(".mt3",f("label.db.fw4.lh-copy.f6","高"),f("input.b.pa2.input-reset.ba.bg-transparent.w-40.red",{id:"height",name:"height",oninput(e){let n=e.target.value;i.height=parseInt(n),t.height=n},value:t&&t.height})),f(".mt3",f("label.db.fw4.lh-copy.f6","解析度"),f("input.b.pa2.input-reset.ba.bg-transparent.w-40.red",{id:"resolution",name:"resolution",oninput(e){let n=e.target.value;i.resolution=parseFloat(n),t.resolution=n},value:t&&t.resolution})),f(".mt3",f("label.db.fw4.lh-copy.f6","是否反鋸齒"),f("input.b.pa2.input-reset.ba.bg-transparent.w-40.red",{id:"antialias",name:"antialias",oninput(e){let n=e.target.value;i.antialias=!1,"true"===n&&(i.antialias=!0),t.antialias=n},value:t&&t.antialias})),f(".mt3",f("label.db.fw4.lh-copy.f6","是否透明"),f("input.b.pa2.input-reset.ba.bg-transparent.w-40.red",{id:"transparent",name:"transparent",oninput(e){let n=e.target.value;i.transparent=!1,"true"===n&&(i.transparent=!0),t.transparent=n},value:t&&t.transparent})),f(".mt3",f("input.b.ph3.pv2.input-reset.ba.b--black.bg-transparent.grow.pointer.f6 white",{onclick(){Object.getOwnPropertyNames(i).forEach((e=>{t[e]=i[e]})),e&&e.ready&&(e.visible=!1,e.ready())},value:"確定"}))])]))}},pt=null,ft=null,bt={oninit(e){let t=this,i=e.attrs;t.style=i.style,t.options=i.options,t.resource=i.resource,t.timeout=null,t.isLeave=!1;let o={start(){},resBegin(){},resEnd(){},sceneResBegin(){},sceneResLoading(){t.timeout&&(b.updateManager.remove(t.timeout),t.timeout=null),t.isLeave||(t.timeout=b.updateManager.setTimeout((()=>{t.isLeave=!0,t.game&&(t.game.stop(),t.game=null),t.options&&t.options.ready&&t.options.ready();let e=r;a[e.OVERVIEW_ANIMATION]=!1,a[e.OVERVIEW_PROGRESS]=!0,f.redraw(),t.timeout=null}),5))},sceneResEnd(){},finish(){t.timeout&&(b.updateManager.remove(t.timeout),t.timeout=null)}};!async function(){if(!pt)try{let e=import.meta.resolve("scenes/loading");ft=e.substring(0,e.indexOf("scenes/loading")),ft+="scenes/loading",pt=await import(e)}catch(e){t.options&&t.options.ready&&t.options.ready();let i=r;return a[i.OVERVIEW_ANIMATION]=!1,a[i.OVERVIEW_PROGRESS]=!0,void f.redraw()}let e;try{e=await pt.scene.init({resName:"base",langID:s(),baseURL:ft,useAvif:n.useAvif})}catch(e){}e&&(t.resource.setting=e,We(e),t.pixiConfig=pt.scene.pixiConfig,Ze.engine||(t.pixiConfig.view=Ze.canvas,Ze.engine=await at(t.pixiConfig),Ze.game.setEngine(Ze.engine))),async function(e){e.resource=i.resource,e.play(),t.game=e;try{t.scene=await pt.scene.create(e,o,b)}catch(i){t.resource.setting&&Ge(t.resource.setting),e.stop(),t.options&&t.options.ready&&t.options.ready();let n=r;return a[n.OVERVIEW_ANIMATION]=!1,a[n.OVERVIEW_PROGRESS]=!0,void f.redraw()}t.options&&t.options.ready&&t.options.ready()}(Ze.game)}()},async oncreate(e){let t=this,i=e.dom;Ze.game&&Ze.game.layer&&(Ze.game.layer.background.removeChildren(),await Ze.game.idle(.01)),i.appendChild(Ze.canvas),t.resource.setting&&We(t.resource.setting)},onremove(e){let t=this;e.dom.removeChild(Ze.canvas),t.resource.setting&&Ge(t.resource.setting);let i=t.game;i&&i.stop()},view(){let e=this;return e.pixiConfig?f(".",{id:"loading9999",style:e.style}):f(".")}};function wt(e){let t,i=e[0],n=1;for(;n<e.length;){const s=e[n],a=e[n+1];if(n+=2,("optionalAccess"===s||"optionalCall"===s)&&null==i)return;"access"===s||"optionalAccess"===s?(t=i,i=a(i)):"call"!==s&&"optionalCall"!==s||(i=a(((...e)=>i.call(t,...e))),t=void 0)}return i}let yt,vt=r,xt={oninit(e){let s=this,r=e.attrs,o=r.setUpdateEvent;s.scene=r.scene,s.ready=r.ready,s.serve=r.serve,s.finish=r.finish,s.manager=r.manager;let l=a;if(!n.useOptions){let e=s.scene.options;if(e){l[vt.OVERVIEW_LOGO]=!1,//!!overview.logo;
g.isCheckGameCDN?l[vt.OVERVIEW_ANIMATION]=!1:l[vt.OVERVIEW_ANIMATION]=!0,l[vt.OVERVIEW_BACKGROUND]=!0,l[vt.OVERVIEW_PROGRESS]=!1;let t=e.game;t&&(l[vt.GAME_SCENE_CUSTOM]=!!t.custom,l[vt.GAME_PERFORMANCE_FPS]=!!t.fps,l[vt.GAME_DEBUG_MODE]=!!t.debug,l[vt.GAME_DIALOG_CUSTOM]=!!t.useDialog)}}s.elementLogo=null,s.progress=0,s.progressValue=0,s.baseURL=s.scene.baseURL||"",Xe(s.scene.screen),qe(),l[vt.OVERVIEW_LOGO]&&(s.setting={id:"logo",isLock:!0,useCenter:!0,left:"25%",top:"25%",width:"50%",height:"50%",game:{width:512,height:512},reference:{left:.25,top:.25,width:.5,height:.5}});s.settingBackground={id:"background",isLock:!1,left:"0%",top:"0%",width:"100%",height:"100%",game:{width:10240,height:10240},reference:{left:0,top:1,width:1,height:1}},s.message="建立預覽",s.display="inline",s.isFinish=!1,s.options={scene:s.scene,visible:!0,ready:s.ready},s.scene.pixiConfig||(a[vt.GAME_SCENE_CUSTOM]=!1);let h=g;s.manager.show=()=>{Ot.overview.visible=!0,f.redraw()},s.manager.hide=()=>{Ot.overview.visible=!1,f.redraw()},s.leave=function(){if(!g.isCheckGameCDN)if(s.isFinish=!0,h.isFinish=!0,n.isReload=!1,f.redraw(),n.disableNet){if(!Ot.manual.overview){let e=Ot.overview.manager;e.hide&&e.hide()}let e=wi(),t={id:s.scene.id},i=e.scene[t.id];i&&i.localEvent&&i.localEvent.enter(t)}else s.title=t("connecting"),s.message=t("start"),c.isKickOut||(d.isLogin?(jt(),Ht()):s.serve&&fi(s.serve).then((()=>{s.title=t("quickPlay"),f.redraw()})))},s.timeout=null;let u={start(){s.message="開始讀取遊戲資料",f.redraw(),wt([h,"optionalAccess",e=>e.loadingEvent,"optionalAccess",e=>e.start,"call",e=>e()])},resBegin(e){wt([h,"optionalAccess",e=>e.loadingEvent,"optionalAccess",e=>e.resBegin,"call",t=>t(e)])},resEnd(e){wt([h,"optionalAccess",e=>e.loadingEvent,"optionalAccess",e=>e.resEnd,"call",t=>t(e)])},sceneResBegin(e){wt([h,"optionalAccess",e=>e.loadingEvent,"optionalAccess",e=>e.sceneResBegin,"call",t=>t(e)])},sceneResLoading(e){let t=0;if(Object.prototype.hasOwnProperty.call(e,"totalProgress")){let i=e.state,n=e.totalProgress;if(i){n=(i.currentIndex-1)/i.totals*100+n/i.totals}t=n.toFixed(0),s.progress=t,s.progressValue=.01*n}else{let i=e.current/e.length;t=(100*i).toFixed(0),s.progress=t,s.progressValue=i}s.isFinish||(s.timeout&&(b.updateManager.remove(s.timeout),s.timeout=null),i||(s.timeout=b.updateManager.setTimeout((()=>{n.isReload=!0,ri({url:s.baseURL,group:s.scene.group,game:s.scene.appConfig}),s.timeout=null}),5))),a[vt.OVERVIEW_PROGRESS]&&f.redraw(),wt([h,"optionalAccess",e=>e.loadingEvent,"optionalAccess",e=>e.sceneResLoading,"call",e=>e(t)])},sceneResEnd(e){wt([h,"optionalAccess",e=>e.loadingEvent,"optionalAccess",e=>e.sceneResEnd,"call",t=>t(e)])},async finish(){if(s.timeout&&(b.updateManager.remove(s.timeout),s.timeout=null),n.requestReload)return;let e=n.store;if(e)try{await e.setItem("baseURL",globalThis.BASE_URL)}catch(e){}a[vt.OVERVIEW_ANIMATION]&&s.animationLeave?s.animationLeave():s.leave(),wt([h,"optionalAccess",e=>e.loadingEvent,"optionalAccess",e=>e.finish,"call",e=>e()])}};o&&o(u)},oncreate(){let e=this;e.setting&&We(e.setting),e.settingBackground&&We(e.settingBackground),De(!0),n.requestReload&&(n.requestReload=!1),a[vt.GAME_SCENE_CUSTOM]||a[vt.OVERVIEW_ANIMATION]||e.options.ready&&e.options.ready()},onremove(){self.setting&&Ge(self.setting),self.settingBackground&&Ge(self.settingBackground)},onbeforeremove:e=>(["animate__animated","animate__fadeOut","animate__faster"].forEach((t=>{e.dom.classList.add(t)})),new Promise((function(t){e.dom.addEventListener("animationend",t)}))),view(){let e=this,i=g.setting,s=e.settingBackground,r=e.setting,o=e.options;e.display,i||(i={left:"0%",top:"0%",width:"0%",height:"0%"}),Pe.isMobile&&Pe.currentY;let l="",c=n.images;return c&&(l=globalThis.innerHeight>globalThis.innerWidth?c.background[`${n.agent}Portrait`]:c.background[`${n.agent}Landscape`]),globalThis.BASE_URL&&(l=globalThis.BASE_URL+"agent/"+l),f(".",{style:{display:e.display,position:"absolute",zIndex:100,left:s.left,top:`${Pe.currentY+parseInt(s.top)}px`,width:s.width,height:s.height}},f(".",{style:{position:"absolute",left:"0%",top:"0%",width:"100%",height:"100%"}},f(".aspect-ratio--object cover",{style:{zIndex:0,background:`url(${l}) center`}})),a[vt.OVERVIEW_ANIMATION]?f(".",{style:{position:"absolute",left:i.left,top:i.top,width:i.width,height:i.height}},f(bt,{style:{position:"absolute",left:"0%",top:"0%",width:"100%",height:"100%"},options:o,resource:g})):null,!n.isReload&&a[vt.OVERVIEW_LOGO]?f(".",{style:{position:"absolute",left:"25%",top:"25%",width:"50%",height:"50%"}},f("img",{oncreate(t){e.elementLogo=t.dom},src:n.logo,onload(){["animate__animated","animate__fadeIn"].forEach((t=>{e.elementLogo.classList.add(t)}))},style:{opacity:0,zIndex:700,position:"absolute",left:r.left,top:r.top,width:r.width,height:r.height}})):null,a[vt.GAME_SCENE_CUSTOM]&&o.visible?f(".",{style:{position:"absolute",zIndex:300,left:"0%",top:"0%",width:"100%",height:"100%"}},f(".pv2 mb2 white bg-dark-green o-20",{style:{position:"absolute",left:"0%",top:"0%",width:"100%",height:"100%"}}),f(".",{style:{position:"absolute",left:"0%",top:"0%",width:"100%",height:"100%"}},f(mt,{options:o}))):null,a[vt.OVERVIEW_PROGRESS]&&!e.isFinish?f(".",{style:{zIndex:100,position:"absolute",left:"10%",top:"90%",width:"80%",height:"4%"}},f("progress.progress",{style:{position:"absolute",left:"0%",top:"0%",width:"100%",height:"40%"},max:"100",value:`${e.progress}`}),f(".tc",{style:{position:"absolute",left:"0%",top:"30%",width:"100%",height:"60%",color:"#a0cdff"}},f("p.v-btm",`${t("loading")} ${e.progress}%`))):null)}},Lt={fatal(e){},high(e){},middle(e){},low(e){}},Ct={disableDialog:!1,handle(){let e=r;if(d.state="未連線",n.isInGame&&globalThis.scene){Object.getOwnPropertyNames(globalThis.scene).forEach((e=>{let t=globalThis.scene[e];t&&t.game&&t.game.disconnect&&t.game.disconnect()}))}Ct.disableDialog||a[e.GAME_DIALOG_CUSTOM]&&(d.isError||b.updateManager.setTimeout((()=>{d.isError||E({title:"errorLow",msg:"disconnect"})}),2))}},Tt={handle(t){let i=wi();d.state="遊戲中",Ct.disableDialog=!0,e.serviceEnd(Tt.report),e.log({label:"net",category:"進入遊戲"});let n={id:t.gid};k();let s=i.scene[n.id];s&&s.localEvent&&s.localEvent.enter(n)},report:{time:0,category:"進入遊戲",getLabel:()=>"net"},error:Lt.low};let Et=null,kt={position:"absolute",left:"0%",top:"0%",width:"100%",height:"100%",backgroundColor:"rgba(0,0,0,0)"},Rt=[{style:{zIndex:10,position:"absolute",left:"5%",top:"5%",width:"30%",height:"85%"},reference:{left:.05,top:.05,width:.3,height:.85}},{style:{zIndex:10,position:"absolute",left:"35%",top:"5%",width:"30%",height:"85%"},reference:{left:.35,top:.05,width:.3,height:.85}},{style:{zIndex:10,position:"absolute",left:"65%",top:"5%",width:"30%",height:"85%"},reference:{left:.65,top:.05,width:.3,height:.85}}],Ot={overview:{visible:!0,manager:{}},packet:null,gid:null,manual:{overview:!1}},It={visible:!1},Mt="",$t=[],Ut={oninit(e){let t=e.attrs,i=this;i.isLoading=!1;let n=t.loadingEvent,s=c,a={id:t.id,decimal:0,mode:s.mode,isCreate:!0,scene:t.scene,loadingEvent:{start(){i.isLoading=!0,n&&n.start&&n.start()},resBegin(e){n&&n.resBegin&&n.resBegin(e)},resEnd(e){n&&n.resEnd&&n.resEnd(e)},sceneResBegin(e){n&&n.sceneResBegin&&n.sceneResBegin(e)},sceneResLoading(e){n&&n.sceneResLoading&&n.sceneResLoading(e)},sceneResEnd(e){n&&n.sceneResEnd&&n.sceneResEnd(e)},finish(e){e&&e.localEvent&&(t.localEvent=e.localEvent),i.isLoading=!1,t.finish&&t.finish(e),n&&n.finish&&n.finish(e)}}},r={create:Bt,destroy:Nt,reload:Pt,init:Ft,clean:St,currentGame:Ot};i.gameManager=r,i.config=a,i.style=t.style,i.reference=t.reference,i.fix=t.fix,i.absPos=t.absPos,i.updateBlur=t.updateBlur,i.isChild=t.isChild},view(){let e=this;return f(".",{style:e.style},f(ut,{updateStyle(t){if(t){let i=e.style;i.display=t.display||i.display,Object.prototype.hasOwnProperty.call(t,"opacity")&&(i.opacity=t.opacity),Object.prototype.hasOwnProperty.call(t,"zIndex")&&(i.zIndex=t.zIndex)}},gameManager:e.gameManager,config:e.config,currentBaseURL:globalThis.BASE_URL,left:"0%",top:"0%",width:"100%",height:"100%",reference:e.reference,updateBlur:e.updateBlur,fix:e.fix,isChild:e.isChild,absPos:e.absPos}))}},_t={oninit(e){let t=e.attrs,i=this,n=t.sceneInfo;i.objList=t.objList,i.serve=t.serve,i.isReady=!1;let s={reload(){i.isReady=!1}},a={};let r=c,o={id:n.id,decimal:0,mode:r.mode,isCreate:!0,scene:n,loadingEvent:{start(){a.start&&a.start()},resBegin(e){a.resBegin&&a.resBegin(e)},resEnd(e){a.resEnd&&a.resEnd(e)},sceneResBegin(e){a.sceneResBegin&&a.sceneResBegin(e)},sceneResLoading(e){a.sceneResLoading&&a.sceneResLoading(e)},sceneResEnd(e){a.sceneResEnd&&a.sceneResEnd(e)},finish(){a.finish&&a.finish()}}};Ot.packet=null,Ot.gid=n.id||i.serve.id;let l={create:Bt,destroy:Nt,reload:Pt,init:Ft,clean:St,currentGame:Ot};i.gameManager=l,i.gameConf=o,i.sceneInfo=n,i.ctrlEvent=s,i.setUpdateEvent=function(e){a=e},i.event={ready:function(){i.isReady=!0,f.redraw()},finish:function(){let e=Et.getLobby();if(e){let t=null;const s=b.Lobby.CMD;e.setLobbyCommand(s.IN_GAME,{packet:t,gid:n.id||i.serve.id})}}}},view(){let e=this,t=e.objList,i=e.gameConf,n=e.event;return f(".",{style:kt},It.visible&&e.isReady?f(ut,{gameManager:e.gameManager,currentBaseURL:globalThis.BASE_URL,sysTray:e.sceneInfo.sysTray,ctrlEvent:e.ctrlEvent,config:e.gameConf,zIndex:4,left:"0%",top:"0%",width:"100%",height:"100%",objList:t}):null,f(".",Ot.overview.visible?f(xt,{manager:Ot.overview.manager,serve:e.serve,scene:i.scene,setUpdateEvent:e.setUpdateEvent,ready(){n.ready()},finish(){n.finish()}}):null))}};async function Pt(){return new Promise((e=>{Object.getOwnPropertyNames(globalThis.scene).forEach((e=>{let t=globalThis.scene[e];t&&(delete t.event,delete t.loadingEvent),delete globalThis.scene[e]})),globalThis.scene={};let t={oncreate(){e()},view:()=>null};Et&&Et.setCurrentContext(t)}))}function At(e){Et=e}function Ft(t){yt=n.langID,n.serve=t.serve,Ot.manual={overview:!1},Ot.overview.visible=!0,function(t){let i=null;if(t.gameCard)i=t.gameCard;else{let e;e=A(t.group),i=e[t.id]}if(!i)return;i.manual&&(Ot.manual=i.manual,i.manual.disableNet&&(n.disableNet=!0)),e.report.name=`${i.group}/${i.appConfig}`,Mt=i.group;let s=i.baseURL||"",a=i.images;if(n.useAvif?a.v2&&(a=a.v2):a.v1&&(a=a.v1),a.icon){let e=document.getElementsByTagName("link");if(e){let t=e[0];if(t)if(t.setAttribute("crossorigin","icon"),t.setAttribute("rel","icon"),t.setAttribute("type","image/png"),"kc"===n.agent){let e="data/img/logo/kc/87faada2e433ffce.ico";t.setAttribute("href",e)}else t.setAttribute("href",s+a.icon)}}let r=i.app;"object"==typeof r&&(r=r[yt]),i.name[yt]?document.title=i.name[yt]:document.title=i.name[h.EN],It.objList=$t,It.sceneInfo=i,It.serve=t.serve,It.visible=!0,Et&&Et.setCurrentContext(_t,It)}(t)}function Bt(e,t=0){let i=e,s=t;"number"==typeof e&&(i=t,s=e);let a=i.groupName||Mt;return F(i.sceneID,a,globalThis.BASE_URL).then((e=>{let t=Rt[s],a=e.gameCard;if(!a)return;i.reloadConfig&&(a.reloadConfig=i.reloadConfig),t||(t={style:kt,reference:{left:0,top:0,width:1,height:1}});let r={com:Ut,attrs:{loadingEvent:i.loadingEvent,index:s,style:i.style||t.style,reference:i.reference||t.reference,absPos:i.absPos||t.absPos,id:i.id,scene:a,isChild:!0,finish:function(e){n.isReload||i.finish&&i.finish(e)}}};n.isReload||(null!==$t[s]?($t[s]=null,f.redraw(),b.updateManager.setTimeout((()=>{$t[s]=r,f.redraw()}),.1)):($t[s]=r,f.redraw()))}))}function Nt(e){$t[e]=null,f.redraw()}function St(){$t=[],It.visible=!0,f.redraw()}let zt=!1;function jt(){zt=!1}function Ht(){let t=null;if(zt)return!0;Et&&(t=Et.getLobby());const i=b.Lobby.CMD;let s=Ot,a=n,r=d;if(b.updateManager.setTimeout((()=>{"遊戲中"!==r.state&&(globalThis.Howler&&(globalThis.Howler.mute(!0),globalThis.Howler.unload()),E({title:"connecting",msg:"disconnect"}))}),.001*u),a.module?import("./agent.b9eeeecc.js").then((e=>{e.ingame({name:c.game,group:c.group,gid:s.gid})})):(t&&t.setLobbyCommand(i.IN_GAME,{packet:s.packet,gid:s.gid}),e.serviceBegin(Tt.report)),zt=!0,!s.manual.overview){let e=s.overview.manager;e.hide&&e.hide()}return!0}var Vt=Object.freeze({__proto__:null,clean:St,create:Bt,currentGame:Ot,destroy:Nt,enterGame:Ht,imgWaiting:function(){return'<svg class="hourglass" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 120 206" preserveAspectRatio="none">\n  <path class="middle" d="M120 0H0v206h120V0zM77.1 133.2C87.5 140.9 92 145 92 152.6V178H28v-25.4c0-7.6 4.5-11.7 14.9-19.4 6-4.5 13-9.6 17.1-17 4.1 7.4 11.1 12.6 17.1 17zM60 89.7c-4.1-7.3-11.1-12.5-17.1-17C32.5 65.1 28 61 28 53.4V28h64v25.4c0 7.6-4.5 11.7-14.9 19.4-6 4.4-13 9.6-17.1 16.9z"/>\n  <path class="outer" d="M93.7 95.3c10.5-7.7 26.3-19.4 26.3-41.9V0H0v53.4c0 22.5 15.8 34.2 26.3 41.9 3 2.2 7.9 5.8 9 7.7-1.1 1.9-6 5.5-9 7.7C15.8 118.4 0 130.1 0 152.6V206h120v-53.4c0-22.5-15.8-34.2-26.3-41.9-3-2.2-7.9-5.8-9-7.7 1.1-2 6-5.5 9-7.7zM70.6 103c0 18 35.4 21.8 35.4 49.6V192H14v-39.4c0-27.9 35.4-31.6 35.4-49.6S14 81.2 14 53.4V14h92v39.4C106 81.2 70.6 85 70.6 103z"/>\n</svg>'},init:Ft,get isInGame(){return zt},reload:Pt,reset:jt,setComRoot:At});let Dt={oninit(e){let t=e.attrs,i=t.strings,n=t.dspScreen,s=t.gameManager;this.strings=i,this.dspScreen=n,t.yesno||s.clean(),this.title=t.title,this.msg=t.msg,this.setting={id:"dialog",isLock:!1,useCenter:!1,left:"0%",top:"0%",width:"100%",height:"100%",game:{width:1024,height:1024},reference:{left:0,top:0,width:1,height:1}},n.addSetting(this.setting)},oncreate(){},view(){let e=this,t=e.setting,i=null,n=e.strings,s=e.dspScreen;return i=s.state.isMobile?{position:"absolute",left:t.left,top:s.state.currentY+"px",backgroundColor:"rgba(0,0,0,1)",zIndex:990,opacity:1,width:t.width,height:t.height}:{position:"absolute",left:t.left,top:t.top,backgroundColor:"rgba(0,0,0,1)",zIndex:990,opacity:1,width:t.width,height:t.height},f(".",{style:i},f(".bg-moon-gray ba bw1",{style:{position:"absolute",left:"10%",top:"10%",width:"80%",height:"75%"}},f(".bg-near-black white f4 fw6 pa4",{style:{position:"absolute",left:"0%",top:"0%",width:"100%",height:"20%"}},f(".tc",n.get(e.title)||"title")),f(".tc pa5",{style:{position:"absolute",left:"0%",top:"20%",width:"100%",height:"50%"}},f.trust(n.get(e.msg))||"body message")))}},Wt={oninit(){let e=this;e.timeValue=-1,e.touchmoveOnce=!1,e.fields=["一","二","三","四","五","六","七","八","九","十","一","二","三","四","五","六","七","八","九","十"],e.pageY=0,e.imgRotate={id:"rotate",isLock:!0,useCenter:!0,left:"10%",top:"10",width:"80%",height:"80%",game:{width:5120,height:5120},reference:{left:0,top:0,width:1,height:1}},e.imgFullscreen={id:"screen",isLock:!0,useCenter:!0,left:"10%",top:"10",width:"80%",height:"80%",game:{width:5120,height:5120},reference:{left:0,top:0,width:1,height:1}}},view(){let e=this,t=Pe,i=t.orientation,n=globalThis.innerWidth,s=globalThis.innerHeight;return i.isTrigger&&(n*=2.5,s*=2.5),t.isMobile&&t.currentY,[t.isTouchOnce&&t.isFullscreen?null:f(".",{style:{zIndex:850,position:"absolute",left:"0%",top:t.currentY+"px",width:(n||t.screenWidth)+"px",height:(s||t.screenHeight)+"px",backgroundColor:"rgba(0,0,0,1)"},ontouchmove(e){Pe.isMobile&&!Pe.ios&&e.preventDefault()},ontouchend(){if(globalThis.Howl){let e=new globalThis.Howl({src:["data/f82550ea2e80cd97.wav"]});e&&(e.volume(.001),e.play())}if(t.isFullscreen=!0,t.isTouchDown=!1,t.isTouchOnce=!0,Pe.ios){let e=globalThis.scene;t.settingList.forEach((t=>{if(e){let i=e[t.id];if(i){(i.game&&i.game.sysTray).isFullscreen=!1}}})),f.redraw(),De(),t.mobileReady&&t.mobileReady()}else Re().then((()=>{let e=globalThis.scene;t.settingList.forEach((t=>{if(e){let i=e[t.id];if(i){(i.game&&i.game.sysTray).isFullscreen=!0}}})),f.redraw(),De(),t.mobileReady&&t.mobileReady()})).catch((()=>{let e=globalThis.scene;t.settingList.forEach((t=>{if(e){let i=e[t.id];if(i){(i.game&&i.game.sysTray).isFullscreen=!1}}})),f.redraw(),De(),t.mobileReady&&t.mobileReady()}))},ontouchstart(i){if(globalThis.Howl){let e=new globalThis.Howl({src:["data/f82550ea2e80cd97.wav"]});e.volume(.001),e.play()}if(t.isTouchDown)return;t.isTouchDown=!0;let n=i.changedTouches||i.originalEvent.touches;if(n){let t=n[0];e.pageY=t.pageY}}},f(".",{oncreate(){We(e.imgFullscreen)},onremove(){Ge(e.imgFullscreen)},style:{position:"absolute",left:"10%",top:"10%",width:"80%",height:"80%"}},f("img",{src:"data/img/c7aecda7af142624.png",style:{position:"absolute",zIndex:850,left:e.imgFullscreen.left,top:e.imgFullscreen.top,width:e.imgFullscreen.width,height:e.imgFullscreen.height}}))),!i.isTrigger&&t.useOrientation&&t.usePortrait&&!t.isPortrait?f(".",{oncreate(){We(e.imgRotate),De(!0)},onremove(){Ge(e.imgRotate)},style:{zIndex:800,position:"absolute",left:"0px",top:globalThis.pageYOffset+"px",width:(globalThis.innerWidth||t.screenWidth)+"px",height:(globalThis.innerHeight||t.screenHeight)+"px",backgroundColor:"rgba(0,0,0,1)"}},f("img",{src:"data/img/f14a0482453bcc34.png",style:{position:"absolute",left:e.imgRotate.left,top:e.imgRotate.top,width:e.imgRotate.width,height:e.imgRotate.height}})):null,!i.isTrigger&&t.useOrientation&&t.useLandscape&&!t.isLandscape?f(".",{oncreate(){We(e.imgRotate),De(!0)},onremove(){Ge(e.imgRotate)},style:{zIndex:800,position:"absolute",left:"0px",top:globalThis.pageYOffset+"px",width:(globalThis.innerWidth||t.screenWidth)+"px",height:(globalThis.innerHeight||t.screenHeight)+"px",backgroundColor:"rgba(0,0,0,1)"}},f("img",{src:"data/img/b4c0d11274ffa254.gif",style:{position:"absolute",left:e.imgRotate.left,top:e.imgRotate.top,width:e.imgRotate.width,height:e.imgRotate.height}})):null]}},Gt={"game.2.0":'<!DOCTYPE html>\n<html>\n<head>\n  <meta charset="UTF-8" />\n  <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0" />\n  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />\n  <title>game 2.0 {{{name}}}</title>\n\n  <script type="systemjs-importmap" crossorigin="anonymous">\n    {\n      "imports": {\n      {{#importmap}}\n        {{{importmapName}}}\n      {{/importmap}}\n      }\n    }\n  <\/script>\n\n</head>\n<body id="{{{id}}}" style="height:100%;width:100%;overflow-x:hidden;overflow-y:hidden">\n<script crossorigin="anonymous">\n  if(!window.globalThis) {\n    window.globalThis = window;\n  }\n\n  let isInitCache = false;\n  function initCache () {\n    if(isInitCache) {\n      return;\n    }\n    isInitCache = true;\n    let isLoaded = false;\n    let registration = null;\n    function loadScript() {\n      if(isLoaded) {\n        return;\n      }\n      isLoaded = true;\n      let script = document.createElement(\'script\');\n      script.onload = function() {\n        System.import("{{{appName}}}");\n      };\n      script.src = "{{{systemjsURL}}}";\n      document.getElementsByTagName(\'head\')[0].appendChild(script);\n    }\n    loadScript();\n  }\n  initCache();\n\n<\/script>\n</body>\n</html>\n',"game.3.0":'<!DOCTYPE html>\n<html>\n<head>\n  <meta charset="UTF-8" />\n  <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0" />\n  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />\n  <title>game 3.0 {{{name}}}</title>\n\n  {{#importmap}}\n  {{{jsName}}}\n  {{/importmap}}\n\n</head>\n<body id="{{{id}}}" style="height:100%;width:100%;overflow-x:hidden;overflow-y:hidden">\n<script crossorigin="anonymous">\n  if(!window.globalThis) {\n    window.globalThis = window;\n  }\n\n  let isInitCache = false;\n  function initCache () {\n    if(isInitCache) {\n      return;\n    }\n    isInitCache = true;\n    let isLoaded = false;\n    let registration = null;\n    function loadScript() {\n      if(isLoaded) {\n        return;\n      }\n      isLoaded = true;\n      let script = document.createElement(\'script\');\n      script.onload = function() {\n      };\n      script.src = "{{{appName}}}";\n      script.crossorigin = "anonymous";\n      document.getElementsByTagName(\'head\')[0].appendChild(script);\n    }\n    loadScript();\n  }\n\n  initCache();\n<\/script>\n</body>\n</html>\n',"game.4.0":'<!DOCTYPE html>\n<html>\n<head>\n  <meta charset="UTF-8" />\n  <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0" />\n  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />\n  <title>game 4.0 {{{name}}}</title>\n\n  {{{shimOptions}}}\n  {{{jsImportShim}}}\n\n  <script type="importmap{{{moduleType}}}">\n  {\n    "imports": {\n      {{#importmap}}\n      {{{importmapName}}}\n      {{/importmap}}\n    },\n    "scopes": {\n      "{{{scopeName}}}": {\n        {{#scopemap}}\n        {{{scopemapName}}}\n        {{/scopemap}}\n      }\n    }\n  }\n  <\/script>\n\n  {{#globalmap}}\n  {{{jsName}}}\n  {{/globalmap}}\n\n\n  <script crossorigin="anonymous">\n  if(!window.globalThis) {\n    window.globalThis = window;\n  }\n  <\/script>\n\n</head>\n<body id="{{{id}}}" style="height:100%;width:100%;overflow-x:hidden;overflow-y:hidden">\n  <script crossorigin="anonymous" type="module{{{moduleType}}}">\n    import "{{{appName}}}";\n  <\/script>\n</body>\n</html>\n',"slot.2.1":'<!DOCTYPE html>\n<html>\n  <head>\n  <meta charset="UTF-8" />\n  <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0" />\n  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />\n  <title>slot.2.1 {{{name}}}</title>\n  </head>\n  <body id="{{{id}}}" style="height:100%;width:100%;overflow-x:hidden;overflow-y:hidden">\n  <script crossorigin="anonymous">\n  if(!window.globalThis) {\n    window.globalThis = window;\n  }\n\n  let isInitCache = false;\n  function initCache () {\n    if(isInitCache) {\n      return;\n    }\n    isInitCache = true;\n    let isLoaded = false;\n    let registration = null;\n    function loadScript() {\n      if(isLoaded) {\n        return;\n      }\n      isLoaded = true;\n      let script = document.createElement(\'script\');\n      script.onload = function() {\n        {{{appConfig}}}\n        ;System.import(\'{{{appName}}}\');\n\n      };\n      script.src = "{{{systemjsURL}}}";\n      script.crossorigin = "anonymous";\n      document.getElementsByTagName(\'head\')[0].appendChild(script);\n    }\n    loadScript();\n  }\n\n  initCache();\n  <\/script>  \n  </body>\n</html>\n'};let Yt={oninit(t){let i=this,a=t.attrs,r={category:"測試CDN 主網址",getLabel:()=>"common"};e.loadBegin(r),i.cdnList=n.cdnList,i.server=c,i.ready=a.ready;let o=[];i.gamecdnFields=o,i.isFinish=!1;let h=0,g=i.cdnList.length;function d(e){h+=1,h>=g&&(i.server.cdn.errorCounts+=1,i.server.cdn.errorCounts<3?(n.requestReload=!1,n.isReload=!0,l.reload&&l.reload({url:e.target,group:e.group,game:e.appConfig||e.game})):(n.hasCDN=!1,E({yesno:!1,title:"service",msg:"errorCDN"})))}function u(t){i.isFinish||(i.isFinish=!0,t.isLight=!0,n.isCheckGameCDN=!1,i.server.cdn.errorCounts=0,e.loadEnd(r),e.log({label:"common",category:"測試CDN 主網址"}),i.ready&&i.ready(t.target))}n.isCheckGameCDN=!0,i.cdnList.forEach(((e,t)=>{let a={};a.index=t,a.isLight=!1,a.id=e.id,a.url=e.url,a.target=e.target,a.timestamp=Math.round(performance.now()),a.timeOnload=0,a.timeInit=0,a.timeScene=0,a.timeReady=9999,a.gamecard=null,a.icon="",a.isIconLoaded=!1,a.downloadEnabled=!1,a.loadingEvent={},a.ready=u,a.error=d,a.useTest=!0,o.push(a),async function(e,t,i){let a="",r=null,o=null,l=t.target,c=!1,h=s(),g=(new Date).getTime();t.group=e.group,t.game=e.game;try{if(a=e.version?`${l}${e.group}/${e.game}/config/v${e.version}`:`${l}${e.group}/${e.game}/config/gamecard.txt?v=${g}`,r=await fetch(a,{headers:{"Content-Type":"text/plain"}}),!i&&!n.isCheckGameCDN)return null;r.ok&&(o=await r.text())}catch(e){}if(!o)try{if(a=`${l}config/${e.group}/${e.game}/gamecard.txt?v=${g}`,r=await fetch(a,{headers:{"Content-Type":"text/plain"}}),!i&&!n.isCheckGameCDN)return null;r.ok&&(o=await r.text(),c=!0)}catch(e){}let d=null;if(o){d=JSON.parse(o);let s=d.images;n.useAvif?s.v2&&(s=s.v2):s.v1&&(s=s.v1);let a=null;c?(d.templateVersion="slot.2.1",a=`${l}${s.icon}`):a=`${l}${e.group}/${e.game}/${s.icon}`;let g="";"string"==typeof d.name?g+=d.name+" ":g+=d.name[h]+" ";let u=null;if("string"==typeof d.app?(u=`${l}${d.app}`,g+=d.app):(u=`${l}${d.app[h]}`,g+=d.app[h]),t.app=g,t.version=d.version,t.icon=a,t.downloadEnabled=!0,t.appConfig=d.appConfig,t.gamecard=d,t.useTest){if(u){if(r=await fetch(u),!i&&!n.isCheckGameCDN)return null;if(!r.ok)return t.error&&t.error(t),null}if(a){if(r=await fetch(a),!i&&!n.isCheckGameCDN)return null;if(!r.ok)return t.error&&t.error(t),null}t.timeReady=Math.round(performance.now()-t.timestamp),t.ready&&t.ready(t)}}else t.app="",t.version="",t.gamecard=null,t.error&&t.error(t);f.redraw()}(i.server,a)}))},oncreate(){},view:()=>f(".",{left:"0%",right:"0%",width:"100%",height:"100%",position:"absolute",zIndex:0},f(".tmp",f(".cssload-loader",f.trust('<svg class="cssload-logo" height="200" width="200"><text x="49%" y="56%" dominant-baseline="middle" text-anchor="middle" fill="#1375ff">Loading</text></svg>'),f(".cssload-inner cssload-one"),f(".cssload-inner cssload-two"),f(".cssload-inner cssload-three"))),f(".",{style:{opacity:0,left:"0%",right:"0%",width:"1px",height:"1px",position:"absolute",zIndex:0}},f("article.dt.w-100.bb.b--black-05.pb2.mt2",f("div.dtc.v-mid.pl3",f("h1.f6.f5-ns.fw6.lh-title.white.mv1.tc","檢測服務線路"),f("h2.f6.fw4.mt1.mb1.green.tc","使用的線路")))))},qt=!1,Kt=null,Xt=["一","二","三","四","五","六","七","八","九","十","一","二","三","四","五","六","七","八","九","十"],Jt=!0,Qt=null,Zt=null,ei=null,ti=!1,ii=null,ni=null,si=null;async function ai(e){return new Promise(((t,i)=>{let n=document.createElement("script");n.type="text/javascript",n.src=e,n.onload=()=>{t()},n.onerror=()=>{i()},document.body.appendChild(n)}))}async function ri(t){if(!n.requestReload){let i={eventName:`CDN ${t.url}`,category:"服務線路錯誤",label:`${t.group}${t.game}`};e.error(i),globalThis.scene={},n.requestReload=!0,n.cdnList=[],n.hasCDN=!1,n.selectCDN=!1,Zt=null,f.redraw();let s=async function(){si&&(await si(),0===n.cdnList.length?pi({element:document.body}):f.redraw())};b.updateManager.setTimeout((()=>{s()}),.1)}}async function oi(e){ti=!0,ii=e||{},ii.hideInfo=li,ni=await import("./agent.7554db6f.js"),f.redraw()}function li(){ti=!1,f.redraw()}let ci={ready(t){globalThis.BASE_URL=t,e.report.currentURL=t,n.selectCDN=!0,globalThis.scene={},f.redraw();let i=c;F(i.game,i.group,t).then((e=>{e&&e.gameCard&&Ft({gameCard:e.gameCard,serve:i,id:i.game,group:i.group})}))}},hi={context:null,view:()=>Jt?n.hasCDN&&!n.selectCDN?f(".basic",f(Yt,ci)):f(".basic",Pe.isMobile?f(".",{style:{zIndex:0,position:"absolute",left:"0%",top:"0%",width:"100%",height:"100%"}},Pe.orientation.isTrigger?null:Xt.map((()=>f(".ba h-25 black tc",{style:{opacity:0}},"")))):null,Zt?f(Zt,ei):null,Pe.isMobile?f(Wt):null,v()?f(Dt,{strings:Kt,dspScreen:Je,gameManager:Vt,title:L(),msg:T()}):null,ti&&ni?f(ni.Component,ii):null):n.hasCDN&&!n.selectCDN?f(".basic#root",f(Yt,ci)):f(".basic#root",[Pe.isMobile?f(".",{style:{zIndex:0,position:"absolute",left:"0%",top:"0%",width:"100%",height:"100%"}},Pe.orientation.isTrigger?null:Xt.map((()=>f(".ba h-25 black tc",{style:{opacity:0}},"")))):null,Zt?f(Zt,ei):null,Pe.isMobile?f(Wt):null,v()?f(Dt,{strings:Kt,dspScreen:Je,gameManager:Vt,title:L(),msg:T()}):null,ti&&ni?f(ni.Component,ii):null])};function gi(e){Jt=e}function di(e,t){Zt=e,ei=t,f.redraw()}let ui={};function mi(e){return ui[e]}async function pi(e){let t=c;si=e.checkCDN,Kt=e.strings,l.getGameTemplate=mi,l.reload=ri,l.getManager=wi,l.showInfo=oi,l.hideInfo=li;let s=globalThis;s.addEventListener&&(s.addEventListener("beforeunload",(e=>{})),s.addEventListener("unload",(()=>{}))),s.scene={},s.game={},ui["game.2.0"]=Gt["game.2.0"],ui["game.3.0"]=Gt["game.3.0"],ui["game.4.0"]=Gt["game.4.0"],ui["slot.2.1"]=Gt["slot.2.1"],function(){if(it)return;it=!0;let e="position: absolute; left: 0%; top: 0%; width: 100%; height: 100%;";Ze.canvas=document.createElement("canvas"),Ze.canvas.style=e,Ze.game=new b.GameBase.Base,Ze.game.init({view:Ze.canvas}),et.canvas=document.createElement("canvas"),et.canvas.style=e,et.game=new b.GameBase.Base,et.game.init({view:et.canvas}),tt.canvas=document.createElement("canvas"),tt.canvas.style=e,tt.game=new b.GameBase.Base,tt.game.init({view:tt.canvas})}(),At({setCurrentContext:di,getLobby:bi});let a={game:t.game,group:t.group};if(t.group&&t.game||!p){if(gi(!1),!n.hasCDN){let e=globalThis.BASE_URL,t=n.version;F(a.game,a.group,e,t).then((e=>{e&&e.gameCard&&Ft({gameCard:e.gameCard,serve:a,id:a.game,group:a.group})}))}}else Zt=z;let r=o;if(t.mode===r.DEMO){let e=840;b.updateManager.setTimeout((()=>{globalThis.Howler&&(globalThis.Howler.mute(!0),globalThis.Howler.unload()),E({title:"gameModeDemo",msg:"demoTimeout"})}),e)}if(f.mount(e.element,hi),!i)try{let e=(0,l.decode)(c.key);Date.now()-1e3*e.exp>0&&(c.isKickOut=!0,E({title:"exitGame",msg:"kickOut"}))}catch(e){}}function fi(e){let t=c;if(qt){return new Promise((e=>{let i=t.info;Qt&&(Qt.login(i),e(Qt))}))}return qt=!0,e&&(t.game=e.game||t.game,t.group=e.group||t.group,t.host=e.host||t.host),new Promise((e=>{let i=globalThis;i.lobby={currentUser:{},table:{},net:{}},n.module?import("./agent.2cdb09a8.js").then((n=>{let s=n.create();i.lobby.net.gameCommand=s;(()=>{t.host.indexOf("://")<0&&(t.host=`wss://${t.host}`);let i=t.info,n=t.host,s=t.protocol,a=t.gameFormat,r={hostname:n};import("./agent.b9eeeecc.js").then((t=>{t.init({gameFormat:a,protocol:s}).then((()=>{t.connect(r).then((()=>{(async function(e){try{let t=await import("./agent.b9eeeecc.js");return await t.login(e)}catch(e){}})(i).then((()=>{e(null)}))}))}))}))})()})):async function(){let e,t="/dependence/";n.selectCDN&&(t=`${globalThis.BASE_URL}dependence/`),e=["socket.io/socket.io.min.2.4.0.js"];let i=[];for(let n=0;n<e.length;n++){let s=ai(t+e[n]);i.push(s)}await Promise.all(i)}().then((async()=>{b.client.init({io:globalThis.io}),Qt=new b.Lobby({},"/"+t.namespace),Qt.init();let i=await import("./agent.54415d8c.js"),n=globalThis,s=d,a=i.getCommandList(m);Qt.setEventMap(a),Qt.setSendEvent(i.getSendEvent()),s.state="連線中",f.redraw();let r={};r.send=Qt.setGameCommand,r.registerGameEvent=Qt.registerGameEvent,r.unregisterGameEvent=Qt.unregisterGameEvent,n.lobby.net.gameCommand=r,n.lobby.net.setLobbyCommand=Qt.setLobbyCommand,n.lobby.net.CMD=b.Lobby.CMD,n.lobby.setEvent=i.setEvent,t.host&&Qt.setHost(t.host);let o=b.updateManager.setTimeout((()=>{"連線中"===s.state&&(globalThis.Howler&&(globalThis.Howler.mute(!0),globalThis.Howler.unload()),E({title:"connecting",msg:"disconnect"}))}),.001*u);Qt.connect({connect(){o&&(b.updateManager.remove(o),o=null),e(Qt)},disconnect(){o&&(b.updateManager.remove(o),o=null)}})}))}))}function bi(){return Qt}function wi(){return globalThis}var yi=Object.freeze({__proto__:null,autoLogin:fi,getCurrentContext:function(){return Zt},getGameTemplate:mi,getLobby:bi,getManager:wi,hideInfo:li,reload:ri,resetCache:function(){if(n.useCache){let e=n.registration;if(e&&e.active&&navigator.serviceWorker.controller){let e={reset:"games"};navigator.serviceWorker.controller.postMessage(e)}}},run:pi,setAccountVisible:gi,setCurrentContext:di,setKey:function(e){c.key=e},showGameList:function(){Zt=z},showInfo:oi});export{Tt as C,We as a,E as b,R as c,Ge as d,De as e,Ht as f,wi as g,k as h,bi as i,Lt as j,Ct as k,yi as l,Pe as s};
