import{c as e,s as t,o as n,O as i,G as r,a as s,l as o,r as a,b as l,T as c,d as u}from"./agent.c55f3b95.js";import{u as h,n as d,c as g,L as f}from"./agent.b38a3088.js";import{g as p,a as m,I as b}from"./agent.87cf6255.js";import{r as v}from"./agent.e16c05fc.js";var y,w;function x(){if(w)return y;function e(e,t,n,i,r,s){return{tag:e,key:t,attrs:n,children:i,text:r,dom:s,domSize:void 0,state:void 0,events:void 0,instance:void 0}}return w=1,e.normalize=function(t){return Array.isArray(t)?e("[",void 0,void 0,e.normalizeChildren(t),void 0,void 0):null==t||"boolean"==typeof t?null:"object"==typeof t?t:e("#",void 0,void 0,String(t),void 0,void 0)},e.normalizeChildren=function(t){var n=[];if(t.length){for(var i=null!=t[0]&&null!=t[0].key,r=1;r<t.length;r++)if((null!=t[r]&&null!=t[r].key)!==i)throw new TypeError(!i||null==t[r]&&"boolean"!=typeof t[r]?"In fragments, vnodes must either all have keys or none have keys.":"In fragments, vnodes must either all have keys or none have keys. You may wish to consider using an explicit keyed empty fragment, m.fragment({key: ...}), instead of a hole.");for(r=0;r<t.length;r++)n[r]=e.normalize(t[r])}return n},y=e}var T,L,C=x(),k=function(){var e,t=arguments[this],n=this+1;if(null==t?t={}:("object"!=typeof t||null!=t.tag||Array.isArray(t))&&(t={},n=this),arguments.length===n+1)e=arguments[n],Array.isArray(e)||(e=[e]);else for(e=[];n<arguments.length;)e.push(arguments[n++]);return C("",t.key,t,e)};function E(){return L?T:(L=1,T={}.hasOwnProperty)}var R=x(),O=k,I=E(),$=/(?:(^|#|\.)([^#\.\[\]]+))|(\[(.+?)(?:\s*=\s*("|'|)((?:\\["'\]]|.)*?)\5)?\])/g,U={};function A(e){for(var t in e)if(I.call(e,t))return!1;return!0}function P(e){for(var t,n="div",i=[],r={};t=$.exec(e);){var s=t[1],o=t[2];if(""===s&&""!==o)n=o;else if("#"===s)r.id=o;else if("."===s)i.push(o);else if("["===t[3][0]){var a=t[6];a&&(a=a.replace(/\\(["'])/g,"$1").replace(/\\\\/g,"\\")),"class"===t[4]?i.push(a):r[t[4]]=""===a?a:a||!0}}return i.length>0&&(r.className=i.join(" ")),U[e]={tag:n,attrs:r}}function _(e,t){var n=t.attrs,i=I.call(n,"class"),r=i?n.class:n.className;if(t.tag=e.tag,t.attrs={},!A(e.attrs)&&!A(n)){var s={};for(var o in n)I.call(n,o)&&(s[o]=n[o]);n=s}for(var o in e.attrs)I.call(e.attrs,o)&&"className"!==o&&!I.call(n,o)&&(n[o]=e.attrs[o]);for(var o in null==r&&null==e.attrs.className||(n.className=null!=r?null!=e.attrs.className?String(e.attrs.className)+" "+String(r):r:null!=e.attrs.className?e.attrs.className:null),i&&(n.class=null),n)if(I.call(n,o)&&"key"!==o){t.attrs=n;break}return t}var S=function(e){if(null==e||"string"!=typeof e&&"function"!=typeof e&&"function"!=typeof e.view)throw Error("The selector must be either a string or a component.");var t=O.apply(1,arguments);return"string"==typeof e&&(t.children=R.normalizeChildren(t.children),"["!==e)?_(U[e]||P(e),t):(t.tag=e,t)},F=x(),N=x(),j=k,z=S;z.trust=function(e){return null==e&&(e=""),F("<",void 0,void 0,e,void 0,void 0)},z.fragment=function(){var e=j.apply(0,arguments);return e.tag="[",e.children=N.normalizeChildren(e.children),e};var M,B,H=z,V={},D={get exports(){return V},set exports(e){V=e}};function W(){if(B)return M;B=1;var e=function(t){if(!(this instanceof e))throw new Error("Promise must be called with 'new'.");if("function"!=typeof t)throw new TypeError("executor must be a function.");var n=this,i=[],r=[],s=c(i,!0),o=c(r,!1),a=n._instance={resolvers:i,rejectors:r},l="function"==typeof setImmediate?setImmediate:setTimeout;function c(e,t){return function s(c){var h;try{if(!t||null==c||"object"!=typeof c&&"function"!=typeof c||"function"!=typeof(h=c.then))l((function(){!t&&e.length;for(var n=0;n<e.length;n++)e[n](c);i.length=0,r.length=0,a.state=t,a.retry=function(){s(c)}}));else{if(c===n)throw new TypeError("Promise can't be resolved with itself.");u(h.bind(c))}}catch(e){o(e)}}}function u(e){var t=0;function n(e){return function(n){t++>0||e(n)}}var i=n(o);try{e(n(s),i)}catch(e){i(e)}}u(t)};return e.prototype.then=function(t,n){var i,r,s=this._instance;function o(e,t,n,o){t.push((function(t){if("function"!=typeof e)n(t);else try{i(e(t))}catch(e){r&&r(e)}})),"function"==typeof s.retry&&o===s.state&&s.retry()}var a=new e((function(e,t){i=e,r=t}));return o(t,s.resolvers,i,!0),o(n,s.rejectors,r,!1),a},e.prototype.catch=function(e){return this.then(null,e)},e.prototype.finally=function(t){return this.then((function(n){return e.resolve(t()).then((function(){return n}))}),(function(n){return e.resolve(t()).then((function(){return e.reject(n)}))}))},e.resolve=function(t){return t instanceof e?t:new e((function(e){e(t)}))},e.reject=function(t){return new e((function(e,n){n(t)}))},e.all=function(t){return new e((function(e,n){var i=t.length,r=0,s=[];if(0===t.length)e([]);else for(var o=0;o<t.length;o++)!function(o){function a(t){r++,s[o]=t,r===i&&e(s)}null==t[o]||"object"!=typeof t[o]&&"function"!=typeof t[o]||"function"!=typeof t[o].then?a(t[o]):t[o].then(a,n)}(o)}))},e.race=function(t){return new e((function(e,n){for(var i=0;i<t.length;i++)t[i].then(e,n)}))},M=e}var G,q,Y,K,J=W();function Q(){if(q)return G;q=1;var e=x();return G=function(t){var n,i=t&&t.document,r={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"};function s(e){return e.attrs&&e.attrs.xmlns||r[e.tag]}function o(e,t){if(e.state!==t)throw new Error("'vnode.state' must not be modified.")}function a(e){var t=e.state;try{return this.apply(t,arguments)}finally{o(e,t)}}function l(){try{return i.activeElement}catch(e){return null}}function c(e,t,n,i,r,s,o){for(var a=n;a<i;a++){var l=t[a];null!=l&&u(e,l,r,o,s)}}function u(t,n,r,o,l){var h=n.tag;if("string"==typeof h)switch(n.state={},null!=n.attrs&&j(n.attrs,n,r),h){case"#":!function(e,t,n){t.dom=i.createTextNode(t.children),w(e,t.dom,n)}(t,n,l);break;case"<":d(t,n,o,l);break;case"[":!function(e,t,n,r,s){var o=i.createDocumentFragment();if(null!=t.children){var a=t.children;c(o,a,0,a.length,n,null,r)}t.dom=o.firstChild,t.domSize=o.childNodes.length,w(e,o,s)}(t,n,r,o,l);break;default:!function(e,t,n,r,o){var a=t.tag,l=t.attrs,u=l&&l.is;r=s(t)||r;var h=r?u?i.createElementNS(r,a,{is:u}):i.createElementNS(r,a):u?i.createElement(a,{is:u}):i.createElement(a);t.dom=h,null!=l&&function(e,t,n){"input"===e.tag&&null!=t.type&&e.dom.setAttribute("type",t.type);var i=null!=t&&"input"===e.tag&&"file"===t.type;for(var r in t)R(e,r,null,t[r],n,i)}(t,l,r);if(w(e,h,o),!x(t)&&null!=t.children){var d=t.children;c(h,d,0,d.length,n,null,r),"select"===t.tag&&null!=l&&function(e,t){if("value"in t)if(null===t.value)-1!==e.dom.selectedIndex&&(e.dom.value=null);else{var n=""+t.value;e.dom.value===n&&-1!==e.dom.selectedIndex||(e.dom.value=n)}"selectedIndex"in t&&R(e,"selectedIndex",null,t.selectedIndex,void 0)}(t,l)}}(t,n,r,o,l)}else!function(t,n,i,r,s){(function(t,n){var i;if("function"==typeof t.tag.view){if(t.state=Object.create(t.tag),null!=(i=t.state.view).$$reentrantLock$$)return;i.$$reentrantLock$$=!0}else{if(t.state=void 0,null!=(i=t.tag).$$reentrantLock$$)return;i.$$reentrantLock$$=!0,t.state=null!=t.tag.prototype&&"function"==typeof t.tag.prototype.view?new t.tag(t):t.tag(t)}j(t.state,t,n),null!=t.attrs&&j(t.attrs,t,n);if(t.instance=e.normalize(a.call(t.state.view,t)),t.instance===t)throw Error("A view cannot return the vnode it received as argument");i.$$reentrantLock$$=null})(n,i),null!=n.instance?(u(t,n.instance,i,r,s),n.dom=n.instance.dom,n.domSize=null!=n.dom?n.instance.domSize:0):n.domSize=0}(t,n,r,o,l)}var h={caption:"table",thead:"table",tbody:"table",tfoot:"table",tr:"tbody",th:"tr",td:"tr",colgroup:"table",col:"colgroup"};function d(e,t,n,r){var s=t.children.match(/^\s*?<(\w+)/im)||[],o=i.createElement(h[s[1]]||"div");"http://www.w3.org/2000/svg"===n?(o.innerHTML='<svg xmlns="http://www.w3.org/2000/svg">'+t.children+"</svg>",o=o.firstChild):o.innerHTML=t.children,t.dom=o.firstChild,t.domSize=o.childNodes.length,t.instance=[];for(var a,l=i.createDocumentFragment();a=o.firstChild;)t.instance.push(a),l.appendChild(a);w(e,l,r)}function g(e,t,n,i,r,s){if(t!==n&&(null!=t||null!=n))if(null==t||0===t.length)c(e,n,0,n.length,i,r,s);else if(null==n||0===n.length)T(e,t,0,t.length);else{var o=null!=t[0]&&null!=t[0].key,a=null!=n[0]&&null!=n[0].key,l=0,h=0;if(!o)for(;h<t.length&&null==t[h];)h++;if(!a)for(;l<n.length&&null==n[l];)l++;if(o!==a)T(e,t,h,t.length),c(e,n,l,n.length,i,r,s);else if(a){for(var d,g,y,w,x,C=t.length-1,k=n.length-1;C>=h&&k>=l&&(y=t[C],w=n[k],y.key===w.key);)y!==w&&f(e,y,w,i,r,s),null!=w.dom&&(r=w.dom),C--,k--;for(;C>=h&&k>=l&&(d=t[h],g=n[l],d.key===g.key);)h++,l++,d!==g&&f(e,d,g,i,b(t,h,r),s);for(;C>=h&&k>=l&&l!==k&&d.key===w.key&&y.key===g.key;)v(e,y,x=b(t,h,r)),y!==g&&f(e,y,g,i,x,s),++l<=--k&&v(e,d,r),d!==w&&f(e,d,w,i,r,s),null!=w.dom&&(r=w.dom),h++,y=t[--C],w=n[k],d=t[h],g=n[l];for(;C>=h&&k>=l&&y.key===w.key;)y!==w&&f(e,y,w,i,r,s),null!=w.dom&&(r=w.dom),k--,y=t[--C],w=n[k];if(l>k)T(e,t,h,C+1);else if(h>C)c(e,n,l,k+1,i,r,s);else{var E,R,O=r,I=k-l+1,$=new Array(I),U=0,A=0,P=2147483647,_=0;for(A=0;A<I;A++)$[A]=-1;for(A=k;A>=l;A--){null==E&&(E=p(t,h,C+1));var S=E[(w=n[A]).key];null!=S&&(P=S<P?S:-1,$[A-l]=S,y=t[S],t[S]=null,y!==w&&f(e,y,w,i,r,s),null!=w.dom&&(r=w.dom),_++)}if(r=O,_!==C-h+1&&T(e,t,h,C+1),0===_)c(e,n,l,k+1,i,r,s);else if(-1===P)for(R=function(e){var t=[0],n=0,i=0,r=0,s=m.length=e.length;for(r=0;r<s;r++)m[r]=e[r];for(r=0;r<s;++r)if(-1!==e[r]){var o=t[t.length-1];if(e[o]<e[r])m[r]=o,t.push(r);else{for(n=0,i=t.length-1;n<i;){var a=(n>>>1)+(i>>>1)+(n&i&1);e[t[a]]<e[r]?n=a+1:i=a}e[r]<e[t[n]]&&(n>0&&(m[r]=t[n-1]),t[n]=r)}}n=t.length,i=t[n-1];for(;n-- >0;)t[n]=i,i=m[i];return m.length=0,t}($),U=R.length-1,A=k;A>=l;A--)g=n[A],-1===$[A-l]?u(e,g,i,s,r):R[U]===A-l?U--:v(e,g,r),null!=g.dom&&(r=n[A].dom);else for(A=k;A>=l;A--)g=n[A],-1===$[A-l]&&u(e,g,i,s,r),null!=g.dom&&(r=n[A].dom)}}else{var F=t.length<n.length?t.length:n.length;for(l=l<h?l:h;l<F;l++)(d=t[l])===(g=n[l])||null==d&&null==g||(null==d?u(e,g,i,s,b(t,l+1,r)):null==g?L(e,d):f(e,d,g,i,b(t,l+1,r),s));t.length>F&&T(e,t,l,t.length),n.length>F&&c(e,n,l,n.length,i,r,s)}}}function f(t,n,i,r,o,l){var c=n.tag;if(c===i.tag){if(i.state=n.state,i.events=n.events,function(e,t){do{var n;if(null!=e.attrs&&"function"==typeof e.attrs.onbeforeupdate)if(void 0!==(n=a.call(e.attrs.onbeforeupdate,e,t))&&!n)break;if("string"!=typeof e.tag&&"function"==typeof e.state.onbeforeupdate)if(void 0!==(n=a.call(e.state.onbeforeupdate,e,t))&&!n)break;return!1}while(0);return e.dom=t.dom,e.domSize=t.domSize,e.instance=t.instance,e.attrs=t.attrs,e.children=t.children,e.text=t.text,!0}(i,n))return;if("string"==typeof c)switch(null!=i.attrs&&z(i.attrs,i,r),c){case"#":!function(e,t){e.children.toString()!==t.children.toString()&&(e.dom.nodeValue=t.children);t.dom=e.dom}(n,i);break;case"<":!function(e,t,n,i,r){t.children!==n.children?(C(e,t),d(e,n,i,r)):(n.dom=t.dom,n.domSize=t.domSize,n.instance=t.instance)}(t,n,i,l,o);break;case"[":!function(e,t,n,i,r,s){g(e,t.children,n.children,i,r,s);var o=0,a=n.children;if(n.dom=null,null!=a){for(var l=0;l<a.length;l++){var c=a[l];null!=c&&null!=c.dom&&(null==n.dom&&(n.dom=c.dom),o+=c.domSize||1)}1!==o&&(n.domSize=o)}}(t,n,i,r,o,l);break;default:!function(e,t,n,i){var r=t.dom=e.dom;i=s(t)||i,"textarea"===t.tag&&null==t.attrs&&(t.attrs={});(function(e,t,n,i){if(null!=n){"input"===e.tag&&null!=n.type&&e.dom.setAttribute("type",n.type);var r="input"===e.tag&&"file"===n.type;for(var s in n)R(e,s,t&&t[s],n[s],i,r)}var o;if(null!=t)for(var s in t)null==(o=t[s])||null!=n&&null!=n[s]||O(e,s,o,i)})(t,e.attrs,t.attrs,i),x(t)||g(r,e.children,t.children,n,null,i)}(n,i,r,l)}else!function(t,n,i,r,s,o){if(i.instance=e.normalize(a.call(i.state.view,i)),i.instance===i)throw Error("A view cannot return the vnode it received as argument");z(i.state,i,r),null!=i.attrs&&z(i.attrs,i,r);null!=i.instance?(null==n.instance?u(t,i.instance,r,o,s):f(t,n.instance,i.instance,r,s,o),i.dom=i.instance.dom,i.domSize=i.instance.domSize):null!=n.instance?(L(t,n.instance),i.dom=void 0,i.domSize=0):(i.dom=n.dom,i.domSize=n.domSize)}(t,n,i,r,o,l)}else L(t,n),u(t,i,r,l,o)}function p(e,t,n){for(var i=Object.create(null);t<n;t++){var r=e[t];if(null!=r){var s=r.key;null!=s&&(i[s]=t)}}return i}var m=[];function b(e,t,n){for(;t<e.length;t++)if(null!=e[t]&&null!=e[t].dom)return e[t].dom;return n}function v(e,t,n){var r=i.createDocumentFragment();y(e,r,t),w(e,r,n)}function y(e,t,n){for(;null!=n.dom&&n.dom.parentNode===e;){if("string"!=typeof n.tag){if(null!=(n=n.instance))continue}else if("<"===n.tag)for(var i=0;i<n.instance.length;i++)t.appendChild(n.instance[i]);else if("["!==n.tag)t.appendChild(n.dom);else if(1===n.children.length){if(null!=(n=n.children[0]))continue}else for(i=0;i<n.children.length;i++){var r=n.children[i];null!=r&&y(e,t,r)}break}}function w(e,t,n){null!=n?e.insertBefore(t,n):e.appendChild(t)}function x(e){if(null==e.attrs||null==e.attrs.contenteditable&&null==e.attrs.contentEditable)return!1;var t=e.children;if(null!=t&&1===t.length&&"<"===t[0].tag){var n=t[0].children;e.dom.innerHTML!==n&&(e.dom.innerHTML=n)}else if(null!=t&&0!==t.length)throw new Error("Child node of a contenteditable must be trusted.");return!0}function T(e,t,n,i){for(var r=n;r<i;r++){var s=t[r];null!=s&&L(e,s)}}function L(e,t){var n,i,r,s=0,l=t.state;"string"!=typeof t.tag&&"function"==typeof t.state.onbeforeremove&&(null!=(r=a.call(t.state.onbeforeremove,t))&&"function"==typeof r.then&&(s=1,n=r));t.attrs&&"function"==typeof t.attrs.onbeforeremove&&(null!=(r=a.call(t.attrs.onbeforeremove,t))&&"function"==typeof r.then&&(s|=2,i=r));if(o(t,l),s){if(null!=n){var c=function(){1&s&&((s&=2)||u())};n.then(c,c)}if(null!=i){c=function(){2&s&&((s&=1)||u())};i.then(c,c)}}else E(t),k(e,t);function u(){o(t,l),E(t),k(e,t)}}function C(e,t){for(var n=0;n<t.instance.length;n++)e.removeChild(t.instance[n])}function k(e,t){for(;null!=t.dom&&t.dom.parentNode===e;){if("string"!=typeof t.tag){if(null!=(t=t.instance))continue}else if("<"===t.tag)C(e,t);else{if("["!==t.tag&&(e.removeChild(t.dom),!Array.isArray(t.children)))break;if(1===t.children.length){if(null!=(t=t.children[0]))continue}else for(var n=0;n<t.children.length;n++){var i=t.children[n];null!=i&&k(e,i)}}break}}function E(e){if("string"!=typeof e.tag&&"function"==typeof e.state.onremove&&a.call(e.state.onremove,e),e.attrs&&"function"==typeof e.attrs.onremove&&a.call(e.attrs.onremove,e),"string"!=typeof e.tag)null!=e.instance&&E(e.instance);else{var t=e.children;if(Array.isArray(t))for(var n=0;n<t.length;n++){var i=t[n];null!=i&&E(i)}}}function R(e,t,n,r,s,o){if(!("key"===t||"is"===t||null==r||I(t)||n===r&&!function(e,t){return"value"===t||"checked"===t||"selectedIndex"===t||"selected"===t&&e.dom===l()||"option"===e.tag&&e.dom.parentNode===i.activeElement}(e,t)&&"object"!=typeof r||"type"===t&&"input"===e.tag)){if("o"===t[0]&&"n"===t[1])return N(e,t,r);if("xlink:"===t.slice(0,6))e.dom.setAttributeNS("http://www.w3.org/1999/xlink",t.slice(6),r);else if("style"===t)S(e.dom,n,r);else if($(e,t,s)){if("value"===t){if(("input"===e.tag||"textarea"===e.tag)&&e.dom.value===""+r&&(o||e.dom===l()))return;if("select"===e.tag&&null!==n&&e.dom.value===""+r)return;if("option"===e.tag&&null!==n&&e.dom.value===""+r)return;if(o&&""+r!="")return}e.dom[t]=r}else"boolean"==typeof r?r?e.dom.setAttribute(t,""):e.dom.removeAttribute(t):e.dom.setAttribute("className"===t?"class":t,r)}}function O(e,t,n,i){if("key"!==t&&"is"!==t&&null!=n&&!I(t))if("o"===t[0]&&"n"===t[1])N(e,t,void 0);else if("style"===t)S(e.dom,n,null);else if(!$(e,t,i)||"className"===t||"title"===t||"value"===t&&("option"===e.tag||"select"===e.tag&&-1===e.dom.selectedIndex&&e.dom===l())||"input"===e.tag&&"type"===t){var r=t.indexOf(":");-1!==r&&(t=t.slice(r+1)),!1!==n&&e.dom.removeAttribute("className"===t?"class":t)}else e.dom[t]=null}function I(e){return"oninit"===e||"oncreate"===e||"onupdate"===e||"onremove"===e||"onbeforeremove"===e||"onbeforeupdate"===e}function $(e,t,n){return void 0===n&&(e.tag.indexOf("-")>-1||null!=e.attrs&&e.attrs.is||"href"!==t&&"list"!==t&&"form"!==t&&"width"!==t&&"height"!==t)&&t in e.dom}var U,A=/[A-Z]/g;function P(e){return"-"+e.toLowerCase()}function _(e){return"-"===e[0]&&"-"===e[1]?e:"cssFloat"===e?"float":e.replace(A,P)}function S(e,t,n){if(t===n);else if(null==n)e.style.cssText="";else if("object"!=typeof n)e.style.cssText=n;else if(null==t||"object"!=typeof t)for(var i in e.style.cssText="",n){null!=(r=n[i])&&e.style.setProperty(_(i),String(r))}else{for(var i in n){var r;null!=(r=n[i])&&(r=String(r))!==String(t[i])&&e.style.setProperty(_(i),r)}for(var i in t)null!=t[i]&&null==n[i]&&e.style.removeProperty(_(i))}}function F(){this._=n}function N(e,t,i){if(null!=e.events){if(e.events._=n,e.events[t]===i)return;null==i||"function"!=typeof i&&"object"!=typeof i?(null!=e.events[t]&&e.dom.removeEventListener(t.slice(2),e.events,!1),e.events[t]=void 0):(null==e.events[t]&&e.dom.addEventListener(t.slice(2),e.events,!1),e.events[t]=i)}else null==i||"function"!=typeof i&&"object"!=typeof i||(e.events=new F,e.dom.addEventListener(t.slice(2),e.events,!1),e.events[t]=i)}function j(e,t,n){"function"==typeof e.oninit&&a.call(e.oninit,t),"function"==typeof e.oncreate&&n.push(a.bind(e.oncreate,t))}function z(e,t,n){"function"==typeof e.onupdate&&n.push(a.bind(e.onupdate,t))}return F.prototype=Object.create(null),F.prototype.handleEvent=function(e){var t,n=this["on"+e.type];"function"==typeof n?t=n.call(e.currentTarget,e):"function"==typeof n.handleEvent&&n.handleEvent(e),this._&&!1!==e.redraw&&(0,this._)(),!1===t&&(e.preventDefault(),e.stopPropagation())},function(t,i,r){if(!t)throw new TypeError("DOM element being rendered to does not exist.");if(null!=U&&t.contains(U))throw new TypeError("Node is currently being rendered to and thus is locked.");var s=n,o=U,a=[],c=l(),u=t.namespaceURI;U=t,n="function"==typeof r?r:void 0;try{null==t.vnodes&&(t.textContent=""),i=e.normalizeChildren(Array.isArray(i)?i:[i]),g(t,t.vnodes,i,a,null,"http://www.w3.org/1999/xhtml"===u?void 0:u),t.vnodes=i,null!=c&&l()!==c&&"function"==typeof c.focus&&c.focus();for(var h=0;h<a.length;h++)a[h]()}finally{n=s,U=o}}},G}function X(){return K?Y:(K=1,Y=Q()("undefined"!=typeof window?window:null))}"undefined"!=typeof window?(void 0===window.Promise?window.Promise=J:window.Promise.prototype.finally||(window.Promise.prototype.finally=J.prototype.finally),D.exports=window.Promise):void 0!==e?(void 0===e.Promise?e.Promise=J:e.Promise.prototype.finally||(e.Promise.prototype.finally=J.prototype.finally),D.exports=e.Promise):D.exports=J;var Z,ee,te,ne,ie,re,se=x(),oe=function(e,t,n){var i=[],r=!1,s=-1;function o(){for(s=0;s<i.length;s+=2)try{e(i[s],se(i[s+1]),a)}catch(e){n.error(e)}s=-1}function a(){r||(r=!0,t((function(){r=!1,o()})))}return a.sync=o,{mount:function(t,n){if(null!=n&&null==n.view&&"function"!=typeof n)throw new TypeError("m.mount expects a component, not a vnode.");var r=i.indexOf(t);r>=0&&(i.splice(r,2),r<=s&&(s-=2),e(t,[])),null!=n&&(i.push(t,n),e(t,se(n),a))},redraw:a}}(X(),"undefined"!=typeof requestAnimationFrame?requestAnimationFrame:null,"undefined"!=typeof console?console:null);function ae(){return ee||(ee=1,Z=function(e){if("[object Object]"!==Object.prototype.toString.call(e))return"";var t=[];for(var n in e)i(n,e[n]);return t.join("&");function i(e,n){if(Array.isArray(n))for(var r=0;r<n.length;r++)i(e+"["+r+"]",n[r]);else if("[object Object]"===Object.prototype.toString.call(n))for(var r in n)i(e+"["+r+"]",n[r]);else t.push(encodeURIComponent(e)+(null!=n&&""!==n?"="+encodeURIComponent(n):""))}}),Z}function le(){if(ne)return te;ne=1;var e=E();return te=Object.assign||function(t,n){for(var i in n)e.call(n,i)&&(t[i]=n[i])}}function ce(){if(re)return ie;re=1;var e=ae(),t=le();return ie=function(n,i){if(/:([^\/\.-]+)(\.{3})?:/.test(n))throw new SyntaxError("Template parameter names must be separated by either a '/', '-', or '.'.");if(null==i)return n;var r=n.indexOf("?"),s=n.indexOf("#"),o=s<0?n.length:s,a=r<0?o:r,l=n.slice(0,a),c={};t(c,i);var u=l.replace(/:([^\/\.-]+)(\.{3})?/g,(function(e,t,n){return delete c[t],null==i[t]?e:n?i[t]:encodeURIComponent(String(i[t]))})),h=u.indexOf("?"),d=u.indexOf("#"),g=d<0?u.length:d,f=h<0?g:h,p=u.slice(0,f);r>=0&&(p+=n.slice(r,o)),h>=0&&(p+=(r<0?"?":"&")+u.slice(h,g));var m=e(c);return m&&(p+=(r<0&&h<0?"?":"&")+m),s>=0&&(p+=n.slice(s)),d>=0&&(p+=(s<0?"":"&")+u.slice(d)),p},ie}var ue,he,de,ge,fe,pe,me,be,ve,ye,we,xe,Te=ce(),Le=E(),Ce=function(e,t,n){var i=0;function r(e){return new t(e)}function s(e){return function(i,s){"string"!=typeof i?(s=i,i=i.url):null==s&&(s={});var o=new t((function(t,n){e(Te(i,s.params),s,(function(e){if("function"==typeof s.type)if(Array.isArray(e))for(var n=0;n<e.length;n++)e[n]=new s.type(e[n]);else e=new s.type(e);t(e)}),n)}));if(!0===s.background)return o;var a=0;function l(){0==--a&&"function"==typeof n&&n()}return function e(t){var n=t.then;return t.constructor=r,t.then=function(){a++;var i=n.apply(t,arguments);return i.then(l,(function(e){if(l(),0===a)throw e})),e(i)},t}(o)}}function o(e,t){for(var n in e.headers)if(Le.call(e.headers,n)&&n.toLowerCase()===t)return!0;return!1}return r.prototype=t.prototype,r.__proto__=t,{request:s((function(t,n,i,r){var s,a=null!=n.method?n.method.toUpperCase():"GET",l=n.body,c=(null==n.serialize||n.serialize===JSON.serialize)&&!(l instanceof e.FormData||l instanceof e.URLSearchParams),u=n.responseType||("function"==typeof n.extract?"":"json"),h=new e.XMLHttpRequest,d=!1,g=!1,f=h,p=h.abort;for(var m in h.abort=function(){d=!0,p.call(this)},h.open(a,t,!1!==n.async,"string"==typeof n.user?n.user:void 0,"string"==typeof n.password?n.password:void 0),c&&null!=l&&!o(n,"content-type")&&h.setRequestHeader("Content-Type","application/json; charset=utf-8"),"function"==typeof n.deserialize||o(n,"accept")||h.setRequestHeader("Accept","application/json, text/*"),n.withCredentials&&(h.withCredentials=n.withCredentials),n.timeout&&(h.timeout=n.timeout),h.responseType=u,n.headers)Le.call(n.headers,m)&&h.setRequestHeader(m,n.headers[m]);h.onreadystatechange=function(e){if(!d&&4===e.target.readyState)try{var s,o=e.target.status>=200&&e.target.status<300||304===e.target.status||/^file:\/\//i.test(t),a=e.target.response;if("json"===u){if(!e.target.responseType&&"function"!=typeof n.extract)try{a=JSON.parse(e.target.responseText)}catch(e){a=null}}else u&&"text"!==u||null==a&&(a=e.target.responseText);if("function"==typeof n.extract?(a=n.extract(e.target,n),o=!0):"function"==typeof n.deserialize&&(a=n.deserialize(a)),o)i(a);else{var l=function(){try{s=e.target.responseText}catch(e){s=a}var t=new Error(s);t.code=e.target.status,t.response=a,r(t)};0===h.status?setTimeout((function(){g||l()})):l()}}catch(e){r(e)}},h.ontimeout=function(e){g=!0;var t=new Error("Request timed out");t.code=e.target.status,r(t)},"function"==typeof n.config&&(h=n.config(h,n,t)||h)!==f&&(s=h.abort,h.abort=function(){d=!0,s.call(this)}),null==l?h.send():"function"==typeof n.serialize?h.send(n.serialize(l)):l instanceof e.FormData||l instanceof e.URLSearchParams?h.send(l):h.send(JSON.stringify(l))})),jsonp:s((function(t,n,r,s){var o=n.callbackName||"_mithril_"+Math.round(1e16*Math.random())+"_"+i++,a=e.document.createElement("script");e[o]=function(t){delete e[o],a.parentNode.removeChild(a),r(t)},a.onerror=function(){delete e[o],a.parentNode.removeChild(a),s(new Error("JSONP request failed"))},a.src=t+(t.indexOf("?")<0?"?":"&")+encodeURIComponent(n.callbackKey||"callback")+"="+encodeURIComponent(o),e.document.documentElement.appendChild(a)}))}}("undefined"!=typeof window?window:null,V,oe.redraw);function ke(){if(he)return ue;function e(e){try{return decodeURIComponent(e)}catch(t){return e}}return he=1,ue=function(t){if(""===t||null==t)return{};"?"===t.charAt(0)&&(t=t.slice(1));for(var n=t.split("&"),i={},r={},s=0;s<n.length;s++){var o=n[s].split("="),a=e(o[0]),l=2===o.length?e(o[1]):"";"true"===l?l=!0:"false"===l&&(l=!1);var c=a.split(/\]\[?|\[/),u=r;a.indexOf("[")>-1&&c.pop();for(var h=0;h<c.length;h++){var d=c[h],g=c[h+1],f=""==g||!isNaN(parseInt(g,10));if(""===d)null==i[a=c.slice(0,h).join()]&&(i[a]=Array.isArray(u)?u.length:0),d=i[a]++;else if("__proto__"===d)break;if(h===c.length-1)u[d]=l;else{var p=Object.getOwnPropertyDescriptor(u,d);null!=p&&(p=p.value),null==p&&(u[d]=p=f?[]:{}),u=p}}}return r},ue}function Ee(){if(ge)return de;ge=1;var e=ke();return de=function(t){var n=t.indexOf("?"),i=t.indexOf("#"),r=i<0?t.length:i,s=n<0?r:n,o=t.slice(0,s).replace(/\/{2,}/g,"/");return o?("/"!==o[0]&&(o="/"+o),o.length>1&&"/"===o[o.length-1]&&(o=o.slice(0,-1))):o="/",{path:o,params:n<0?{}:e(t.slice(n+1,r))}}}function Re(){if(pe)return fe;pe=1;var e=Ee();return fe=function(t){var n=e(t),i=Object.keys(n.params),r=[],s=new RegExp("^"+n.path.replace(/:([^\/.-]+)(\.{3}|\.(?!\.)|-)?|[\\^$*+.()|\[\]{}]/g,(function(e,t,n){return null==t?"\\"+e:(r.push({k:t,r:"..."===n}),"..."===n?"(.*)":"."===n?"([^/]+)\\.":"([^/]+)"+(n||""))}))+"$");return function(e){for(var t=0;t<i.length;t++)if(n.params[i[t]]!==e.params[i[t]])return!1;if(!r.length)return s.test(e.path);var o=s.exec(e.path);if(null==o)return!1;for(t=0;t<r.length;t++)e.params[r[t].k]=r[t].r?o[t+1]:decodeURIComponent(o[t+1]);return!0}},fe}function Oe(){if(be)return me;be=1;var e=E(),t=new RegExp("^(?:key|oninit|oncreate|onbeforeupdate|onupdate|onbeforeremove|onremove)$");return me=function(n,i){var r={};if(null!=i)for(var s in n)e.call(n,s)&&!t.test(s)&&i.indexOf(s)<0&&(r[s]=n[s]);else for(var s in n)e.call(n,s)&&!t.test(s)&&(r[s]=n[s]);return r}}var Ie=H,$e=Ce,Ue=oe,Ae=function(){return Ie.apply(this,arguments)};Ae.m=Ie,Ae.trust=Ie.trust,Ae.fragment=Ie.fragment,Ae.Fragment="[",Ae.mount=Ue.mount,Ae.route=function(){if(xe)return we;xe=1;var e=oe;return we=function(){if(ye)return ve;ye=1;var e=x(),t=S,n=V,i=ce(),r=Ee(),s=Re(),o=le(),a=Oe(),l={};function c(e){try{return decodeURIComponent(e)}catch(t){return e}}return ve=function(u,h){var d,g,f,p,m,b,v=null==u?null:"function"==typeof u.setImmediate?u.setImmediate:u.setTimeout,y=n.resolve(),w=!1,x=!1,T=0,L=l,C={onbeforeupdate:function(){return!(!(T=T?2:1)||l===L)},onremove:function(){u.removeEventListener("popstate",R,!1),u.removeEventListener("hashchange",E,!1)},view:function(){if(T&&l!==L){var t=[e(f,p.key,p)];return L&&(t=L.render(t[0])),t}}},k=I.SKIP={};function E(){w=!1;var e=u.location.hash;"#"!==I.prefix[0]&&(e=u.location.search+e,"?"!==I.prefix[0]&&"/"!==(e=u.location.pathname+e)[0]&&(e="/"+e));var t=e.concat().replace(/(?:%[a-f89][a-f0-9])+/gim,c).slice(I.prefix.length),n=r(t);function i(e){O(g,null,{replace:!0})}o(n.params,u.history.state),function e(r){for(;r<d.length;r++)if(d[r].check(n)){var s=d[r].component,o=d[r].route,a=s,l=b=function(i){if(l===b){if(i===k)return e(r+1);f=null==i||"function"!=typeof i.view&&"function"!=typeof i?"div":i,p=n.params,m=t,b=null,L=s.render?s:null,2===T?h.redraw():(T=2,h.redraw.sync())}};return void(s.view||"function"==typeof s?(s={},l(a)):s.onmatch?y.then((function(){return s.onmatch(n.params,t,o)})).then(l,t===g?null:i):l("div"))}if(t===g)throw new Error("Could not resolve default route "+g+".");O(g,null,{replace:!0})}(0)}function R(){w||(w=!0,v(E))}function O(e,t,n){if(e=i(e,t),x){R();var r=n?n.state:null,s=n?n.title:null;n&&n.replace?u.history.replaceState(r,s,I.prefix+e):u.history.pushState(r,s,I.prefix+e)}else u.location.href=I.prefix+e}function I(e,t,n){if(!e)throw new TypeError("DOM element being rendered to does not exist.");if(d=Object.keys(n).map((function(e){if("/"!==e[0])throw new SyntaxError("Routes must start with a '/'.");if(/:([^\/\.-]+)(\.{3})?:/.test(e))throw new SyntaxError("Route parameter names must be separated with either '/', '.', or '-'.");return{route:e,component:n[e],check:s(e)}})),g=t,null!=t){var i=r(t);if(!d.some((function(e){return e.check(i)})))throw new ReferenceError("Default route doesn't match any known routes.")}"function"==typeof u.history.pushState?u.addEventListener("popstate",R,!1):"#"===I.prefix[0]&&u.addEventListener("hashchange",E,!1),x=!0,h.mount(e,C),E()}return I.set=function(e,t,n){null!=b&&((n=n||{}).replace=!0),b=null,O(e,t,n)},I.get=function(){return m},I.prefix="#!",I.Link={view:function(e){var n,r,s,o=t(e.attrs.selector||"a",a(e.attrs,["options","params","selector","onclick"]),e.children);return(o.attrs.disabled=Boolean(o.attrs.disabled))?(o.attrs.href=null,o.attrs["aria-disabled"]="true"):(n=e.attrs.options,r=e.attrs.onclick,s=i(o.attrs.href,e.attrs.params),o.attrs.href=I.prefix+s,o.attrs.onclick=function(e){var t;"function"==typeof r?t=r.call(e.currentTarget,e):null==r||"object"!=typeof r||"function"==typeof r.handleEvent&&r.handleEvent(e),!1===t||e.defaultPrevented||0!==e.button&&0!==e.which&&1!==e.which||e.currentTarget.target&&"_self"!==e.currentTarget.target||e.ctrlKey||e.metaKey||e.shiftKey||e.altKey||(e.preventDefault(),e.redraw=!1,I.set(s,null,n))}),o}},I.param=function(e){return p&&null!=e?p[e]:p},I},ve}()("undefined"!=typeof window?window:null,e),we}(),Ae.render=X(),Ae.redraw=Ue.redraw,Ae.request=$e.request,Ae.jsonp=$e.jsonp,Ae.parseQueryString=ke(),Ae.buildQueryString=ae(),Ae.parsePathname=Ee(),Ae.buildPathname=ce(),Ae.vnode=x(),Ae.PromisePolyfill=W(),Ae.censor=Oe();var Pe=Ae;let _e={Android:()=>navigator.userAgent.match(/Android/i),BlackBerry:()=>navigator.userAgent.match(/BlackBerry/i),iOS:()=>navigator.userAgent.match(/iPhone|iPad|iPod/i),Opera:()=>navigator.userAgent.match(/Opera Mini/i),Windows:()=>navigator.userAgent.match(/IEMobile/i),any:()=>_e.Android()||_e.BlackBerry()||_e.iOS()||_e.Opera()||_e.Windows()},Se=null;function Fe(e){Se=e}function Ne(e){Se&&Se.fix&&(globalThis.innerHeight>=e.screenHeight-Se.fix.height?e.isFullscreen=!0:e.isFullscreen=!1)}let je={name:"chrome",0:{offset:{x:0,y:0,width:0,height:0},fix:{height:68}},90:{offset:{x:0,y:0,width:0,height:0},fix:{height:28}},"-90":{offset:{x:0,y:0,width:0,height:0},fix:{height:28}},270:{offset:{x:0,y:0,width:0,height:0},fix:{height:28}},180:{offset:{x:0,y:0,width:0,height:0},fix:{height:68}}};var ze=Object.freeze({__proto__:null,checkFullscreen:function(e){Ne(e)},getCurrentValue:function(){return Se},setCurrentValue:function(e){Fe(je[e])},value:je});let Me={name:"firefox",0:{offset:0,fix:{height:26}},90:{offset:0,fix:{height:26}},"-90":{offset:0,fix:{height:26}},270:{offset:0,fix:{height:26}},180:{offset:0,fix:{height:26}}};var Be=Object.freeze({__proto__:null,checkFullscreen:function(e){Ne(e)},getCurrentValue:function(){return Se},setCurrentValue:function(e){Fe(Me[e])},value:Me});let He={name:"opera",0:{offset:0,fix:{height:114}},90:{offset:0,fix:{height:72}},"-90":{offset:0,fix:{height:72}},270:{offset:0,fix:{height:72}},180:{offset:0,fix:{height:114}}};var Ve=Object.freeze({__proto__:null,checkFullscreen:function(e){Ne(e)},getCurrentValue:function(){return Se},setCurrentValue:function(e){Fe(He[e])},value:He});let De={name:"uc",0:{offset:0,fix:{height:0}},90:{offset:0,fix:{height:0}},"-90":{offset:0,fix:{height:0}},270:{offset:0,fix:{height:0}},180:{offset:0,fix:{height:0}}};var We=Object.freeze({__proto__:null,checkFullscreen:function(e){Ne(e)},getCurrentValue:function(){return Se},setCurrentValue:function(e){Fe(De[e])},value:De});let Ge={name:"baidu",0:{offset:{x:0,y:0,width:0,height:0},fix:{height:87}},90:{offset:0,fix:{height:87}},"-90":{offset:0,fix:{height:87}},270:{offset:0,fix:{height:87}},180:{offset:0,fix:{height:87}}};var qe=Object.freeze({__proto__:null,checkFullscreen:function(e){Ne(e)},getCurrentValue:function(){return Se},setCurrentValue:function(e){Fe(Ge[e])},value:Ge});let Ye={name:"lieao",0:{offset:{x:0,y:0,width:0,height:0},fix:{height:0}},90:{offset:0,fix:{height:0}},"-90":{offset:0,fix:{height:0}},270:{offset:0,fix:{height:0}},180:{offset:0,fix:{height:0}}};var Ke=Object.freeze({__proto__:null,checkFullscreen:function(e){Ne(e)},getCurrentValue:function(){return Se},setCurrentValue:function(e){Fe(Ye[e])},value:Ye});let Je={name:"unknown",0:{offset:{x:0,y:0,width:0,height:0},fix:{height:0}},90:{offset:0,fix:{height:0}},"-90":{offset:0,fix:{height:0}},270:{offset:0,fix:{height:0}},180:{offset:0,fix:{height:0}}};var Qe=Object.freeze({__proto__:null,checkFullscreen:function(e){Ne(e)},getCurrentValue:function(){return Se},setCurrentValue:function(e){Fe(Je[e])},value:Je});let Xe={name:"chrome",0:{offset:{x:0,y:0,width:0,height:4},fix:{height:24}},90:{offset:{x:0,y:0,width:0,height:4},fix:{height:24}},"-90":{offset:{x:0,y:0,width:0,height:4},fix:{height:24}},180:{offset:{x:0,y:0,width:0,height:4},fix:{height:24}}},Ze=null;var et=Object.freeze({__proto__:null,checkFullscreen:function(e){Ze&&Ze.fix&&(globalThis.innerHeight>=e.screenHeight-Ze.fix.height?e.isFullscreen=!0:e.isFullscreen=!1)},eventOrientation:function(e){let t=Xe.state;switch(Ze=Xe[e],Fe(Ze),e){case 0:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!0,t.isLandscape=!1),t.screenHeight=screen.height,t.screenWidth=screen.width;break;case-90:case 90:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!1,t.isLandscape=!0),screen.width<screen.height?(t.screenHeight=screen.width,t.screenWidth=screen.height):(t.screenHeight=screen.height,t.screenWidth=screen.width);break;case 180:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!0,t.isLandscape=!1),t.screenHeight=screen.height,t.screenWidth=screen.width}},getCurrentValue:function(){return Se},value:Xe});let tt={name:"firefox",0:{offset:{x:0,y:0,width:0,height:4},fix:{height:40}},90:{offset:{x:0,y:0,width:0,height:4},fix:{height:8}},"-90":{offset:{x:0,y:0,width:0,height:4},fix:{height:8}},180:{offset:{x:0,y:0,width:0,height:4},fix:{height:40}}},nt=null;var it=Object.freeze({__proto__:null,checkFullscreen:function(e){nt&&nt.fix&&(globalThis.innerHeight>=e.screenHeight-nt.fix.height?e.isFullscreen=!0:e.isFullscreen=!1)},eventOrientation:function(e){let t=tt.state;switch(nt=tt[e],Fe(nt),e){case 0:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!0,t.isLandscape=!1),t.screenHeight=screen.height,t.screenWidth=screen.width;break;case-90:case 90:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!1,t.isLandscape=!0),screen.width<screen.height?(t.screenHeight=screen.width,t.screenWidth=screen.height):(t.screenHeight=screen.height,t.screenWidth=screen.width);break;case 180:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!0,t.isLandscape=!1),t.screenHeight=screen.height,t.screenWidth=screen.width}globalThis.outerWidth<globalThis.innerWidth&&(globalThis.outerWidth=globalThis.innerWidth),globalThis.outerHeight<globalThis.innerHeight&&(globalThis.outerHeight=globalThis.innerHeight)},getCurrentValue:function(){return Se},value:tt});let rt={name:"uc",0:{offset:{x:0,y:0,width:0,height:4},fix:{height:82}},90:{offset:{x:0,y:0,width:0,height:4},fix:{height:100}},"-90":{offset:{x:0,y:0,width:0,height:4},fix:{height:100}},180:{offset:{x:0,y:0,width:0,height:4},fix:{height:82}}},st=null;var ot=Object.freeze({__proto__:null,checkFullscreen:function(e){e.isFullscreen=!0},eventOrientation:function(e){let t=rt.state;switch(st=rt[e],Fe(st),e){case 0:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!0,t.isLandscape=!1),t.screenHeight=screen.height,t.screenWidth=screen.width;break;case-90:case 90:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!1,t.isLandscape=!0),screen.width<screen.height?(t.screenHeight=screen.width,t.screenWidth=screen.height):(t.screenHeight=screen.height,t.screenWidth=screen.width);break;case 180:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!0,t.isLandscape=!1),t.screenHeight=screen.height,t.screenWidth=screen.width}},getCurrentValue:function(){return Se},value:rt});let at={name:"safari",0:{offset:{x:0,y:0,width:0,height:4},fix:{height:32}},90:{offset:{x:0,y:0,width:0,height:4},fix:{height:16}},"-90":{offset:{x:0,y:0,width:0,height:4},fix:{height:16}},180:{offset:{x:0,y:0,width:0,height:4},fix:{height:32}}},lt=null;var ct=Object.freeze({__proto__:null,checkFullscreen:function(e){lt&&lt.fix&&(globalThis.innerHeight>=e.screenHeight-lt.fix.height?e.isFullscreen=!0:e.isFullscreen=!1)},eventOrientation:function(e){let t=at.state;switch(lt=at[e],Fe(lt),e){case 0:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!0,t.isLandscape=!1),t.screenHeight=screen.height,t.screenWidth=screen.width;break;case-90:case 90:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!1,t.isLandscape=!0),screen.width<screen.height?(t.screenHeight=screen.width,t.screenWidth=screen.height):(t.screenHeight=screen.height,t.screenWidth=screen.width);break;case 180:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!0,t.isLandscape=!1),t.screenHeight=screen.height,t.screenWidth=screen.width}},getCurrentValue:function(){return Se},value:at});let ut={name:"baidu",0:{offset:{x:0,y:0,width:0,height:4},fix:{height:0}},90:{offset:{x:0,y:0,width:0,height:4},fix:{height:0}},"-90":{offset:{x:0,y:0,width:0,height:4},fix:{height:0}},180:{offset:{x:0,y:0,width:0,height:4},fix:{height:0}}},ht=null;var dt=Object.freeze({__proto__:null,checkFullscreen:function(e){ht&&ht.fix&&(globalThis.innerHeight>=e.screenHeight-ht.fix.height?e.isFullscreen=!0:e.isFullscreen=!1)},eventOrientation:function(e){let t=ut.state;switch(ht=ut[e],Fe(ht),e){case 0:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!0,t.isLandscape=!1),t.screenHeight=screen.height,t.screenWidth=screen.width;break;case-90:case 90:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!1,t.isLandscape=!0),screen.width<screen.height?(t.screenHeight=screen.width,t.screenWidth=screen.height):(t.screenHeight=screen.height,t.screenWidth=screen.width);break;case 180:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!0,t.isLandscape=!1),t.screenHeight=screen.height,t.screenWidth=screen.width}},getCurrentValue:function(){return Se},value:ut});let gt={name:"liebao",0:{offset:{x:0,y:0,width:0,height:4},fix:{height:24}},90:{offset:{x:0,y:0,width:0,height:4},fix:{height:24}},"-90":{offset:{x:0,y:0,width:0,height:4},fix:{height:24}},180:{offset:{x:0,y:0,width:0,height:4},fix:{height:24}}},ft=null;var pt=Object.freeze({__proto__:null,checkFullscreen:function(e){ft&&ft.fix&&(globalThis.innerHeight>=e.screenHeight-ft.fix.height?e.isFullscreen=!0:e.isFullscreen=!1)},eventOrientation:function(e){let t=gt.state;switch(ft=gt[e],Fe(ft),e){case 0:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!0,t.isLandscape=!1),t.screenHeight=screen.height,t.screenWidth=screen.width;break;case-90:case 90:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!1,t.isLandscape=!0),screen.width<screen.height?(t.screenHeight=screen.width,t.screenWidth=screen.height):(t.screenHeight=screen.height,t.screenWidth=screen.width);break;case 180:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!0,t.isLandscape=!1),t.screenHeight=screen.height,t.screenWidth=screen.width}},getCurrentValue:function(){return Se},value:gt});let mt={name:"unknown",0:{offset:{x:0,y:0,width:0,height:4},fix:{height:0}},90:{offset:{x:0,y:0,width:0,height:4},fix:{height:0}},"-90":{offset:{x:0,y:0,width:0,height:4},fix:{height:0}},180:{offset:{x:0,y:0,width:0,height:4},fix:{height:0}}},bt=null;var vt=Object.freeze({__proto__:null,checkFullscreen:function(e){bt&&bt.fix&&(globalThis.innerHeight>=e.screenHeight-bt.fix.height?e.isFullscreen=!0:e.isFullscreen=!1),e.isFullscreen=!0},eventOrientation:function(e){let t=mt.state;switch(bt=mt[e],Fe(bt),e){case 0:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!0,t.isLandscape=!1),t.screenHeight=screen.height,t.screenWidth=screen.width;break;case-90:case 90:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!1,t.isLandscape=!0),screen.width<screen.height?(t.screenHeight=screen.width,t.screenWidth=screen.height):(t.screenHeight=screen.height,t.screenWidth=screen.width);break;case 180:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!0,t.isLandscape=!1),t.screenHeight=screen.height,t.screenWidth=screen.width}},getCurrentValue:function(){return Se},value:mt});function yt(e){let t=!1;return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement?(t=!0,e&&(e.isFullscreen=!0)):(t=!1,e&&(e.isFullscreen=!1)),t}async function wt(e){if(!document.fullscreenEnabled)return Promise.reject();let t=!1;document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement?(e&&(e.isFullscreen=!1),document.exitFullscreen?(await document.exitFullscreen(),t=!0):document.msExitFullscreen?(await document.msExitFullscreen(),t=!0):document.mozCancelFullScreen?(await document.mozCancelFullScreen(),t=!0):document.webkitExitFullscreen&&(await document.webkitExitFullscreen(),t=!0),t&&e&&(e.isFullscreen=!1)):(document.documentElement.requestFullscreen?(await document.documentElement.requestFullscreen(),t=!0):document.documentElement.msRequestFullscreen?(await document.documentElement.msRequestFullscreen(),t=!0):document.documentElement.mozRequestFullScreen?(await document.documentElement.mozRequestFullScreen(),t=!0):document.documentElement.webkitRequestFullscreen&&(await document.documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT),t=!0),t&&(e&&(e.isFullscreen=!0),Rt.useOrientation&&globalThis.screen&&globalThis.screen.orientation&&globalThis.screen.orientation.lock&&await globalThis.screen.orientation.lock(Rt.orientation.name)))}let xt=!0,Tt=!1;let Lt={oninit(e){let t=this,n=e.attrs;t.onclick=n.onclick,t.style=n.style,t.config=n.config},onbeforeremove(){},view(){let e=this,t=e.config;return Pe(".pointer",{style:{width:"4%",height:"10%",borderRadius:"4px 8px 8px 4px",backgroundColor:"#000",opacity:.6,position:"absolute",left:e.style.left,top:e.style.top,zIndex:900},onclick(){t&&(t.isMenu=!0,t.visible=!1),e.onclick&&e.onclick()}},Pe.trust('<img src="data/sys/4021bb29611b24c4.svg" class="w-100 h-100 dropshadow">'))}},Ct={oninit(e){let t=e.attrs,n=this;n.event=t.event,n.tray=t.tray,n.info=t.info,n.config=t.config,n.isLeave=!1,n.config||(n.config={isMenu:Tt,visible:xt,flags:{fullscreen:!0,lock:!0,sound:!0,music:!0}}),n.config.flags||(n.config.flags={}),n.info||(n.info={logo:"logo.png",gameName:"test game",version:"0.0.0",mode:" test mode",token:"token"}),n.tray||(n.tray={state:{visible:!0},sound:{isMute:!1},music:{isMute:!1},screen:{isAutoScale:!0,isLock:!1},isLock:!1,isFullscreen:!1},Object.defineProperty(n.tray,"visible",{get:()=>n.tray.state.visible,set(e){n.tray.state.visible=e}}))},onbeforeremove:e=>(["animate__fadeOutLeft","animate__animated"].forEach((t=>{e.dom.classList.add(t)})),new Promise((e=>{h.setTimeout((()=>{e()}),.4)}))),onremove(){},view(){let e=this,n=e.tray,i=e.event,r=e.info,s=e.config,o=s.flags,a=t.menu||[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0];return Pe(".animate__fadeInLeft animate__animated",{onclick(){e.isLeave?(s.isMenu=!1,s.visible=!1,n.visible=!1):(s.visible=!1,n.visible=!0)},style:{zIndex:900,position:"absolute",left:"0%",top:"0%",width:"100%",height:"100%"}},Pe(".pv2.ph2.bg-black.[id='panel']",[Pe(".fl.bb.b--gray.mb2.dib.pb2.mb2.w-100.rwdPanelHeader",[Pe("table.pa2.ml4.dib.br2.bg-black.white.rwdAppInfo",Pe("tbody.rwd-lh",[Pe("tr",[Pe("td",p("gameName")),Pe("td"," : "),Pe("td.blue",r.gameName)]),Pe("tr",[Pe("td",p("version")),Pe("td"," : "),Pe("td.blue",r.version)]),a[8]?Pe("tr",[Pe("td",p("gameMode")),Pe("td"," : "),Pe("td.blue",r.mode)]):null]))]),a[0]&&o.fullscreen&&!Rt.ios?Pe(".",[Pe(".fl.w-70.pa1.ma1.rwdOpt",Pe(".no-underline.near-white.inline-flex",[Pe("img.dib.fl.mv1.rwdOptIcon.dropshadow",{alt:"FULL SCREEN",src:"data/sys/f512613ddcb62054.png"}),Pe(".ml3.white.mv3.f4.rwdPanelFont",p("fullscreen"))])),Pe(".fr.w-20.pt2.mv2.mr2.rwdToggle",{onclick(){n.isFullscreen=!n.isFullscreen,Pe.redraw(),wt(n).then((()=>{i&&i.fullscreen&&i.fullscreen(n.isFullscreen)}))}},Pe("label.switch",[Pe("input[name='toggle'][type='checkbox'][value='fullscreen']",{disabled:!0,checked:n.isFullscreen}),Pe("span.slider.round")]))]):Pe("."),a[1]&&o.lock?Pe(".",[Pe(".fl.w-70.pa1.ma1.rwdOpt",Pe(".no-underline.near-white.inline-flex",[Pe("img.dib.fl.mv1.rwdOptIcon.dropshadow",{alt:"LOCK SCALE",src:"data/sys/8920df5ffd5c25b0.png"}),Pe(".ml3.white.mv3.f4.rwdPanelFont",p("lock"))])),Pe(".fr.w-20.pt2.mv2.mr2.rwdToggle",{onclick(){n.isLock=!n.isLock,n.update&&n.update(n),Pe.redraw(),i&&i.lock&&i.lock(n.isLock)}},Pe("label.switch",[Pe("input[name='toggle'][type='checkbox'][value='lock']",{disabled:!0,checked:n.isLock}),Pe("span.slider.round")]))]):Pe("."),a[2]&&o.music?Pe(".",[Pe(".fl.w-70.pa1.ma1.rwdOpt",Pe(".no-underline.near-white.inline-flex",[Pe("img.h-100.dib.fl.mv1.rwdOptIcon.dropshadow[alt='MUSIC'][src='data/sys/ddb7103e5eca70e6.png']"),Pe(".ml3.white.mv3.f4.rwdPanelFont",p("music"))])),Pe(".fr.w-20.pt2.mv2.mr2.rwdToggle",{onclick(){n.music.isMute=!n.music.isMute,Pe.redraw(),i&&i.music&&i.music(n.music)}},Pe("label.switch",[Pe("input[name='toggle'][type='checkbox'][value='music']",{disabled:!0,checked:!n.music.isMute}),Pe("span.slider.round")]))]):Pe("."),a[3]&&o.sound?Pe(".",[Pe(".fl.w-70.pa1.ma1.rwdOpt",Pe(".no-underline.near-white.inline-flex",[Pe("img.dib.fl.mv1.rwdOptIcon.dropshadow[alt='SOUND'][src='data/sys/ddb7103e5eca70e6.png']"),Pe(".ml3.white.mv3.f4.rwdPanelFont",p("sound"))])),Pe(".fr.w-20.pt2.mv2.mr2.rwdToggle",Pe("label.switch",[Pe("input[name='toggle'][type='checkbox'][value='sound']",{checked:!n.sound.isMute,onclick(){n.sound.isMute=!n.sound.isMute,i&&i.sound&&i.sound(n.sound)}}),Pe("span.slider.round")]))]):Pe("."),a[4]?Pe(".fl.w-100.pa2.pt3.bt.b--gray.mt2.rwdBtn",{onclick(){Rt.useFocus=!0}},Pe(".w-100 no-underline near-white bg-animate bg-near-black hover-bg-gray inline-flex items-center ma1 tc br1 pa1 border-box pointer",[Pe("img.dib h2 w2[src='data/sys/35b95e6d1d3ebf48.png']"),Pe(".w-100.f3.white.mv1.dib.noselect.rwdPanelFont",p("history"))])):Pe("."),a[5]?Pe(".fl.w-100.pa2",{onclick(){Rt.useFocus=!0}},Pe(".w-100 no-underline near-white bg-animate bg-near-black hover-bg-gray inline-flex items-center ma1 tc br1 pa1 border-box pointer",[Pe("img.dib h2 w2[src='data/sys/2357769f78f010b1.png']"),Pe(".w-100.f3.white.mv1.dib.noselect",p("deposit"))])):Pe("."),a[6]?Pe(".fl.w-100.pa2",{onclick(){globalThis.Howler&&(globalThis.Howler.mute(!0),globalThis.Howler.unload()),Rt.useFocus=!0}},Pe(".w-100 no-underline near-white bg-animate bg-near-black hover-bg-gray inline-flex items-center ma1 tc br1 pa1 border-box pointer",[Pe("img.dib h2 w2[src='data/sys/94615eed5b8c0616.png']"),Pe(".w-100.f3.white.mv1.dib.noselect",p("back"))])):Pe("."),a[7]?Pe(".fl.w-100.pa2",{onclick(){if(Rt.useFocus=!0,e.isLeave=!0,r.iframe){let e=r.iframe.contentDocument||r.iframe.contentglobalThis.document;e?(e.open(),e.write(""),e.close()):r.iframe.srcdoc="about:blank"}globalThis.Howler&&(globalThis.Howler.mute(!0),globalThis.Howler.unload())}},Pe(".w-100 no-underline near-white bg-animate bg-near-black hover-bg-gray inline-flex items-center ma1 tc br1 pa1 border-box pointer",[Pe("img.dib h2 w2[src='data/sys/fe342b264ea95dbb.png']"),Pe(".w-100.f3.white.mv1.dib.noselect",p("lobby"))])):Pe("."),Pe(".")]))}};function kt(e,t){return null!=e?e:t()}function Et(e){let t,n=e[0],i=1;for(;i<e.length;){const r=e[i],s=e[i+1];if(i+=2,("optionalAccess"===r||"optionalCall"===r)&&null==n)return;"access"===r||"optionalAccess"===r?(t=n,n=s(n)):"call"!==r&&"optionalCall"!==r||(n=s(((...e)=>n.call(t,...e))),t=void 0)}return n}let Rt={},Ot={resizeTimer:null,timer:null,eventDelay:260},It=null,$t={name:null,angle:0,isTrigger:!1},Ut=null;function At(e){switch(Ut&&Ut.setCurrentValue&&Ut.setCurrentValue(e),e){case 0:(Rt.usePortrait||Rt.useLandscape)&&(Rt.isPortrait=!0,Rt.isLandscape=!1),Rt.screenHeight=screen.height,Rt.screenWidth=screen.width;break;case 270:case-90:case-270:case 90:(Rt.usePortrait||Rt.useLandscape)&&(Rt.isPortrait=!1,Rt.isLandscape=!0),screen.width<screen.height?(Rt.screenHeight=screen.width,Rt.screenWidth=screen.height):(Rt.screenHeight=screen.height,Rt.screenWidth=screen.width);break;case-180:case 180:(Rt.usePortrait||Rt.useLandscape)&&(Rt.isPortrait=!0,Rt.isLandscape=!1),Rt.screenHeight=screen.height,Rt.screenWidth=screen.width}globalThis.parent===window&&globalThis.scrollTo(0,Rt.currentY)}function Pt(){Rt.isPortrait=!1,Rt.isLandscape=!1;let e=0;e=window.matchMedia("(orientation: portrait)").matches?0:90,0===e&&(e=globalThis.screen.orientation&&"number"==typeof globalThis.screen.orientation.angle?globalThis.screen.orientation.angle:parseInt(globalThis.orientation)),$t.angle=e,It?It(e):Ut&&Ut.eventOrientation?Ut.eventOrientation(e):At(e),globalThis.parent===window&&globalThis.scrollTo(0,Rt.currentY)}function _t(e){Ot.timer&&(h.remove(Ot.timer),Ot.timer=null),$t.isTrigger=!0,Pe.redraw(),Ot.timer=h.setTimeout((()=>{$t.isTrigger=!1,Pt(),Nt()}),.001*Ot.eventDelay)}function St(e){if(Rt.isMobile&&!e.isChild&&Ut&&Ut.getCurrentValue){let t=Ut.getCurrentValue();if(t){let n=t.offset;e.left=0,e.top=0,e.width=globalThis.innerWidth,e.height=globalThis.innerHeight,"number"==typeof n?e.height=globalThis.innerHeight-n:n&&("number"==typeof n.x&&(e.left=n.x),"number"==typeof n.y&&(e.top=n.y),"number"==typeof n.width&&(e.width=globalThis.innerWidth-n.width),"number"==typeof n.height&&(e.height=globalThis.innerHeight-n.height))}else e.left=0,e.top=0,e.width=globalThis.innerWidth,e.height=globalThis.innerHeight;e.left+="px",e.top+="px",e.width+="px",e.height+="px"}}function Ft(e){let t=e.game,n={x:1,y:1},i=screen.width,r=screen.height;Rt.isMobile?(i=globalThis.innerWidth,r=globalThis.innerHeight,Rt.useFullscreen||(i=globalThis.innerWidth,r=globalThis.innerHeight),Rt.ios&&(r=globalThis.innerHeight,i=globalThis.innerWidth)):(i=globalThis.innerWidth,r=globalThis.innerHeight),t.portrait&&t.landscape&&(i>r?(t.width=t.landscape.width||512,t.height=t.landscape.height||512):(t.width=t.portrait.width||512,t.height=t.portrait.height||512)),e.fix&&(i=parseInt(e.fix.width),r=parseInt(e.fix.height));let s={x:0,y:0};e.left=0,e.top=0;let o=e.reference;o&&(s.x=o.left*i,s.y=o.top*r,i*=o.width,r*=o.height),i-t.width<0?(e.width=i,n.x=i/t.width):e.width=t.width,r-t.height<0?(e.height=r,n.y=r/t.height):e.height=t.height,n.x<n.y?e.height=t.height*n.x:n.x>n.y&&(e.width=t.width*n.y);let a=e.anchor;if(a){let t=(i-e.width)*kt(a.x,(()=>.5)),n=(r-e.height)*kt(a.y,(()=>.5));e.left=s.x+t,e.top=s.y+n}if(e.useCenter){let t=0,n=0;"boolean"==typeof e.useCenter?(n=.5*(r-e.height),n<0&&(n=0),t=.5*(i-e.width),t<0&&(t=0)):(e.useCenter.vertical&&(n=.5*(r-e.height),n<0&&(n=0)),(e.useCenter.horizontal||e.useCenter.left)&&(t=.5*(i-e.width),t<0&&(t=0))),e.left=s.x+t,e.top=s.y+n}e.absPos&&("number"==typeof e.absPos.top?e.top=e.absPos.top:"number"==typeof e.absPos.bottom&&(e.top=r+e.absPos.bottom),"number"==typeof e.absPos.left?e.left=e.absPos.left:"number"==typeof e.absPos.right&&(e.left=i+e.absPos.right)),t.eventResize&&t.eventResize({left:e.left,top:e.top,width:e.width,height:e.height}),e.eventResize&&e.eventResize({width:globalThis.innerWidth,height:globalThis.innerHeight}),e.left+="px",e.top+="px",e.width+="px",e.height+="px"}function Nt(e){if(!$t.isTrigger&&!Rt.disableResize){if(!e)return!!$t.isTrigger||void(Ot.resizeTimer||(Rt.isResize=!0,Pe.redraw(),Ot.resizeTimer=h.setTimeout((()=>{h.remove(Ot.resizeTimer),Ot.resizeTimer=null,t()}),.3)));t()}function t(){Rt.isMobile&&globalThis.parent===window&&globalThis.scrollTo(0,Rt.currentY),h.setTimeout((()=>{Ut&&Ut.checkFullscreen&&Rt.useFullscreen&&Ut.checkFullscreen(Rt);let e=globalThis.scene;if(Rt.settingList.forEach((t=>{if(t){if(!t.isLock)return St(t),Pe.redraw(),!0;if(Ft(t),e){let n=e[t.id];if(n){let e=n.localEvent;if(e&&e.resize){let n={isMobile:Rt.isMobile};n.width=globalThis.innerWidth,n.height=globalThis.innerHeight,n.setting=t,e.resize(n)}}}Pe.redraw()}})),e){Object.getOwnPropertyNames(e).forEach((t=>{let n=e[t];if(n){let e=n.localEvent;if(e&&e.resize){let t={isMobile:Rt.isMobile};t.width=globalThis.innerWidth,t.height=globalThis.innerHeight,4!==n.state&&5!==n.state||e.resize(t)}}}))}Rt.isResize=!1,Pe.redraw()}),.01)}}function jt(e){if(Et([e,"optionalAccess",e=>e.index])>=0)return-1;let t=-1;for(let n=0;n<Rt.settingList.length;n+=1){Rt.settingList[n]||(t=n,Rt.settingList[n]=e)}return t<0&&(t=Rt.settingList.length,Rt.settingList.push(e)),e.isLock&&Ft(e),e.index=t,t}function zt(e){if(Et([e,"optionalAccess",e=>e.index])>=0){let t=e.index;t<Rt.settingList.length&&(Rt.settingList[t]=null),delete e.index}}function Mt(e){Rt.disableResize=e}Rt.ios=!1,Rt.useOrientation=!1,Rt.usePortrait=!1,Rt.useLandscape=!1,Rt.isMobile=!1,Rt.mobileReady=null,Rt.useFullscreen=!1,Rt.isFullscreen=!1,Rt.isPortrait=!1,Rt.isLandscape=!1,Rt.isTouchOnce=!1,Rt.isResize=!1,Rt.currentY=0,Rt.screenWidth=screen.width,Rt.screenHeight=screen.height,Rt.screenUnit="px",Rt.orientation=$t,Rt.isTouchDown=!1,Rt.useFocus=!1,Rt.disableResize=!1,Rt.settingList=[];let Bt=!1;let Ht=!1;function Vt(){return Ht}let Dt="title";function Wt(){return Dt}let Gt="message";function qt(){return Gt}function Yt(e){Dt=e.title,Gt=e.msg,Ht=!0,Pe.redraw()}function Kt(){Ht=!1,Pe.redraw()}var Jt=Object.freeze({__proto__:null,getMessage:qt,getTitle:Wt,hide:Kt,isVisible:Vt,show:Yt});let Qt=null,Xt={oninit(e){let t=e.attrs;this.style=t.style,this.complete=t.complete,this.logo=null},async oncreate(e){let t=this,n=e.attrs,i=e.dom,r=n.url,s=await fetch(r);if(s&&s.ok){let e=await s.blob();const n=URL.createObjectURL(e);i.src=n,Pe.redraw(),t.complete&&t.complete()}},view(){return Pe("img",{style:this.style})}},Zt={timeBase:1,oninit(e){let t=e.attrs;this.class=t.class||"ba b--light-blue animate__animated animate__bounceIn",this.style=t.style||{left:"0%",top:"0%",width:"100%",height:"100%"},this.info=t.info,this.serve=t.serve,this.config=t.config||{width:300,height:200,resolution:1,antialias:!1,transparent:!0},this.id=t.id,this.group=t.group,this.title=t.title||"標題",this.logo=t.logo,this.game=null,this.eventClass={current:"ba b--dotted bw1 white-50",onmouseenter:"ba b--dotted bw2 white-50",onmouseleave:"ba b--dotted bw1 white-50"}},onbeforeremove(e){let t=this;return t.game&&t.game.pause(),["animate__animated","animate__lightSpeedOut"].forEach((t=>{e.dom.classList.add(t)})),new Promise((e=>{h.setTimeout(e,.4)}))},view(){let e=this,t=e.eventClass;return Pe(".",{class:e.class,style:e.style},[Pe(".game-card-title",e.title),Pe(Xt,{class:"game-card-view ba b--light-gray",style:{zValue:0,position:"absolute",left:"0%",top:"0%",width:"100%",height:"100%"},url:e.logo,complete(){}}),Pe(".",{onclick(){globalThis.Howl&&(Qt||(Qt=new globalThis.Howl({src:["data/f82550ea2e80cd97.wav"]}),Qt.volume(.01)),Qt.play()),ki(!1),ni({serve:e.serve,id:e.id,group:e.group})},onmouseenter(){t.current=t.onmouseenter,Pe.redraw()},onmouseleave(){t.current=t.onmouseleave,Pe.redraw()},class:t.current,style:{position:"absolute",left:"10%",top:"10%",width:"80%",height:"75%"}}),Pe(".game-card-download",{onclick(){Yt({yesno:!1,title:"connecting",msg:"disconnect"})}},[Pe.trust(`<div class="no-underline near-white bg-animate bg-near-black hover-bg-gray inline-flex items-center ma2 tc br2 pa2">\n    <svg fill="#77ff77" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">\n    <path d="M19 8l-4 4h3c0 3.31-2.69 6-6 6-1.01 0-1.97-.25-2.8-.7l-1.46 1.46C8.97 19.54 10.43 20 12 20c4.42 0 8-3.58 8-8h3l-4-4zM6 12c0-3.31 2.69-6 6-6 1.01 0 1.97.25 2.8.7l1.46-1.46C15.03 4.46 13.57 4 12 4c-4.42 0-8 3.58-8 8H1l4 4 4-4H6z"/>\n    <path d="M0 0h24v24H0z" fill="none"/>\n</svg>\n    <span class="f6 ml3 pr2">${p("download")}</span>\n  </div>`)]),Pe(".game-card-stop",{onclick(){v.getIP().then((e=>{}))}},[Pe.trust(`<div class="no-underline near-white bg-animate bg-near-black hover-bg-gray inline-flex items-center ma2 tc br2 pa2">\n    <svg fill="#77ff77" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">\n    <path d="M0 0h24v24H0z" fill="none"/>\n    <path d="M14.59 8L12 10.59 9.41 8 8 9.41 10.59 12 8 14.59 9.41 16 12 13.41 14.59 16 16 14.59 13.41 12 16 9.41 14.59 8zM12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"/>\n</svg>\n    <span class="f6 ml3 pr2">${p("stop")}</span>\n  </div>`)])])}},en={left:"0px",top:"0px",width:"300px",height:"200px"},tn={},nn={},rn=null;function sn(e){return tn[e]||(tn[e]={}),nn=tn[e],nn}function on(e,r,s,o){let a={};function l(){let e=t.registration;e&&e.active&&navigator.serviceWorker.controller?navigator.serviceWorker.controller.postMessage(a):h.setTimeout(l,.05)}if(!t.versionTimestamp){let e=new Date;t.versionTimestamp=e.getTime()}let c=t.versionTimestamp,u=!1,d=null;return d=new Promise((h=>{if(!e||!r)return void h(null);function d(){let o=`config/${r}/${e}/gamecard.txt?v=${c}`,d=`config/${r}/${e}/cache.txt`;if(s){let t=s;"/"===t[t.length-1]&&(t=t.substring(0,t.length-1)),o=`${t}/config/${r}/${e}/gamecard.txt?v=${c}`,d=`${t}/config/${r}/${e}/cache.txt`}else o=`config/${r}/${e}/gamecard.txt?v=${c}`,d=`config/${r}/${e}/cache.txt`;a.cacheName=`${r}${e}`,a.url=d,t.useCache&&l(),fetch(o,{headers:{"Content-Type":"text/plain"}}).then((e=>e.ok?e.text():null)).then((e=>{if(!e)return;let r={},o=new String(e),a=o.indexOf("{");if(a>=0&&a<=9){let e=JSON.parse(o);if(!e.options||!e.options.overview){let e=i;t.useOptions||(n[e.OVERVIEW_LOGO]=1,n[e.OVERVIEW_ANIMATION]=0,n[e.OVERVIEW_BACKGROUND]=0,n[e.OVERVIEW_PROGRESS]=1)}if(e.templateVersion="slot.2.1",r.gameCard=e,s){let e=s;"/"===e[e.length-1]&&(e=e.substring(0,e.length-1)),r.gameCard.baseURL=`${e}/`}u=!0,h(r)}})).catch((e=>{}))}let g,f;if(s){let t=s;"/"===t[t.length-1]&&(t=t.substring(0,t.length-1)),o?g=`${t}/${r}/${e}/config/v${o}.txt`:(g=`${t}/${r}/${e}/config/gamecard.txt?v=${c}`,f=`${t}/${r}/${e}/config/cache.txt`)}else o?g=`${t.projectURL}${r}/${e}/config/v${o}.txt`:(g=`${t.projectURL}${r}/${e}/config/gamecard.txt?v=${c}`,f=`${t.projectURL}${r}/${e}/config/cache.txt`);a.cacheName=`${r}${e}`,a.url=f,t.useCache&&l(),fetch(g,{headers:{"Content-Type":"text/plain"}}).then((e=>e.ok?e.text():(d(),null))).then((e=>{if(!e)return;let n={},i=new String(e),r=i.indexOf("{");if(r>=0&&r<=9){if(n.gameCard=JSON.parse(i),s)if(n.gameCard.baseURL){let e=s;"/"===e[e.length-1]&&(e=e.substring(0,e.length-1)),n.gameCard.baseURL=e+n.gameCard.baseURL.replace(t.projectURL,"/")}else n.gameCard.baseURL=s;else{let e=globalThis.location.origin;n.gameCard.baseURL?n.gameCard.baseURL.indexOf("://")<0&&(n.gameCard.baseURL=e+n.gameCard.baseURL):n.gameCard.baseURL=globalThis.location.origin+"/"}u=!0,h(n)}if(u)return!0;d()})).catch((()=>{d()}))})),d}function an(e){switch(e.key||e.code){case"r":case"R":if(rn){globalThis.scene[rn.id].reload({game:rn.appConfig,group:rn.group,id:rn.id,tablekey:"abcd1234"})}}}function ln(e){e.key||e.code}let cn={oninit(){let e={},t={};!function(e,t,n){let i="";i="test/data/gameList.txt?v="+Date.now(),t[e]=[],n[e]=0;let r=0;Pe.request(i).then((i=>{t[e]=i||[],i.forEach((e=>{if(!e)return;e.isSub&&(r+=1);let t=sn(e.group);if(globalThis.BASE_URL)if(e.baseURL){let t=globalThis.BASE_URL;"/"===t[t.length-1]&&(t=t.substring(0,t.length-1)),e.baseURL=t+e.baseURL}else e.baseURL=globalThis.BASE_URL;else{let t=globalThis.location.origin;e.baseURL?e.baseURL=t+e.baseURL:e.baseURL=globalThis.location.origin+"/"}t[e.id]=e})),n[e]=i.length-r}))}("test",e,t),this.group=e,this.displayCount=t,globalThis.addEventListener("keydown",an),globalThis.addEventListener("keyup",ln)},view(){let e=this;return Pe(".gameCardList",{style:{left:"0%",top:"0%",width:"100%",height:"100%"}},Pe(".",{style:{position:"absolute",left:"0%",top:"40%",width:"100%",height:"25%"}},"group zzzz",Pe(".layout",{style:{left:"0%",marginTop:"0px",width:25*e.displayCount.game+"%",height:"100%"}},e.group.test?e.group.test.map((e=>{if(!e||e.isSub)return Pe(".");let n=e.baseURL||"",i=e.images;return t.useAvif?i.v2&&(i=i.v2):i.v1&&(i=i.v1),Pe(".",{style:en},[Pe(Zt,{id:e.id,group:e.group,serve:{game:e.id,group:e.group},logo:n+i.logo,title:`${e.name[m()]}(${e.appConfig})`})])})):Pe("."))))}};
/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */var un=Object.prototype.toString,hn=Array.isArray||function(e){return"[object Array]"===un.call(e)};function dn(e){return"function"==typeof e}function gn(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function fn(e,t){return null!=e&&"object"==typeof e&&t in e}var pn=RegExp.prototype.test;var mn=/\S/;function bn(e){return!function(e,t){return pn.call(e,t)}(mn,e)}var vn={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};var yn=/\s*/,wn=/\s+/,xn=/\s*=/,Tn=/\s*\}/,Ln=/#|\^|\/|>|\{|&|=|!/;function Cn(e){this.string=e,this.tail=e,this.pos=0}function kn(e,t){this.view=e,this.cache={".":this.view},this.parent=t}function En(){this.templateCache={_cache:{},set:function(e,t){this._cache[e]=t},get:function(e){return this._cache[e]},clear:function(){this._cache={}}}}Cn.prototype.eos=function(){return""===this.tail},Cn.prototype.scan=function(e){var t=this.tail.match(e);if(!t||0!==t.index)return"";var n=t[0];return this.tail=this.tail.substring(n.length),this.pos+=n.length,n},Cn.prototype.scanUntil=function(e){var t,n=this.tail.search(e);switch(n){case-1:t=this.tail,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,n),this.tail=this.tail.substring(n)}return this.pos+=t.length,t},kn.prototype.push=function(e){return new kn(e,this)},kn.prototype.lookup=function(e){var t,n,i,r=this.cache;if(r.hasOwnProperty(e))t=r[e];else{for(var s,o,a,l=this,c=!1;l;){if(e.indexOf(".")>0)for(s=l.view,o=e.split("."),a=0;null!=s&&a<o.length;)a===o.length-1&&(c=fn(s,o[a])||(n=s,i=o[a],null!=n&&"object"!=typeof n&&n.hasOwnProperty&&n.hasOwnProperty(i))),s=s[o[a++]];else s=l.view[e],c=fn(l.view,e);if(c){t=s;break}l=l.parent}r[e]=t}return dn(t)&&(t=t.call(this.view)),t},En.prototype.clearCache=function(){void 0!==this.templateCache&&this.templateCache.clear()},En.prototype.parse=function(e,t){var n=this.templateCache,i=e+":"+(t||Rn.tags).join(":"),r=void 0!==n,s=r?n.get(i):void 0;return null==s&&(s=function(e,t){if(!e)return[];var n,i,r,s=!1,o=[],a=[],l=[],c=!1,u=!1,h="",d=0;function g(){if(c&&!u)for(;l.length;)delete a[l.pop()];else l=[];c=!1,u=!1}function f(e){if("string"==typeof e&&(e=e.split(wn,2)),!hn(e)||2!==e.length)throw new Error("Invalid tags: "+e);n=new RegExp(gn(e[0])+"\\s*"),i=new RegExp("\\s*"+gn(e[1])),r=new RegExp("\\s*"+gn("}"+e[1]))}f(t||Rn.tags);for(var p,m,b,v,y,w,x=new Cn(e);!x.eos();){if(p=x.pos,b=x.scanUntil(n))for(var T=0,L=b.length;T<L;++T)bn(v=b.charAt(T))?(l.push(a.length),h+=v):(u=!0,s=!0,h+=" "),a.push(["text",v,p,p+1]),p+=1,"\n"===v&&(g(),h="",d=0,s=!1);if(!x.scan(n))break;if(c=!0,m=x.scan(Ln)||"name",x.scan(yn),"="===m?(b=x.scanUntil(xn),x.scan(xn),x.scanUntil(i)):"{"===m?(b=x.scanUntil(r),x.scan(Tn),x.scanUntil(i),m="&"):b=x.scanUntil(i),!x.scan(i))throw new Error("Unclosed tag at "+x.pos);if(y=">"==m?[m,b,p,x.pos,h,d,s]:[m,b,p,x.pos],d++,a.push(y),"#"===m||"^"===m)o.push(y);else if("/"===m){if(!(w=o.pop()))throw new Error('Unopened section "'+b+'" at '+p);if(w[1]!==b)throw new Error('Unclosed section "'+w[1]+'" at '+p)}else"name"===m||"{"===m||"&"===m?u=!0:"="===m&&f(b)}if(g(),w=o.pop())throw new Error('Unclosed section "'+w[1]+'" at '+x.pos);return function(e){for(var t,n=[],i=n,r=[],s=0,o=e.length;s<o;++s)switch((t=e[s])[0]){case"#":case"^":i.push(t),r.push(t),i=t[4]=[];break;case"/":r.pop()[5]=t[2],i=r.length>0?r[r.length-1][4]:n;break;default:i.push(t)}return n}(function(e){for(var t,n,i=[],r=0,s=e.length;r<s;++r)(t=e[r])&&("text"===t[0]&&n&&"text"===n[0]?(n[1]+=t[1],n[3]=t[3]):(i.push(t),n=t));return i}(a))}(e,t),r&&n.set(i,s)),s},En.prototype.render=function(e,t,n,i){var r=this.getConfigTags(i),s=this.parse(e,r),o=t instanceof kn?t:new kn(t,void 0);return this.renderTokens(s,o,n,e,i)},En.prototype.renderTokens=function(e,t,n,i,r){for(var s,o,a,l="",c=0,u=e.length;c<u;++c)a=void 0,"#"===(o=(s=e[c])[0])?a=this.renderSection(s,t,n,i,r):"^"===o?a=this.renderInverted(s,t,n,i,r):">"===o?a=this.renderPartial(s,t,n,r):"&"===o?a=this.unescapedValue(s,t):"name"===o?a=this.escapedValue(s,t,r):"text"===o&&(a=this.rawValue(s)),void 0!==a&&(l+=a);return l},En.prototype.renderSection=function(e,t,n,i,r){var s=this,o="",a=t.lookup(e[1]);if(a){if(hn(a))for(var l=0,c=a.length;l<c;++l)o+=this.renderTokens(e[4],t.push(a[l]),n,i,r);else if("object"==typeof a||"string"==typeof a||"number"==typeof a)o+=this.renderTokens(e[4],t.push(a),n,i,r);else if(dn(a)){if("string"!=typeof i)throw new Error("Cannot use higher-order sections without the original template");null!=(a=a.call(t.view,i.slice(e[3],e[5]),(function(e){return s.render(e,t,n,r)})))&&(o+=a)}else o+=this.renderTokens(e[4],t,n,i,r);return o}},En.prototype.renderInverted=function(e,t,n,i,r){var s=t.lookup(e[1]);if(!s||hn(s)&&0===s.length)return this.renderTokens(e[4],t,n,i,r)},En.prototype.indentPartial=function(e,t,n){for(var i=t.replace(/[^ \t]/g,""),r=e.split("\n"),s=0;s<r.length;s++)r[s].length&&(s>0||!n)&&(r[s]=i+r[s]);return r.join("\n")},En.prototype.renderPartial=function(e,t,n,i){if(n){var r=this.getConfigTags(i),s=dn(n)?n(e[1]):n[e[1]];if(null!=s){var o=e[6],a=e[5],l=e[4],c=s;0==a&&l&&(c=this.indentPartial(s,l,o));var u=this.parse(c,r);return this.renderTokens(u,t,n,c,i)}}},En.prototype.unescapedValue=function(e,t){var n=t.lookup(e[1]);if(null!=n)return n},En.prototype.escapedValue=function(e,t,n){var i=this.getConfigEscape(n)||Rn.escape,r=t.lookup(e[1]);if(null!=r)return"number"==typeof r&&i===Rn.escape?String(r):i(r)},En.prototype.rawValue=function(e){return e[1]},En.prototype.getConfigTags=function(e){return hn(e)?e:e&&"object"==typeof e?e.tags:void 0},En.prototype.getConfigEscape=function(e){return e&&"object"==typeof e&&!hn(e)?e.escape:void 0};var Rn={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(e){On.templateCache=e},get templateCache(){return On.templateCache}},On=new En;Rn.clearCache=function(){return On.clearCache()},Rn.parse=function(e,t){return On.parse(e,t)},Rn.render=function(e,t,n,i){if("string"!=typeof e)throw new TypeError('Invalid template! Template should be a "string" but "'+((hn(r=e)?"array":typeof r)+'" was given as the first argument for mustache#render(template, view, partials)'));var r;return On.render(e,t,n,i)},Rn.escape=function(e){return String(e).replace(/[&<>"'`=\/]/g,(function(e){return vn[e]}))},Rn.Scanner=Cn,Rn.Context=kn,Rn.Writer=En;let In={oninit(e){let t=e.attrs;this.url=t.url,this.manager=t.manager,this.setting={id:"children",isLock:!1,useCenter:!1,left:"0%",top:"0%",width:"100%",height:"100%",game:{width:1024,height:1024},reference:{left:0,top:0,width:1,height:1}},jt(this.setting)},oncreate(e){let t=e.instance.children[0].dom;h.setTimeout((()=>{Mt(!0),t.focus()}),.2)},view(){let e=this,t=e.setting;return Pe(".rwdPanelHeader",{style:{position:"absolute",left:t.left,top:t.top,backgroundColor:"rgba(0,0,0,1)",zIndex:950,opacity:1,width:t.width,height:t.height}},Pe("iframe",{src:e.url,scrolling:"yes",frameborder:0,style:{position:"absolute",left:"0%",top:"0%",width:"100%",height:"100%"}}),Pe(".fl.tc.pv4.bg-black.hover-bg-gray",{style:{position:"absolute",left:"5%",top:"0%",width:"90%",height:"10%",opacity:.75,cursor:"pointer"},onclick(){Mt(!1),e.manager.childrenVisible=!1,e.url=""}},Pe(".inline-flex.white.border-box.pointer",`${p("close")}`)))}};function $n(e){let t,n=e[0],i=1;for(;i<e.length;){const r=e[i],s=e[i+1];if(i+=2,("optionalAccess"===r||"optionalCall"===r)&&null==n)return;"access"===r||"optionalAccess"===r?(t=n,n=s(n)):"call"!==r&&"optionalCall"!==r||(n=s(((...e)=>n.call(t,...e))),t=void 0)}return n}const Un=0,An=6,Pn=1,_n=3,Sn=4,Fn=5;let Nn={oninit(){this.options={}},oncreate(e){let n=this;n.isIframeLoaded=!1,n.isIframeInit=!1;let i,a=Math.round(performance.now());n.timestamp=a,n.checkItem=null;let l={isFirstTime:!0,useVideo:!1,isCheckData:!1,isChild:!1,isGame:!0,isCreate:!1,isBusy:!0,rendered:null,disable:!0,sysTray:null,trayVisible:!1,childrenVisible:!1,currentUrl:"",useCenter:!0,position:"absolute",left:"25%",top:"25%",width:"50%",height:"50%"},c={state:{visible:!0},sound:{isMute:!1},music:{isMute:!1},screen:{isAutoScale:!0,isLock:!1},isLock:!1,isFullscreen:!1};Object.prototype.hasOwnProperty.call(c,"visible")||Object.defineProperty(c,"visible",{get:()=>c.state.visible,set(e){l.mode!==r.DEMO&&(c.state.visible=e,l.sysTray&&(e?(l.sysTray.isMenu=!1,l.sysTray.visible=!0):(l.sysTray.isMenu=!1,l.sysTray.visible=!1),Pe.redraw()))}});let u=n.options,f=e.attrs;if(n.currentBaseURL=null,f&&(n.checkItem=f.checkItem,n.currentBaseURL=f.currentBaseURL,l.left=f.left||"25%",l.top=f.top||"25%",l.width=f.width||"50%",l.height=f.height||"50%",l.reference=f.reference,l.fix=f.fix,l.isChild=f.isChild,l.isCheckData=f.isCheckData,f.sysTray?l.sysTray={visible:!0,isMenu:!1,flags:f.sysTray.flags,style:{left:f.sysTray.left||"0px",top:f.sysTray.top||"0px"}}:l.sysTray=null,i=f.config,n.ctrlEvent=f.ctrlEvent),c.visible=!1,!i)return;let y=m();l.isCreate=i.isCreate,l.templateVersion=i.scene.templateVersion,"slot.2.1"===l.templateVersion&&"en-us"===m()&&(y="en"),l.id=i.id,l.mode=i.mode,l.name=i.scene.name[y],l.group=i.scene.group||"game",l.appName=i.scene.app,l.appHash=i.scene.appHash,l.appConfig=i.scene.appConfig,l.devMode=i.scene.devMode,l.dependence=i.scene.dependence,l.background=null,l.backgroundCSS=null,n.appTimeout=null;let w=`${l.group}${l.appConfig}`,x={category:"遊戲程式 "+(n.currentBaseURL||"主網址"),getLabel:()=>w},T={category:"遊戲場景 "+(n.currentBaseURL||"主網址"),getLabel:()=>w},L={category:"建立遊戲 "+(n.currentBaseURL||"主網址"),getLabel:()=>w};t.isCheckGameCDN||(v.loadBegin(L),v.loadBegin(x)),l.anim={element:null,isPlay:!1},l.display="inline",l.opacity=0,l.zIndex=1,f.updateStyle&&f.updateStyle(l);let C=i.scene.images;t.useAvif?C.v2&&(C=C.v2):C.v1&&(C=C.v1),l.game={id:i.id,group:i.scene.group,mode:i.mode,decimal:i.decimal,name:l.name,logo:C&&C.logo,theOther:i.scene.theOther,version:i.scene.version,baseURL:i.scene.baseURL||"",langID:y},C&&Object.prototype.hasOwnProperty.call(C,"useBackground")&&C.background&&(l.isCheckData||(l.background=`${l.game.baseURL}${C.background}`),"string"==typeof C.useBackground?l.backgroundCSS=`${C.useBackground}`:(C.useBackground,l.backgroundCSS=null)),i.scene.theOther&&i.scene.theOther.id&&(l.game.theOther=i.scene.theOther.id),i.scene.screen&&(l.isLock=i.scene.screen.isLock,l.game.width=i.scene.screen.width||640,l.game.height=i.scene.screen.height||960,l.game.portrait=i.scene.screen.portrait,l.game.landscape=i.scene.screen.landscape,Rt.isMobile,c.isLock=l.isLock),l.images=C,l.isCheckData||jt(l);let k=null,E=i.loadingEvent,R=Ai(),O=null,I=R.scene[l.id]={templateVersion:l.templateVersion,state:Un,event:{create:null,play:null,pause:null,enter:null,leave:null,focus:null,blur:null,lock:null,fullscreen:null,resize:null,music:null,sound:null},info:{isChild:l.isChild,baseURL:l.game.baseURL||"",id:l.game.id,name:l.game.name,group:l.game.group,theOther:l.game.theOther,width:l.game.width,height:l.game.height,decimal:l.game.decimal,mode:l.game.mode,langID:l.game.langID},gamecard:i.scene,loadingEvent:{title:l.name,start(){t.isCheckGameCDN||v.loadBegin(T),E.start&&E.start()},resBegin(e){E.resBegin&&E.resBegin(e)},resEnd(e){E.resEnd&&E.resEnd(e)},sceneResBegin(e){E.sceneResBegin&&E.sceneResBegin(e)},sceneResLoading(e){E.sceneResLoading&&E.sceneResLoading(e)},sceneResEnd(e){E.sceneResEnd&&E.sceneResEnd(e)},finish(){I.state=Sn,t.isCheckGameCDN||(v.loadEnd(T),v.log({label:w,category:"遊戲場景 "+(n.currentBaseURL||"主網址")}),v.loadEnd(L)),E.finish&&E.finish(I)}},callWeb(e){"string"==typeof e?R.document&&R.document.location&&R.document.location.replace?R.document.location.replace(e||"about:blank"):R.location.href=e||"about:blank":xi(e)},open(e){l.childrenVisible=!0,l.currentUrl=e,Pe.redraw()},setDisableResize(e){Mt(e)},createTheOther(e,n=0){!function(e,n=0){let i=e,r=n;"number"==typeof e&&(i=n,r=e);let s=i.groupName||Xn,o=i.sceneID,a=globalThis.BASE_URL;on(o,s,a).then((e=>{let n=Kn[r],s=e.gameCard;if(!s)return;function o(e){t.isReload||i.finish&&i.finish(e)}i.reloadConfig&&(s.reloadConfig=i.reloadConfig),n||(n={style:Yn,reference:{left:0,top:0,width:1,height:1}});let a={com:ei,attrs:{loadingEvent:i.loadingEvent,index:r,style:i.style||n.style,reference:i.reference||n.reference,absPos:i.absPos||n.absPos,id:i.id,scene:s,isChild:!0,finish:o}};t.isReload||(null!==Zn[r]?(Zn[r]=null,Pe.redraw(),h.setTimeout((()=>{Zn[r]=a,Pe.redraw()}),.1)):(Zn[r]=a,Pe.redraw()))}))}(e,n)},destroyTheOther(e){Zn[e]=null,Pe.redraw(),R.scene[e]=null},callTheOther(e,t){let n,i=!1,r=R.scene[e];return r&&r.state===Sn&&(I.game.debug=!1,I.state=Sn,I.info.isChild?(I.localEvent.pause(),I.localEvent.hide()):I.localEvent.pause(),n=t||{what:" is this ?"},n.from=I.info.id,i=!0,r.localEvent.pause(),r.state=Fn,r.templateVersion,r.setting.background=t&&t.background||"rgba(0,0,0,0)",r.localEvent.show(),r.localEvent.play(n)),i},checkTheOther(e){let t=!1,n=R.scene[e];return n&&n.state===Sn&&(t=!0),t},getTheOther:e=>R.scene[e],reload(e){if(t.isReload)return;Ti(),t.isReload=!0;let i=e;i||(i={game:l.appConfig,group:l.group}),I.game.stop(),I.game.reset();let r=()=>{u.initGame=null,I.game=null,n.ctrlEvent&&n.ctrlEvent.reload&&n.ctrlEvent.reload(),Pe.redraw(),h.setTimeout((()=>{(async function(){return new Promise((e=>{Object.getOwnPropertyNames(globalThis.scene).forEach((e=>{let t=globalThis.scene[e];t&&(delete t.event,delete t.loadingEvent),delete globalThis.scene[e]})),globalThis.scene={},Ei({oncreate(){e()},view:()=>null})}))})().then((()=>{on(i.game,i.group,n.currentBaseURL,i.version).then((t=>{t&&t.gameCard&&(t.gameCard.reloadConfig=e,ni({gameCard:t.gameCard,id:i.game,group:i.group}))}))}))}),.01)};ii(),h.setTimeout((()=>{for(let e=0;e<globalThis.frames.length;e+=1){let t=globalThis.frames[e];if(t){let e=t.document;e&&(e.documentElement.innerHTML="")}}r()}),.05)},leave(e){},setMode(e){let t=r;s.mode=e,s.mode===t.REAL?u.info.mode=p("gameModeReal"):u.info.mode=p("gameModeDemo"),Pe.redraw()},async fullscreen(e){if(e||!yt())try{return await wt(c)}catch(e){}},ready(e){if(!I.game&&e&&(I.game=e),n.appTimeout&&(h.remove(n.appTimeout),n.appTimeout=null),t.isCheckGameCDN||(v.loadEnd(x),v.log({label:w,category:"遊戲程式 "+(n.currentBaseURL||"主網址")})),n.checkItem){let e=n.checkItem,t=Math.round(performance.now());e.timeInit=t-n.timestamp,n.timestamp=t,e.state="app",e.timeReady=t-e.timestamp,e.timestamp=t,Pe.redraw(),e.ready&&e.ready(e)}O(I.game).then((()=>{if(I.game){let e={error(e){v.error({label:w,category:e})},log(e){"string"==typeof e?v.log({label:w,category:e}):e&&(e.label=w,v.log(e))},serviceBegin(e){if(e){if(e.getLabel=()=>w,!e.category)return;v.serviceBegin(e)}},serviceEnd(e){if(e){if(e.getLabel=()=>w,!e.category)return;v.serviceEnd(e)}},loadBegin(e){if(e){if(e.getLabel=()=>w,!e.category)return;v.loadBegin(e)}},loadEnd(e){if(e){if(e.getLabel=()=>w,!e.category)return;v.loadEnd(e)}}};I.game.report=e,I.game.localforage=o}l.isBusy=!1,l.isCreate&&I.event&&I.event.create?(I.info.console=console,I.info.setting=t,I.event.create(I.info),I.state=Pn):I.state=_n}))},graphReady(){I.ready()},setOverviewVisible(e){I.gamecard.manual&&I.gamecard.manual.overview&&(Jn.overview.visible=e,Pe.redraw())},setEvent(e){let t=I.event;t.create=e.create||t.create,t.play=e.play||t.play,t.pause=e.pause||t.pause,t.enter=e.enter||t.enter,t.leave=e.leave||t.leave,t.focus=e.focus||t.focus,t.blur=e.blur||t.blur,t.lock=e.lock||t.lock,t.fullscreen=e.fullscreen||t.fullscreen,t.resize=e.resize||t.resize,t.music=e.music||t.music,t.sound=e.sound||t.sound}};I.state=An,O=async e=>{let i=globalThis.location.origin;n.currentBaseURL&&(i=n.currentBaseURL),l.game.baseURL.length>0&&(i=l.game.baseURL);let r=i;r.length>0&&"/"===r[r.length-1]&&(r=r.substring(0,r.length-1));let s=l.appName;if("object"==typeof s&&(s=l.appName[l.game.langID],s||(s=l.appName[b.EN_US])),s){let e=s.split("/"),t=e.length-1;r=t>2?`${r}/${e[t-1]}/${e[t]}`:`${r}/${s}`}if("game.5.0"===l.templateVersion){let n=await import(r),i=await n.scene.init({setting:t,baseURL:I.info.baseURL,isChild:I.info.isChild,langID:I.info.langID,gamecard:I.gamecard,game:e,nuts:d});Object.defineProperty(e,"scene",{get:()=>I});let s={create(n){R.lobby&&(e.currentUser=R.lobby.currentUser,e.command=R.lobby.net.gameCommand,e.lobby={setEvent:R.lobby.setEvent,setCommand:R.lobby.net.setLobbyCommand,CMD:R.lobby.net.CMD}),i.create&&(n.game=e,n.setting=t,i.create(n))},play(n){e.play(),i.play&&(n.game=e,n.setting=t,i.play(n))},pause(n){e.pause(),i.pause&&(n.game=e,n.setting=t,i.pause(n))},enter(n){i.enter&&(n.game=e,n.setting=t,i.enter(n))},leave(n){i.leave&&(n.game=e,n.setting=t,i.leave(n))},focus(){i.focus&&i.focus()},blur(){i.blur&&i.blur()},lock(e){i.lock&&i.lock(e)},fullscreen(e){i.fullscreen&&i.fullscreen(e)},resize(e){i.resize&&i.resize(e)},music(e){i.music&&i.music(e)},sound(e){i.sound&&i.sound(e)}};I.setEvent(s),I.game=e}};let $={isActive:!0,create(e){e.isCreate&&$n([I,"access",e=>e.event,"optionalAccess",e=>e.create])&&(I.info.console=console,I.info.setting=t,I.event.create(I.info),I.state=Pn)},async enter(e){let n=e||{};n.from||(n.from=I.info.id),n.id||(n.id=l.game.id),n.game||(n.game=I.game),t.isInGame=!0,Rt.isMobile&&(l.isChild||globalThis.scrollTo(0,Rt.currentY)),l.isFirstTime&&(l.isFirstTime=!1),I.game&&(R.lobby&&(I.game.command=R.lobby.net.gameCommand,I.game.table=R.lobby.table[n.id],I.game.currentUser=R.lobby.currentUser),I.game.sysTray=c,I.game.getLCS=async function(){return null},I.game.scanLCS=async function(e){let t={name:"串流服務",category:"檢測串流",getLabel:()=>w},n=await import("./agent.06583e7f.js");return await n.scan(e,t)},I.game.getProject=async function(e,t){const n=await import("./agent.c7a26b30.js");return await n.getProject(e,t)},I.game.getIP=v.getIP),$.show({finish(){$n([I,"access",e=>e.event,"optionalAccess",e=>e.enter])&&(n.setting=t,I.event.enter(n)),$.blur&&$.blur(),Nt(!0);let e=null,i=R.scene[I.info.theOther];if(I.info.isChild||i||!I.info.theOther||(I.info.theOther,I.info.theOther.length>0?e={id:I.info.theOther,group:I.info.group}:"object"==typeof I.info.theOther&&(e={id:I.info.theOther.id,group:I.info.theOther.group})),null!==e){let t={style:{position:"absolute",left:"0%",top:"0%",width:"100%",height:"100%"},reference:{left:0,top:0,width:1,height:1},groupName:e.group,id:e.id,sceneID:e.id,loadingEvent:{start(){},resBegin(){},resEnd(){},sceneResBegin(){},sceneResLoading(){},sceneResEnd(){},finish(e){e.localEvent.pause(),e.localEvent.hide()}}};I.createTheOther(t)}}})},leave(e){let n=e||{};n.from||(n.from=I.info.id),n.game||(n.game=I.game),$n([I,"access",e=>e.event,"optionalAccess",e=>e.leave])&&(n.setting=t,I.event.leave(n))},play(e){let n=e||{};n.from||(n.from=I.info.id),n.game||(n.game=I.game),$n([I,"access",e=>e.event,"optionalAccess",e=>e.play])&&(n.setting=t,I.event.play(n)),I.state=Fn,Nt(!0)},pause(e){let n=e||{};n.from||(n.from=I.info.id),n.game||(n.game=I.game),$n([I,"access",e=>e.event,"optionalAccess",e=>e.pause])&&(n.setting=t,I.event.pause(n)),I.state=Sn},focus(){$.isActive||($.isActive=!0,$n([I,"access",e=>e.event,"optionalAccess",e=>e.focus])&&I.event.focus())},blur(){$.isActive&&($.isActive=!1,$n([I,"access",e=>e.event,"optionalAccess",e=>e.blur])&&I.event.blur())},updateBlur(e){e&&e!==$&&$.blur();let t=f.objList;t&&Array.isArray(t)&&t.forEach((t=>{if(t){let n=t.attrs.localEvent;e!==n&&n&&n.blur&&n.blur()}}))},lock(e){l.isLock=e,l.left=f.left||"25%",l.top=f.top||"25%",l.width=f.width||"50%",l.height=f.height||"50%";let t=R.scene[I.info.theOther];t&&t.localEvent.lock(e),Nt(!0),$n([I,"access",e=>e.event,"optionalAccess",e=>e.lock])&&I.event.lock(e)},fullscreen(e){$n([I,"access",e=>e.event,"optionalAccess",e=>e.fullscreen])&&I.event.fullscreen(e)},resize(e){$n([I,"access",e=>e.event,"optionalAccess",e=>e.resize])&&I.event.resize(e)},music(e){$n([I,"access",e=>e.event,"optionalAccess",e=>e.music])&&I.event.music(e);let t=R.scene[I.info.theOther];t&&t.localEvent.music(e)},sound(e){$n([I,"access",e=>e.event,"optionalAccess",e=>e.sound])&&I.event.sound(e);let t=R.scene[I.info.theOther];t&&t.localEvent.sound(e)},show(e){let t=l.anim;if(t.element){if(t.isPlay&&(t.isPlay=!1),l.display="inline",l.disable=!1,l.zIndex=4,l.opacity=1,e){if(e.style){let t=e.style;l.zIndex=t.zIndex||4}e.finish&&e.finish()}f.updateStyle&&f.updateStyle(l),Pe.redraw()}},hide(e){let t=l.anim;if(t.element){if(t.isPlay&&(t.isPlay=!1),l.disable=!0,l.display="none",l.zIndex=2,l.opacity=0,e){if(e.style){let t=e.style;l.zIndex=t.zIndex||2}e.finish&&e.finish()}f.updateStyle&&f.updateStyle(l),Pe.redraw()}}};I.localEvent=$,I.setting=l,u.onfocus=onfocus,u.initGame=async function(e){l.anim.element=e.dom},u.event=$,u.setting=l,u.tray=c,u.objList=f.objList,u.updateStyle=f.updateStyle;let U=Pe(".");var A;"game.5.0"===l.templateVersion?I.gamecard.pixiConfig&&(U=[Pe(g.game.pixi,{id:l.id,style:{position:"absolute",left:"0px",top:"0px",width:"100%",height:"100%"},config:I.gamecard.pixiConfig,ready:I.ready})]):U=[Pe("iframe",{style:{position:"absolute",left:"0px",top:"0px",width:"100%",height:"100%"},scrolling:"no",frameborder:0,oncreate:function(e){k=e.dom,k.scrolling="no",k.frameborder=0;let i=k.style;if(i.width="100%",i.height="100%",i.left="0%",i.top="0%",i.position="absolute",l.isChild||(i.zIndex=2,i.display="inline"),n.isIframeInit)return;n.isIframeInit=!0,u.info.iframe=k;let r=l.id,s=l.name,o=l.group,a=l.appName,c=l.appConfig||r,d=l.devMode,g=l.background,f=l.dependence,p=null;if("object"==typeof a&&(a=l.appName[l.game.langID],a||(a=l.appName[b.EN_US])),"game.4.0"===l.templateVersion){let e=globalThis.location.origin;if(n.currentBaseURL&&(e=n.currentBaseURL),l.game.baseURL.length>0&&(e=l.game.baseURL),p={appName(){let t=e;if(t.length>0&&"/"===t[t.length-1]&&(t=t.substring(0,t.length-1)),a){let e=a.split("/"),n=e.length-1;t=n>2?`${t}/${e[n-1]}/${e[n]}`:`${t}/${a}`}return t},appIntegrity:"",id:r,name:s,group:o,jsName(){let e,t=globalThis.location.origin;return n.currentBaseURL&&(t=n.currentBaseURL),t&&t.length>0&&"/"===t[t.length-1]&&(t=t.substring(0,t.length-1)),e=`<script src="${t}${this.pathname}"  crossorigin><\/script>`,e},globalName(){let e=`globalThis.parent.${this.libName} && `;return e+=`(globalThis.${this.libName} = globalThis.parent.${this.libName})`,e},background:g},f){let e=[],t=f;Object.getOwnPropertyNames(t).forEach((n=>{let i=t[n],r={};"string"==typeof i?(r.key=n,r.pathname=i):(r.key=n,r.pathname=i.pathname,r.integrity=i.integrity),e.push(r)})),e.length>0&&(e[e.length-1].isLast=!0),p.importmap=e}l.rendered=Rn.render(Oi(l.templateVersion),p)}else if("game.3.0"===l.templateVersion){let e=globalThis.location.origin;n.currentBaseURL&&(e=n.currentBaseURL);let i=e;if(i&&i.length>0&&"/"===i[i.length-1]&&(i=i.substring(0,i.length-1)),p={appName(){let e=i;return e="debug"===d?`${e}/${a}`:`${e}/${t.projectURL}${a}`,e},appIntegrity:"",id:r,name:s,group:o,jsName(){let e,t=`${i}${this.pathname}`,n="";return this.integrity&&(n=`integrity="${this.integrity}"`),this.isLast,e=`<script src="${t}" ${n} crossorigin><\/script>`,e},background:g},f){let e=[],t=f;Object.getOwnPropertyNames(t).forEach((n=>{let i=t[n],r={};"string"==typeof i?(r.key=n,r.pathname=i):(r.key=n,r.pathname=i.pathname,r.integrity=i.integrity),e.push(r)})),e.length>0&&(e[e.length-1].isLast=!0),p.importmap=e}l.rendered=Rn.render(Oi(l.templateVersion),p)}else if("game.2.0"===l.templateVersion){let e=globalThis.location.origin;n.currentBaseURL&&(e=n.currentBaseURL);let i=e;i&&i.length>0&&"/"===i[i.length-1]&&(i=i.substring(0,i.length-1)),p={appName:a,id:r,name:s,group:o,importmapName(){let e=i;n.currentBaseURL&&(this.pathname=this.pathname.replace(t.projectURL,"/"));let r,s=`${e}${this.pathname}`;return r=`"${this.key}": "${s}"`,this.isLast||(r+=","),r},systemjsURL(){let e=`${i}/`;return e=n.currentBaseURL?`${e}systemjs/6.13.0/system.min.js`:"/systemjs/6.13.0/system.min.js",e},background:g};let c=[];if(p.importmap=c,f){let e=f;Object.getOwnPropertyNames(e).forEach((i=>{let r=e[i],s={};"string"==typeof r?(s.key=i,s.pathname=r):(s.key=i,n.currentBaseURL?s.pathname=r.pathname.replace(t.projectURL,"/"):s.pathname=r.pathname,s.integrity=r.integrity),c.push(s)}))}if(p.appName=`${o}-${r}`,"debug"===d){c.push({key:`${o}-${r}`,pathname:`${a}`});let t=e;t&&t.length>0&&"/"===t[t.length-1]&&(t=t.substring(0,t.length-1)),p.appName=`${t}${a}`}else{let i=e;n.currentBaseURL?(c.push({key:`${o}-${r}`,pathname:`/${a}`}),p.appName=`${i}${a}`):(c.push({key:`${o}-${r}`,pathname:`${t.projectURL}${a}`}),p.appName=`${i}${t.projectURL}${a}`)}c.length>0&&(c[c.length-1].isLast=!0),l.rendered=Rn.render(Oi(l.templateVersion),p)}else if("slot.2.1"===l.templateVersion){let e="";n.currentBaseURL&&(e=n.currentBaseURL);let i=e;i&&i.length>0&&"/"===i[i.length-1]&&(i=i.substring(0,i.length-1));let u="";p={appName(){let e=i;return e=""===i?`${a}`:n.currentBaseURL?`${e}/${a}`:`${e}${t.projectURL}${a}`,e},systemjsURL(){let e=`${i}/`;return e=`${e}systemjs/system.js`,e},appConfig:()=>u,id:r,name:s,group:o,background:g},I.info.langID=l.game.langID;let d=t.projectURL;n.currentBaseURL&&(d="/");let f=`${i}${d}config/${o}/${c}/browser.config.js`;""===i&&(f=`config/${o}/${c}/browser.config.js`),fetch(f,{headers:{"Content-Type":"text/plain"}}).then((e=>e.ok?e.text():null)).then((e=>{if(!e)return null;if(u=new String(e),""!==i){let e=`${i}/dependence/`;n.currentBaseURL&&(e=`${n.currentBaseURL}dependence/`),u=u.replace("dependence/",e)}l.rendered=Rn.render(Oi(l.templateVersion),p),k.src="data/template/9ef1c941a7edfbb9.html",k.addEventListener("load",(()=>{if(!n.isIframeLoaded&&(n.isIframeLoaded=!0,h.setTimeout((()=>{let e=k.contentDocument||k.contentWindow.document;e.open(),e.write(l.rendered||"!!!! unknown template !!!!"),e.close()}),.05),n.checkItem)){let e=n.checkItem,t=Math.round(performance.now());e.timeOnload=t-n.timestamp,n.timestamp=t,e.state="web",Pe.redraw()}}),{capture:!0,once:!0})}))}if("slot.2.1"!==l.templateVersion){k.src="data/template/9ef1c941a7edfbb9.html";const e=()=>{if(!n.isIframeLoaded&&(n.isIframeLoaded=!0,h.setTimeout((()=>{let e=k.contentDocument||k.contentWindow.document;e.open(),e.write(l.rendered||"!!!! unknown template !!!!"),e.close()}),.05),n.checkItem)){let e=n.checkItem,t=Math.round(performance.now());e.timeOnload=t-n.timestamp,n.timestamp=t,e.state="web",Pe.redraw()}};k.addEventListener("load",e,{capture:!0,once:!0})}}})],u.gamePage=U,u.info={iframe:{},token:s.info.token,gameName:l.game.name,logo:l.game.baseURL+l.game.logo,version:l.game.version||"0.9.9",open(e){l.childrenVisible=!0,l.currentUrl=e,Pe.redraw()}},A=I.gamecard,rn=A;let P=r;s.mode===P.REAL?u.info.mode=p("gameModeReal"):u.info.mode=p("gameModeDemo"),Pe.redraw()},onremove(){zt(this.options.setting)},view(){let e,n=this.options,i=n.setting,r=n.objList||[];if(n.info&&n.info.iframe&&Rt.isMobile){n.info.iframe.style||(n.info.iframe.style={});let e=n.info.iframe.style;e.width=i.width,e.height=i.height}if(n.initGame){e=!i.isChild&&Rt.isMobile?(Rt.useFullscreen,{position:"absolute",left:"0px",top:Rt.currentY+"px",width:"100%",height:"100%",backgroundColor:"rgba(0,0,0,0)"}):{position:"absolute",left:"0px",top:"0px",width:"100%",height:"100%",backgroundColor:"rgba(0,0,0,0)"},i.isCheckData&&(e={left:"0%",top:"0%",width:"100%",height:"100%",backgroundColor:"rgba(0,0,0,0)"});let s="";return i.images.useBackground&&(s=i.background),Pe(".",{style:e},i.isChild?null:Pe(".center",{style:{overflowY:"hidden",position:"absolute",zIndex:1,top:"0%",left:"0%",width:`${globalThis.innerWidth}px`,height:`${globalThis.innerHeight}px`}},Pe(".aspect-ratio--object cover",{style:{background:`url(${s}) center`}})),Pe(".",{oncreate:n.initGame,style:{position:i.position,boxShadow:i.backgroundCSS,left:i.left,top:i.top,width:i.width,height:i.height,zIndex:i.zIndex||2,opacity:i.opacity,display:i.display}},n.gamePage,r.map((e=>e?(e.attrs.fix=i,e.attrs.updateBlur=n.event.updateBlur,Pe(e.com,e.attrs)):null)),i.sysTray&&i.sysTray.visible?Pe(Lt,{style:i.sysTray.style,config:i.sysTray}):null,i.sysTray&&i.sysTray.isMenu?Pe(Ct,{tray:n.tray,event:n.event,info:n.info,config:i.sysTray}):null),i.childrenVisible?Pe(In,{url:i.currentUrl,manager:i}):null,t.msg.length>0?Pe(".",{style:{position:"absolute",color:"#fff",left:"50%",top:"0%",width:"64px",height:"16px",zIndex:900}},t.msg):null)}return Pe(".")}},jn={oninit(e){let t=e.attrs;this.options=t.options,this.saveConfig={}},oncreate(){},view(){let e=this.options,t=e.scene.pixiConfig,n=this.saveConfig;return Pe("article.pa4.white",Pe("form",[Pe("fieldset.ba.b--transparent.ph0.mh0",[Pe("legend.ph0.mh0.fw6.white","遊戲場景設定"),Pe(".mt3",Pe("label.db.fw4.lh-copy.f6","寬"),Pe("input.pa2.input-reset.ba.bg-transparent.w-40.red",{id:"width",name:"width",oninput(e){let i=e.target.value;n.width=parseInt(i),t.width=i},value:t&&t.width})),Pe(".mt3",Pe("label.db.fw4.lh-copy.f6","高"),Pe("input.b.pa2.input-reset.ba.bg-transparent.w-40.red",{id:"height",name:"height",oninput(e){let i=e.target.value;n.height=parseInt(i),t.height=i},value:t&&t.height})),Pe(".mt3",Pe("label.db.fw4.lh-copy.f6","解析度"),Pe("input.b.pa2.input-reset.ba.bg-transparent.w-40.red",{id:"resolution",name:"resolution",oninput(e){let i=e.target.value;n.resolution=parseFloat(i),t.resolution=i},value:t&&t.resolution})),Pe(".mt3",Pe("label.db.fw4.lh-copy.f6","是否反鋸齒"),Pe("input.b.pa2.input-reset.ba.bg-transparent.w-40.red",{id:"antialias",name:"antialias",oninput(e){let i=e.target.value;n.antialias=!1,"true"===i&&(n.antialias=!0),t.antialias=i},value:t&&t.antialias})),Pe(".mt3",Pe("label.db.fw4.lh-copy.f6","是否透明"),Pe("input.b.pa2.input-reset.ba.bg-transparent.w-40.red",{id:"transparent",name:"transparent",oninput(e){let i=e.target.value;n.transparent=!1,"true"===i&&(n.transparent=!0),t.transparent=i},value:t&&t.transparent})),Pe(".mt3",Pe("input.b.ph3.pv2.input-reset.ba.b--black.bg-transparent.grow.pointer.f6 white",{onclick(){Object.getOwnPropertyNames(n).forEach((e=>{t[e]=n[e]})),e&&e.ready&&(e.visible=!1,e.ready())},value:"確定"}))])]))}},zn=null,Mn={oninit(e){let r=this,s=e.attrs;r.style=s.style,r.options=s.options,r.resource=s.resource,r.timeout=null,r.isLeave=!1;let o={start(){},resBegin(){},resEnd(){},sceneResBegin(){},sceneResLoading(){r.timeout&&(h.remove(r.timeout),r.timeout=null),r.isLeave||(r.timeout=h.setTimeout((()=>{r.isLeave=!0,r.game&&(r.game.resetUpdate(),r.game.stop(),r.game=null),r.options&&r.options.ready&&r.options.ready();let e=i;n[e.OVERVIEW_ANIMATION]=!1,n[e.OVERVIEW_PROGRESS]=!0,Pe.redraw(),r.timeout=null}),5))},sceneResEnd(){},finish(){r.timeout&&(h.remove(r.timeout),r.timeout=null)}};!async function(){if(!zn)try{const{getProject:e}=await import("./agent.c7a26b30.js");zn=await e("scenes/loading",{version:"2.2.0"})}catch(e){r.options&&r.options.ready&&r.options.ready();let t=i;return n[t.OVERVIEW_ANIMATION]=!1,n[t.OVERVIEW_PROGRESS]=!0,void Pe.redraw()}let e=await zn.lib.scene.init({resName:"ex",langID:m(),baseURL:zn.pathname,useAvif:t.useAvif});r.resource.setting=e,jt(e),r.pixiConfig=zn.lib.scene.pixiConfig,Pe.redraw()}(),r.ready=async function(e){e.resource=s.resource,e.play(),r.game=e;try{r.scene=await zn.lib.scene.create(e,o,d)}catch(t){r.resource.setting&&zt(r.resource.setting),e.resetUpdate(),e.stop(),r.options&&r.options.ready&&r.options.ready();let s=i;return n[s.OVERVIEW_ANIMATION]=!1,n[s.OVERVIEW_PROGRESS]=!0,void Pe.redraw()}r.options&&r.options.ready&&r.options.ready()}},oncreate(){let e=this;e.resource.setting&&jt(e.resource.setting)},onremove(){let e=this;e.resource.setting&&zt(e.resource.setting),e.scene&&e.scene.hide();let t=e.game;t&&(t.resetUpdate(),t.stop())},view(){let e=this;return e.pixiConfig?Pe(g.game.pixi,{id:"loading9999",config:e.pixiConfig,ready:e.ready}):Pe(".")}};function Bn(e){let t,n=e[0],i=1;for(;i<e.length;){const r=e[i],s=e[i+1];if(i+=2,("optionalAccess"===r||"optionalCall"===r)&&null==n)return;"access"===r||"optionalAccess"===r?(t=n,n=s(n)):"call"!==r&&"optionalCall"!==r||(n=s(((...e)=>n.call(t,...e))),t=void 0)}return n}let Hn,Vn=i,Dn={oninit(e){let i=this,r=e.attrs,o=r.setUpdateEvent;i.scene=r.scene,i.ready=r.ready,i.serve=r.serve,i.finish=r.finish,i.manager=r.manager;let c=n;if(!t.useOptions){let e=i.scene.options;if(e){c[Vn.OVERVIEW_LOGO]=!1,//!!overview.logo;
a.isCheckGameCDN?c[Vn.OVERVIEW_ANIMATION]=!1:c[Vn.OVERVIEW_ANIMATION]=!0,c[Vn.OVERVIEW_BACKGROUND]=!0,c[Vn.OVERVIEW_PROGRESS]=!1;let t=e.game;t&&(c[Vn.GAME_SCENE_CUSTOM]=!!t.custom,c[Vn.GAME_PERFORMANCE_FPS]=!!t.fps,c[Vn.GAME_DEBUG_MODE]=!!t.debug,c[Vn.GAME_DIALOG_CUSTOM]=!!t.useDialog)}}i.elementLogo=null,i.progress=0,i.progressValue=0,i.baseURL=i.scene.baseURL||"",function(e){if(Rt.currentY=0,document){let e=globalThis.scene;document.onfullscreenchange=document.onwebkitfullscreenchange=()=>{Rt.settingList.forEach((t=>{if(t&&e){let n=e[t.id];if(n){let e=n.game&&n.game.sysTray;yt(e);let t=n.localEvent;if(t&&t.fullscreen){let n=e&&e.isFullscreen;t.fullscreen(n)}}}})),Pe.redraw()},document.onfullscreenerror=document.onwebkitfullscreenerror=()=>{Rt.settingList.forEach((t=>{if(t&&e){let n=e[t.id];if(n){let e=n.game&&n.game.sysTray;yt(e);let t=n.localEvent;if(t&&t.fullscreen){let n=e&&e.isFullscreen;t.fullscreen(n)}}}})),Pe.redraw()}}if(!t.isCheckGameCDN&&_e.any()?(Bt||(screen&&screen.orientation&&screen.orientation.addEventListener?screen.orientation.addEventListener("change",_t):globalThis.addEventListener("orientationchange",_t)),Rt.isMobile=!0,It=At,_e.iOS()?(globalThis.parent===window&&(Rt.currentY=200),Rt.ios=!0,It=null):_e.Android()&&(globalThis.parent===window&&(Rt.currentY=200),It=null)):Rt.isMobile=!1,e&&(Rt.useOrientation=!1,Rt.usePortrait=!1,Rt.useLandscape=!1,Rt.isMobile&&("string"==typeof e.orientation&&("portrait"===e.orientation?(Rt.usePortrait=!0,Rt.orientation.name="portrait"):(Rt.useLandscape=!0,Rt.orientation.name="landscape"),Rt.useOrientation=!0),Ut=null,Rt.useFullscreen=!1,_e.iOS()?navigator.userAgent.match(/baidu/i)?(Ut=dt,Rt.screenUnit="px",Rt.useFullscreen=!1):navigator.userAgent.match(/CriOS/i)?(Ut=et,Rt.screenUnit="px",Rt.useFullscreen=!1):navigator.userAgent.match(/LieBao|ACHEETAHI/i)?(Ut=pt,Rt.screenUnit="px",Rt.useFullscreen=!1):navigator.userAgent.match(/FxiOS/i)?(Ut=it,Rt.screenUnit="px",Rt.useFullscreen=!1):navigator.userAgent.match(/Safari/i)?(Ut=ct,Rt.screenUnit="px",Rt.useFullscreen=!1):navigator.userAgent.match(/UCB/i)?(Ut=ot,Rt.screenUnit="px",Rt.useFullscreen=!1):Ut=vt:_e.Android()&&(navigator.userAgent.match(/OPR/i)?(Ut=Ve,Rt.screenUnit="px",Rt.useFullscreen=!1,navigator.userAgent.match(/baidu/i)?Ut=qe:navigator.userAgent.match(/LieBao|ACHEETAHI/i)&&(Ut=Ke,Rt.screenUnit="px",Rt.useFullscreen=!1)):navigator.userAgent.match(/baidu/i)?(Ut=qe,Rt.screenUnit="px",Rt.useFullscreen=!1):navigator.userAgent.match(/LieBao|ACHEETAHI/i)?(Ut=Ke,Rt.screenUnit="px",Rt.useFullscreen=!1):navigator.userAgent.match(/Firefox/i)?(Ut=Be,Rt.screenUnit="px",Rt.useFullscreen=!1):navigator.userAgent.match(/UCB/i)?(Ut=We,Rt.screenUnit="px",Rt.useFullscreen=!1):navigator.userAgent.match(/Chrome/i)?(Rt.useFullscreen=!1,Rt.screenUnit="px",Ut=ze):Ut=Qe),navigator.userAgent.match(/(UBiOS|Pad|Tablet|KFAUW|Mb2345|ME173X|NRD90M|VIE|N2G47H)/i)&&(Rt.useFullscreen=!1,Rt.screenUnit="px"),Ut&&(Ut.value.state=Rt),Bt||globalThis.addEventListener("focus",(()=>{Rt.useFocus&&(Rt.isTouchOnce=!0,Rt.useFocus=!1,Nt(!0))}),!0),Pt(),Nt(!0),Rt.settingList.forEach((e=>{if(e)return e.isLock?void Ft(e):(St(e),!0)})),Rt.isFullscreen=!0,Rt.isTouchDown=!1,Rt.isTouchOnce=!0)),t.mobileMode){let e=t.mobileMode;parseInt(e)>0&&(Rt.isFullscreen=!0,Rt.isTouchDown=!1,Rt.isTouchOnce=!0)}document.body.onscroll=()=>{!Rt.isMobile||Rt.orientation.isTrigger||Rt.isResize||Rt.disableResize||globalThis.parent===window&&Rt.isMobile&&(Rt.currentY=globalThis.pageYOffset,globalThis.scrollTo(0,Rt.currentY),Pe.redraw())},Bt||globalThis.addEventListener("resize",Nt),Bt=!0}(i.scene.screen),Rt.settingList=[],c[Vn.OVERVIEW_LOGO]&&(i.setting={id:"logo",isLock:!0,useCenter:!0,left:"25%",top:"25%",width:"50%",height:"50%",game:{width:512,height:512},reference:{left:.25,top:.25,width:.5,height:.5}});i.settingBackground={id:"background",isLock:!1,left:"0%",top:"0%",width:"100%",height:"100%",game:{width:10240,height:10240},reference:{left:0,top:1,width:1,height:1}},i.message="建立預覽",i.display="inline",i.isFinish=!1,i.options={scene:i.scene,visible:!0,ready:i.ready},i.scene.pixiConfig||(n[Vn.GAME_SCENE_CUSTOM]=!1);let u=a;i.manager.show=()=>{Jn.overview.visible=!0,Pe.redraw()},i.manager.hide=()=>{Jn.overview.visible=!1,Pe.redraw()},i.leave=function(){if(!a.isCheckGameCDN)if(i.isFinish=!0,u.isFinish=!0,t.isReload=!1,Pe.redraw(),t.disableNet){if(!Jn.manual.overview){let e=Jn.overview.manager;e.hide&&e.hide()}let e=Ai(),t={id:i.scene.id},n=e.scene[t.id];n&&n.localEvent&&n.localEvent.enter(t)}else i.title=p("connecting"),i.message=p("start"),s.isKickOut||(l.isLogin?(ri=!1,si()):i.serve&&$i(i.serve).then((()=>{i.title=p("quickPlay"),Pe.redraw()})))},i.timeout=null;let d={start(){i.message="開始讀取遊戲資料",Pe.redraw(),Bn([u,"optionalAccess",e=>e.loadingEvent,"optionalAccess",e=>e.start,"call",e=>e()])},resBegin(e){Bn([u,"optionalAccess",e=>e.loadingEvent,"optionalAccess",e=>e.resBegin,"call",t=>t(e)])},resEnd(e){Bn([u,"optionalAccess",e=>e.loadingEvent,"optionalAccess",e=>e.resEnd,"call",t=>t(e)])},sceneResBegin(e){Bn([u,"optionalAccess",e=>e.loadingEvent,"optionalAccess",e=>e.sceneResBegin,"call",t=>t(e)])},sceneResLoading(e){let t=0;if(Object.prototype.hasOwnProperty.call(e,"totalProgress")){let n=e.state,r=e.totalProgress;if(n){r=(n.currentIndex-1)/n.totals*100+r/n.totals}t=r.toFixed(0),i.progress=t,i.progressValue=.01*r}else{let n=e.current/e.length;t=(100*n).toFixed(0),i.progress=t,i.progressValue=n}i.isFinish||i.timeout&&(h.remove(i.timeout),i.timeout=null),n[Vn.OVERVIEW_PROGRESS]&&Pe.redraw(),Bn([u,"optionalAccess",e=>e.loadingEvent,"optionalAccess",e=>e.sceneResLoading,"call",e=>e(t)])},sceneResEnd(e){Bn([u,"optionalAccess",e=>e.loadingEvent,"optionalAccess",e=>e.sceneResEnd,"call",t=>t(e)])},async finish(){if(i.timeout&&(h.remove(i.timeout),i.timeout=null),t.requestReload)return;let e=t.store;if(e)try{await e.setItem("baseURL",globalThis.BASE_URL)}catch(e){}n[Vn.OVERVIEW_ANIMATION]&&i.animationLeave?i.animationLeave():i.leave(),Bn([u,"optionalAccess",e=>e.loadingEvent,"optionalAccess",e=>e.finish,"call",e=>e()])}};o&&o(d)},oncreate(){let e=this;e.setting&&jt(e.setting),e.settingBackground&&jt(e.settingBackground),Nt(!0),t.requestReload&&(t.requestReload=!1),n[Vn.GAME_SCENE_CUSTOM]||n[Vn.OVERVIEW_ANIMATION]||e.options.ready&&e.options.ready()},onremove(){self.setting&&zt(self.setting),self.settingBackground&&zt(self.settingBackground)},onbeforeremove:e=>(["animate__animated","animate__fadeOut","animate__faster"].forEach((t=>{e.dom.classList.add(t)})),new Promise((function(t){e.dom.addEventListener("animationend",t)}))),view(){let e=this,i=a.setting,r=e.settingBackground,s=e.setting,o=e.options;e.display,i||(i={left:"0%",top:"0%",width:"0%",height:"0%"}),Rt.isMobile&&Rt.currentY;let l="",c=t.images;return c&&(l=globalThis.innerHeight>globalThis.innerWidth?c.background[`${t.agent}Portrait`]:c.background[`${t.agent}Landscape`]),globalThis.BASE_URL&&(l=globalThis.BASE_URL+"agent/"+l),Pe(".",{style:{display:e.display,position:"absolute",zIndex:100,left:r.left,top:`${Rt.currentY+parseInt(r.top)}px`,width:r.width,height:r.height}},Pe(".",{style:{position:"absolute",left:"0%",top:"0%",width:"100%",height:"100%"}},Pe(".aspect-ratio--object cover",{style:{zIndex:0,background:`url(${l}) center`}})),n[Vn.OVERVIEW_ANIMATION]?Pe(".",{style:{position:"absolute",left:i.left,top:i.top,width:i.width,height:i.height}},Pe(Mn,{style:{position:"absolute",left:"0%",top:"0%",width:"100%",height:"100%"},options:o,resource:a})):null,!t.isReload&&n[Vn.OVERVIEW_LOGO]?Pe(".",{style:{position:"absolute",left:"25%",top:"25%",width:"50%",height:"50%"}},Pe("img",{oncreate(t){e.elementLogo=t.dom},src:t.logo,onload(){["animate__animated","animate__fadeIn"].forEach((t=>{e.elementLogo.classList.add(t)}))},style:{opacity:0,zIndex:700,position:"absolute",left:s.left,top:s.top,width:s.width,height:s.height}})):null,n[Vn.GAME_SCENE_CUSTOM]&&o.visible?Pe(".",{style:{position:"absolute",zIndex:300,left:"0%",top:"0%",width:"100%",height:"100%"}},Pe(".pv2 mb2 white bg-dark-green o-20",{style:{position:"absolute",left:"0%",top:"0%",width:"100%",height:"100%"}}),Pe(".",{style:{position:"absolute",left:"0%",top:"0%",width:"100%",height:"100%"}},Pe(jn,{options:o}))):null,n[Vn.OVERVIEW_PROGRESS]&&!e.isFinish?Pe(".",{style:{zIndex:100,position:"absolute",left:"10%",top:"90%",width:"80%",height:"4%"}},Pe("progress.progress",{style:{position:"absolute",left:"0%",top:"0%",width:"100%",height:"40%"},max:"100",value:`${e.progress}`}),Pe(".tc",{style:{position:"absolute",left:"0%",top:"30%",width:"100%",height:"60%",color:"#a0cdff"}},Pe("p.v-btm",`${p("loading")} ${e.progress}%`))):null)}},Wn={fatal(e){},high(e){},middle(e){},low(e){}},Gn={disableDialog:!1,handle(){let e=i;if(l.state="未連線",t.isInGame&&globalThis.scene){Object.getOwnPropertyNames(globalThis.scene).forEach((e=>{let t=globalThis.scene[e];t&&t.game&&t.game.disconnect&&t.game.disconnect()}))}Gn.disableDialog||n[e.GAME_DIALOG_CUSTOM]&&(l.isError||h.setTimeout((()=>{l.isError||Yt({title:"errorLow",msg:"disconnect"})}),2))}},qn={handle(e){let t=Ai();l.state="遊戲中",Gn.disableDialog=!0,v.serviceEnd(qn.report),v.log({label:"net",category:"進入遊戲"});let n={id:e.gid};Kt();let i=t.scene[n.id];i&&i.localEvent&&i.localEvent.enter(n)},report:{time:0,category:"進入遊戲",getLabel:()=>"net"},error:Wn.low},Yn={position:"absolute",left:"0%",top:"0%",width:"100%",height:"100%",backgroundColor:"rgba(0,0,0,0)"},Kn=[{style:{zIndex:10,position:"absolute",left:"5%",top:"5%",width:"30%",height:"85%"},reference:{left:.05,top:.05,width:.3,height:.85}},{style:{zIndex:10,position:"absolute",left:"35%",top:"5%",width:"30%",height:"85%"},reference:{left:.35,top:.05,width:.3,height:.85}},{style:{zIndex:10,position:"absolute",left:"65%",top:"5%",width:"30%",height:"85%"},reference:{left:.65,top:.05,width:.3,height:.85}}],Jn={overview:{visible:!0,manager:{}},packet:null,gid:null,manual:{overview:!1}},Qn={visible:!1},Xn="",Zn=[],ei={oninit(e){let t=e.attrs,n=this;n.isLoading=!1;let i=t.loadingEvent,r=s,o={id:t.id,decimal:0,mode:r.mode,isCreate:!0,scene:t.scene,loadingEvent:{start(){n.isLoading=!0,i&&i.start&&i.start()},resBegin(e){i&&i.resBegin&&i.resBegin(e)},resEnd(e){i&&i.resEnd&&i.resEnd(e)},sceneResBegin(e){i&&i.sceneResBegin&&i.sceneResBegin(e)},sceneResLoading(e){i&&i.sceneResLoading&&i.sceneResLoading(e)},sceneResEnd(e){i&&i.sceneResEnd&&i.sceneResEnd(e)},finish(e){e&&e.localEvent&&(t.localEvent=e.localEvent),n.isLoading=!1,t.finish&&t.finish(e),i&&i.finish&&i.finish(e)}}};n.config=o,n.style=t.style,n.reference=t.reference,n.fix=t.fix,n.absPos=t.absPos,n.updateBlur=t.updateBlur,n.isChild=t.isChild},view(){let e=this;return Pe(".",{style:e.style},Pe(Nn,{updateStyle(t){if(t){let n=e.style;n.display=t.display||n.display,Object.prototype.hasOwnProperty.call(t,"opacity")&&(n.opacity=t.opacity),Object.prototype.hasOwnProperty.call(t,"zIndex")&&(n.zIndex=t.zIndex)}},config:e.config,currentBaseURL:globalThis.BASE_URL,left:"0%",top:"0%",width:"100%",height:"100%",reference:e.reference,updateBlur:e.updateBlur,fix:e.fix,isChild:e.isChild,absPos:e.absPos}))}},ti={oninit(e){let t=e.attrs,n=this,i=t.sceneInfo;n.objList=t.objList,n.serve=t.serve,n.isReady=!1;let r={reload(){n.isReady=!1}},o={};let a=s,l={id:i.id,decimal:0,mode:a.mode,isCreate:!0,scene:i,loadingEvent:{start(){o.start&&o.start()},resBegin(e){o.resBegin&&o.resBegin(e)},resEnd(e){o.resEnd&&o.resEnd(e)},sceneResBegin(e){o.sceneResBegin&&o.sceneResBegin(e)},sceneResLoading(e){o.sceneResLoading&&o.sceneResLoading(e)},sceneResEnd(e){o.sceneResEnd&&o.sceneResEnd(e)},finish(){o.finish&&o.finish()}}};Jn.packet=null,Jn.gid=i.id||n.serve.id,n.setUpdateEvent=function(e){o=e},n.gameConf=l,n.sceneInfo=i,n.ctrlEvent=r,n.event={ready:function(){n.isReady=!0,Pe.redraw()},finish:function(){let e=Ui();const t=f.CMD;e&&e.setLobbyCommand(t.IN_GAME,{packet:null,gid:i.id||n.serve.id})}}},view(){let e=this,t=e.objList,n=e.gameConf,i=e.event;return Pe(".",{style:Yn},Qn.visible&&e.isReady?Pe(Nn,{currentBaseURL:globalThis.BASE_URL,sysTray:e.sceneInfo.sysTray,ctrlEvent:e.ctrlEvent,config:e.gameConf,zIndex:4,left:"0%",top:"0%",width:"100%",height:"100%",objList:t}):null,Pe(".",Jn.overview.visible?Pe(Dn,{manager:Jn.overview.manager,serve:e.serve,scene:n.scene,setUpdateEvent:e.setUpdateEvent,ready(){i.ready()},finish(){i.finish()}}):null))}};function ni(e){Hn=t.langID,t.serve=e.serve,Jn.manual={overview:!1},Jn.overview.visible=!0,function(e){let n=null;if(e.gameCard)n=e.gameCard;else{let t;t=sn(e.group),n=t[e.id]}if(!n)return;n.manual&&(Jn.manual=n.manual,n.manual.disableNet&&(t.disableNet=!0)),v.report.name=`${n.group}/${n.appConfig}`,Xn=n.group;let i=n.baseURL||"",r=n.images;if(t.useAvif?r.v2&&(r=r.v2):r.v1&&(r=r.v1),r.icon){let e=document.getElementsByTagName("link");if(e){let n=e[0];if(n)if(n.setAttribute("crossorigin","icon"),n.setAttribute("rel","icon"),n.setAttribute("type","image/png"),"kc"===t.agent){let e="data/img/logo/kc/87faada2e433ffce.ico";n.setAttribute("href",e)}else n.setAttribute("href",i+r.icon)}}let s=n.app;"object"==typeof s&&(s=s[Hn]),n.name[Hn]?document.title=n.name[Hn]:document.title=n.name[b.EN],Qn.objList=Zn,Qn.sceneInfo=n,Qn.serve=e.serve,Qn.visible=!0,Ei(ti,Qn)}(e)}function ii(){Zn=[],Qn.visible=!0,Pe.redraw()}let ri=!1;function si(){let e=Ui();const n=f.CMD;let i=Jn;if(ri)return!0;let r=t,o=l;if(h.setTimeout((()=>{"遊戲中"!==o.state&&(globalThis.Howler&&(globalThis.Howler.mute(!0),globalThis.Howler.unload()),Yt({title:"connecting",msg:"disconnect"}))}),.001*c),r.module?import("./agent.d4220880.js").then((e=>{e.ingame({name:s.game,group:s.group,gid:i.gid})})):(e&&e.setLobbyCommand(n.IN_GAME,{packet:i.packet,gid:i.gid}),v.serviceBegin(qn.report)),ri=!0,!i.manual.overview){let e=i.overview.manager;e.hide&&e.hide()}return!0}let oi={oninit(e){let t=e.attrs;t.yesno||ii(),this.title=t.title,this.msg=t.msg,this.setting={id:"dialog",isLock:!1,useCenter:!1,left:"0%",top:"0%",width:"100%",height:"100%",game:{width:1024,height:1024},reference:{left:0,top:0,width:1,height:1}},jt(this.setting)},oncreate(){},view(){let e=this,t=e.setting,n=null;return n=Rt.isMobile?{position:"absolute",left:t.left,top:Rt.currentY+"px",backgroundColor:"rgba(0,0,0,1)",zIndex:990,opacity:1,width:t.width,height:t.height}:{position:"absolute",left:t.left,top:t.top,backgroundColor:"rgba(0,0,0,1)",zIndex:990,opacity:1,width:t.width,height:t.height},Pe(".",{style:n},Pe(".bg-moon-gray ba bw1",{style:{position:"absolute",left:"10%",top:"10%",width:"80%",height:"75%"}},Pe(".bg-near-black white f4 fw6 pa4",{style:{position:"absolute",left:"0%",top:"0%",width:"100%",height:"20%"}},Pe(".tc",p(e.title)||"title")),Pe(".tc pa5",{style:{position:"absolute",left:"0%",top:"20%",width:"100%",height:"50%"}},Pe.trust(p(e.msg))||"body message")))}},ai={oninit(){let e=this;e.timeValue=-1,e.touchmoveOnce=!1,e.fields=["一","二","三","四","五","六","七","八","九","十","一","二","三","四","五","六","七","八","九","十"],e.pageY=0,e.imgRotate={id:"rotate",isLock:!0,useCenter:!0,left:"10%",top:"10",width:"80%",height:"80%",game:{width:5120,height:5120},reference:{left:0,top:0,width:1,height:1}},e.imgFullscreen={id:"screen",isLock:!0,useCenter:!0,left:"10%",top:"10",width:"80%",height:"80%",game:{width:5120,height:5120},reference:{left:0,top:0,width:1,height:1}}},view(){let e=this,t=Rt,n=t.orientation,i=globalThis.innerWidth,r=globalThis.innerHeight;return n.isTrigger&&(i*=2.5,r*=2.5),t.isMobile&&t.currentY,[t.isTouchOnce&&t.isFullscreen?null:Pe(".",{style:{zIndex:850,position:"absolute",left:"0%",top:t.currentY+"px",width:(i||t.screenWidth)+"px",height:(r||t.screenHeight)+"px",backgroundColor:"rgba(0,0,0,1)"},ontouchmove(e){Rt.isMobile&&!Rt.ios&&e.preventDefault()},ontouchend(){if(globalThis.Howl){let e=new globalThis.Howl({src:["data/f82550ea2e80cd97.wav"]});e&&(e.volume(.001),e.play())}if(t.isFullscreen=!0,t.isTouchDown=!1,t.isTouchOnce=!0,Rt.ios){let e=globalThis.scene;t.settingList.forEach((t=>{if(e){let n=e[t.id];if(n){(n.game&&n.game.sysTray).isFullscreen=!1}}})),Pe.redraw(),Nt(),t.mobileReady&&t.mobileReady()}else wt().then((()=>{let e=globalThis.scene;t.settingList.forEach((t=>{if(e){let n=e[t.id];if(n){(n.game&&n.game.sysTray).isFullscreen=!0}}})),Pe.redraw(),Nt(),t.mobileReady&&t.mobileReady()})).catch((()=>{let e=globalThis.scene;t.settingList.forEach((t=>{if(e){let n=e[t.id];if(n){(n.game&&n.game.sysTray).isFullscreen=!1}}})),Pe.redraw(),Nt(),t.mobileReady&&t.mobileReady()}))},ontouchstart(n){if(globalThis.Howl){let e=new globalThis.Howl({src:["data/f82550ea2e80cd97.wav"]});e.volume(.001),e.play()}if(t.isTouchDown)return;t.isTouchDown=!0;let i=n.changedTouches||n.originalEvent.touches;if(i){let t=i[0];e.pageY=t.pageY}}},Pe(".",{oncreate(){jt(e.imgFullscreen)},onremove(){zt(e.imgFullscreen)},style:{position:"absolute",left:"10%",top:"10%",width:"80%",height:"80%"}},Pe("img",{src:"data/img/c7aecda7af142624.png",style:{position:"absolute",zIndex:850,left:e.imgFullscreen.left,top:e.imgFullscreen.top,width:e.imgFullscreen.width,height:e.imgFullscreen.height}}))),!n.isTrigger&&t.useOrientation&&t.usePortrait&&!t.isPortrait?Pe(".",{oncreate(){jt(e.imgRotate),Nt(!0)},onremove(){zt(e.imgRotate)},style:{zIndex:800,position:"absolute",left:"0px",top:globalThis.pageYOffset+"px",width:(globalThis.innerWidth||t.screenWidth)+"px",height:(globalThis.innerHeight||t.screenHeight)+"px",backgroundColor:"rgba(0,0,0,1)"}},Pe("img",{src:"data/img/f14a0482453bcc34.png",style:{position:"absolute",left:e.imgRotate.left,top:e.imgRotate.top,width:e.imgRotate.width,height:e.imgRotate.height}})):null,!n.isTrigger&&t.useOrientation&&t.useLandscape&&!t.isLandscape?Pe(".",{oncreate(){jt(e.imgRotate),Nt(!0)},onremove(){zt(e.imgRotate)},style:{zIndex:800,position:"absolute",left:"0px",top:globalThis.pageYOffset+"px",width:(globalThis.innerWidth||t.screenWidth)+"px",height:(globalThis.innerHeight||t.screenHeight)+"px",backgroundColor:"rgba(0,0,0,1)"}},Pe("img",{src:"data/img/b4c0d11274ffa254.gif",style:{position:"absolute",left:e.imgRotate.left,top:e.imgRotate.top,width:e.imgRotate.width,height:e.imgRotate.height}})):null]}},li={"game.2.0":'<!DOCTYPE html>\n<html>\n<head>\n  <meta charset="UTF-8" />\n  <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0" />\n  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />\n  <title>game 2.0 {{{name}}}</title>\n\n  <script type="systemjs-importmap" crossorigin="anonymous">\n    {\n      "imports": {\n      {{#importmap}}\n        {{{importmapName}}}\n      {{/importmap}}\n      }\n    }\n  <\/script>\n\n</head>\n<body id="{{{id}}}" style="height:100%;width:100%;overflow-x:hidden;overflow-y:hidden">\n<script crossorigin="anonymous">\n  if(!window.globalThis) {\n    window.globalThis = window;\n  }\n\n  let isInitCache = false;\n  function initCache () {\n    if(isInitCache) {\n      return;\n    }\n    isInitCache = true;\n    let isLoaded = false;\n    let registration = null;\n    function loadScript() {\n      if(isLoaded) {\n        return;\n      }\n      isLoaded = true;\n      let script = document.createElement(\'script\');\n      script.onload = function() {\n        System.import("{{{appName}}}");\n      };\n      script.src = "{{{systemjsURL}}}";\n      document.getElementsByTagName(\'head\')[0].appendChild(script);\n    }\n    loadScript();\n  }\n  initCache();\n\n<\/script>\n</body>\n</html>\n',"game.3.0":'<!DOCTYPE html>\n<html>\n<head>\n  <meta charset="UTF-8" />\n  <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0" />\n  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />\n  <title>game 3.0 {{{name}}}</title>\n\n  {{#importmap}}\n  {{{jsName}}}\n  {{/importmap}}\n\n</head>\n<body id="{{{id}}}" style="height:100%;width:100%;overflow-x:hidden;overflow-y:hidden">\n<script crossorigin="anonymous">\n  if(!window.globalThis) {\n    window.globalThis = window;\n  }\n\n  let isInitCache = false;\n  function initCache () {\n    if(isInitCache) {\n      return;\n    }\n    isInitCache = true;\n    let isLoaded = false;\n    let registration = null;\n    function loadScript() {\n      if(isLoaded) {\n        return;\n      }\n      isLoaded = true;\n      let script = document.createElement(\'script\');\n      script.onload = function() {\n      };\n      script.src = "{{{appName}}}";\n      script.crossorigin = "anonymous";\n      document.getElementsByTagName(\'head\')[0].appendChild(script);\n    }\n    loadScript();\n  }\n\n  initCache();\n<\/script>\n</body>\n</html>\n',"game.4.0":'<!DOCTYPE html>\n<html>\n<head>\n  <meta charset="UTF-8" />\n  <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0" />\n  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />\n  <title>game 4.0 {{{name}}}</title>\n\n\n  {{#importmap}}\n  {{{jsName}}}\n  {{/importmap}}\n  \n  <script crossorigin="anonymous">\n    if(!window.globalThis) {\n      window.globalThis = window;\n    }\n    {{#globalmap}}\n    {{{globalName}}}\n    {{/globalmap}}\n\n  <\/script>\n</head>\n<body id="{{{id}}}" style="height:100%;width:100%;overflow-x:hidden;overflow-y:hidden">\n  <script crossorigin="anonymous" type="module">\n    import "{{{appName}}}";\n    window.supportsDynamicImport = true;\n  <\/script>\n</body>\n</html>\n',"slot.2.1":'<!DOCTYPE html>\n<html>\n  <head>\n  <meta charset="UTF-8" />\n  <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0" />\n  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />\n  <title>slot.2.1 {{{name}}}</title>\n  </head>\n  <body id="{{{id}}}" style="height:100%;width:100%;overflow-x:hidden;overflow-y:hidden">\n  <script crossorigin="anonymous">\n  if(!window.globalThis) {\n    window.globalThis = window;\n  }\n\n  let isInitCache = false;\n  function initCache () {\n    if(isInitCache) {\n      return;\n    }\n    isInitCache = true;\n    let isLoaded = false;\n    let registration = null;\n    function loadScript() {\n      if(isLoaded) {\n        return;\n      }\n      isLoaded = true;\n      let script = document.createElement(\'script\');\n      script.onload = function() {\n        {{{appConfig}}}\n        ;System.import(\'{{{appName}}}\');\n\n      };\n      script.src = "{{{systemjsURL}}}";\n      script.crossorigin = "anonymous";\n      document.getElementsByTagName(\'head\')[0].appendChild(script);\n    }\n    loadScript();\n  }\n\n  initCache();\n  <\/script>  \n  </body>\n</html>\n'};let ci={oninit(e){let n=this,i=e.attrs,r={category:"測試CDN 主網址",getLabel:()=>"common"};v.loadBegin(r),n.cdnList=t.cdnList,n.server=s,n.ready=i.ready;let o=[];n.gamecdnFields=o,n.isFinish=!1;let a=0,l=n.cdnList.length;function c(e){a+=1,a>=l&&(n.server.cdn.errorCounts+=1,n.server.cdn.errorCounts<3?(t.requestReload=!1,t.isReload=!0,wi({url:e.target,group:e.group,game:e.appConfig||e.game})):(t.hasCDN=!1,Yt({yesno:!1,title:"service",msg:"errorCDN"})))}function u(e){n.isFinish||(n.isFinish=!0,e.isLight=!0,t.isCheckGameCDN=!1,n.server.cdn.errorCounts=0,v.loadEnd(r),v.log({label:"common",category:"測試CDN 主網址"}),n.ready&&n.ready(e.target))}t.isCheckGameCDN=!0,n.cdnList.forEach(((e,i)=>{let r={};r.index=i,r.isLight=!1,r.id=e.id,r.url=e.url,r.target=e.target,r.timestamp=Math.round(performance.now()),r.timeOnload=0,r.timeInit=0,r.timeScene=0,r.timeReady=9999,r.gamecard=null,r.icon="",r.isIconLoaded=!1,r.downloadEnabled=!1,r.loadingEvent={},r.ready=u,r.error=c,r.useTest=!0,o.push(r),async function(e,n,i){let r="",s=null,o=null,a=n.target,l=!1,c=m(),u=(new Date).getTime();n.group=e.group,n.game=e.game;try{if(r=e.version?`${a}${e.group}/${e.game}/config/v${e.version}`:`${a}${e.group}/${e.game}/config/gamecard.txt?v=${u}`,s=await fetch(r,{headers:{"Content-Type":"text/plain"}}),!i&&!t.isCheckGameCDN)return null;s.ok&&(o=await s.text())}catch(e){}if(!o)try{if(r=`${a}config/${e.group}/${e.game}/gamecard.txt?v=${u}`,s=await fetch(r,{headers:{"Content-Type":"text/plain"}}),!i&&!t.isCheckGameCDN)return null;s.ok&&(o=await s.text(),l=!0)}catch(e){}let h=null;if(o){h=JSON.parse(o);let r=h.images;t.useAvif?r.v2&&(r=r.v2):r.v1&&(r=r.v1);let u=null;l?(h.templateVersion="slot.2.1",u=`${a}${r.icon}`):u=`${a}${e.group}/${e.game}/${r.icon}`;let d="";"string"==typeof h.name?d+=h.name+" ":d+=h.name[c]+" ";let g=null;if("string"==typeof h.app?(g=`${a}${h.app}`,d+=h.app):(g=`${a}${h.app[c]}`,d+=h.app[c]),n.app=d,n.version=h.version,n.icon=u,n.downloadEnabled=!0,n.appConfig=h.appConfig,n.gamecard=h,n.useTest){if(g){if(s=await fetch(g),!i&&!t.isCheckGameCDN)return null;if(!s.ok)return n.error&&n.error(n),null}if(u){if(s=await fetch(u),!i&&!t.isCheckGameCDN)return null;if(!s.ok)return n.error&&n.error(n),null}n.timeReady=Math.round(performance.now()-n.timestamp),n.ready&&n.ready(n)}}else n.app="",n.version="",n.gamecard=null,n.error&&n.error(n);Pe.redraw()}(n.server,r)}))},oncreate(){},view:()=>Pe(".",{left:"0%",right:"0%",width:"100%",height:"100%",position:"absolute",zIndex:0},Pe(".tmp",Pe(".cssload-loader",Pe.trust('<svg class="cssload-logo" height="200" width="200"><text x="49%" y="56%" dominant-baseline="middle" text-anchor="middle" fill="#1375ff">Loading</text></svg>'),Pe(".cssload-inner cssload-one"),Pe(".cssload-inner cssload-two"),Pe(".cssload-inner cssload-three"))),Pe(".",{style:{opacity:0,left:"0%",right:"0%",width:"1px",height:"1px",position:"absolute",zIndex:0}},Pe("article.dt.w-100.bb.b--black-05.pb2.mt2",Pe("div.dtc.v-mid.pl3",Pe("h1.f6.f5-ns.fw6.lh-title.white.mv1.tc","檢測服務線路"),Pe("h2.f6.fw4.mt1.mb1.green.tc","使用的線路")))))},ui=!1,hi=["一","二","三","四","五","六","七","八","九","十","一","二","三","四","五","六","七","八","九","十"],di=!0,gi=null,fi=null,pi=null,mi=!1,bi=null,vi=null,yi=null;async function wi(e){if(!t.requestReload){let n={eventName:`CDN ${e.url}`,category:"服務線路錯誤",label:`${e.group}${e.game}`};v.error(n),globalThis.scene={},t.requestReload=!0,t.cdnList=[],t.hasCDN=!1,t.selectCDN=!1,fi=null,Pe.redraw();let i=async function(){yi&&(await yi(),0===t.cdnList.length?Ii({element:document.body}):Pe.redraw())};h.setTimeout((()=>{i()}),.1)}}async function xi(e){mi=!0,bi=e||{},vi=await import("./agent.1f21c108.js"),Pe.redraw()}function Ti(){mi=!1,Pe.redraw()}let Li={ready(e){globalThis.BASE_URL=e,v.report.currentURL=e,t.selectCDN=!0,globalThis.scene={},Pe.redraw();let n=s;on(n.game,n.group,e).then((e=>{e&&e.gameCard&&ni({gameCard:e.gameCard,serve:n,id:n.game,group:n.group})}))}},Ci={context:null,view:()=>di?t.hasCDN&&!t.selectCDN?Pe(".basic",Pe(ci,Li)):Pe(".basic",Rt.isMobile?Pe(".",{style:{zIndex:0,position:"absolute",left:"0%",top:"0%",width:"100%",height:"100%"}},Rt.orientation.isTrigger?null:hi.map((()=>Pe(".ba h-25 black tc",{style:{opacity:0}},"")))):null,fi?Pe(fi,pi):null,Rt.isMobile?Pe(ai):null,Vt()?Pe(oi,{title:Wt(),msg:qt()}):null,mi&&vi?Pe(vi.Component,bi):null):t.hasCDN&&!t.selectCDN?Pe(".basic#root",Pe(ci,Li)):Pe(".basic#root",[Rt.isMobile?Pe(".",{style:{zIndex:0,position:"absolute",left:"0%",top:"0%",width:"100%",height:"100%"}},Rt.orientation.isTrigger?null:hi.map((()=>Pe(".ba h-25 black tc",{style:{opacity:0}},"")))):null,fi?Pe(fi,pi):null,Rt.isMobile?Pe(ai):null,Vt()?Pe(oi,{title:Wt(),msg:qt()}):null,mi&&vi?Pe(vi.Component,bi):null])};function ki(e){di=e}function Ei(e,t){fi=e,pi=t,Pe.redraw()}let Ri={};function Oi(e){return Ri[e]}async function Ii(e){let n=s;yi=e.checkCDN;let i=globalThis;i.addEventListener&&(i.addEventListener("beforeunload",(e=>{})),i.addEventListener("unload",(()=>{}))),i.scene={},i.game={},Ri["game.2.0"]=li["game.2.0"],Ri["game.3.0"]=li["game.3.0"],Ri["game.4.0"]=li["game.4.0"],Ri["slot.2.1"]=li["slot.2.1"];let o={game:n.game,group:n.group};if(n.group&&n.game||!u){if(ki(!1),!t.hasCDN){let e=globalThis.BASE_URL,n=t.version;on(o.game,o.group,e,n).then((e=>{e&&e.gameCard&&ni({gameCard:e.gameCard,serve:o,id:o.game,group:o.group})}))}}else fi=cn;let a=r;if(n.mode===a.DEMO){let e=840;h.setTimeout((()=>{globalThis.Howler&&(globalThis.Howler.mute(!0),globalThis.Howler.unload()),Yt({title:"gameModeDemo",msg:"demoTimeout"})}),e)}Pe.mount(e.element,Ci)}function $i(e){let n=s;if(ui){return new Promise((e=>{let t=n.info;gi&&(gi.login(t),e(gi))}))}return ui=!0,e&&(n.game=e.game||n.game,n.group=e.group||n.group,n.host=e.host||n.host),new Promise((e=>{let i=globalThis;i.lobby={currentUser:{},table:{},net:{}},t.module?import("./agent.e170783c.js").then((t=>{let r=t.create();i.lobby.net.gameCommand=r;(()=>{n.host.indexOf("://")<0&&(n.host=`wss://${n.host}`);let t=n.info,i=n.host,r=n.protocol,s=n.gameFormat,o={hostname:i};import("./agent.d4220880.js").then((n=>{n.init({gameFormat:s,protocol:r}).then((()=>{n.connect(o).then((()=>{(async function(e){try{let t=await import("./agent.d4220880.js");return await t.login(e)}catch(e){}})(t).then((()=>{e(null)}))}))}))}))})()})):(gi=new f({},"/"+n.namespace),gi.init(),import("./agent.94bb7c8a.js").then((t=>{let i,r=globalThis,s=l;i=t.getCommandList(),gi.setEventMap(i),gi.setSendEvent(t.getSendEvent()),s.state="連線中",Pe.redraw();let o={};o.send=gi.setGameCommand,o.registerGameEvent=gi.registerGameEvent,o.unregisterGameEvent=gi.unregisterGameEvent,r.lobby.net.gameCommand=o,r.lobby.net.setLobbyCommand=gi.setLobbyCommand,r.lobby.net.CMD=f.CMD,r.lobby.setEvent=t.setEvent,n.host&&gi.setHost(n.host);let a=h.setTimeout((()=>{"連線中"===s.state&&(globalThis.Howler&&(globalThis.Howler.mute(!0),globalThis.Howler.unload()),Yt({title:"connecting",msg:"disconnect"}))}),.001*c);gi.connect({connect(){a&&(h.remove(a),a=null),e(gi)},disconnect(){a&&(h.remove(a),a=null)}})})))}))}function Ui(){return gi}function Ai(){return globalThis}var Pi=Object.freeze({__proto__:null,autoLogin:$i,getCurrentContext:function(){return fi},getGameTemplate:Oi,getLobby:Ui,getManager:Ai,hideInfo:Ti,reload:wi,resetCache:function(){if(t.useCache){let e=t.registration;if(e&&e.active&&navigator.serviceWorker.controller){let e={reset:"games"};navigator.serviceWorker.controller.postMessage(e)}}},run:Ii,setAccountVisible:ki,setCurrentContext:Ei,setKey:function(e){s.key=e},showGameList:function(){fi=cn},showInfo:xi});export{qn as C,jt as a,Yt as b,Pi as c,zt as d,Nt as e,Jt as f,Kt as g,Ti as h,si as i,Ai as j,Wn as k,Ui as l,Pe as m,Gn as n,Rt as s};
