import{s as A,a as e,G as a,o,M as l,i as t}from"./agent.4bc95a1a.js";import{i as n,s}from"./agent.2704ee2b.js";async function g(){let g,i=e,r=A,h=a,m=globalThis.location.search.substring(1),u=null,c={module:A=>r.module=A,lang:A=>r.langID=A,launch:A=>r.launch=A,res:A=>r.res=A,logo:A=>{A.indexOf("//")>=0?r.logo=A:r.logo="data/img/"+A},agent:A=>{"megahot"===A?r.agent="bg":"jigtp"===A?r.agent="tp":"gatest"===A?r.agent="bg":"aekvnd01"===A?r.agent="ae":"kingco"===A&&(r.agent="kc")},hostname:A=>i.host=A,key:A=>i.key=A,group:A=>i.group=A,game:A=>i.game=A,room:A=>i.room=A,currency:A=>i.currency=A,mode:A=>i.mode=A,namespace:A=>i.namespace=A,tablekey:A=>i.tablekey=A,menu:A=>r.menu=A,options:A=>u=A,lobbyName:A=>r.lobbyName=A,mobileMode:A=>r.mobileMode=A,ping:()=>r.ping=!0,version:A=>r.version=A};if(g=m.split("&",25),g.forEach((A=>{let e=A.split("=",2),a=c[e[0]];a&&a(e[1])})),r.launch&&r.launch.length>0&&(i.game=r.launch),r.menu&&r.menu.length>0){let A=[];for(let e=0;e<r.menu.length;e+=1)A[e]=parseInt(r.menu[e]);r.menu=A}let b=o;if(u&&u.length>0){r.useOptions=!0;for(let A=0;A<u.length;A+=1)b[A]=parseInt(u[A])}i.host&&0===i.host.length&&(i.host=null),t?(i.host||(i.host="http://127.0.0.1:11102"),i.key||(i.key="a1")):i.host||(i.host=globalThis.location.hostname+":"+globalThis.location.port),(!i.mode||i.mode.length<=1)&&(i.mode=h.REAL);let f=i.info;if(f.token=i.key,i.tablekey&&(f.tablekey=i.tablekey),r.langID=n[r.langID],r.langID||(r.langID="en-us"),s(r.langID),r.module)if(0===r.module.length)r.module=null;else{let A=l,e=r.module[A.PROTOCOL];"p"===e?i.protocol="protobuf":"a"===e&&(i.protocol="avro"),e=r.module[A.GAME_FORMAT],i.gameFormat="gti","g"===e?i.gameFormat="gti":"v"===e&&(i.gameFormat="video")}let d=new Date;return A.version=d.getTime(),new Promise((e=>{A.useAvif=!1;let a=new Image;a.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=",a.onload=()=>{A.useAvif=!0,e()},a.onerror=()=>{e()}}))}async function i(){if(globalThis.BASE_URL)return new Promise((e=>{let a=!1;A.cdnList=[],A.hasCDN=!1,A.selectCDN=!1;let o=[];if(Array.isArray(globalThis.DISABLE_AUTO_CDN))o=globalThis.DISABLE_AUTO_CDN;else if(globalThis.DISABLE_AUTO_CDN)return;let l=globalThis.BASE_URL.indexOf("/",9),t=globalThis.BASE_URL.substring(l+1);function n(e){A.cdnList.push(e),A.hasCDN||(A.hasCDN=!0)}setTimeout((function(){e(),a=!0}),500),function(){let l=[];globalThis.CDN_LIST&&Array.isArray(globalThis.CDN_LIST)&&globalThis.CDN_LIST.forEach((e=>{if(e&&e.url){let a=e.url;a.lastIndexOf(".jpg")<0&&(e.target=`${a}${t}`,e.url=`${a}webedit/it.jpg`),A.isReload?e.target!==globalThis.BASE_URL&&l.push(e):l.push(e)}})),0===l.length&&(l=[]);let s=0,g=0,i=0;l.forEach(((l,t)=>{if(o[t])return;let r=Math.round(performance.now()),h=l.url;s+=1,fetch(h,{credentials:"omit"}).then((A=>A.ok?A.arrayBuffer():null)).then((o=>{if(!a)if(o){if(r=Math.round(performance.now()-r),i>=8)return void e();A.isReload?l.target!==globalThis.BASE_URL&&(n(l),i+=1):(n(l),i+=1),g+=1,g>=s&&e()}else g+=1,g>=s&&e()})).catch((A=>{g+=1,g>=s&&e()}))})),0===s&&e()}()}))}export{i as checkCDN,g as start};
