import{m as e,u as t,g as i,s as n,b as s,d as r,o as a,i as o,O as l,c,a as h,G as g,r as u,e as d,l as p,n as m,f,h as b,j as w,I as y,P as v,T as x,L,k as T,p as C}from"./agent.0e2c50f2.js";let E={Android:()=>navigator.userAgent.match(/Android/i),BlackBerry:()=>navigator.userAgent.match(/BlackBerry/i),iOS:()=>navigator.userAgent.match(/iPhone|iPad|iPod/i),Opera:()=>navigator.userAgent.match(/Opera Mini/i),Windows:()=>navigator.userAgent.match(/IEMobile/i),any:()=>E.Android()||E.BlackBerry()||E.iOS()||E.Opera()||E.Windows()},k=null;function R(e){k=e}function O(e){k&&k.fix&&(globalThis.innerHeight>=e.screenHeight-k.fix.height?e.isFullscreen=!0:e.isFullscreen=!1)}let I={name:"chrome",0:{offset:{x:0,y:0,width:0,height:0},fix:{height:68}},90:{offset:{x:0,y:0,width:0,height:0},fix:{height:28}},"-90":{offset:{x:0,y:0,width:0,height:0},fix:{height:28}},270:{offset:{x:0,y:0,width:0,height:0},fix:{height:28}},180:{offset:{x:0,y:0,width:0,height:0},fix:{height:68}}};var U=Object.freeze({__proto__:null,checkFullscreen:function(e){O(e)},setCurrentValue:function(e){R(I[e])},getCurrentValue:function(){return k},value:I});let _={name:"firefox",0:{offset:0,fix:{height:26}},90:{offset:0,fix:{height:26}},"-90":{offset:0,fix:{height:26}},270:{offset:0,fix:{height:26}},180:{offset:0,fix:{height:26}}};var P=Object.freeze({__proto__:null,checkFullscreen:function(e){O(e)},setCurrentValue:function(e){R(_[e])},getCurrentValue:function(){return k},value:_});let B={name:"opera",0:{offset:0,fix:{height:114}},90:{offset:0,fix:{height:72}},"-90":{offset:0,fix:{height:72}},270:{offset:0,fix:{height:72}},180:{offset:0,fix:{height:114}}};var $=Object.freeze({__proto__:null,checkFullscreen:function(e){O(e)},setCurrentValue:function(e){R(B[e])},getCurrentValue:function(){return k},value:B});let A={name:"uc",0:{offset:0,fix:{height:0}},90:{offset:0,fix:{height:0}},"-90":{offset:0,fix:{height:0}},270:{offset:0,fix:{height:0}},180:{offset:0,fix:{height:0}}};var F=Object.freeze({__proto__:null,checkFullscreen:function(e){O(e)},setCurrentValue:function(e){R(A[e])},getCurrentValue:function(){return k},value:A});let M={name:"baidu",0:{offset:{x:0,y:0,width:0,height:0},fix:{height:87}},90:{offset:0,fix:{height:87}},"-90":{offset:0,fix:{height:87}},270:{offset:0,fix:{height:87}},180:{offset:0,fix:{height:87}}};var S=Object.freeze({__proto__:null,checkFullscreen:function(e){O(e)},setCurrentValue:function(e){R(M[e])},getCurrentValue:function(){return k},value:M});let N={name:"lieao",0:{offset:{x:0,y:0,width:0,height:0},fix:{height:0}},90:{offset:0,fix:{height:0}},"-90":{offset:0,fix:{height:0}},270:{offset:0,fix:{height:0}},180:{offset:0,fix:{height:0}}};var H=Object.freeze({__proto__:null,checkFullscreen:function(e){O(e)},setCurrentValue:function(e){R(N[e])},getCurrentValue:function(){return k},value:N});let V={name:"unknown",0:{offset:{x:0,y:0,width:0,height:0},fix:{height:0}},90:{offset:0,fix:{height:0}},"-90":{offset:0,fix:{height:0}},270:{offset:0,fix:{height:0}},180:{offset:0,fix:{height:0}}};var z=Object.freeze({__proto__:null,checkFullscreen:function(e){O(e)},setCurrentValue:function(e){R(V[e])},getCurrentValue:function(){return k},value:V});let j={name:"chrome",0:{offset:{x:0,y:0,width:0,height:4},fix:{height:24}},90:{offset:{x:0,y:0,width:0,height:4},fix:{height:24}},"-90":{offset:{x:0,y:0,width:0,height:4},fix:{height:24}},180:{offset:{x:0,y:0,width:0,height:4},fix:{height:24}}},D=null;var W=Object.freeze({__proto__:null,getCurrentValue:function(){return k},value:j,eventOrientation:function(e){let t=j.state;switch(D=j[e],R(D),e){case 0:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!0,t.isLandscape=!1),t.screenHeight=screen.height,t.screenWidth=screen.width;break;case-90:case 90:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!1,t.isLandscape=!0),screen.width<screen.height?(t.screenHeight=screen.width,t.screenWidth=screen.height):(t.screenHeight=screen.height,t.screenWidth=screen.width);break;case 180:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!0,t.isLandscape=!1),t.screenHeight=screen.height,t.screenWidth=screen.width}},checkFullscreen:function(e){D&&D.fix&&(globalThis.innerHeight>=e.screenHeight-D.fix.height?e.isFullscreen=!0:e.isFullscreen=!1)}});let G={name:"firefox",0:{offset:{x:0,y:0,width:0,height:4},fix:{height:40}},90:{offset:{x:0,y:0,width:0,height:4},fix:{height:8}},"-90":{offset:{x:0,y:0,width:0,height:4},fix:{height:8}},180:{offset:{x:0,y:0,width:0,height:4},fix:{height:40}}},Y=null;var q=Object.freeze({__proto__:null,getCurrentValue:function(){return k},value:G,eventOrientation:function(e){let t=G.state;switch(Y=G[e],R(Y),e){case 0:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!0,t.isLandscape=!1),t.screenHeight=screen.height,t.screenWidth=screen.width;break;case-90:case 90:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!1,t.isLandscape=!0),screen.width<screen.height?(t.screenHeight=screen.width,t.screenWidth=screen.height):(t.screenHeight=screen.height,t.screenWidth=screen.width);break;case 180:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!0,t.isLandscape=!1),t.screenHeight=screen.height,t.screenWidth=screen.width}globalThis.outerWidth<globalThis.innerWidth&&(globalThis.outerWidth=globalThis.innerWidth),globalThis.outerHeight<globalThis.innerHeight&&(globalThis.outerHeight=globalThis.innerHeight)},checkFullscreen:function(e){Y&&Y.fix&&(globalThis.innerHeight>=e.screenHeight-Y.fix.height?e.isFullscreen=!0:e.isFullscreen=!1)}});let X={name:"uc",0:{offset:{x:0,y:0,width:0,height:4},fix:{height:82}},90:{offset:{x:0,y:0,width:0,height:4},fix:{height:100}},"-90":{offset:{x:0,y:0,width:0,height:4},fix:{height:100}},180:{offset:{x:0,y:0,width:0,height:4},fix:{height:82}}},K=null;var J=Object.freeze({__proto__:null,getCurrentValue:function(){return k},value:X,eventOrientation:function(e){let t=X.state;switch(K=X[e],R(K),e){case 0:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!0,t.isLandscape=!1),t.screenHeight=screen.height,t.screenWidth=screen.width;break;case-90:case 90:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!1,t.isLandscape=!0),screen.width<screen.height?(t.screenHeight=screen.width,t.screenWidth=screen.height):(t.screenHeight=screen.height,t.screenWidth=screen.width);break;case 180:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!0,t.isLandscape=!1),t.screenHeight=screen.height,t.screenWidth=screen.width}},checkFullscreen:function(e){e.isFullscreen=!0}});let Q={name:"safari",0:{offset:{x:0,y:0,width:0,height:4},fix:{height:32}},90:{offset:{x:0,y:0,width:0,height:4},fix:{height:16}},"-90":{offset:{x:0,y:0,width:0,height:4},fix:{height:16}},180:{offset:{x:0,y:0,width:0,height:4},fix:{height:32}}},Z=null;var ee=Object.freeze({__proto__:null,getCurrentValue:function(){return k},value:Q,eventOrientation:function(e){let t=Q.state;switch(Z=Q[e],R(Z),e){case 0:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!0,t.isLandscape=!1),t.screenHeight=screen.height,t.screenWidth=screen.width;break;case-90:case 90:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!1,t.isLandscape=!0),screen.width<screen.height?(t.screenHeight=screen.width,t.screenWidth=screen.height):(t.screenHeight=screen.height,t.screenWidth=screen.width);break;case 180:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!0,t.isLandscape=!1),t.screenHeight=screen.height,t.screenWidth=screen.width}},checkFullscreen:function(e){Z&&Z.fix&&(globalThis.innerHeight>=e.screenHeight-Z.fix.height?e.isFullscreen=!0:e.isFullscreen=!1)}});let te={name:"baidu",0:{offset:{x:0,y:0,width:0,height:4},fix:{height:0}},90:{offset:{x:0,y:0,width:0,height:4},fix:{height:0}},"-90":{offset:{x:0,y:0,width:0,height:4},fix:{height:0}},180:{offset:{x:0,y:0,width:0,height:4},fix:{height:0}}},ie=null;var ne=Object.freeze({__proto__:null,getCurrentValue:function(){return k},value:te,eventOrientation:function(e){let t=te.state;switch(ie=te[e],R(ie),e){case 0:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!0,t.isLandscape=!1),t.screenHeight=screen.height,t.screenWidth=screen.width;break;case-90:case 90:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!1,t.isLandscape=!0),screen.width<screen.height?(t.screenHeight=screen.width,t.screenWidth=screen.height):(t.screenHeight=screen.height,t.screenWidth=screen.width);break;case 180:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!0,t.isLandscape=!1),t.screenHeight=screen.height,t.screenWidth=screen.width}},checkFullscreen:function(e){ie&&ie.fix&&(globalThis.innerHeight>=e.screenHeight-ie.fix.height?e.isFullscreen=!0:e.isFullscreen=!1)}});let se={name:"liebao",0:{offset:{x:0,y:0,width:0,height:4},fix:{height:24}},90:{offset:{x:0,y:0,width:0,height:4},fix:{height:24}},"-90":{offset:{x:0,y:0,width:0,height:4},fix:{height:24}},180:{offset:{x:0,y:0,width:0,height:4},fix:{height:24}}},re=null;var ae=Object.freeze({__proto__:null,getCurrentValue:function(){return k},value:se,eventOrientation:function(e){let t=se.state;switch(re=se[e],R(re),e){case 0:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!0,t.isLandscape=!1),t.screenHeight=screen.height,t.screenWidth=screen.width;break;case-90:case 90:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!1,t.isLandscape=!0),screen.width<screen.height?(t.screenHeight=screen.width,t.screenWidth=screen.height):(t.screenHeight=screen.height,t.screenWidth=screen.width);break;case 180:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!0,t.isLandscape=!1),t.screenHeight=screen.height,t.screenWidth=screen.width}},checkFullscreen:function(e){re&&re.fix&&(globalThis.innerHeight>=e.screenHeight-re.fix.height?e.isFullscreen=!0:e.isFullscreen=!1)}});let oe={name:"unknown",0:{offset:{x:0,y:0,width:0,height:4},fix:{height:0}},90:{offset:{x:0,y:0,width:0,height:4},fix:{height:0}},"-90":{offset:{x:0,y:0,width:0,height:4},fix:{height:0}},180:{offset:{x:0,y:0,width:0,height:4},fix:{height:0}}},le=null;var ce=Object.freeze({__proto__:null,getCurrentValue:function(){return k},value:oe,eventOrientation:function(e){let t=oe.state;switch(le=oe[e],R(le),e){case 0:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!0,t.isLandscape=!1),t.screenHeight=screen.height,t.screenWidth=screen.width;break;case-90:case 90:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!1,t.isLandscape=!0),screen.width<screen.height?(t.screenHeight=screen.width,t.screenWidth=screen.height):(t.screenHeight=screen.height,t.screenWidth=screen.width);break;case 180:(t.usePortrait||t.useLandscape)&&(t.isPortrait=!0,t.isLandscape=!1),t.screenHeight=screen.height,t.screenWidth=screen.width}},checkFullscreen:function(e){le&&le.fix&&(globalThis.innerHeight>=e.screenHeight-le.fix.height?e.isFullscreen=!0:e.isFullscreen=!1),e.isFullscreen=!0}});function he(e){let t=!1;return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement?(t=!0,e&&(e.isFullscreen=!0)):(t=!1,e&&(e.isFullscreen=!1)),t}async function ge(e){if(!document.fullscreenEnabled)return Promise.reject();let t=!1;document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement?(e&&(e.isFullscreen=!1),document.exitFullscreen?(await document.exitFullscreen(),t=!0):document.msExitFullscreen?(await document.msExitFullscreen(),t=!0):document.mozCancelFullScreen?(await document.mozCancelFullScreen(),t=!0):document.webkitExitFullscreen&&(await document.webkitExitFullscreen(),t=!0),t&&e&&(e.isFullscreen=!1)):(document.documentElement.requestFullscreen?(await document.documentElement.requestFullscreen(),t=!0):document.documentElement.msRequestFullscreen?(await document.documentElement.msRequestFullscreen(),t=!0):document.documentElement.mozRequestFullScreen?(await document.documentElement.mozRequestFullScreen(),t=!0):document.documentElement.webkitRequestFullscreen&&(await document.documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT),t=!0),t&&(e&&(e.isFullscreen=!0),we.useOrientation&&globalThis.screen&&globalThis.screen.orientation&&globalThis.screen.orientation.lock&&await globalThis.screen.orientation.lock(we.orientation.name)))}let ue=!0,de=!1;let pe={oninit(e){let t=this,i=e.attrs;t.onclick=i.onclick,t.style=i.style,t.config=i.config},onbeforeremove(){},view(){let t=this,i=t.config;return e(".pointer",{style:{width:"4%",height:"10%",borderRadius:"4px 8px 8px 4px",backgroundColor:"#000",opacity:.6,position:"absolute",left:t.style.left,top:t.style.top,zIndex:900},onclick(){i&&(i.isMenu=!0,i.visible=!1),t.onclick&&t.onclick()}},e.trust('<img src="data/sys/4021bb29611b24c4.svg" class="w-100 h-100 dropshadow">'))}},me={oninit(e){let t=e.attrs,i=this;i.event=t.event,i.tray=t.tray,i.info=t.info,i.config=t.config,i.isLeave=!1,i.config||(i.config={isMenu:de,visible:ue,flags:{fullscreen:!0,lock:!0,sound:!0,music:!0}}),i.config.flags||(i.config.flags={}),i.info||(i.info={logo:"logo.png",gameName:"test game",version:"0.0.0",mode:" test mode",token:"token"}),i.tray||(i.tray={state:{visible:!0},sound:{isMute:!1},music:{isMute:!1},screen:{isAutoScale:!0,isLock:!1},isLock:!1,isFullscreen:!1},Object.defineProperty(i.tray,"visible",{get:()=>i.tray.state.visible,set(e){i.tray.state.visible=e}}))},onbeforeremove:e=>(["animate__fadeOutLeft","animate__animated"].forEach((t=>{e.dom.classList.add(t)})),new Promise((e=>{t.setTimeout((()=>{e()}),.4)}))),onremove(){},view(){let t=this,r=t.tray,a=t.event,o=t.info,l=t.config,c=l.flags,h=s.URLs,g=n.menu||[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0];return e(".animate__fadeInLeft animate__animated",{onclick(){t.isLeave?(l.isMenu=!1,l.visible=!1,r.visible=!1):(l.visible=!1,r.visible=!0)},style:{zIndex:900,position:"absolute",left:"0%",top:"0%",width:"100%",height:"100%"}},e(".pv2.ph2.bg-black.[id='panel']",[e(".fl.bb.b--gray.mb2.dib.pb2.mb2.w-100.rwdPanelHeader",[e("table.pa2.ml4.dib.br2.bg-black.white.rwdAppInfo",e("tbody.rwd-lh",[e("tr",[e("td",i("gameName")),e("td"," : "),e("td.blue",o.gameName)]),e("tr",[e("td",i("version")),e("td"," : "),e("td.blue",o.version)]),g[8]?e("tr",[e("td",i("gameMode")),e("td"," : "),e("td.blue",o.mode)]):null]))]),g[0]&&c.fullscreen&&!we.ios?e(".",[e(".fl.w-70.pa1.ma1.rwdOpt",e(".no-underline.near-white.inline-flex",[e("img.dib.fl.mv1.rwdOptIcon.dropshadow",{alt:"FULL SCREEN",src:"data/sys/f512613ddcb62054.png"}),e(".ml3.white.mv3.f4.rwdPanelFont",i("fullscreen"))])),e(".fr.w-20.pt2.mv2.mr2.rwdToggle",{onclick(){r.isFullscreen=!r.isFullscreen,e.redraw(),ge(r).then((()=>{a&&a.fullscreen&&a.fullscreen(r.isFullscreen)}))}},e("label.switch",[e("input[name='toggle'][type='checkbox'][value='fullscreen']",{disabled:!0,checked:r.isFullscreen}),e("span.slider.round")]))]):e("."),g[1]&&c.lock?e(".",[e(".fl.w-70.pa1.ma1.rwdOpt",e(".no-underline.near-white.inline-flex",[e("img.dib.fl.mv1.rwdOptIcon.dropshadow",{alt:"LOCK SCALE",src:"data/sys/8920df5ffd5c25b0.png"}),e(".ml3.white.mv3.f4.rwdPanelFont",i("lock"))])),e(".fr.w-20.pt2.mv2.mr2.rwdToggle",{onclick(){r.isLock=!r.isLock,r.update&&r.update(r),e.redraw(),a&&a.lock&&a.lock(r.isLock)}},e("label.switch",[e("input[name='toggle'][type='checkbox'][value='lock']",{disabled:!0,checked:r.isLock}),e("span.slider.round")]))]):e("."),g[2]&&c.music?e(".",[e(".fl.w-70.pa1.ma1.rwdOpt",e(".no-underline.near-white.inline-flex",[e("img.h-100.dib.fl.mv1.rwdOptIcon.dropshadow[alt='MUSIC'][src='data/sys/ddb7103e5eca70e6.png']"),e(".ml3.white.mv3.f4.rwdPanelFont",i("music"))])),e(".fr.w-20.pt2.mv2.mr2.rwdToggle",{onclick(){r.music.isMute=!r.music.isMute,e.redraw(),a&&a.music&&a.music(r.music)}},e("label.switch",[e("input[name='toggle'][type='checkbox'][value='music']",{disabled:!0,checked:!r.music.isMute}),e("span.slider.round")]))]):e("."),g[3]&&c.sound?e(".",[e(".fl.w-70.pa1.ma1.rwdOpt",e(".no-underline.near-white.inline-flex",[e("img.dib.fl.mv1.rwdOptIcon.dropshadow[alt='SOUND'][src='data/sys/ddb7103e5eca70e6.png']"),e(".ml3.white.mv3.f4.rwdPanelFont",i("sound"))])),e(".fr.w-20.pt2.mv2.mr2.rwdToggle",e("label.switch",[e("input[name='toggle'][type='checkbox'][value='sound']",{checked:!r.sound.isMute,onclick(){r.sound.isMute=!r.sound.isMute,a&&a.sound&&a.sound(r.sound)}}),e("span.slider.round")]))]):e("."),g[4]?e(".fl.w-100.pa2.pt3.bt.b--gray.mt2.rwdBtn",{onclick(){we.useFocus=!0,h&&h.list&&globalThis.open(h.list+o.token)}},e(".w-100 no-underline near-white bg-animate bg-near-black hover-bg-gray inline-flex items-center ma1 tc br1 pa1 border-box pointer",[e("img.dib h2 w2[src='data/sys/35b95e6d1d3ebf48.png']"),e(".w-100.f3.white.mv1.dib.noselect.rwdPanelFont",i("history"))])):e("."),g[5]?e(".fl.w-100.pa2",{onclick(){we.useFocus=!0,h&&h.deposit&&globalThis.open(h.deposit+o.token)}},e(".w-100 no-underline near-white bg-animate bg-near-black hover-bg-gray inline-flex items-center ma1 tc br1 pa1 border-box pointer",[e("img.dib h2 w2[src='data/sys/2357769f78f010b1.png']"),e(".w-100.f3.white.mv1.dib.noselect",i("deposit"))])):e("."),g[6]?e(".fl.w-100.pa2",{onclick(){globalThis.Howler&&(globalThis.Howler.mute(!0),globalThis.Howler.unload()),"gold"===n.lobbyName&&(globalThis.parent!==globalThis&&globalThis.parent.postMessage("leave","*"),document.location="postdata://leave"),we.useFocus=!0,h&&h.official&&globalThis.open(h.official+o.token)}},e(".w-100 no-underline near-white bg-animate bg-near-black hover-bg-gray inline-flex items-center ma1 tc br1 pa1 border-box pointer",[e("img.dib h2 w2[src='data/sys/94615eed5b8c0616.png']"),e(".w-100.f3.white.mv1.dib.noselect",i("back"))])):e("."),g[7]?e(".fl.w-100.pa2",{onclick(){if(we.useFocus=!0,t.isLeave=!0,o.iframe){let e=o.iframe.contentDocument||o.iframe.contentglobalThis.document;e?(e.open(),e.write(""),e.close()):o.iframe.srcdoc="about:blank"}globalThis.Howler&&(globalThis.Howler.mute(!0),globalThis.Howler.unload()),"gold"===n.lobbyName?(globalThis.parent!==globalThis&&globalThis.parent.postMessage("leave","*"),document.location="postdata://leave"):h&&h.lobby&&(globalThis.document&&globalThis.document.location&&globalThis.document.location.replace?globalThis.document.location.replace(h.lobby||"about:blank"):globalThis.location.href=h.lobby||"about:blank")}},e(".w-100 no-underline near-white bg-animate bg-near-black hover-bg-gray inline-flex items-center ma1 tc br1 pa1 border-box pointer",[e("img.dib h2 w2[src='data/sys/fe342b264ea95dbb.png']"),e(".w-100.f3.white.mv1.dib.noselect",i("lobby"))])):e("."),e(".")]))}};function fe(e,t){return null!=e?e:t()}function be(e){let t,i=e[0],n=1;for(;n<e.length;){const s=e[n],r=e[n+1];if(n+=2,("optionalAccess"===s||"optionalCall"===s)&&null==i)return;"access"===s||"optionalAccess"===s?(t=i,i=r(i)):"call"!==s&&"optionalCall"!==s||(i=r(((...e)=>i.call(t,...e))),t=void 0)}return i}let we={},ye={resizeTimer:null,timer:null,eventDelay:260},ve=null,xe={name:null,angle:0,isTrigger:!1},Le=null;function Te(e){switch(Le&&Le.setCurrentValue&&Le.setCurrentValue(e),e){case 0:(we.usePortrait||we.useLandscape)&&(we.isPortrait=!0,we.isLandscape=!1),we.screenHeight=screen.height,we.screenWidth=screen.width;break;case 270:case-90:(we.usePortrait||we.useLandscape)&&(we.isPortrait=!1,we.isLandscape=!0),screen.width<screen.height?(we.screenHeight=screen.width,we.screenWidth=screen.height):(we.screenHeight=screen.height,we.screenWidth=screen.width);break;case-270:case 90:(we.usePortrait||we.useLandscape)&&(we.isPortrait=!1,we.isLandscape=!0),screen.width<screen.height?(we.screenHeight=screen.width,we.screenWidth=screen.height):(we.screenHeight=screen.height,we.screenWidth=screen.width);break;case-180:case 180:(we.usePortrait||we.useLandscape)&&(we.isPortrait=!0,we.isLandscape=!1),we.screenHeight=screen.height,we.screenWidth=screen.width}globalThis.parent===window&&globalThis.scrollTo(0,we.currentY)}function Ce(){we.isPortrait=!1,we.isLandscape=!1;let e=0;e=window.matchMedia("(orientation: portrait)").matches?0:90,0===e&&(e=globalThis.screen.orientation&&"number"==typeof globalThis.screen.orientation.angle?globalThis.screen.orientation.angle:parseInt(globalThis.orientation)),xe.angle=e,ve?ve(e):Le&&Le.eventOrientation?Le.eventOrientation(e):Te(e),globalThis.parent===window&&globalThis.scrollTo(0,we.currentY)}function Ee(i){ye.timer&&(t.remove(ye.timer),ye.timer=null),xe.isTrigger=!0,e.redraw(),ye.timer=t.setTimeout((()=>{xe.isTrigger=!1,Ce(),Oe()}),.001*ye.eventDelay)}function ke(e){if(we.isMobile&&!e.isChild&&Le&&Le.getCurrentValue){let t=Le.getCurrentValue();if(t){let i=t.offset;e.left=0,e.top=0,e.width=globalThis.innerWidth,e.height=globalThis.innerHeight,"number"==typeof i?e.height=globalThis.innerHeight-i:i&&("number"==typeof i.x&&(e.left=i.x),"number"==typeof i.y&&(e.top=i.y),"number"==typeof i.width&&(e.width=globalThis.innerWidth-i.width),"number"==typeof i.height&&(e.height=globalThis.innerHeight-i.height))}else e.left=0,e.top=0,e.width=globalThis.innerWidth,e.height=globalThis.innerHeight;e.left+="px",e.top+="px",e.width+="px",e.height+="px"}}function Re(e){let t=e.game,i={x:1,y:1},n=screen.width,s=screen.height;we.isMobile?(n=globalThis.innerWidth,s=globalThis.innerHeight,we.useFullscreen||(n=globalThis.innerWidth,s=globalThis.innerHeight),we.ios&&(s=globalThis.innerHeight,n=globalThis.innerWidth)):(n=globalThis.innerWidth,s=globalThis.innerHeight),t.portrait&&t.landscape&&(n>s?(t.width=t.landscape.width||512,t.height=t.landscape.height||512):(t.width=t.portrait.width||512,t.height=t.portrait.height||512)),e.fix&&(n=parseInt(e.fix.width),s=parseInt(e.fix.height));let r={x:0,y:0};e.left=0,e.top=0;let a=e.reference;a&&(r.x=a.left*n,r.y=a.top*s,n*=a.width,s*=a.height),n-t.width<0?(e.width=n,i.x=n/t.width):e.width=t.width,s-t.height<0?(e.height=s,i.y=s/t.height):e.height=t.height,i.x<i.y?e.height=t.height*i.x:i.x>i.y&&(e.width=t.width*i.y);let o=e.anchor;if(o){let t=(n-e.width)*fe(o.x,(()=>.5)),i=(s-e.height)*fe(o.y,(()=>.5));e.left=r.x+t,e.top=r.y+i}if(e.useCenter){let t=0,i=0;"boolean"==typeof e.useCenter?(i=.5*(s-e.height),i<0&&(i=0),t=.5*(n-e.width),t<0&&(t=0)):(e.useCenter.vertical&&(i=.5*(s-e.height),i<0&&(i=0)),(e.useCenter.horizontal||e.useCenter.left)&&(t=.5*(n-e.width),t<0&&(t=0))),e.left=r.x+t,e.top=r.y+i}e.absPos&&("number"==typeof e.absPos.top?e.top=e.absPos.top:"number"==typeof e.absPos.bottom&&(e.top=s+e.absPos.bottom),"number"==typeof e.absPos.left?e.left=e.absPos.left:"number"==typeof e.absPos.right&&(e.left=n+e.absPos.right)),t.eventResize&&t.eventResize({left:e.left,top:e.top,width:e.width,height:e.height}),e.eventResize&&e.eventResize({width:globalThis.innerWidth,height:globalThis.innerHeight}),e.left+="px",e.top+="px",e.width+="px",e.height+="px"}function Oe(i){if(!xe.isTrigger&&!we.disableResize){if(!i)return!!xe.isTrigger||void(ye.resizeTimer||(we.isResize=!0,e.redraw(),ye.resizeTimer=t.setTimeout((()=>{t.remove(ye.resizeTimer),ye.resizeTimer=null,n()}),.3)));n()}function n(){we.isMobile&&globalThis.parent===window&&globalThis.scrollTo(0,we.currentY),t.setTimeout((()=>{Le&&Le.checkFullscreen&&we.useFullscreen&&Le.checkFullscreen(we);let t=globalThis.scene;if(we.settingList.forEach((i=>{if(i){if(!i.isLock)return ke(i),e.redraw(),!0;if(Re(i),t){let e=t[i.id];if(e){let t=e.localEvent;if(t&&t.resize){let e={isMobile:we.isMobile};e.width=globalThis.innerWidth,e.height=globalThis.innerHeight,e.setting=i,t.resize(e)}}}e.redraw()}})),t){Object.getOwnPropertyNames(t).forEach((e=>{let i=t[e];if(i){let e=i.localEvent;if(e&&e.resize){let t={isMobile:we.isMobile};t.width=globalThis.innerWidth,t.height=globalThis.innerHeight,4!==i.state&&5!==i.state||e.resize(t)}}}))}we.isResize=!1,e.redraw()}),.01)}}function Ie(e){if(be([e,"optionalAccess",e=>e.index])>=0)return-1;let t=-1;for(let i=0;i<we.settingList.length;i+=1){we.settingList[i]||(t=i,we.settingList[i]=e)}return t<0&&(t=we.settingList.length,we.settingList.push(e)),e.isLock&&Re(e),e.index=t,t}function Ue(e){if(be([e,"optionalAccess",e=>e.index])>=0){let t=e.index;t<we.settingList.length&&(we.settingList[t]=null),delete e.index}}function _e(e){we.disableResize=e}we.ios=!1,we.useOrientation=!1,we.usePortrait=!1,we.useLandscape=!1,we.isMobile=!1,we.mobileReady=null,we.useFullscreen=!1,we.isFullscreen=!1,we.isPortrait=!1,we.isLandscape=!1,we.isTouchOnce=!1,we.isResize=!1,we.currentY=0,we.screenWidth=screen.width,we.screenHeight=screen.height,we.screenUnit="px",we.orientation=xe,we.isTouchDown=!1,we.useFocus=!1,we.disableResize=!1,we.settingList=[];let Pe=!1;let Be=!1;function $e(){return Be}let Ae="title";function Fe(){return Ae}let Me="message";function Se(){return Me}function Ne(t){Ae=t.title,Me=t.msg,Be=!0,e.redraw()}function He(){Be=!1,e.redraw()}var Ve=Object.freeze({__proto__:null,isVisible:$e,getTitle:Fe,getMessage:Se,show:Ne,hide:He});let ze=null,je={oninit(e){let t=e.attrs;this.style=t.style,this.complete=t.complete,this.logo=null},oncreate(t){let i=this,n=t.attrs,s=t.dom,r=n.url,a="logo",o=new globalThis.Loader;o.add(a,r,{crossOrigin:!1}),o.load(((t,n)=>{let r=n.logo.data;r.style.position="absolute",r.style.left="0%",r.style.top="0%",r.style.width="100%",r.style.height="100%",i.logo=r,s.appendChild(r),e.redraw(),i.complete&&i.complete()}))},view(){return e(".",{style:this.style})}},De={timeBase:1,oninit(e){let t=e.attrs;this.class=t.class||"ba b--light-blue animate__animated animate__bounceIn",this.style=t.style||{left:"0%",top:"0%",width:"100%",height:"100%"},this.info=t.info,this.serve=t.serve,this.config=t.config||{width:300,height:200,resolution:1,antialias:!1,transparent:!0},this.id=t.id,this.group=t.group,this.title=t.title||"標題",this.logo=t.logo,this.game=null,this.eventClass={current:"ba b--dotted bw1 white-50",onmouseenter:"ba b--dotted bw2 white-50",onmouseleave:"ba b--dotted bw1 white-50"}},onbeforeremove(e){let i=this;return i.game&&i.game.pause(),["animate__animated","animate__lightSpeedOut"].forEach((t=>{e.dom.classList.add(t)})),new Promise((e=>{t.setTimeout(e,.4)}))},view(){let t=this,n=t.eventClass;return e(".",{class:t.class,style:t.style},[e(".game-card-title",t.title),e(je,{class:"game-card-view ba b--light-gray",style:{zValue:0,position:"absolute",left:"0%",top:"0%",width:"100%",height:"100%"},url:t.logo,complete(){}}),e(".",{onclick(){globalThis.Howl&&(ze||(ze=new globalThis.Howl({src:["data/f82550ea2e80cd97.wav"]}),ze.volume(.01)),ze.play()),Qt(!1),Ut({serve:t.serve,id:t.id,group:t.group})},onmouseenter(){n.current=n.onmouseenter,e.redraw()},onmouseleave(){n.current=n.onmouseleave,e.redraw()},class:n.current,style:{position:"absolute",left:"10%",top:"10%",width:"80%",height:"75%"}}),e(".game-card-download",{onclick(){Ne({yesno:!0,title:"exitGame",msg:"exitGame"})}},[e.trust(`<div class="no-underline near-white bg-animate bg-near-black hover-bg-gray inline-flex items-center ma2 tc br2 pa2">\n    <svg fill="#77ff77" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">\n    <path d="M19 8l-4 4h3c0 3.31-2.69 6-6 6-1.01 0-1.97-.25-2.8-.7l-1.46 1.46C8.97 19.54 10.43 20 12 20c4.42 0 8-3.58 8-8h3l-4-4zM6 12c0-3.31 2.69-6 6-6 1.01 0 1.97.25 2.8.7l1.46-1.46C15.03 4.46 13.57 4 12 4c-4.42 0-8 3.58-8 8H1l4 4 4-4H6z"/>\n    <path d="M0 0h24v24H0z" fill="none"/>\n</svg>\n    <span class="f6 ml3 pr2">${i("download")}</span>\n  </div>`)]),e(".game-card-stop",{onclick(){qt()}},[e.trust(`<div class="no-underline near-white bg-animate bg-near-black hover-bg-gray inline-flex items-center ma2 tc br2 pa2">\n    <svg fill="#77ff77" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">\n    <path d="M0 0h24v24H0z" fill="none"/>\n    <path d="M14.59 8L12 10.59 9.41 8 8 9.41 10.59 12 8 14.59 9.41 16 12 13.41 14.59 16 16 14.59 13.41 12 16 9.41 14.59 8zM12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"/>\n</svg>\n    <span class="f6 ml3 pr2">${i("stop")}</span>\n  </div>`)])])}},We={left:"0px",top:"0px",width:"300px",height:"200px"},Ge={},Ye={},qe=null;function Xe(e){return Ge[e]||(Ge[e]={}),Ye=Ge[e],Ye}function Ke(e,i,s){let r={};function o(){let e=n.registration;e&&e.active&&navigator.serviceWorker.controller?navigator.serviceWorker.controller.postMessage(r):t.setTimeout(o,.05)}let c=n.version||"1.0.0",h=!1,g=null;return g=new Promise((t=>{if(!e||!i)return void t(null);function g(){let g=`config/${i}/${e}/gamecard.txt?v=${c}`,u=`config/${i}/${e}/cache.txt`;if(s){let t=s;"/"===t[t.length-1]&&(t=t.substring(0,t.length-1)),g=`${t}/config/${i}/${e}/gamecard.txt?v=${c}`,u=`${t}/config/${i}/${e}/cache.txt`}else g=`config/${i}/${e}/gamecard.txt?v=${c}`,u=`config/${i}/${e}/cache.txt`;r.cacheName=`${i}${e}`,r.url=u,n.useCache&&o(),fetch(g,{headers:{"Content-Type":"text/plain"}}).then((e=>e.ok?e.text():null)).then((e=>{if(!e)return;let i={},r=new String(e),o=r.indexOf("{");if(o>=0&&o<=9){let e=JSON.parse(r);if(!e.options||!e.options.overview){let e=l;n.useOptions||(a[e.OVERVIEW_LOGO]=1,a[e.OVERVIEW_ANIMATION]=0,a[e.OVERVIEW_BACKGROUND]=0,a[e.OVERVIEW_PROGRESS]=1)}if(e.templateVersion="slot.2.1",i.gameCard=e,s){let e=s;"/"===e[e.length-1]&&(e=e.substring(0,e.length-1)),i.gameCard.baseURL=`${e}/`}h=!0,t(i)}})).catch((e=>{}))}let u,d;if(s){let t=s;"/"===t[t.length-1]&&(t=t.substring(0,t.length-1)),u=`${t}/${i}/${e}/config/gamecard.txt?v=${c}`,d=`${t}/${i}/${e}/config/cache.txt`}else u=`${n.projectURL}${i}/${e}/config/gamecard.txt?v=${c}`,d=`${n.projectURL}${i}/${e}/config/cache.txt`;r.cacheName=`${i}${e}`,r.url=d,n.useCache&&o(),fetch(u,{headers:{"Content-Type":"text/plain"}}).then((e=>e.ok?e.text():(g(),null))).then((e=>{if(!e)return;let i={},r=new String(e),a=r.indexOf("{");if(a>=0&&a<=9){if(i.gameCard=JSON.parse(r),s)if(i.gameCard.baseURL){let e=s;"/"===e[e.length-1]&&(e=e.substring(0,e.length-1)),i.gameCard.baseURL=e+i.gameCard.baseURL.replace(n.projectURL,"/")}else i.gameCard.baseURL=s;else{let e=globalThis.location.origin;i.gameCard.baseURL?i.gameCard.baseURL.indexOf("://")<0&&(i.gameCard.baseURL=e+i.gameCard.baseURL):i.gameCard.baseURL=globalThis.location.origin+"/"}h=!0,t(i)}if(h)return!0;g()})).catch((()=>{g()}))})),g}function Je(t,i,n){let s=Date.now(),r="";o&&(r="test/data/gameList.txt?v="+s),i[t]=[],n[t]=0;let a=0;e.request(r).then((e=>{i[t]=e||[],e.forEach((e=>{if(!e)return;e.isSub&&(a+=1);let t=Xe(e.group);if(globalThis.BASE_URL)if(e.baseURL){let t=globalThis.BASE_URL;"/"===t[t.length-1]&&(t=t.substring(0,t.length-1)),e.baseURL=t+e.baseURL}else e.baseURL=globalThis.BASE_URL;else{let t=globalThis.location.origin;e.baseURL?e.baseURL=t+e.baseURL:e.baseURL=globalThis.location.origin+"/"}t[e.id]=e})),n[t]=e.length-a}))}window.addEventListener("keydown",(function(e){const t=e.key||e.code;if(o)switch(t){case"r":case"R":if(qe){globalThis.scene[qe.id].reload({game:qe.appConfig,group:qe.group,id:qe.id,tablekey:"abcd1234"})}}})),window.addEventListener("keyup",(function(e){e.key||e.code}));let Qe={oninit(){let e={},t={};o?Je("test",e,t):(Je("slot",e,t),Je("video",e,t),Je("game",e,t)),this.group=e,this.displayCount=t},view(){let t=this;return o?e(".gameCardList",{style:{left:"0%",top:"0%",width:"100%",height:"100%"}},e(".",{style:{position:"absolute",left:"0%",top:"40%",width:"100%",height:"25%"}},"group zzzz",e(".layout",{style:{left:"0%",marginTop:"0px",width:25*t.displayCount.game+"%",height:"100%"}},t.group.test?t.group.test.map((t=>{if(!t||t.isSub)return e(".");let i=t.baseURL||"";return e(".",{style:We},[e(De,{id:t.id,group:t.group,serve:{game:t.id,group:t.group},logo:i+t.images.logo,title:`${t.name[r()]}(${t.appConfig})`})])})):e(".")))):e(".gameCardList",{style:{left:"0%",top:"0%",width:"100%",height:"100%"}},e(".",{style:{position:"absolute",left:"0%",top:"65%",width:"100%",height:"25%",overflowX:"scroll"}},"group game",e(".layout",{style:{left:"0%",marginTop:"0px",width:25*t.displayCount.game+"%",height:"100%"}},t.group.game.map((t=>{if(!t||t.isSub)return e(".");let i=t.baseURL||"";return e(".",{style:{left:"0%",top:"0%",width:"90%",height:"100%"}},e(De,{id:t.id,group:"game",serve:{game:t.id,group:"game"},logo:i+t.images.logo,title:t.name[r()]}))})))),e(".",{style:{position:"absolute",left:"0%",top:"5%",width:"100%",height:"25%",overflowX:"scroll"}},"group slot",e(".layout",{style:{left:"0%",marginTop:"0px",width:25*t.displayCount.slot+"%",height:"100%"}},t.group.slot.map((t=>{if(!t&&t.isSub)return e(".");let i=t.baseURL||"";return e(".",{style:{left:"0%",top:"0%",width:"100%",height:"100%"}},[e(De,{id:t.id,group:"slot",serve:{game:t.id,group:"slot"},logo:i+t.images.logo,title:t.name[r()]})])})))),e(".",{style:{position:"absolute",left:"0%",top:"35%",width:"100%",height:"25%",overflowX:"scroll"}},"group video",e(".layout",{style:{left:"0%",marginTop:"0px",width:25*t.displayCount.video+"%",height:"100%"}},t.group.video.map((t=>{if(!t||t.isSub)return e(".");let i=t.baseURL||"";return e(".",{style:{left:"0%",top:"0%",width:"100%",height:"80%"}},[e(De,{id:t.id,group:"video",serve:{game:t.id,group:"video"},logo:i+t.images.logo,title:t.name[r()]})])})))))}};var Ze=c((function(e,t){e.exports=function(){
/*!
   * mustache.js - Logic-less {{mustache}} templates with JavaScript
   * http://github.com/janl/mustache.js
   */
var e=Object.prototype.toString,t=Array.isArray||function(t){return"[object Array]"===e.call(t)};function i(e){return"function"==typeof e}function n(e){return t(e)?"array":typeof e}function s(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function r(e,t){return null!=e&&"object"==typeof e&&t in e}function a(e,t){return null!=e&&"object"!=typeof e&&e.hasOwnProperty&&e.hasOwnProperty(t)}var o=RegExp.prototype.test;function l(e,t){return o.call(e,t)}var c=/\S/;function h(e){return!l(c,e)}var g={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};function u(e){return String(e).replace(/[&<>"'`=\/]/g,(function(e){return g[e]}))}var d=/\s*/,p=/\s+/,m=/\s*=/,f=/\s*\}/,b=/#|\^|\/|>|\{|&|=|!/;function w(e,i){if(!e)return[];var n,r,a,o=!1,l=[],c=[],g=[],u=!1,w=!1,L="",T=0;function E(){if(u&&!w)for(;g.length;)delete c[g.pop()];else g=[];u=!1,w=!1}function k(e){if("string"==typeof e&&(e=e.split(p,2)),!t(e)||2!==e.length)throw new Error("Invalid tags: "+e);n=new RegExp(s(e[0])+"\\s*"),r=new RegExp("\\s*"+s(e[1])),a=new RegExp("\\s*"+s("}"+e[1]))}k(i||C.tags);for(var R,O,I,U,_,P,B=new x(e);!B.eos();){if(R=B.pos,I=B.scanUntil(n))for(var $=0,A=I.length;$<A;++$)h(U=I.charAt($))?(g.push(c.length),L+=U):(w=!0,o=!0,L+=" "),c.push(["text",U,R,R+1]),R+=1,"\n"===U&&(E(),L="",T=0,o=!1);if(!B.scan(n))break;if(u=!0,O=B.scan(b)||"name",B.scan(d),"="===O?(I=B.scanUntil(m),B.scan(m),B.scanUntil(r)):"{"===O?(I=B.scanUntil(a),B.scan(f),B.scanUntil(r),O="&"):I=B.scanUntil(r),!B.scan(r))throw new Error("Unclosed tag at "+B.pos);if(_=">"==O?[O,I,R,B.pos,L,T,o]:[O,I,R,B.pos],T++,c.push(_),"#"===O||"^"===O)l.push(_);else if("/"===O){if(!(P=l.pop()))throw new Error('Unopened section "'+I+'" at '+R);if(P[1]!==I)throw new Error('Unclosed section "'+P[1]+'" at '+R)}else"name"===O||"{"===O||"&"===O?w=!0:"="===O&&k(I)}if(E(),P=l.pop())throw new Error('Unclosed section "'+P[1]+'" at '+B.pos);return v(y(c))}function y(e){for(var t,i,n=[],s=0,r=e.length;s<r;++s)(t=e[s])&&("text"===t[0]&&i&&"text"===i[0]?(i[1]+=t[1],i[3]=t[3]):(n.push(t),i=t));return n}function v(e){for(var t,i=[],n=i,s=[],r=0,a=e.length;r<a;++r)switch((t=e[r])[0]){case"#":case"^":n.push(t),s.push(t),n=t[4]=[];break;case"/":s.pop()[5]=t[2],n=s.length>0?s[s.length-1][4]:i;break;default:n.push(t)}return i}function x(e){this.string=e,this.tail=e,this.pos=0}function L(e,t){this.view=e,this.cache={".":this.view},this.parent=t}function T(){this.templateCache={_cache:{},set:function(e,t){this._cache[e]=t},get:function(e){return this._cache[e]},clear:function(){this._cache={}}}}x.prototype.eos=function(){return""===this.tail},x.prototype.scan=function(e){var t=this.tail.match(e);if(!t||0!==t.index)return"";var i=t[0];return this.tail=this.tail.substring(i.length),this.pos+=i.length,i},x.prototype.scanUntil=function(e){var t,i=this.tail.search(e);switch(i){case-1:t=this.tail,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,i),this.tail=this.tail.substring(i)}return this.pos+=t.length,t},L.prototype.push=function(e){return new L(e,this)},L.prototype.lookup=function(e){var t,n=this.cache;if(n.hasOwnProperty(e))t=n[e];else{for(var s,o,l,c=this,h=!1;c;){if(e.indexOf(".")>0)for(s=c.view,o=e.split("."),l=0;null!=s&&l<o.length;)l===o.length-1&&(h=r(s,o[l])||a(s,o[l])),s=s[o[l++]];else s=c.view[e],h=r(c.view,e);if(h){t=s;break}c=c.parent}n[e]=t}return i(t)&&(t=t.call(this.view)),t},T.prototype.clearCache=function(){void 0!==this.templateCache&&this.templateCache.clear()},T.prototype.parse=function(e,t){var i=this.templateCache,n=e+":"+(t||C.tags).join(":"),s=void 0!==i,r=s?i.get(n):void 0;return null==r&&(r=w(e,t),s&&i.set(n,r)),r},T.prototype.render=function(e,t,i,n){var s=this.parse(e,n),r=t instanceof L?t:new L(t,void 0);return this.renderTokens(s,r,i,e,n)},T.prototype.renderTokens=function(e,t,i,n,s){for(var r,a,o,l="",c=0,h=e.length;c<h;++c)o=void 0,"#"===(a=(r=e[c])[0])?o=this.renderSection(r,t,i,n):"^"===a?o=this.renderInverted(r,t,i,n):">"===a?o=this.renderPartial(r,t,i,s):"&"===a?o=this.unescapedValue(r,t):"name"===a?o=this.escapedValue(r,t):"text"===a&&(o=this.rawValue(r)),void 0!==o&&(l+=o);return l},T.prototype.renderSection=function(e,n,s,r){var a=this,o="",l=n.lookup(e[1]);function c(e){return a.render(e,n,s)}if(l){if(t(l))for(var h=0,g=l.length;h<g;++h)o+=this.renderTokens(e[4],n.push(l[h]),s,r);else if("object"==typeof l||"string"==typeof l||"number"==typeof l)o+=this.renderTokens(e[4],n.push(l),s,r);else if(i(l)){if("string"!=typeof r)throw new Error("Cannot use higher-order sections without the original template");null!=(l=l.call(n.view,r.slice(e[3],e[5]),c))&&(o+=l)}else o+=this.renderTokens(e[4],n,s,r);return o}},T.prototype.renderInverted=function(e,i,n,s){var r=i.lookup(e[1]);if(!r||t(r)&&0===r.length)return this.renderTokens(e[4],i,n,s)},T.prototype.indentPartial=function(e,t,i){for(var n=t.replace(/[^ \t]/g,""),s=e.split("\n"),r=0;r<s.length;r++)s[r].length&&(r>0||!i)&&(s[r]=n+s[r]);return s.join("\n")},T.prototype.renderPartial=function(e,t,n,s){if(n){var r=i(n)?n(e[1]):n[e[1]];if(null!=r){var a=e[6],o=e[5],l=e[4],c=r;return 0==o&&l&&(c=this.indentPartial(r,l,a)),this.renderTokens(this.parse(c,s),t,n,c,s)}}},T.prototype.unescapedValue=function(e,t){var i=t.lookup(e[1]);if(null!=i)return i},T.prototype.escapedValue=function(e,t){var i=t.lookup(e[1]);if(null!=i)return C.escape(i)},T.prototype.rawValue=function(e){return e[1]};var C={name:"mustache.js",version:"4.0.1",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(e){E.templateCache=e},get templateCache(){return E.templateCache}},E=new T;return C.clearCache=function(){return E.clearCache()},C.parse=function(e,t){return E.parse(e,t)},C.render=function(e,t,i,s){if("string"!=typeof e)throw new TypeError('Invalid template! Template should be a "string" but "'+n(e)+'" was given as the first argument for mustache#render(template, view, partials)');return E.render(e,t,i,s)},C.escape=u,C.Scanner=x,C.Context=L,C.Writer=T,C}()}));let et={oninit(e){let t=e.attrs;this.url=t.url,this.manager=t.manager,this.setting={id:"children",isLock:!1,useCenter:!1,left:"0%",top:"0%",width:"100%",height:"100%",game:{width:1024,height:1024},reference:{left:0,top:0,width:1,height:1}},Ie(this.setting)},oncreate(e){let i=e.instance.children[0].dom;t.setTimeout((()=>{_e(!0),i.focus()}),.2)},view(){let t=this,n=t.setting;return e(".rwdPanelHeader",{style:{position:"absolute",left:n.left,top:n.top,backgroundColor:"rgba(0,0,0,1)",zIndex:950,opacity:1,width:n.width,height:n.height}},e("iframe",{src:t.url,scrolling:"yes",frameborder:0,style:{position:"absolute",left:"0%",top:"0%",width:"100%",height:"100%"}}),e(".fl.tc.pv4.bg-black.hover-bg-gray",{style:{position:"absolute",left:"5%",top:"0%",width:"90%",height:"10%",opacity:.75,cursor:"pointer"},onclick(){_e(!1),t.manager.childrenVisible=!1,t.url=""}},e(".inline-flex.white.border-box.pointer",`${i("close")}`)))}};class tt{constructor(e){let t=this;t.worker=null,t.videoScreen=null,t.isBusy=!1,t.PIXI=e,t.texture=t.PIXI.EMPTY}async stop(){let e=this;return e.worker?(e.texture&&(e.texture.destroy(!0),e.texture=e.PIXI.EMPTY),new Promise((t=>{e.worker.onmessage=function(e){e.data&&"stop"===e.data.cmd&&t()};e.worker.postMessage({cmd:"stop"})}))):Promise.resolve()}async play(e,t){let i=this;if(!i.isBusy)return i.isBusy=!0,await i.stop(),i.worker&&(i.worker.terminate(),i.worker=void 0),new Promise((n=>{let s=!0;i.videoMessage=e=>{if(e.data){let t=e.data;if(t.byteLength>0){let e=new Uint8Array(t);return i.texture?(i.texture.baseTexture.resource.data=e,i.texture.baseTexture.update()):i.texture=i.PIXI.Texture.fromBuffer(e,i.videoScreen.width,i.videoScreen.height),i.tmpBuffer&&i.worker.postMessage(i.tmpBuffer,[i.tmpBuffer]),i.tmpBuffer=t,void(s&&(i.isBusy=!1,s=!1,n(i.texture)))}if(t.cmd,"resize"===t.cmd)i.videoScreen=t.screen;else if("render"===t.cmd){let r=new Uint8Array(e.data.buffer);i.texture?(i.texture.baseTexture.resource.data=r,i.texture.baseTexture.update()):i.texture=i.PIXI.Texture.fromBuffer(r,i.videoScreen.width,i.videoScreen.height),i.tmpBuffer&&i.worker.postMessage({cmd:t.cmd,buffer:i.tmpBuffer},[i.tmpBuffer]),i.tmpBuffer=t.buffer,s&&(i.isBusy=!1,s=!1,n(i.texture))}}},i.worker=new Worker("/dependence/video/player.1.0.0b.js"),i.worker.onmessage=i.videoMessage;let r={cmd:"player",options:t,url:e};i.worker.postMessage(r)}))}}function it(e){let t,i=e[0],n=1;for(;n<e.length;){const s=e[n],r=e[n+1];if(n+=2,("optionalAccess"===s||"optionalCall"===s)&&null==i)return;"access"===s||"optionalAccess"===s?(t=i,i=r(i)):"call"!==s&&"optionalCall"!==s||(i=r(((...e)=>i.call(t,...e))),t=void 0)}return i}const nt=0,st=6,rt=1,at=3,ot=4,lt=5;let ct={oninit(){this.options={}},oncreate(s){let a=this;a.isIframeLoaded=!1,a.isIframeInit=!1;let l,c=Math.round(performance.now());a.timestamp=c,a.checkItem=null;let h={isFirstTime:!0,useVideo:!1,isCheckData:!1,isChild:!1,isGame:!0,isCreate:!1,isBusy:!0,rendered:null,disable:!0,sysTray:null,trayVisible:!1,childrenVisible:!1,currentUrl:"",useCenter:!0,position:"absolute",left:"25%",top:"25%",width:"50%",height:"50%"},b={state:{visible:!0},sound:{isMute:!1},music:{isMute:!1},screen:{isAutoScale:!0,isLock:!1},isLock:!1,isFullscreen:!1};Object.prototype.hasOwnProperty.call(b,"visible")||Object.defineProperty(b,"visible",{get:()=>b.state.visible,set(t){h.mode!==g.DEMO&&(b.state.visible=t,h.sysTray&&(t?(h.sysTray.isMenu=!1,h.sysTray.visible=!0):(h.sysTray.isMenu=!1,h.sysTray.visible=!1),e.redraw()))}});let w=a.options,y=s.attrs;if(a.currentBaseURL=null,y&&(a.checkItem=y.checkItem,a.currentBaseURL=y.currentBaseURL,h.left=y.left||"25%",h.top=y.top||"25%",h.width=y.width||"50%",h.height=y.height||"50%",h.reference=y.reference,h.fix=y.fix,h.isChild=y.isChild,h.isCheckData=y.isCheckData,y.sysTray?h.sysTray={visible:!0,isMenu:!1,flags:y.sysTray.flags,style:{left:y.sysTray.left||"0px",top:y.sysTray.top||"0px"}}:h.sysTray=null,l=y.config,a.ctrlEvent=y.ctrlEvent),b.visible=!1,!l)return;let v=r();h.isCreate=l.isCreate,h.templateVersion=l.scene.templateVersion,"slot.2.1"===h.templateVersion&&"en-us"===r()&&(v="en"),h.id=l.id,h.mode=l.mode,h.name=l.scene.name[v],h.group=l.scene.group||"game",h.appName=l.scene.app,h.appHash=l.scene.appHash,h.appConfig=l.scene.appConfig,h.devMode=l.scene.devMode,h.dependence=l.scene.dependence,h.background=null,h.backgroundCSS=null,a.appTimeout=o?null:t.setTimeout((()=>{w.initGame=null,a.appTimeout=null,e.redraw(),t.setTimeout((()=>{n.requestReload=!1,n.isReload=!0,Yt({url:a.currentBaseURL,group:h.group,game:h.appConfig})}),.1)}),10);let x=`${h.group}${h.appConfig}`,L={category:"遊戲程式 "+(a.currentBaseURL||"主網址"),getLabel:()=>x},T={category:"遊戲場景 "+(a.currentBaseURL||"主網址"),getLabel:()=>x},C={category:"建立遊戲 "+(a.currentBaseURL||"主網址"),getLabel:()=>x};n.isCheckGameCDN||(u.loadBegin(C),u.loadBegin(L)),h.anim={element:null,isPlay:!1},h.display="inline",h.opacity=0,h.zIndex=1,y.updateStyle&&y.updateStyle(h);let E=l.scene.images;h.game={id:l.id,group:l.scene.group,mode:l.mode,decimal:l.decimal,name:h.name,logo:E&&E.logo,theOther:l.scene.theOther,version:l.scene.version,baseURL:l.scene.baseURL||"",langID:v},E&&Object.prototype.hasOwnProperty.call(E,"useBackground")&&E.background&&(h.isCheckData||(h.background=`${h.game.baseURL}${E.background}`),"string"==typeof E.useBackground?h.backgroundCSS=`${E.useBackground}`:(E.useBackground,h.backgroundCSS=null)),l.scene.theOther&&l.scene.theOther.id&&(h.game.theOther=l.scene.theOther.id),l.scene.screen&&(h.isLock=l.scene.screen.isLock,h.game.width=l.scene.screen.width||640,h.game.height=l.scene.screen.height||960,h.game.portrait=l.scene.screen.portrait,h.game.landscape=l.scene.screen.landscape,we.isMobile,b.isLock=h.isLock),h.images=E,h.isCheckData||Ie(h);let k=null,R=l.loadingEvent,O=ri(),I=null,U=O.scene[h.id]={templateVersion:h.templateVersion,state:nt,event:{create:null,play:null,pause:null,enter:null,leave:null,focus:null,blur:null,lock:null,fullscreen:null,resize:null,music:null,sound:null},info:{isChild:h.isChild,baseURL:h.game.baseURL||"",id:h.game.id,name:h.game.name,group:h.game.group,theOther:h.game.theOther,width:h.game.width,height:h.game.height,decimal:h.game.decimal,mode:h.game.mode,langID:h.game.langID},gamecard:l.scene,loadingEvent:{title:h.name,start(){n.isCheckGameCDN||u.loadBegin(T),R.start&&R.start()},resBegin(e){R.resBegin&&R.resBegin(e)},resEnd(e){R.resEnd&&R.resEnd(e)},sceneResBegin(e){R.sceneResBegin&&R.sceneResBegin(e)},sceneResLoading(e){R.sceneResLoading&&R.sceneResLoading(e)},sceneResEnd(e){R.sceneResEnd&&R.sceneResEnd(e)},finish(){U.state=ot,n.isCheckGameCDN||(u.loadEnd(T),u.log({label:x,category:"遊戲場景 "+(a.currentBaseURL||"主網址")}),u.loadEnd(C)),R.finish&&R.finish(U)}},callWeb(e){"string"==typeof e?O.document&&O.document.location&&O.document.location.replace?O.document.location.replace(e||"about:blank"):O.location.href=e||"about:blank":qt(e)},open(t){h.childrenVisible=!0,h.currentUrl=t,e.redraw()},setDisableResize(e){_e(e)},createTheOther(i,s=0){!function(i,s=0){let r=i,a=s;"number"==typeof i&&(r=s,a=i);let o=r.groupName||Et,l=r.sceneID,c=globalThis.BASE_URL;Ke(l,o,c).then((i=>{let s=xt[a],o=i.gameCard;if(!o)return;function l(e){n.isReload||r.finish&&r.finish(e)}r.reloadConfig&&(o.reloadConfig=r.reloadConfig),s||(s={style:vt,reference:{left:0,top:0,width:1,height:1}});let c={com:Rt,attrs:{loadingEvent:r.loadingEvent,index:a,style:r.style||s.style,reference:r.reference||s.reference,absPos:r.absPos||s.absPos,id:r.id,scene:o,isChild:!0,finish:l}};n.isReload||(null!==kt[a]?(kt[a]=null,e.redraw(),t.setTimeout((()=>{kt[a]=c,e.redraw()}),.1)):(kt[a]=c,e.redraw()))}))}(i,s)},destroyTheOther(t){kt[t]=null,e.redraw(),O.scene[t]=null},callTheOther(e,t){let i,n=!1,s=O.scene[e];return s&&s.state===ot&&(U.game.debug=!1,U.state=ot,U.info.isChild?(U.localEvent.pause(),U.localEvent.hide()):U.localEvent.pause(),i=t||{what:" is this ?"},i.from=U.info.id,n=!0,s.localEvent.pause(),s.state=lt,s.templateVersion,s.setting.background=t&&t.background||"rgba(0,0,0,0)",s.localEvent.show(),s.localEvent.play(i)),n},checkTheOther(e){let t=!1,i=O.scene[e];return i&&i.state===ot&&(t=!0),t},getTheOther:e=>O.scene[e],reload(i){if(n.isReload)return;Xt(),n.isReload=!0;let s=i;s||(s={game:h.appConfig,group:h.group}),U.game.stop(),U.game.reset();let r=()=>{w.initGame=null,U.game=null,a.ctrlEvent&&a.ctrlEvent.reload&&a.ctrlEvent.reload(),e.redraw(),t.setTimeout((()=>{(async function(){return new Promise((e=>{Object.getOwnPropertyNames(globalThis.scene).forEach((e=>{let t=globalThis.scene[e];t&&(delete t.event,delete t.loadingEvent),delete globalThis.scene[e]})),globalThis.scene={},Zt({oncreate(){e()},view:()=>null})}))})().then((()=>{Ke(s.game,s.group,a.currentBaseURL).then((e=>{e&&e.gameCard&&(e.gameCard.reloadConfig=i,Ut({gameCard:e.gameCard,id:s.game,group:s.group}))}))}))}),.01)};_t(),t.setTimeout((()=>{for(let e=0;e<globalThis.frames.length;e+=1){let t=globalThis.frames[e];if(t){let e=t.document;e&&(e.documentElement.innerHTML="")}}r()}),.05)},leave(e){},setMode(t){let n=g;d.mode=t,d.mode===n.REAL?w.info.mode=i("gameModeReal"):w.info.mode=i("gameModeDemo"),e.redraw()},async fullscreen(e){if(e||!he())try{return await ge(b)}catch(e){}},ready(i){if(!U.game&&i&&(U.game=i),a.appTimeout&&(t.remove(a.appTimeout),a.appTimeout=null),n.isCheckGameCDN||(u.loadEnd(L),u.log({label:x,category:"遊戲程式 "+(a.currentBaseURL||"主網址")})),a.checkItem){let t=a.checkItem,i=Math.round(performance.now());t.timeInit=i-a.timestamp,a.timestamp=i,t.state="app",t.timeReady=i-t.timestamp,t.timestamp=i,e.redraw(),t.ready&&t.ready(t)}I(U.game).then((()=>{if(U.game){let e={error(e){u.error({label:x,category:e})},log(e){"string"==typeof e?u.log({label:x,category:e}):e&&(e.label=x,u.log(e))},serviceBegin(e){if(e){if(e.getLabel=()=>x,!e.category)return;u.serviceBegin(e)}},serviceEnd(e){if(e){if(e.getLabel=()=>x,!e.category)return;u.serviceEnd(e)}},loadBegin(e){if(e){if(e.getLabel=()=>x,!e.category)return;u.loadBegin(e)}},loadEnd(e){if(e){if(e.getLabel=()=>x,!e.category)return;u.loadEnd(e)}}};U.game.report=e,U.game.localforage=p}h.isBusy=!1,h.isCreate&&U.event&&U.event.create?(o&&(U.info.console=console),U.info.setting=n,U.event.create(U.info),U.state=rt):U.state=at}))},graphReady(){U.ready()},setOverviewVisible(t){U.gamecard.manual&&U.gamecard.manual.overview&&(Tt.overview.visible=t,e.redraw())},setEvent(e){let t=U.event;t.create=e.create||t.create,t.play=e.play||t.play,t.pause=e.pause||t.pause,t.enter=e.enter||t.enter,t.leave=e.leave||t.leave,t.focus=e.focus||t.focus,t.blur=e.blur||t.blur,t.lock=e.lock||t.lock,t.fullscreen=e.fullscreen||t.fullscreen,t.resize=e.resize||t.resize,t.music=e.music||t.music,t.sound=e.sound||t.sound}};U.state=st,I=async e=>{let t=globalThis.location.origin||"";a.currentBaseURL&&(t=a.currentBaseURL);let i=t;i&&i.length>0&&"/"===i[i.length-1]&&(i=i.substring(0,i.length-1));let s=h.appName;if("object"==typeof s&&(s=h.appName[h.game.langID]),i="debug"===h.devMode?`${i}${s}`:`${i}${n.projectURL}${s}`,a.currentBaseURL&&(i=i.replace(n.projectURL,"/")),"game.5.0"===h.templateVersion){let t=await import(i),s=await t.scene.init({setting:n,baseURL:U.info.baseURL,isChild:U.info.isChild,langID:U.info.langID,gamecard:U.gamecard,game:e,nuts:m});Object.defineProperty(e,"scene",{get:()=>U});let r={create(t){O.lobby&&(e.currentUser=O.lobby.currentUser,e.command=O.lobby.net.gameCommand,e.lobby={setEvent:O.lobby.setEvent,setCommand:O.lobby.net.setLobbyCommand,CMD:O.lobby.net.CMD}),s.create&&(t.game=e,t.setting=n,s.create(t))},play(t){e.play(),s.play&&(t.game=e,t.setting=n,s.play(t))},pause(t){e.pause(),s.pause&&(t.game=e,t.setting=n,s.pause(t))},enter(t){s.enter&&(t.game=e,t.setting=n,s.enter(t))},leave(t){s.leave&&(t.game=e,t.setting=n,s.leave(t))},focus(){s.focus&&s.focus()},blur(){s.blur&&s.blur()},lock(e){s.lock&&s.lock(e)},fullscreen(e){s.fullscreen&&s.fullscreen(e)},resize(e){s.resize&&s.resize(e)},music(e){s.music&&s.music(e)},sound(e){s.sound&&s.sound(e)}};U.setEvent(r),U.game=e}};let _={isActive:!0,create(e){e.isCreate&&it([U,"access",e=>e.event,"optionalAccess",e=>e.create])&&(o&&(U.info.console=console),U.info.setting=n,U.event.create(U.info),U.state=rt)},async enter(e){let t=e||{};t.from||(t.from=U.info.id),t.id||(t.id=h.game.id),t.game||(t.game=U.game),n.isInGame=!0,we.isMobile&&(h.isChild||globalThis.scrollTo(0,we.currentY)),h.isFirstTime&&(h.isFirstTime=!1,u.send()),U.game&&(U.game.command=O.lobby.net.gameCommand,U.game.table=O.lobby.table[t.id],U.game.currentUser=O.lobby.currentUser,U.game.sysTray=b,U.game.getLCS=async function(){h.useVideo=!0;let{LCS:e}=await import("./agent.8a3f3769.js");return e&&e.setReport&&(e.labelName=x,e.setReport(u)),e},U.game.getStream=async function(){h.useVideo=!0;let{LCS:e}=await import("./agent.670accaf.js");return e},U.game.scanLCS=async function(e){let t={name:"串流服務",category:"檢測串流",getLabel:()=>x},i=await import("./agent.25ba47ed.js"),n=await i.scan(e,t);return u.sendVideo(),n},U.game.getProject=async function(e){const t=await import("./agent.9df56024.js");return await t.getProject(e)},U.game.getIP=u.getIP,U.game.Streaming=tt),_.show({finish(){it([U,"access",e=>e.event,"optionalAccess",e=>e.enter])&&(t.setting=n,U.event.enter(t)),_.blur&&_.blur(),Oe(!0);let e=null,i=O.scene[U.info.theOther];if(U.info.isChild||i||!U.info.theOther||(U.info.theOther,U.info.theOther.length>0?e={id:U.info.theOther,group:U.info.group}:"object"==typeof U.info.theOther&&(e={id:U.info.theOther.id,group:U.info.theOther.group})),null!==e){let t={style:{position:"absolute",left:"0%",top:"0%",width:"100%",height:"100%"},reference:{left:0,top:0,width:1,height:1},groupName:e.group,id:e.id,sceneID:e.id,loadingEvent:{start(){},resBegin(){},resEnd(){},sceneResBegin(){},sceneResLoading(){},sceneResEnd(){},finish(e){e.localEvent.pause(),e.localEvent.hide()}}};U.createTheOther(t)}}})},leave(e){let t=e||{};t.from||(t.from=U.info.id),t.game||(t.game=U.game),it([U,"access",e=>e.event,"optionalAccess",e=>e.leave])&&(t.setting=n,U.event.leave(t))},play(e){let t=e||{};t.from||(t.from=U.info.id),t.game||(t.game=U.game),it([U,"access",e=>e.event,"optionalAccess",e=>e.play])&&(t.setting=n,U.event.play(t)),U.state=lt,Oe(!0)},pause(e){let t=e||{};t.from||(t.from=U.info.id),t.game||(t.game=U.game),it([U,"access",e=>e.event,"optionalAccess",e=>e.pause])&&(t.setting=n,U.event.pause(t)),U.state=ot},focus(){_.isActive||(_.isActive=!0,it([U,"access",e=>e.event,"optionalAccess",e=>e.focus])&&U.event.focus())},blur(){_.isActive&&(_.isActive=!1,it([U,"access",e=>e.event,"optionalAccess",e=>e.blur])&&U.event.blur())},updateBlur(e){e&&e!==_&&_.blur();let t=y.objList;t&&Array.isArray(t)&&t.forEach((t=>{if(t){let i=t.attrs.localEvent;e!==i&&i&&i.blur&&i.blur()}}))},lock(e){h.isLock=e,h.left=y.left||"25%",h.top=y.top||"25%",h.width=y.width||"50%",h.height=y.height||"50%";let t=O.scene[U.info.theOther];t&&t.localEvent.lock(e),Oe(!0),it([U,"access",e=>e.event,"optionalAccess",e=>e.lock])&&U.event.lock(e)},fullscreen(e){it([U,"access",e=>e.event,"optionalAccess",e=>e.fullscreen])&&U.event.fullscreen(e)},resize(e){it([U,"access",e=>e.event,"optionalAccess",e=>e.resize])&&U.event.resize(e)},music(e){it([U,"access",e=>e.event,"optionalAccess",e=>e.music])&&U.event.music(e);let t=O.scene[U.info.theOther];t&&t.localEvent.music(e)},sound(e){it([U,"access",e=>e.event,"optionalAccess",e=>e.sound])&&U.event.sound(e);let t=O.scene[U.info.theOther];t&&t.localEvent.sound(e)},show(t){let i=h.anim;if(i.element){if(i.isPlay&&(i.isPlay=!1),h.display="inline",h.disable=!1,h.zIndex=4,h.opacity=1,t){if(t.style){let e=t.style;h.zIndex=e.zIndex||4}t.finish&&t.finish()}y.updateStyle&&y.updateStyle(h),e.redraw()}},hide(t){let i=h.anim;if(i.element){if(i.isPlay&&(i.isPlay=!1),h.disable=!0,h.display="none",h.zIndex=2,h.opacity=0,t){if(t.style){let e=t.style;h.zIndex=e.zIndex||2}t.finish&&t.finish()}y.updateStyle&&y.updateStyle(h),e.redraw()}}};U.localEvent=_,U.setting=h,w.onfocus=onfocus,w.initGame=async function(e){h.anim.element=e.dom},w.event=_,w.setting=h,w.tray=b,w.objList=y.objList,w.updateStyle=y.updateStyle;let P=e(".");var B;"game.5.0"===h.templateVersion?U.gamecard.pixiConfig&&(P=[e(f.game.pixi,{id:h.id,style:{position:"absolute",left:"0px",top:"0px",width:"100%",height:"100%"},config:U.gamecard.pixiConfig,ready:U.ready})]):P=[e("iframe",{style:{position:"absolute",left:"0px",top:"0px",width:"100%",height:"100%"},scrolling:"no",frameborder:0,oncreate:function(i){k=i.dom,k.scrolling="no",k.frameborder=0;let s=k.style;if(s.width="100%",s.height="100%",s.left="0%",s.top="0%",s.position="absolute",h.isChild||(s.zIndex=2,s.display="inline"),a.isIframeInit)return;a.isIframeInit=!0,w.info.iframe=k;let r=h.id,o=h.name,l=h.group,c=h.appName,g=h.appConfig||r,u=h.devMode,d=h.background,p=h.dependence,m=null;if("object"==typeof c&&(c=h.appName[h.game.langID]),"game.4.0"===h.templateVersion){let e=globalThis.location.origin||"";if(a.currentBaseURL&&(e=a.currentBaseURL),m={appName(){let t=e;return t&&t.length>0&&"/"===t[t.length-1]&&(t=t.substring(0,t.length-1)),t="debug"===u?`${t}${c}`:`${t}${n.projectURL}${c}`,a.currentBaseURL&&(t=t.replace(n.projectURL,"/")),t},appIntegrity:"",id:r,name:o,group:l,jsName(){let t,i=e;return i&&i.length>0&&"/"===i[i.length-1]&&(i=i.substring(0,i.length-1)),a.currentBaseURL&&(this.pathname=this.pathname.replace(n.projectURL,"/")),t=`<script src="${i}${this.pathname}"  crossorigin><\/script>`,t},globalName(){let e=`globalThis.parent.${this.libName} && `;return e+=`(globalThis.${this.libName} = globalThis.parent.${this.libName})`,e},background:d},p){let e=[],t=p;Object.getOwnPropertyNames(t).forEach((i=>{let n=t[i],s={};"string"==typeof n?(s.key=i,s.pathname=n):(s.key=i,s.pathname=n.pathname,s.integrity=n.integrity),e.push(s)})),e.length>0&&(e[e.length-1].isLast=!0),m.importmap=e}h.rendered=Ze.render(ti(h.templateVersion),m)}else if("game.3.0"===h.templateVersion){let e=globalThis.location.origin||"";a.currentBaseURL&&(e=a.currentBaseURL);let t=e;if(t&&t.length>0&&"/"===t[t.length-1]&&(t=t.substring(0,t.length-1)),m={appName(){let e=t;return e="debug"===u?`${e}/${c}`:`${e}/${n.projectURL}${c}`,e},appIntegrity:"",id:r,name:o,group:l,jsName(){let e,i=`${t}${this.pathname}`,n="";return this.integrity&&(n=`integrity="${this.integrity}"`),this.isLast,e=`<script src="${i}" ${n} crossorigin><\/script>`,e},background:d},p){let e=[],t=p;Object.getOwnPropertyNames(t).forEach((i=>{let n=t[i],s={};"string"==typeof n?(s.key=i,s.pathname=n):(s.key=i,s.pathname=n.pathname,s.integrity=n.integrity),e.push(s)})),e.length>0&&(e[e.length-1].isLast=!0),m.importmap=e}h.rendered=Ze.render(ti(h.templateVersion),m)}else if("game.2.0"===h.templateVersion){let e=globalThis.location.origin||"";a.currentBaseURL&&(e=a.currentBaseURL);let t=e;t&&t.length>0&&"/"===t[t.length-1]&&(t=t.substring(0,t.length-1)),m={appName:c,id:r,name:o,group:l,importmapName(){let e=t;a.currentBaseURL&&(this.pathname=this.pathname.replace(n.projectURL,"/"));let i,s=`${e}${this.pathname}`;return i=`"${this.key}": "${s}"`,this.isLast||(i+=","),i},systemjsURL(){let e=`${t}/`;return e=a.currentBaseURL?`${e}systemjs/6.8.3/system.min.js`:"/systemjs/6.8.3/system.min.js",e},background:d};let i=[];if(m.importmap=i,p){let e=p;Object.getOwnPropertyNames(e).forEach((t=>{let s=e[t],r={};"string"==typeof s?(r.key=t,r.pathname=s):(r.key=t,a.currentBaseURL?r.pathname=s.pathname.replace(n.projectURL,"/"):r.pathname=s.pathname,r.integrity=s.integrity),i.push(r)}))}if(m.appName=`${l}-${r}`,"debug"===u){i.push({key:`${l}-${r}`,pathname:`${c}`});let t=e;t&&t.length>0&&"/"===t[t.length-1]&&(t=t.substring(0,t.length-1)),m.appName=`${t}${c}`}else{let t=e;a.currentBaseURL?(i.push({key:`${l}-${r}`,pathname:`/${c}`}),m.appName=`${t}${c}`):(i.push({key:`${l}-${r}`,pathname:`${n.projectURL}${c}`}),m.appName=`${t}${n.projectURL}${c}`)}i.length>0&&(i[i.length-1].isLast=!0),h.rendered=Ze.render(ti(h.templateVersion),m)}else if("slot.2.1"===h.templateVersion){let i="";a.currentBaseURL&&(i=a.currentBaseURL);let s=i;s&&s.length>0&&"/"===s[s.length-1]&&(s=s.substring(0,s.length-1));let u="";m={appName(){let e=s;return e=""===s?`${c}`:a.currentBaseURL?`${e}/${c}`:`${e}${n.projectURL}${c}`,e},systemjsURL(){let e=`${s}/`;return e=`${e}systemjs/system.js`,e},appConfig:()=>u,id:r,name:o,group:l,background:d},U.info.langID=v;let p=n.projectURL;a.currentBaseURL&&(p="/");let f=`${s}${p}config/${l}/${g}/browser.config.js`;""===s&&(f=`config/${l}/${g}/browser.config.js`),fetch(f,{headers:{"Content-Type":"text/plain"}}).then((e=>e.ok?e.text():null)).then((i=>{if(!i)return null;if(u=new String(i),""!==s){let e=`${s}/dependence/`;a.currentBaseURL&&(e=`${a.currentBaseURL}dependence/`),u=u.replace("dependence/",e)}h.rendered=Ze.render(ti(h.templateVersion),m),k.src="data/template/4b3df1064ed5591c.html",k.addEventListener("load",(()=>{if(!a.isIframeLoaded&&(a.isIframeLoaded=!0,t.setTimeout((()=>{let e=k.contentDocument||k.contentWindow.document;e.open(),e.write(h.rendered||"!!!! unknown template !!!!"),e.close()}),.05),a.checkItem)){let t=a.checkItem,i=Math.round(performance.now());t.timeOnload=i-a.timestamp,a.timestamp=i,t.state="web",e.redraw()}}),{capture:!0,once:!0})}))}if("slot.2.1"!==h.templateVersion){k.src="data/template/4b3df1064ed5591c.html";const i=()=>{if(!a.isIframeLoaded&&(a.isIframeLoaded=!0,t.setTimeout((()=>{let e=k.contentDocument||k.contentWindow.document;e.open(),e.write(h.rendered||"!!!! unknown template !!!!"),e.close()}),.05),a.checkItem)){let t=a.checkItem,i=Math.round(performance.now());t.timeOnload=i-a.timestamp,a.timestamp=i,t.state="web",e.redraw()}};k.addEventListener("load",i,{capture:!0,once:!0})}}})],w.gamePage=P,w.info={iframe:{},token:d.info.token,gameName:h.game.name,logo:h.game.baseURL+h.game.logo,version:h.game.version||"0.9.9",open(t){h.childrenVisible=!0,h.currentUrl=t,e.redraw()}},B=U.gamecard,qe=B;let $=g;d.mode===$.REAL?w.info.mode=i("gameModeReal"):w.info.mode=i("gameModeDemo"),e.redraw()},view(){let t,i=this.options,s=i.setting,r=i.objList||[];if(i.info&&i.info.iframe&&we.isMobile){i.info.iframe.style||(i.info.iframe.style={});let e=i.info.iframe.style;e.width=s.width,e.height=s.height}if(i.initGame&&(t=!s.isChild&&we.isMobile?(we.useFullscreen,{position:"absolute",left:"0px",top:we.currentY+"px",width:"100%",height:"100%",backgroundColor:"rgba(0,0,0,0)"}):{position:"absolute",left:"0px",top:"0px",width:"100%",height:"100%",backgroundColor:"rgba(0,0,0,0)"},s.isCheckData&&(t={left:"0%",top:"0%",width:"100%",height:"100%",backgroundColor:"rgba(0,0,0,0)"})),i.initGame){let a="";return s.images.useBackground&&(a=s.background),e(".",{style:t},s.isChild?null:e(".center",{style:{overflowY:"hidden",position:"absolute",zIndex:1,top:"0%",left:"0%",width:`${globalThis.innerWidth}px`,height:`${globalThis.innerHeight}px`}},e(".aspect-ratio--object cover",{style:{background:`url(${a}) center`}})),e(".",{oncreate:i.initGame,style:{position:s.position,boxShadow:s.backgroundCSS,left:s.left,top:s.top,width:s.width,height:s.height,zIndex:s.zIndex||2,opacity:s.opacity,display:s.display}},i.gamePage,r.map((t=>t?(t.attrs.fix=s,t.attrs.updateBlur=i.event.updateBlur,e(t.com,t.attrs)):null)),s.sysTray&&s.sysTray.visible?e(pe,{style:s.sysTray.style,config:s.sysTray}):null,s.sysTray&&s.sysTray.isMenu?e(me,{tray:i.tray,event:i.event,info:i.info,config:s.sysTray}):null),s.childrenVisible?e(et,{url:s.currentUrl,manager:s}):null,n.msg.length>0?e(".",{style:{position:"absolute",color:"#fff",left:"50%",top:"0%",width:"64px",height:"16px",zIndex:900}},n.msg):null)}return e(".")}},ht={oninit(e){let t=e.attrs;this.options=t.options,this.saveConfig={}},oncreate(){},view(){let t=this.options,i=t.scene.pixiConfig,n=this.saveConfig;return e("article.pa4.white",e("form",[e("fieldset.ba.b--transparent.ph0.mh0",[e("legend.ph0.mh0.fw6.white","遊戲場景設定"),e(".mt3",e("label.db.fw4.lh-copy.f6","寬"),e("input.pa2.input-reset.ba.bg-transparent.w-40.red",{id:"width",name:"width",oninput(e){let t=e.target.value;n.width=parseInt(t),i.width=t},value:i&&i.width})),e(".mt3",e("label.db.fw4.lh-copy.f6","高"),e("input.b.pa2.input-reset.ba.bg-transparent.w-40.red",{id:"height",name:"height",oninput(e){let t=e.target.value;n.height=parseInt(t),i.height=t},value:i&&i.height})),e(".mt3",e("label.db.fw4.lh-copy.f6","解析度"),e("input.b.pa2.input-reset.ba.bg-transparent.w-40.red",{id:"resolution",name:"resolution",oninput(e){let t=e.target.value;n.resolution=parseFloat(t),i.resolution=t},value:i&&i.resolution})),e(".mt3",e("label.db.fw4.lh-copy.f6","是否反鋸齒"),e("input.b.pa2.input-reset.ba.bg-transparent.w-40.red",{id:"antialias",name:"antialias",oninput(e){let t=e.target.value;n.antialias=!1,"true"===t&&(n.antialias=!0),i.antialias=t},value:i&&i.antialias})),e(".mt3",e("label.db.fw4.lh-copy.f6","是否透明"),e("input.b.pa2.input-reset.ba.bg-transparent.w-40.red",{id:"transparent",name:"transparent",oninput(e){let t=e.target.value;n.transparent=!1,"true"===t&&(n.transparent=!0),i.transparent=t},value:i&&i.transparent})),e(".mt3",e("input.b.ph3.pv2.input-reset.ba.b--black.bg-transparent.grow.pointer.f6 white",{onclick(){Object.getOwnPropertyNames(n).forEach((e=>{i[e]=n[e]})),t&&t.ready&&(t.visible=!1,t.ready())},value:"確定"}))])]))}},gt=null,ut={oninit(i){let n=this,s=i.attrs;n.style=s.style,n.options=s.options,n.resource=s.resource,n.timeout=null,n.isLeave=!1;let o={start(){},resBegin(){},resEnd(){},sceneResBegin(){},sceneResLoading(){n.timeout&&(t.remove(n.timeout),n.timeout=null),n.isLeave||(n.timeout=t.setTimeout((()=>{n.isLeave=!0,n.game&&(n.game.resetUpdate(),n.game.stop(),n.game=null),n.options&&n.options.ready&&n.options.ready();let t=l;a[t.OVERVIEW_ANIMATION]=!1,a[t.OVERVIEW_PROGRESS]=!0,e.redraw(),n.timeout=null}),5))},sceneResEnd(){},finish(){n.timeout&&(t.remove(n.timeout),n.timeout=null)}};!async function(){if(!gt)try{const{getProject:e}=await import("./agent.9df56024.js");gt=await e("scenes/loading")}catch(t){n.options&&n.options.ready&&n.options.ready();let i=l;return a[i.OVERVIEW_ANIMATION]=!1,a[i.OVERVIEW_PROGRESS]=!0,e.redraw(),Promise.reject(t)}let t=await gt.lib.scene.init({langID:r(),baseURL:gt.pathname});n.resource.setting=t,Ie(t),n.pixiConfig=gt.lib.scene.pixiConfig,e.redraw()}(),n.ready=async function(t){t.resource=s.resource,t.play(),n.game=t;try{n.scene=await gt.lib.scene.create(t,o,m)}catch(i){n.resource.setting&&Ue(n.resource.setting),t.resetUpdate(),t.stop(),n.options&&n.options.ready&&n.options.ready();let s=l;return a[s.OVERVIEW_ANIMATION]=!1,a[s.OVERVIEW_PROGRESS]=!0,void e.redraw()}n.options&&n.options.ready&&n.options.ready()}},oncreate(){let e=this;e.resource.setting&&Ie(e.resource.setting)},onremove(){let e=this;e.resource.setting&&Ue(e.resource.setting),e.scene&&e.scene.hide();let t=e.game;t&&(t.resetUpdate(),t.stop())},view(){let t=this;return t.pixiConfig?e(f.game.pixi,{id:"loading9999",config:t.pixiConfig,ready:t.ready}):e(".")}};function dt(e){let t,i=e[0],n=1;for(;n<e.length;){const s=e[n],r=e[n+1];if(n+=2,("optionalAccess"===s||"optionalCall"===s)&&null==i)return;"access"===s||"optionalAccess"===s?(t=i,i=r(i)):"call"!==s&&"optionalCall"!==s||(i=r(((...e)=>i.call(t,...e))),t=void 0)}return i}let pt,mt=l,ft={oninit(r){let l=this,c=r.attrs,h=c.setUpdateEvent;l.scene=c.scene,l.ready=c.ready,l.serve=c.serve,l.finish=c.finish,l.manager=c.manager;let g=a;if(!n.useOptions){let e=l.scene.options;if(e){g[mt.OVERVIEW_LOGO]=!1,//!!overview.logo;
b.isCheckGameCDN?g[mt.OVERVIEW_ANIMATION]=!1:g[mt.OVERVIEW_ANIMATION]=!0,g[mt.OVERVIEW_BACKGROUND]=!0,g[mt.OVERVIEW_PROGRESS]=!1;let t=e.game;t&&(g[mt.GAME_SCENE_CUSTOM]=!!t.custom,g[mt.GAME_PERFORMANCE_FPS]=!!t.fps,g[mt.GAME_DEBUG_MODE]=!!t.debug,g[mt.GAME_DIALOG_CUSTOM]=!!t.useDialog)}}l.elementLogo=null,l.progress=0,l.progressValue=0,l.baseURL=l.scene.baseURL||"",function(t){if(!Pe){if(Pe=!0,we.currentY=0,document){let t=globalThis.scene;document.onfullscreenchange=document.onwebkitfullscreenchange=()=>{we.settingList.forEach((e=>{if(e&&t){let i=t[e.id];if(i){let e=i.game&&i.game.sysTray;he(e);let t=i.localEvent;if(t&&t.fullscreen){let i=e&&e.isFullscreen;t.fullscreen(i)}}}})),e.redraw()},document.onfullscreenerror=document.onwebkitfullscreenerror=()=>{we.settingList.forEach((e=>{if(e&&t){let i=t[e.id];if(i){let e=i.game&&i.game.sysTray;he(e);let t=i.localEvent;if(t&&t.fullscreen){let i=e&&e.isFullscreen;t.fullscreen(i)}}}})),e.redraw()}}if(!n.isCheckGameCDN&&E.any()?(screen&&screen.orientation&&screen.orientation.addEventListener?screen.orientation.addEventListener("change",Ee):globalThis.addEventListener("orientationchange",Ee),we.isMobile=!0,ve=Te,E.iOS()?(globalThis.parent===window&&(we.currentY=200),we.ios=!0,ve=null):E.Android()&&(globalThis.parent===window&&(we.currentY=200),ve=null)):we.isMobile=!1,t&&(we.useOrientation=!1,we.usePortrait=!1,we.useLandscape=!1,we.isMobile&&("string"==typeof t.orientation&&("portrait"===t.orientation?(we.usePortrait=!0,we.orientation.name="portrait"):(we.useLandscape=!0,we.orientation.name="landscape"),we.useOrientation=!0),Le=null,we.useFullscreen=!1,E.iOS()?navigator.userAgent.match(/baidu/i)?(Le=ne,we.screenUnit="px",we.useFullscreen=!1):navigator.userAgent.match(/CriOS/i)?(Le=W,we.screenUnit="px",we.useFullscreen=!1):navigator.userAgent.match(/LieBao|ACHEETAHI/i)?(Le=ae,we.screenUnit="px",we.useFullscreen=!1):navigator.userAgent.match(/FxiOS/i)?(Le=q,we.screenUnit="px",we.useFullscreen=!1):navigator.userAgent.match(/Safari/i)?(Le=ee,we.screenUnit="px",we.useFullscreen=!1):navigator.userAgent.match(/UCB/i)?(Le=J,we.screenUnit="px",we.useFullscreen=!1):Le=ce:E.Android()&&(navigator.userAgent.match(/OPR/i)?(Le=$,we.screenUnit="px",we.useFullscreen=!1,navigator.userAgent.match(/baidu/i)?Le=S:navigator.userAgent.match(/LieBao|ACHEETAHI/i)&&(Le=H,we.screenUnit="px",we.useFullscreen=!1)):navigator.userAgent.match(/baidu/i)?(Le=S,we.screenUnit="px",we.useFullscreen=!1):navigator.userAgent.match(/LieBao|ACHEETAHI/i)?(Le=H,we.screenUnit="px",we.useFullscreen=!1):navigator.userAgent.match(/Firefox/i)?(Le=P,we.screenUnit="px",we.useFullscreen=!1):navigator.userAgent.match(/UCB/i)?(Le=F,we.screenUnit="px",we.useFullscreen=!1):navigator.userAgent.match(/Chrome/i)?(we.useFullscreen=!1,we.screenUnit="px",Le=U):Le=z),navigator.userAgent.match(/(UBiOS|Pad|Tablet|KFAUW|Mb2345|ME173X|NRD90M|VIE|N2G47H)/i)&&(we.useFullscreen=!1,we.screenUnit="px"),Le&&(Le.value.state=we),globalThis.addEventListener("focus",(()=>{we.useFocus&&(we.isTouchOnce=!0,we.useFocus=!1,Oe(!0))}),!0),Ce(),Oe(!0),we.settingList.forEach((e=>{if(e)return e.isLock?void Re(e):(ke(e),!0)})),we.isFullscreen=!0,we.isTouchDown=!1,we.isTouchOnce=!0)),n.mobileMode){let e=n.mobileMode;parseInt(e)>0&&(we.isFullscreen=!0,we.isTouchDown=!1,we.isTouchOnce=!0)}document.body.onscroll=()=>{!we.isMobile||we.orientation.isTrigger||we.isResize||we.disableResize||globalThis.parent===window&&we.isMobile&&(we.currentY=globalThis.pageYOffset,globalThis.scrollTo(0,we.currentY),e.redraw())},globalThis.addEventListener("resize",Oe)}}(l.scene.screen),we.settingList=[],g[mt.OVERVIEW_LOGO]&&(l.setting={id:"logo",isLock:!0,useCenter:!0,left:"25%",top:"25%",width:"50%",height:"50%",game:{width:512,height:512},reference:{left:.25,top:.25,width:.5,height:.5}});l.settingBackground={id:"background",isLock:!1,left:"0%",top:"0%",width:"100%",height:"100%",game:{width:10240,height:10240},reference:{left:0,top:1,width:1,height:1}},l.message="建立預覽",l.display="inline",l.isFinish=!1,l.options={scene:l.scene,visible:!0,ready:l.ready},l.scene.pixiConfig||(a[mt.GAME_SCENE_CUSTOM]=!1);let u=b;l.manager.show=()=>{Tt.overview.visible=!0,e.redraw()},l.manager.hide=()=>{Tt.overview.visible=!1,e.redraw()},l.leave=function(){n.disableNet||(l.isFinish=!0,u.isFinish=!0,l.title=i("connecting"),l.message=i("start"),e.redraw(),n.isReload=!1,s.isLogin?(Pt=!1,Bt()):l.serve&&ni(l.serve).then((()=>{l.title=i("quickPlay"),e.redraw()})))},l.timeout=null,h&&h({start(){l.message="開始讀取遊戲資料",e.redraw(),dt([u,"optionalAccess",e=>e.loadingEvent,"optionalAccess",e=>e.start,"call",e=>e()])},resBegin(e){dt([u,"optionalAccess",e=>e.loadingEvent,"optionalAccess",e=>e.resBegin,"call",t=>t(e)])},resEnd(e){dt([u,"optionalAccess",e=>e.loadingEvent,"optionalAccess",e=>e.resEnd,"call",t=>t(e)])},sceneResBegin(e){dt([u,"optionalAccess",e=>e.loadingEvent,"optionalAccess",e=>e.sceneResBegin,"call",t=>t(e)])},sceneResLoading(i){let s=0;if(Object.prototype.hasOwnProperty.call(i,"totalProgress")){let e=i.state,t=i.totalProgress;if(e){t=(e.currentIndex-1)/e.totals*100+t/e.totals}s=t.toFixed(0),l.progress=s,l.progressValue=.01*t}else{let e=i.current/i.length;s=(100*e).toFixed(0),l.progress=s,l.progressValue=e}l.isFinish||(l.timeout&&(t.remove(l.timeout),l.timeout=null),o||(l.timeout=t.setTimeout((()=>{n.isReload=!0,Yt({url:l.baseURL,group:l.scene.group,game:l.scene.appConfig}),l.timeout=null}),5))),a[mt.OVERVIEW_PROGRESS]&&e.redraw(),dt([u,"optionalAccess",e=>e.loadingEvent,"optionalAccess",e=>e.sceneResLoading,"call",e=>e(s)])},sceneResEnd(e){dt([u,"optionalAccess",e=>e.loadingEvent,"optionalAccess",e=>e.sceneResEnd,"call",t=>t(e)])},async finish(){if(l.timeout&&(t.remove(l.timeout),l.timeout=null),n.requestReload)return;let e=n.store;if(e)try{await e.setItem("baseURL",globalThis.BASE_URL)}catch(e){}a[mt.OVERVIEW_ANIMATION]&&l.animationLeave?l.animationLeave():l.leave(),dt([u,"optionalAccess",e=>e.loadingEvent,"optionalAccess",e=>e.finish,"call",e=>e()])}})},oncreate(){let e=this;e.setting&&Ie(e.setting),e.settingBackground&&Ie(e.settingBackground),Oe(!0),n.requestReload&&(n.requestReload=!1),a[mt.GAME_SCENE_CUSTOM]||a[mt.OVERVIEW_ANIMATION]||e.options.ready&&e.options.ready()},onremove(){self.setting&&Ue(self.setting),self.settingBackground&&Ue(self.settingBackground)},onbeforeremove:e=>(["animate__animated","animate__fadeOut","animate__faster"].forEach((t=>{e.dom.classList.add(t)})),new Promise((function(t){e.dom.addEventListener("animationend",t)}))),view(){let t=this,s=b.setting,r=t.settingBackground,o=t.setting,l=t.options;t.display,s||(s={left:"0%",top:"0%",width:"0%",height:"0%"});let c="";return c=globalThis.innerHeight>globalThis.innerWidth?i(`${n.agent}Portrait`):i(`${n.agent}Landscape`),globalThis.BASE_URL&&(c=globalThis.BASE_URL+"agent/"+c),e(".",{style:{display:t.display,position:"absolute",zIndex:100,left:r.left,top:`${we.currentY+parseInt(r.top)}px`,width:r.width,height:r.height}},e(".",{style:{position:"absolute",left:"0%",top:"0%",width:"100%",height:"100%"}},e(".aspect-ratio--object cover",{style:{zIndex:0,background:`url(${c}) center`}})),a[mt.OVERVIEW_ANIMATION]?e(".",{style:{position:"absolute",left:s.left,top:s.top,width:s.width,height:s.height}},e(ut,{style:{position:"absolute",left:"0%",top:"0%",width:"100%",height:"100%"},options:l,resource:b})):null,!n.isReload&&a[mt.OVERVIEW_LOGO]?e(".",{style:{position:"absolute",left:"25%",top:"25%",width:"50%",height:"50%"}},e("img",{oncreate(e){t.elementLogo=e.dom},src:n.logo,onload(){["animate__animated","animate__fadeIn"].forEach((e=>{t.elementLogo.classList.add(e)}))},style:{opacity:0,zIndex:700,position:"absolute",left:o.left,top:o.top,width:o.width,height:o.height}})):null,a[mt.GAME_SCENE_CUSTOM]&&l.visible?e(".",{style:{position:"absolute",zIndex:300,left:"0%",top:"0%",width:"100%",height:"100%"}},e(".pv2 mb2 white bg-dark-green o-20",{style:{position:"absolute",left:"0%",top:"0%",width:"100%",height:"100%"}}),e(".",{style:{position:"absolute",left:"0%",top:"0%",width:"100%",height:"100%"}},e(ht,{options:l}))):null,a[mt.OVERVIEW_PROGRESS]&&!t.isFinish?e(".",{style:{zIndex:100,position:"absolute",left:"10%",top:"90%",width:"80%",height:"4%"}},e("progress.progress",{style:{position:"absolute",left:"0%",top:"0%",width:"100%",height:"40%"},max:"100",value:`${t.progress}`}),e(".tc",{style:{position:"absolute",left:"0%",top:"30%",width:"100%",height:"60%",color:"#a0cdff"}},e("p.v-btm",`${i("loading")} ${t.progress}%`))):null)}},bt={fatal(e){},high(e){},middle(e){},low(e){}},wt={disableDialog:!1,handle(){let e=l;if(s.state="未連線",n.isInGame&&globalThis.scene){Object.getOwnPropertyNames(globalThis.scene).forEach((e=>{let t=globalThis.scene[e];t&&t.game&&t.game.disconnect&&t.game.disconnect()}))}wt.disableDialog||a[e.GAME_DIALOG_CUSTOM]&&(s.isError||t.setTimeout((()=>{s.isError||Ne({title:"errorLow",msg:"disconnect"})}),2))}},yt={handle(e){let t=ri();s.state="遊戲中",wt.disableDialog=!0,u.serviceEnd(yt.report),u.log({label:"net",category:"進入遊戲"});let i={id:e.gid};He();let n=t.scene[i.id];n&&n.localEvent&&n.localEvent.enter(i)},report:{time:0,category:"進入遊戲",getLabel:()=>"net"},error:bt.low},vt={position:"absolute",left:"0%",top:"0%",width:"100%",height:"100%",backgroundColor:"rgba(0,0,0,0)"},xt=[{style:{zIndex:10,position:"absolute",left:"5%",top:"5%",width:"30%",height:"85%"},reference:{left:.05,top:.05,width:.3,height:.85}},{style:{zIndex:10,position:"absolute",left:"35%",top:"5%",width:"30%",height:"85%"},reference:{left:.35,top:.05,width:.3,height:.85}},{style:{zIndex:10,position:"absolute",left:"65%",top:"5%",width:"30%",height:"85%"},reference:{left:.65,top:.05,width:.3,height:.85}}],Lt={isLock:!1,orientation:"test",width:1024,height:768},Tt={overview:{visible:!0,manager:{}},packet:null,gid:null,manual:{overview:!1}},Ct={visible:!1},Et="",kt=[],Rt={oninit(e){let t=e.attrs,i=this;i.isLoading=!1;let n=t.loadingEvent,s=d,r={id:t.id,decimal:0,mode:s.mode,isCreate:!0,scene:t.scene,loadingEvent:{start(){i.isLoading=!0,n&&n.start&&n.start()},resBegin(e){n&&n.resBegin&&n.resBegin(e)},resEnd(e){n&&n.resEnd&&n.resEnd(e)},sceneResBegin(e){n&&n.sceneResBegin&&n.sceneResBegin(e)},sceneResLoading(e){n&&n.sceneResLoading&&n.sceneResLoading(e)},sceneResEnd(e){n&&n.sceneResEnd&&n.sceneResEnd(e)},finish(e){e&&e.localEvent&&(t.localEvent=e.localEvent),i.isLoading=!1,t.finish&&t.finish(e),n&&n.finish&&n.finish(e)}}};i.config=r,i.style=t.style,i.reference=t.reference,i.fix=t.fix,i.absPos=t.absPos,i.updateBlur=t.updateBlur,i.isChild=t.isChild},view(){let t=this;return e(".",{style:t.style},e(ct,{updateStyle(e){if(e){let i=t.style;i.display=e.display||i.display,Object.prototype.hasOwnProperty.call(e,"opacity")&&(i.opacity=e.opacity),Object.prototype.hasOwnProperty.call(e,"zIndex")&&(i.zIndex=e.zIndex)}},config:t.config,currentBaseURL:globalThis.BASE_URL,left:"0%",top:"0%",width:"100%",height:"100%",reference:t.reference,updateBlur:t.updateBlur,fix:t.fix,isChild:t.isChild,absPos:t.absPos}))}},Ot={oninit(t){let i=t.attrs,n=this,s=i.sceneInfo;n.objList=i.objList,n.serve=i.serve,n.isReady=!1;let r={reload(){n.isReady=!1}},a={};let o=d,l={id:s.id,decimal:0,mode:o.mode,isCreate:!0,scene:s,loadingEvent:{start(){a.start&&a.start()},resBegin(e){a.resBegin&&a.resBegin(e)},resEnd(e){a.resEnd&&a.resEnd(e)},sceneResBegin(e){a.sceneResBegin&&a.sceneResBegin(e)},sceneResLoading(e){a.sceneResLoading&&a.sceneResLoading(e)},sceneResEnd(e){a.sceneResEnd&&a.sceneResEnd(e)},finish(){a.finish&&a.finish()}}};Tt.packet=null,Tt.gid=s.id||n.serve.id,n.setUpdateEvent=function(e){a=e},n.gameConf=l,n.sceneInfo=s,n.ctrlEvent=r,n.event={ready:function(){n.isReady=!0,e.redraw()},finish:function(){let e=si();const t=L.CMD;e&&e.setLobbyCommand(t.IN_GAME,{packet:null,gid:s.id||n.serve.id})}}},view(){let t=this,i=t.objList,n=t.gameConf,s=t.event;return e(".",{style:vt},Ct.visible&&t.isReady?e(ct,{currentBaseURL:globalThis.BASE_URL,sysTray:t.sceneInfo.sysTray,ctrlEvent:t.ctrlEvent,config:t.gameConf,zIndex:4,left:"0%",top:"0%",width:"100%",height:"100%",objList:i}):null,e(".",Tt.overview.visible?e(ft,{manager:Tt.overview.manager,serve:t.serve,scene:n.scene,setUpdateEvent:t.setUpdateEvent,ready(){s.ready()},finish(){s.finish()}}):null))}};function It(t){let i;if(t.gameCard)i=t.gameCard;else{let e;e=Xe(t.group),i=e[t.id]}if(!i)return;i.manual&&(Tt.manual=i.manual),Et=i.group;let s={},r=[],a=i.baseURL||"";if(i.images&&i.images.icon){let e=document.getElementsByTagName("link");if(e){let t=e[0];t&&(t.setAttribute("crossorigin","icon"),t.setAttribute("rel","icon"),t.setAttribute("type","image/png"),t.setAttribute("href",a+i.images.icon))}}let o=i.app;"object"==typeof o&&(o=o[pt]),i.name[pt]?document.title=i.name[pt]+" ["+o+"]":document.title=i.name[y.EN]+" ["+o+"]";let l={};let c=d,h={updateConfig:null,id:i.id||t.id,decimal:0,mode:c.mode,isCreate:!0,scene:i,loadingEvent:{start(){l.start&&l.start()},resBegin(e){l.resBegin&&l.resBegin(e)},resEnd(e){l.resEnd&&l.resEnd(e)},sceneResBegin(e){l.sceneResBegin&&l.sceneResBegin(e)},sceneResLoading(e){l.sceneResLoading&&l.sceneResLoading(e)},sceneResEnd(e){l.sceneResEnd&&l.sceneResEnd(e)},finish(){l.finish&&l.finish()}}};Tt.packet=null,Tt.gid=i.id||t.serve.id,r.push({com:ft,attrs:{manager:Tt.overview.manager,serve:t.serve,scene:h.scene,setUpdateEvent:function(e){l=e},ready(){!function(){r.push({com:ct,attrs:{currentBaseURL:globalThis.BASE_URL,sysTray:i.sysTray,ctrlEvent:s,config:h,zIndex:4,left:"0%",top:"0%",width:"100%",height:"100%"}});let t=null;if(i.theOther&&(i.theOther,i.theOther.length>0?t={id:i.theOther,group:Et,version:n.version}:"object"==typeof i.theOther&&(t={id:i.theOther.id,group:i.theOther.group||Et,version:i.theOther.version||"1.0.0"})),null!==t){let i=globalThis.BASE_URL;Ke(t.id,t.group,i).then((t=>{let i=t.gameCard;if(!i)return;let n=d,a={id:i.id,decimal:0,mode:n.mode,isCreate:!1,scene:i,loadingEvent:{start(){},resBegin(){},resEnd(){},sceneResBegin(){},sceneResLoading(){},sceneResEnd(){},finish(){}}},o=h.scene.screen||Lt;a.scene.screen={isLock:o.isLock,orientation:o.orientation,width:o.width,height:o.height},r.push({com:{oninit(e){this.attrs=e.attrs,this.attrs.currentBaseURL=globalThis.BASE_URL},view(){return e(ct,this.attrs)}},attrs:{ctrlEvent:s,config:a,zIndex:1,left:"0%",top:"0%",width:"100%",height:"100%"}}),e.redraw(),Gt()}))}else Gt();e.redraw()}()},finish(){!function(){let e=t.serve,n=si();const s=L.CMD;n&&n.setLobbyCommand(s.IN_GAME,{packet:null,gid:i.id||e.id})}()}}}),Zt({view:()=>e(".",r.map((t=>e(t.com,t.attrs))))})}function Ut(e){const t=v;switch(pt=n.langID,n.serve=e.serve,Tt.manual={overview:!1},Tt.overview.visible=!0,n.pattern){case t.SINGLE:It(e);break;case t.MULTI:!function(e){let t=null;if(e.gameCard)t=e.gameCard;else{let i;i=Xe(e.group),t=i[e.id]}if(!t)return;t.manual&&(Tt.manual=t.manual),u.report.name=`${t.group}/${t.appConfig}`,Et=t.group;let i=t.baseURL||"";if(t.images&&t.images.icon){let e=document.getElementsByTagName("link");if(e){let n=e[0];n&&(n.setAttribute("crossorigin","icon"),n.setAttribute("rel","icon"),n.setAttribute("type","image/png"),n.setAttribute("href",i+t.images.icon))}}let n=t.app;"object"==typeof n&&(n=n[pt]),t.name[pt]?document.title=t.name[pt]+" ["+n+"]":document.title=t.name[y.EN]+" ["+n+"]",Ct.objList=kt,Ct.sceneInfo=t,Ct.serve=e.serve,Ct.visible=!0,Zt(Ot,Ct)}(e)}}function _t(){kt=[],Ct.visible=!0,e.redraw()}let Pt=!1;function Bt(){let e=si();const i=L.CMD;let r=Tt;if(Pt)return!0;let a=n,o=s;if(t.setTimeout((()=>{"遊戲中"!==o.state&&(globalThis.Howler&&(globalThis.Howler.mute(!0),globalThis.Howler.unload()),Ne({title:"connecting",msg:"disconnect"}))}),.001*x),a.module?import("./agent.f43f4ca4.js").then((e=>{e.ingame({name:d.game,group:d.group,gid:r.gid})})):(e&&e.setLobbyCommand(i.IN_GAME,{packet:r.packet,gid:r.gid}),u.serviceBegin(yt.report)),Pt=!0,!r.manual.overview){let e=r.overview.manager;e.hide&&e.hide()}return!0}let $t={oninit(e){let t=e.attrs;t.yesno||_t(),this.title=t.title,this.msg=t.msg,this.setting={id:"dialog",isLock:!1,useCenter:!1,left:"0%",top:"0%",width:"100%",height:"100%",game:{width:1024,height:1024},reference:{left:0,top:0,width:1,height:1}},Ie(this.setting)},oncreate(){},view(){let t=this,s=t.setting,r=null;return r=we.isMobile?{position:"absolute",left:s.left,top:we.currentY+"px",backgroundColor:"rgba(0,0,0,1)",zIndex:990,opacity:1,width:s.width,height:s.height}:{position:"absolute",left:s.left,top:s.top,backgroundColor:"rgba(0,0,0,1)",zIndex:990,opacity:1,width:s.width,height:s.height},e(".",{style:r},e(".bg-moon-gray ba bw1",{style:{position:"absolute",left:"20%",top:"30%",width:"60%",height:"40%"}},e(".bg-near-black white f4 fw6 pa4",{style:{position:"absolute",left:"0%",top:"0%",width:"100%",height:"20%"}},e(".tc",i(t.title)||"title")),e(".tc pa5",{style:{position:"absolute",left:"0%",top:"20%",width:"100%",height:"50%"}},e.trust(i(t.msg))||"body message"),e(".tc",{style:{position:"absolute",left:"20%",top:"85%",width:"60%",height:"10%"},onclick(){let e=d,t=n,i=(new Date).getTime(),s=(r=globalThis.BASE_URL,a=()=>"http://172.16.65.127:3000/project/",null!=r?r:a());var r,a;globalThis.location.href=`../check/gamecdn/index.html?group=${e.group}&game=${e.game}&lang=${t.langID}&cdn=${s}&v=${i}`}},[e.trust(`<div class="no-underline near-white bg-animate bg-near-black hover-bg-gray inline-flex items-center ma2 tc br2 pa2">\n    <svg fill="#77ff77" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">\n    <path d="M19 8l-4 4h3c0 3.31-2.69 6-6 6-1.01 0-1.97-.25-2.8-.7l-1.46 1.46C8.97 19.54 10.43 20 12 20c4.42 0 8-3.58 8-8h3l-4-4zM6 12c0-3.31 2.69-6 6-6 1.01 0 1.97.25 2.8.7l1.46-1.46C15.03 4.46 13.57 4 12 4c-4.42 0-8 3.58-8 8H1l4 4 4-4H6z"/>\n    <path d="M0 0h24v24H0z" fill="none"/>\n</svg>\n    <span class="f6 ml3 pr2">${i("detect")}</span>\n  </div>`)])))}},At={oninit(){let e=this;e.timeValue=-1,e.touchmoveOnce=!1,e.fields=["一","二","三","四","五","六","七","八","九","十","一","二","三","四","五","六","七","八","九","十"],e.pageY=0,e.imgRotate={id:"rotate",isLock:!0,useCenter:!0,left:"10%",top:"10",width:"80%",height:"80%",game:{width:5120,height:5120},reference:{left:0,top:0,width:1,height:1}},e.imgFullscreen={id:"screen",isLock:!0,useCenter:!0,left:"10%",top:"10",width:"80%",height:"80%",game:{width:5120,height:5120},reference:{left:0,top:0,width:1,height:1}}},view(){let t=this,i=we,n=i.orientation,s=globalThis.innerWidth,r=globalThis.innerHeight;return n.isTrigger&&(s*=2.5,r*=2.5),[i.isTouchOnce&&i.isFullscreen?null:e(".",{style:{zIndex:850,position:"absolute",left:"0%",top:i.currentY+"px",width:(s||i.screenWidth)+"px",height:(r||i.screenHeight)+"px",backgroundColor:"rgba(0,0,0,1)"},ontouchmove(e){we.isMobile&&!we.ios&&e.preventDefault()},ontouchend(){if(globalThis.Howl){let e=new globalThis.Howl({src:["data/f82550ea2e80cd97.wav"]});e&&(e.volume(.001),e.play())}if(i.isFullscreen=!0,i.isTouchDown=!1,i.isTouchOnce=!0,we.ios){let t=globalThis.scene;i.settingList.forEach((e=>{if(t){let i=t[e.id];if(i){(i.game&&i.game.sysTray).isFullscreen=!1}}})),e.redraw(),Oe(),i.mobileReady&&i.mobileReady()}else ge().then((()=>{let t=globalThis.scene;i.settingList.forEach((e=>{if(t){let i=t[e.id];if(i){(i.game&&i.game.sysTray).isFullscreen=!0}}})),e.redraw(),Oe(),i.mobileReady&&i.mobileReady()})).catch((()=>{let t=globalThis.scene;i.settingList.forEach((e=>{if(t){let i=t[e.id];if(i){(i.game&&i.game.sysTray).isFullscreen=!1}}})),e.redraw(),Oe(),i.mobileReady&&i.mobileReady()}))},ontouchstart(e){if(globalThis.Howl){let e=new globalThis.Howl({src:["data/f82550ea2e80cd97.wav"]});e.volume(.001),e.play()}if(i.isTouchDown)return;i.isTouchDown=!0;let n=e.changedTouches||e.originalEvent.touches;if(n){let e=n[0];t.pageY=e.pageY}}},e(".",{oncreate(){Ie(t.imgFullscreen)},onremove(){Ue(t.imgFullscreen)},style:{position:"absolute",left:"10%",top:"10%",width:"80%",height:"80%"}},e("img",{src:"data/img/c7aecda7af142624.png",style:{position:"absolute",zIndex:850,left:t.imgFullscreen.left,top:t.imgFullscreen.top,width:t.imgFullscreen.width,height:t.imgFullscreen.height}}))),!n.isTrigger&&i.useOrientation&&i.usePortrait&&!i.isPortrait?e(".",{oncreate(){Ie(t.imgRotate),Oe(!0)},onremove(){Ue(t.imgRotate)},style:{zIndex:800,position:"absolute",left:"0px",top:globalThis.pageYOffset+"px",width:(globalThis.innerWidth||i.screenWidth)+"px",height:(globalThis.innerHeight||i.screenHeight)+"px",backgroundColor:"rgba(0,0,0,1)"}},e("img",{src:"data/img/f14a0482453bcc34.png",style:{position:"absolute",left:t.imgRotate.left,top:t.imgRotate.top,width:t.imgRotate.width,height:t.imgRotate.height}})):null,!n.isTrigger&&i.useOrientation&&i.useLandscape&&!i.isLandscape?e(".",{oncreate(){Ie(t.imgRotate),Oe(!0)},onremove(){Ue(t.imgRotate)},style:{zIndex:800,position:"absolute",left:"0px",top:globalThis.pageYOffset+"px",width:(globalThis.innerWidth||i.screenWidth)+"px",height:(globalThis.innerHeight||i.screenHeight)+"px",backgroundColor:"rgba(0,0,0,1)"}},e("img",{src:"data/img/b4c0d11274ffa254.gif",style:{position:"absolute",left:t.imgRotate.left,top:t.imgRotate.top,width:t.imgRotate.width,height:t.imgRotate.height}})):null]}},Ft={"game.2.0":'<!DOCTYPE html>\n<html>\n<head>\n  <meta charset="UTF-8" />\n  <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0" />\n  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />\n  <title>game 2.0 {{{name}}}</title>\n\n  <script type="systemjs-importmap" crossorigin="anonymous">\n    {\n      "imports": {\n      {{#importmap}}\n        {{{importmapName}}}\n      {{/importmap}}\n      }\n    }\n  <\/script>\n\n</head>\n<body id="{{{id}}}" style="height:100%;width:100%;overflow-x:hidden;overflow-y:hidden">\n<script crossorigin="anonymous">\n  if(!window.globalThis) {\n    window.globalThis = window;\n  }\n\n  let isInitCache = false;\n  function initCache () {\n    if(isInitCache) {\n      return;\n    }\n    isInitCache = true;\n    let isLoaded = false;\n    let registration = null;\n    function loadScript() {\n      if(isLoaded) {\n        return;\n      }\n      isLoaded = true;\n      let script = document.createElement(\'script\');\n      script.onload = function() {\n        System.import("{{{appName}}}");\n      };\n      script.src = "{{{systemjsURL}}}";\n      document.getElementsByTagName(\'head\')[0].appendChild(script);\n    }\n    loadScript();\n  }\n  initCache();\n\n<\/script>\n</body>\n</html>\n',"game.3.0":'<!DOCTYPE html>\n<html>\n<head>\n  <meta charset="UTF-8" />\n  <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0" />\n  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />\n  <title>game 3.0 {{{name}}}</title>\n\n  {{#importmap}}\n  {{{jsName}}}\n  {{/importmap}}\n\n</head>\n<body id="{{{id}}}" style="height:100%;width:100%;overflow-x:hidden;overflow-y:hidden">\n<script crossorigin="anonymous">\n  if(!window.globalThis) {\n    window.globalThis = window;\n  }\n\n  let isInitCache = false;\n  function initCache () {\n    if(isInitCache) {\n      return;\n    }\n    isInitCache = true;\n    let isLoaded = false;\n    let registration = null;\n    function loadScript() {\n      if(isLoaded) {\n        return;\n      }\n      isLoaded = true;\n      let script = document.createElement(\'script\');\n      script.onload = function() {\n      };\n      script.src = "{{{appName}}}";\n      script.crossorigin = "anonymous";\n      document.getElementsByTagName(\'head\')[0].appendChild(script);\n    }\n    loadScript();\n  }\n\n  initCache();\n<\/script>\n</body>\n</html>\n',"game.4.0":'<!DOCTYPE html>\n<html>\n<head>\n  <meta charset="UTF-8" />\n  <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0" />\n  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />\n  <title>game 4.0 {{{name}}}</title>\n\n\n  {{#importmap}}\n  {{{jsName}}}\n  {{/importmap}}\n  \n  <script crossorigin="anonymous">\n    if(!window.globalThis) {\n      window.globalThis = window;\n    }\n    {{#globalmap}}\n    {{{globalName}}}\n    {{/globalmap}}\n\n  <\/script>\n</head>\n<body id="{{{id}}}" style="height:100%;width:100%;overflow-x:hidden;overflow-y:hidden">\n  <script type="module">\n    import "{{{appName}}}";\n    window.supportsDynamicImport = true;\n  <\/script>\n</body>\n</html>\n',"slot.2.1":'<!DOCTYPE html>\n<html>\n  <head>\n  <meta charset="UTF-8" />\n  <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0" />\n  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />\n  <title>slot.2.1 {{{name}}}</title>\n  </head>\n  <body id="{{{id}}}" style="height:100%;width:100%;overflow-x:hidden;overflow-y:hidden">\n  <script crossorigin="anonymous">\n  if(!window.globalThis) {\n    window.globalThis = window;\n  }\n\n  let isInitCache = false;\n  function initCache () {\n    if(isInitCache) {\n      return;\n    }\n    isInitCache = true;\n    let isLoaded = false;\n    let registration = null;\n    function loadScript() {\n      if(isLoaded) {\n        return;\n      }\n      isLoaded = true;\n      let script = document.createElement(\'script\');\n      script.onload = function() {\n        {{{appConfig}}}\n        ;System.import(\'{{{appName}}}\');\n\n      };\n      script.src = "{{{systemjsURL}}}";\n      script.crossorigin = "anonymous";\n      document.getElementsByTagName(\'head\')[0].appendChild(script);\n    }\n    loadScript();\n  }\n\n  initCache();\n  <\/script>  \n  </body>\n</html>\n'},Mt=!1,St=["一","二","三","四","五","六","七","八","九","十","一","二","三","四","五","六","七","八","九","十"],Nt=!0,Ht=null,Vt=null,zt=null,jt=!1,Dt=null,Wt=null;function Gt(){if(n.useCache){let e=n.registration;if(e&&e.active&&navigator.serviceWorker.controller){let e={reset:"games"};navigator.serviceWorker.controller.postMessage(e)}}}async function Yt(i){if(!n.requestReload){let s={eventName:`CDN ${i.url}`,category:"服務線路錯誤",label:`${i.group}${i.game}`};u.error(s),globalThis.scene={},n.requestReload=!0,n.cdnList=[],n.hasCDN=!1,n.selectCDN=!1,Vt=null,e.redraw();let r=async function(){await C(),0===n.cdnList.length?ii({element:document.body}):e.redraw()};t.setTimeout((()=>{r()}),.1)}}async function qt(t){jt=!0,Dt=t||{},Wt=await import("./agent.1199c549.js"),e.redraw()}function Xt(){jt=!1,e.redraw()}let Kt={ready(t){globalThis.BASE_URL=t,u.report.currentURL=t,n.selectCDN=!0,globalThis.scene={},e.redraw();let i=d;Ke(i.game,i.group,t).then((e=>{e&&e.gameCard&&Ut({gameCard:e.gameCard,serve:i,id:i.game,group:i.group})}))}},Jt={context:null,view:()=>Nt?n.hasCDN&&!n.selectCDN?e(".basic",e(li,Kt)):e(".basic",we.isMobile?e(".",{style:{zIndex:0,position:"absolute",left:"0%",top:"0%",width:"100%",height:"100%"}},we.orientation.isTrigger?null:St.map((()=>e(".ba h-25 black tc",{style:{opacity:0}},"")))):null,Vt?e(Vt,zt):null,we.isMobile?e(At):null,$e()?e($t,{title:Fe(),msg:Se()}):null,jt&&Wt?e(Wt.Component,Dt):null):n.hasCDN&&!n.selectCDN?e(".basic#root",e(li,Kt)):e(".basic#root",[we.isMobile?e(".",{style:{zIndex:0,position:"absolute",left:"0%",top:"0%",width:"100%",height:"100%"}},we.orientation.isTrigger?null:St.map((()=>e(".ba h-25 black tc",{style:{opacity:0}},"")))):null,Vt?e(Vt,zt):null,we.isMobile?e(At):null,$e()?e($t,{title:Fe(),msg:Se()}):null,jt&&Wt?e(Wt.Component,Dt):null])};function Qt(e){Nt=e}function Zt(t,i){Vt=t,zt=i,e.redraw()}let ei={};function ti(e){return ei[e]}async function ii(i){let s=d,r=globalThis;r.addEventListener&&(r.addEventListener("beforeunload",(e=>{})),r.addEventListener("unload",(()=>{}))),r.scene={},r.game={},ei["game.2.0"]=Ft["game.2.0"],ei["game.3.0"]=Ft["game.3.0"],ei["game.4.0"]=Ft["game.4.0"],ei["slot.2.1"]=Ft["slot.2.1"];let a={game:s.game,group:s.group};if(s.group&&s.game||!T){if(Qt(!1),!n.hasCDN){let e=globalThis.BASE_URL;Ke(a.game,a.group,e).then((e=>{e&&e.gameCard&&Ut({gameCard:e.gameCard,serve:a,id:a.game,group:a.group})}))}}else Vt=Qe;let o=g;if(s.mode===o.DEMO){let e=840;t.setTimeout((()=>{globalThis.Howler&&(globalThis.Howler.mute(!0),globalThis.Howler.unload()),Ne({title:"gameModeDemo",msg:"demoTimeout"})}),e)}e.mount(i.element,Jt)}function ni(i){let r=d,a=null;if(Mt){return new Promise((e=>{let t=r.info;Ht&&(Ht.login(t),e(Ht))}))}return Mt=!0,i&&(r.game=i.game||r.game,r.group=i.group||r.group,r.host=i.host||r.host),o&&!r.host&&(a={login:"test/data/login.txt"}),new Promise((i=>{let o=globalThis;o.lobby={currentUser:{},table:{},net:{}},n.module?import("./agent.4597eb46.js").then((e=>{let t=e.create();o.lobby.net.gameCommand=t;let n=()=>{r.host.indexOf("://")<0&&(r.host=`wss://${r.host}`);let e=r.info,t=r.host,n=r.protocol,s=r.gameFormat,a={hostname:t};import("./agent.f43f4ca4.js").then((t=>{t.init({gameFormat:s,protocol:n}).then((()=>{t.connect(a).then((()=>{(async function(e){try{let t=await import("./agent.f43f4ca4.js");return await t.login(e)}catch(e){}})(e).then((()=>{i(null)}))}))}))}))};if(a){let e=new globalThis.Loader;e.add("login",a.login,{crossOrigin:!1}),e.load(((e,t)=>{let i=JSON.parse(t.login.data),s=r.info;i.server&&(s.roomID=s.roomID||i.server.roomID,s.token=s.token||i.server.token,s.tablekey=s.tablekey||i.server.tablekey,r.host||(r.host=i.server.host)),n()}))}else n()})):(Ht=new L({Loader:globalThis.Loader},"/"+r.namespace),Ht.init(a,(n=>{import("./agent.4e754321.js").then((a=>{let o,l=globalThis,c=s;o=a.getCommandList(),Ht.setEventMap(o),Ht.setSendEvent(a.getSendEvent()),c.state="連線中",e.redraw();let h={};h.send=Ht.setGameCommand,h.registerGameEvent=Ht.registerGameEvent,h.unregisterGameEvent=Ht.unregisterGameEvent,l.lobby.net.gameCommand=h,l.lobby.net.setLobbyCommand=Ht.setLobbyCommand,l.lobby.net.CMD=L.CMD,l.lobby.setEvent=a.setEvent,r.host&&Ht.setHost(r.host);let g=r.info;n.login&&n.login.server&&(g.roomID=g.roomID||n.login.server.roomID,g.token=g.token||n.login.server.token,g.tablekey=g.tablekey||n.login.server.tablekey);let u=t.setTimeout((()=>{"連線中"===c.state&&(globalThis.Howler&&(globalThis.Howler.mute(!0),globalThis.Howler.unload()),Ne({title:"connecting",msg:"disconnect"}))}),.001*x);Ht.connect({connect(){u&&(t.remove(u),u=null),i(Ht)},disconnect(){u&&(t.remove(u),u=null)}})}))})))}))}function si(){return Ht}function ri(){return globalThis}var ai=Object.freeze({__proto__:null,resetCache:Gt,reload:Yt,showInfo:qt,hideInfo:Xt,setAccountVisible:Qt,setCurrentContext:Zt,getCurrentContext:function(){return Vt},showGameList:function(){Vt=Qe},getGameTemplate:ti,run:ii,autoLogin:ni,getLobby:si,getManager:ri,setKey:function(e){d.key=e}});async function oi(t,i,s){let a="",o=null,l=null,c=i.target,h=!1,g=r(),u=n.version||"1.0.0";i.group=t.group,i.game=t.game;try{if(a=`${c}${t.group}/${t.game}/config/gamecard.txt?v=${u}`,o=await fetch(a,{headers:{"Content-Type":"text/plain"}}),!s&&!n.isCheckGameCDN)return null;o.ok&&(l=await o.text())}catch(e){}if(!l)try{if(a=`${c}config/${t.group}/${t.game}/gamecard.txt?v=${u}`,o=await fetch(a,{headers:{"Content-Type":"text/plain"}}),!s&&!n.isCheckGameCDN)return null;o.ok&&(l=await o.text(),h=!0)}catch(e){}let d=null;if(l){d=JSON.parse(l);let e=null;h?(d.templateVersion="slot.2.1",e=`${c}${d.images.icon}`):e=`${c}${t.group}/${t.game}/${d.images.icon}`;let r="";"string"==typeof d.name?r+=d.name+" ":r+=d.name[g]+" ";let a=null;if("string"==typeof d.app?(a=`${c}${d.app}`,r+=d.app):(a=`${c}${d.app[g]}`,r+=d.app[g]),i.app=r,i.version=d.version,i.icon=e,i.downloadEnabled=!0,i.appConfig=d.appConfig,i.gamecard=d,i.useTest){if(a){if(o=await fetch(a),!s&&!n.isCheckGameCDN)return null;if(!o.ok)return i.error&&i.error(i),null}if(e){if(o=await fetch(e),!s&&!n.isCheckGameCDN)return null;if(!o.ok)return i.error&&i.error(i),null}i.timeReady=Math.round(performance.now()-i.timestamp),i.ready&&i.ready(i)}}else i.app="",i.version="",i.gamecard=null,i.error&&i.error(i);return e.redraw(),d}let li={oninit(e){let t=this,i=e.attrs,s={category:"測試CDN 主網址",getLabel:()=>"common"};u.loadBegin(s),t.cdnList=n.cdnList,t.server=d,t.ready=i.ready;let r=[];t.gamecdnFields=r,t.isFinish=!1;let a=0,o=t.cdnList.length;function l(e){a+=1,a>=o&&(t.server.cdn.errorCounts+=1,t.server.cdn.errorCounts<3?(n.requestReload=!1,n.isReload=!0,Yt({url:e.target,group:e.group,game:e.appConfig||e.game})):(n.hasCDN=!1,Ne({yesno:!1,title:"service",msg:"errorCDN"})))}function c(e){t.isFinish||(t.isFinish=!0,e.isLight=!0,n.isCheckGameCDN=!1,t.server.cdn.errorCounts=0,u.loadEnd(s),u.log({label:"common",category:"測試CDN 主網址"}),t.ready&&t.ready(e.target))}n.isCheckGameCDN=!0,t.cdnList.forEach(((e,i)=>{let n={};n.index=i,n.isLight=!1,n.id=e.id,n.url=e.url,n.target=e.target,n.timestamp=Math.round(performance.now()),n.timeOnload=0,n.timeInit=0,n.timeScene=0,n.timeReady=9999,n.gamecard=null,n.icon="",n.isIconLoaded=!1,n.downloadEnabled=!1,n.loadingEvent={},n.ready=c,n.error=l,n.useTest=!0,r.push(n),oi(t.server,n)}))},oncreate(){},view:()=>e(".",{left:"0%",right:"0%",width:"100%",height:"100%",position:"absolute",zIndex:0},e(".tmp",e(".cssload-loader",e.trust('<svg class="cssload-logo" height="200" width="200"><text x="49%" y="56%" dominant-baseline="middle" text-anchor="middle" fill="#1375ff">TP</text></svg>'),e(".cssload-inner cssload-one"),e(".cssload-inner cssload-two"),e(".cssload-inner cssload-three"))),e(".",{style:{opacity:0,left:"0%",right:"0%",width:"1px",height:"1px",position:"absolute",zIndex:0}},e("article.dt.w-100.bb.b--black-05.pb2.mt2",e("div.dtc.v-mid.pl3",e("h1.f6.f5-ns.fw6.lh-title.white.mv1.tc","檢測服務線路"),e("h2.f6.fw4.mt1.mb1.green.tc","使用的線路")))))};var ci=Object.freeze({__proto__:null,getGameCard:oi,default:li});export{yt as C,Ie as a,Ne as b,ai as c,Ue as d,Oe as e,Ve as f,He as g,Xt as h,Bt as i,ri as j,bt as k,si as l,wt as m,ci as n,we as s};
