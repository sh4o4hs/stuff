const e={REAL:"real",DEMO:"demo"},t={OVERVIEW_LOGO:0,OVERVIEW_ANIMATION:1,OVERVIEW_BACKGROUND:2,OVERVIEW_PROGRESS:3,GAME_SCENE_CUSTOM:4,GAME_PERFORMANCE_FPS:5,GAME_DIALOG_CUSTOM:6,GAME_DEBUG_MODE:7},n={PROTOCOL:0,GAME_FORMAT:1},r=45e3;let a=!0,o=!0,i={info:{},isKickOut:!1,group:null,game:null,room:null,host:null,key:null,mode:null,namespace:"develop",currency:null,protocol:null,gameFormat:null,cdn:{errorCounts:0},ping:0},s=[];s[t.OVERVIEW_LOGO]=1,s[t.OVERVIEW_ANIMATION]=1,s[t.OVERVIEW_BACKGROUND]=1,s[t.OVERVIEW_PROGRESS]=0,s[t.GAME_SCENE_CUSTOM]=1,s[t.GAME_PERFORMANCE_FPS]=1,s[t.GAME_DEBUG_MODE]=1,s[t.GAME_DIALOG_CUSTOM]=1;let l={isCheckGameCDN:!1,setting:null,isFinish:!1,loadingEvent:null},c={useAvif:!1,res:null,currentURL:"",isReload:!1,hasCDN:!1,selectCDN:!1,cdnList:[],useCache:!1,hasCache:!1,isCheckGameCDN:!1,disableNet:!1,lobbyName:"",mobileMode:"0",projectURL:"/project/",systemjsURL:"",useOptions:!1,msg:"",ping:!1,isInGame:!1,commandTimeout:15,isManual:!1,launch:null,logo:"",agent:"bg",module:null,langID:"en-us",version:"1.0.0"},u={URLs:null,isLogin:!1,state:""};var f,d,h=Object.freeze({__proto__:null,GAME_MODE:e,OPTIONS:t,MODULE:n,TIME_OUT:45e3,get isDeveloper(){return a},displayLobby:true,server:i,options:s,resource:l,setting:c,account:u,useRelease:function(){a=!1}}),m="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function p(){if(d)return f;function e(e,t,n,r,a,o){return{tag:e,key:t,attrs:n,children:r,text:a,dom:o,domSize:void 0,state:void 0,events:void 0,instance:void 0}}return d=1,e.normalize=function(t){return Array.isArray(t)?e("[",void 0,void 0,e.normalizeChildren(t),void 0,void 0):null==t||"boolean"==typeof t?null:"object"==typeof t?t:e("#",void 0,void 0,String(t),void 0,void 0)},e.normalizeChildren=function(t){var n=[];if(t.length){for(var r=null!=t[0]&&null!=t[0].key,a=1;a<t.length;a++)if((null!=t[a]&&null!=t[a].key)!==r)throw new TypeError(!r||null==t[a]&&"boolean"!=typeof t[a]?"In fragments, vnodes must either all have keys or none have keys.":"In fragments, vnodes must either all have keys or none have keys. You may wish to consider using an explicit keyed empty fragment, m.fragment({key: ...}), instead of a hole.");for(a=0;a<t.length;a++)n[a]=e.normalize(t[a])}return n},f=e}var g,v,y=p(),b=function(){var e,t=arguments[this],n=this+1;if(null==t?t={}:("object"!=typeof t||null!=t.tag||Array.isArray(t))&&(t={},n=this),arguments.length===n+1)e=arguments[n],Array.isArray(e)||(e=[e]);else for(e=[];n<arguments.length;)e.push(arguments[n++]);return y("",t.key,t,e)};function x(){return v?g:(v=1,g={}.hasOwnProperty)}var w=p(),E=b,I=x(),S=/(?:(^|#|\.)([^#\.\[\]]+))|(\[(.+?)(?:\s*=\s*("|'|)((?:\\["'\]]|.)*?)\5)?\])/g,T={};function _(e){for(var t in e)if(I.call(e,t))return!1;return!0}function N(e){for(var t,n="div",r=[],a={};t=S.exec(e);){var o=t[1],i=t[2];if(""===o&&""!==i)n=i;else if("#"===o)a.id=i;else if("."===o)r.push(i);else if("["===t[3][0]){var s=t[6];s&&(s=s.replace(/\\(["'])/g,"$1").replace(/\\\\/g,"\\")),"class"===t[4]?r.push(s):a[t[4]]=""===s?s:s||!0}}return r.length>0&&(a.className=r.join(" ")),T[e]={tag:n,attrs:a}}function P(e,t){var n=t.attrs,r=I.call(n,"class"),a=r?n.class:n.className;if(t.tag=e.tag,t.attrs={},!_(e.attrs)&&!_(n)){var o={};for(var i in n)I.call(n,i)&&(o[i]=n[i]);n=o}for(var i in e.attrs)I.call(e.attrs,i)&&"className"!==i&&!I.call(n,i)&&(n[i]=e.attrs[i]);for(var i in null==a&&null==e.attrs.className||(n.className=null!=a?null!=e.attrs.className?String(e.attrs.className)+" "+String(a):a:null!=e.attrs.className?e.attrs.className:null),r&&(n.class=null),n)if(I.call(n,i)&&"key"!==i){t.attrs=n;break}return t}var R=function(e){if(null==e||"string"!=typeof e&&"function"!=typeof e&&"function"!=typeof e.view)throw Error("The selector must be either a string or a component.");var t=E.apply(1,arguments);return"string"==typeof e&&(t.children=w.normalizeChildren(t.children),"["!==e)?P(T[e]||N(e),t):(t.tag=e,t)},C=p(),O=p(),j=b,L=R;L.trust=function(e){return null==e&&(e=""),C("<",void 0,void 0,e,void 0,void 0)},L.fragment=function(){var e=j.apply(0,arguments);return e.tag="[",e.children=O.normalizeChildren(e.children),e};var A,k,M=L,D={exports:{}};function B(){if(k)return A;k=1;var e=function(t){if(!(this instanceof e))throw new Error("Promise must be called with 'new'.");if("function"!=typeof t)throw new TypeError("executor must be a function.");var n=this,r=[],a=[],o=c(r,!0),i=c(a,!1),s=n._instance={resolvers:r,rejectors:a},l="function"==typeof setImmediate?setImmediate:setTimeout;function c(e,t){return function o(c){var f;try{if(!t||null==c||"object"!=typeof c&&"function"!=typeof c||"function"!=typeof(f=c.then))l((function(){!t&&e.length;for(var n=0;n<e.length;n++)e[n](c);r.length=0,a.length=0,s.state=t,s.retry=function(){o(c)}}));else{if(c===n)throw new TypeError("Promise can't be resolved with itself.");u(f.bind(c))}}catch(e){i(e)}}}function u(e){var t=0;function n(e){return function(n){t++>0||e(n)}}var r=n(i);try{e(n(o),r)}catch(e){r(e)}}u(t)};return e.prototype.then=function(t,n){var r,a,o=this._instance;function i(e,t,n,i){t.push((function(t){if("function"!=typeof e)n(t);else try{r(e(t))}catch(e){a&&a(e)}})),"function"==typeof o.retry&&i===o.state&&o.retry()}var s=new e((function(e,t){r=e,a=t}));return i(t,o.resolvers,r,!0),i(n,o.rejectors,a,!1),s},e.prototype.catch=function(e){return this.then(null,e)},e.prototype.finally=function(t){return this.then((function(n){return e.resolve(t()).then((function(){return n}))}),(function(n){return e.resolve(t()).then((function(){return e.reject(n)}))}))},e.resolve=function(t){return t instanceof e?t:new e((function(e){e(t)}))},e.reject=function(t){return new e((function(e,n){n(t)}))},e.all=function(t){return new e((function(e,n){var r=t.length,a=0,o=[];if(0===t.length)e([]);else for(var i=0;i<t.length;i++)!function(i){function s(t){a++,o[i]=t,a===r&&e(o)}null==t[i]||"object"!=typeof t[i]&&"function"!=typeof t[i]||"function"!=typeof t[i].then?s(t[i]):t[i].then(s,n)}(i)}))},e.race=function(t){return new e((function(e,n){for(var r=0;r<t.length;r++)t[r].then(e,n)}))},A=e}var F,G,U,V,z=B();function X(){if(G)return F;G=1;var e=p();return F=function(t){var n,r=t&&t.document,a={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"};function o(e){return e.attrs&&e.attrs.xmlns||a[e.tag]}function i(e,t){if(e.state!==t)throw new Error("'vnode.state' must not be modified.")}function s(e){var t=e.state;try{return this.apply(t,arguments)}finally{i(e,t)}}function l(){try{return r.activeElement}catch(e){return null}}function c(e,t,n,r,a,o,i){for(var s=n;s<r;s++){var l=t[s];null!=l&&u(e,l,a,i,o)}}function u(t,n,a,i,l){var f=n.tag;if("string"==typeof f)switch(n.state={},null!=n.attrs&&B(n.attrs,n,a),f){case"#":!function(e,t,n){t.dom=r.createTextNode(t.children),x(e,t.dom,n)}(t,n,l);break;case"<":d(t,n,i,l);break;case"[":!function(e,t,n,a,o){var i=r.createDocumentFragment();if(null!=t.children){var s=t.children;c(i,s,0,s.length,n,null,a)}t.dom=i.firstChild,t.domSize=i.childNodes.length,x(e,i,o)}(t,n,a,i,l);break;default:!function(e,t,n,a,i){var s=t.tag,l=t.attrs,u=l&&l.is,f=(a=o(t)||a)?u?r.createElementNS(a,s,{is:u}):r.createElementNS(a,s):u?r.createElement(s,{is:u}):r.createElement(s);t.dom=f,null!=l&&function(e,t,n){"input"===e.tag&&null!=t.type&&e.dom.setAttribute("type",t.type);var r=null!=t&&"input"===e.tag&&"file"===t.type;for(var a in t)N(e,a,null,t[a],n,r)}(t,l,a);if(x(e,f,i),!w(t)&&null!=t.children){var d=t.children;c(f,d,0,d.length,n,null,a),"select"===t.tag&&null!=l&&function(e,t){if("value"in t)if(null===t.value)-1!==e.dom.selectedIndex&&(e.dom.value=null);else{var n=""+t.value;e.dom.value===n&&-1!==e.dom.selectedIndex||(e.dom.value=n)}"selectedIndex"in t&&N(e,"selectedIndex",null,t.selectedIndex,void 0)}(t,l)}}(t,n,a,i,l)}else!function(t,n,r,a,o){(function(t,n){var r;if("function"==typeof t.tag.view){if(t.state=Object.create(t.tag),null!=(r=t.state.view).$$reentrantLock$$)return;r.$$reentrantLock$$=!0}else{if(t.state=void 0,null!=(r=t.tag).$$reentrantLock$$)return;r.$$reentrantLock$$=!0,t.state=null!=t.tag.prototype&&"function"==typeof t.tag.prototype.view?new t.tag(t):t.tag(t)}B(t.state,t,n),null!=t.attrs&&B(t.attrs,t,n);if(t.instance=e.normalize(s.call(t.state.view,t)),t.instance===t)throw Error("A view cannot return the vnode it received as argument");r.$$reentrantLock$$=null})(n,r),null!=n.instance?(u(t,n.instance,r,a,o),n.dom=n.instance.dom,n.domSize=null!=n.dom?n.instance.domSize:0):n.domSize=0}(t,n,a,i,l)}var f={caption:"table",thead:"table",tbody:"table",tfoot:"table",tr:"tbody",th:"tr",td:"tr",colgroup:"table",col:"colgroup"};function d(e,t,n,a){var o=t.children.match(/^\s*?<(\w+)/im)||[],i=r.createElement(f[o[1]]||"div");"http://www.w3.org/2000/svg"===n?(i.innerHTML='<svg xmlns="http://www.w3.org/2000/svg">'+t.children+"</svg>",i=i.firstChild):i.innerHTML=t.children,t.dom=i.firstChild,t.domSize=i.childNodes.length,t.instance=[];for(var s,l=r.createDocumentFragment();s=i.firstChild;)t.instance.push(s),l.appendChild(s);x(e,l,a)}function h(e,t,n,r,a,o){if(t!==n&&(null!=t||null!=n))if(null==t||0===t.length)c(e,n,0,n.length,r,a,o);else if(null==n||0===n.length)E(e,t,0,t.length);else{var i=null!=t[0]&&null!=t[0].key,s=null!=n[0]&&null!=n[0].key,l=0,f=0;if(!i)for(;f<t.length&&null==t[f];)f++;if(!s)for(;l<n.length&&null==n[l];)l++;if(i!==s)E(e,t,f,t.length),c(e,n,l,n.length,r,a,o);else if(s){for(var d,h,b,x,w,S=t.length-1,T=n.length-1;S>=f&&T>=l&&(b=t[S],x=n[T],b.key===x.key);)b!==x&&m(e,b,x,r,a,o),null!=x.dom&&(a=x.dom),S--,T--;for(;S>=f&&T>=l&&(d=t[f],h=n[l],d.key===h.key);)f++,l++,d!==h&&m(e,d,h,r,v(t,f,a),o);for(;S>=f&&T>=l&&l!==T&&d.key===x.key&&b.key===h.key;)y(e,b,w=v(t,f,a)),b!==h&&m(e,b,h,r,w,o),++l<=--T&&y(e,d,a),d!==x&&m(e,d,x,r,a,o),null!=x.dom&&(a=x.dom),f++,b=t[--S],x=n[T],d=t[f],h=n[l];for(;S>=f&&T>=l&&b.key===x.key;)b!==x&&m(e,b,x,r,a,o),null!=x.dom&&(a=x.dom),T--,b=t[--S],x=n[T];if(l>T)E(e,t,f,S+1);else if(f>S)c(e,n,l,T+1,r,a,o);else{var _,N,P=a,R=T-l+1,C=new Array(R),O=0,j=0,L=2147483647,A=0;for(j=0;j<R;j++)C[j]=-1;for(j=T;j>=l;j--){null==_&&(_=p(t,f,S+1));var k=_[(x=n[j]).key];null!=k&&(L=k<L?k:-1,C[j-l]=k,b=t[k],t[k]=null,b!==x&&m(e,b,x,r,a,o),null!=x.dom&&(a=x.dom),A++)}if(a=P,A!==S-f+1&&E(e,t,f,S+1),0===A)c(e,n,l,T+1,r,a,o);else if(-1===L)for(N=function(e){var t=[0],n=0,r=0,a=0,o=g.length=e.length;for(a=0;a<o;a++)g[a]=e[a];for(a=0;a<o;++a)if(-1!==e[a]){var i=t[t.length-1];if(e[i]<e[a])g[a]=i,t.push(a);else{for(n=0,r=t.length-1;n<r;){var s=(n>>>1)+(r>>>1)+(n&r&1);e[t[s]]<e[a]?n=s+1:r=s}e[a]<e[t[n]]&&(n>0&&(g[a]=t[n-1]),t[n]=a)}}n=t.length,r=t[n-1];for(;n-- >0;)t[n]=r,r=g[r];return g.length=0,t}(C),O=N.length-1,j=T;j>=l;j--)h=n[j],-1===C[j-l]?u(e,h,r,o,a):N[O]===j-l?O--:y(e,h,a),null!=h.dom&&(a=n[j].dom);else for(j=T;j>=l;j--)h=n[j],-1===C[j-l]&&u(e,h,r,o,a),null!=h.dom&&(a=n[j].dom)}}else{var M=t.length<n.length?t.length:n.length;for(l=l<f?l:f;l<M;l++)(d=t[l])===(h=n[l])||null==d&&null==h||(null==d?u(e,h,r,o,v(t,l+1,a)):null==h?I(e,d):m(e,d,h,r,v(t,l+1,a),o));t.length>M&&E(e,t,l,t.length),n.length>M&&c(e,n,l,n.length,r,a,o)}}}function m(t,n,r,a,i,l){var c=n.tag;if(c===r.tag){if(r.state=n.state,r.events=n.events,function(e,t){do{var n;if(null!=e.attrs&&"function"==typeof e.attrs.onbeforeupdate)if(void 0!==(n=s.call(e.attrs.onbeforeupdate,e,t))&&!n)break;if("string"!=typeof e.tag&&"function"==typeof e.state.onbeforeupdate)if(void 0!==(n=s.call(e.state.onbeforeupdate,e,t))&&!n)break;return!1}while(0);return e.dom=t.dom,e.domSize=t.domSize,e.instance=t.instance,e.attrs=t.attrs,e.children=t.children,e.text=t.text,!0}(r,n))return;if("string"==typeof c)switch(null!=r.attrs&&F(r.attrs,r,a),c){case"#":!function(e,t){e.children.toString()!==t.children.toString()&&(e.dom.nodeValue=t.children);t.dom=e.dom}(n,r);break;case"<":!function(e,t,n,r,a){t.children!==n.children?(S(e,t),d(e,n,r,a)):(n.dom=t.dom,n.domSize=t.domSize,n.instance=t.instance)}(t,n,r,l,i);break;case"[":!function(e,t,n,r,a,o){h(e,t.children,n.children,r,a,o);var i=0,s=n.children;if(n.dom=null,null!=s){for(var l=0;l<s.length;l++){var c=s[l];null!=c&&null!=c.dom&&(null==n.dom&&(n.dom=c.dom),i+=c.domSize||1)}1!==i&&(n.domSize=i)}}(t,n,r,a,i,l);break;default:!function(e,t,n,r){var a=t.dom=e.dom;r=o(t)||r,"textarea"===t.tag&&null==t.attrs&&(t.attrs={});(function(e,t,n,r){if(null!=n){"input"===e.tag&&null!=n.type&&e.dom.setAttribute("type",n.type);var a="input"===e.tag&&"file"===n.type;for(var o in n)N(e,o,t&&t[o],n[o],r,a)}var i;if(null!=t)for(var o in t)null==(i=t[o])||null!=n&&null!=n[o]||P(e,o,i,r)})(t,e.attrs,t.attrs,r),w(t)||h(a,e.children,t.children,n,null,r)}(n,r,a,l)}else!function(t,n,r,a,o,i){if(r.instance=e.normalize(s.call(r.state.view,r)),r.instance===r)throw Error("A view cannot return the vnode it received as argument");F(r.state,r,a),null!=r.attrs&&F(r.attrs,r,a);null!=r.instance?(null==n.instance?u(t,r.instance,a,i,o):m(t,n.instance,r.instance,a,o,i),r.dom=r.instance.dom,r.domSize=r.instance.domSize):null!=n.instance?(I(t,n.instance),r.dom=void 0,r.domSize=0):(r.dom=n.dom,r.domSize=n.domSize)}(t,n,r,a,i,l)}else I(t,n),u(t,r,a,l,i)}function p(e,t,n){for(var r=Object.create(null);t<n;t++){var a=e[t];if(null!=a){var o=a.key;null!=o&&(r[o]=t)}}return r}var g=[];function v(e,t,n){for(;t<e.length;t++)if(null!=e[t]&&null!=e[t].dom)return e[t].dom;return n}function y(e,t,n){var a=r.createDocumentFragment();b(e,a,t),x(e,a,n)}function b(e,t,n){for(;null!=n.dom&&n.dom.parentNode===e;){if("string"!=typeof n.tag){if(null!=(n=n.instance))continue}else if("<"===n.tag)for(var r=0;r<n.instance.length;r++)t.appendChild(n.instance[r]);else if("["!==n.tag)t.appendChild(n.dom);else if(1===n.children.length){if(null!=(n=n.children[0]))continue}else for(r=0;r<n.children.length;r++){var a=n.children[r];null!=a&&b(e,t,a)}break}}function x(e,t,n){null!=n?e.insertBefore(t,n):e.appendChild(t)}function w(e){if(null==e.attrs||null==e.attrs.contenteditable&&null==e.attrs.contentEditable)return!1;var t=e.children;if(null!=t&&1===t.length&&"<"===t[0].tag){var n=t[0].children;e.dom.innerHTML!==n&&(e.dom.innerHTML=n)}else if(null!=t&&0!==t.length)throw new Error("Child node of a contenteditable must be trusted.");return!0}function E(e,t,n,r){for(var a=n;a<r;a++){var o=t[a];null!=o&&I(e,o)}}function I(e,t){var n,r,a,o=0,l=t.state;"string"!=typeof t.tag&&"function"==typeof t.state.onbeforeremove&&(null!=(a=s.call(t.state.onbeforeremove,t))&&"function"==typeof a.then&&(o=1,n=a));t.attrs&&"function"==typeof t.attrs.onbeforeremove&&(null!=(a=s.call(t.attrs.onbeforeremove,t))&&"function"==typeof a.then&&(o|=2,r=a));if(i(t,l),o){if(null!=n){var c=function(){1&o&&((o&=2)||u())};n.then(c,c)}if(null!=r){c=function(){2&o&&((o&=1)||u())};r.then(c,c)}}else _(t),T(e,t);function u(){i(t,l),_(t),T(e,t)}}function S(e,t){for(var n=0;n<t.instance.length;n++)e.removeChild(t.instance[n])}function T(e,t){for(;null!=t.dom&&t.dom.parentNode===e;){if("string"!=typeof t.tag){if(null!=(t=t.instance))continue}else if("<"===t.tag)S(e,t);else{if("["!==t.tag&&(e.removeChild(t.dom),!Array.isArray(t.children)))break;if(1===t.children.length){if(null!=(t=t.children[0]))continue}else for(var n=0;n<t.children.length;n++){var r=t.children[n];null!=r&&T(e,r)}}break}}function _(e){if("string"!=typeof e.tag&&"function"==typeof e.state.onremove&&s.call(e.state.onremove,e),e.attrs&&"function"==typeof e.attrs.onremove&&s.call(e.attrs.onremove,e),"string"!=typeof e.tag)null!=e.instance&&_(e.instance);else{var t=e.children;if(Array.isArray(t))for(var n=0;n<t.length;n++){var r=t[n];null!=r&&_(r)}}}function N(e,t,n,a,o,i){if(!("key"===t||"is"===t||null==a||R(t)||n===a&&!function(e,t){return"value"===t||"checked"===t||"selectedIndex"===t||"selected"===t&&e.dom===l()||"option"===e.tag&&e.dom.parentNode===r.activeElement}(e,t)&&"object"!=typeof a||"type"===t&&"input"===e.tag)){if("o"===t[0]&&"n"===t[1])return D(e,t,a);if("xlink:"===t.slice(0,6))e.dom.setAttributeNS("http://www.w3.org/1999/xlink",t.slice(6),a);else if("style"===t)k(e.dom,n,a);else if(C(e,t,o)){if("value"===t){if(("input"===e.tag||"textarea"===e.tag)&&e.dom.value===""+a&&(i||e.dom===l()))return;if("select"===e.tag&&null!==n&&e.dom.value===""+a)return;if("option"===e.tag&&null!==n&&e.dom.value===""+a)return;if(i&&""+a!="")return}e.dom[t]=a}else"boolean"==typeof a?a?e.dom.setAttribute(t,""):e.dom.removeAttribute(t):e.dom.setAttribute("className"===t?"class":t,a)}}function P(e,t,n,r){if("key"!==t&&"is"!==t&&null!=n&&!R(t))if("o"===t[0]&&"n"===t[1])D(e,t,void 0);else if("style"===t)k(e.dom,n,null);else if(!C(e,t,r)||"className"===t||"title"===t||"value"===t&&("option"===e.tag||"select"===e.tag&&-1===e.dom.selectedIndex&&e.dom===l())||"input"===e.tag&&"type"===t){var a=t.indexOf(":");-1!==a&&(t=t.slice(a+1)),!1!==n&&e.dom.removeAttribute("className"===t?"class":t)}else e.dom[t]=null}function R(e){return"oninit"===e||"oncreate"===e||"onupdate"===e||"onremove"===e||"onbeforeremove"===e||"onbeforeupdate"===e}function C(e,t,n){return void 0===n&&(e.tag.indexOf("-")>-1||null!=e.attrs&&e.attrs.is||"href"!==t&&"list"!==t&&"form"!==t&&"width"!==t&&"height"!==t)&&t in e.dom}var O,j=/[A-Z]/g;function L(e){return"-"+e.toLowerCase()}function A(e){return"-"===e[0]&&"-"===e[1]?e:"cssFloat"===e?"float":e.replace(j,L)}function k(e,t,n){if(t===n);else if(null==n)e.style.cssText="";else if("object"!=typeof n)e.style.cssText=n;else if(null==t||"object"!=typeof t)for(var r in e.style.cssText="",n){null!=(a=n[r])&&e.style.setProperty(A(r),String(a))}else{for(var r in n){var a;null!=(a=n[r])&&(a=String(a))!==String(t[r])&&e.style.setProperty(A(r),a)}for(var r in t)null!=t[r]&&null==n[r]&&e.style.removeProperty(A(r))}}function M(){this._=n}function D(e,t,r){if(null!=e.events){if(e.events._=n,e.events[t]===r)return;null==r||"function"!=typeof r&&"object"!=typeof r?(null!=e.events[t]&&e.dom.removeEventListener(t.slice(2),e.events,!1),e.events[t]=void 0):(null==e.events[t]&&e.dom.addEventListener(t.slice(2),e.events,!1),e.events[t]=r)}else null==r||"function"!=typeof r&&"object"!=typeof r||(e.events=new M,e.dom.addEventListener(t.slice(2),e.events,!1),e.events[t]=r)}function B(e,t,n){"function"==typeof e.oninit&&s.call(e.oninit,t),"function"==typeof e.oncreate&&n.push(s.bind(e.oncreate,t))}function F(e,t,n){"function"==typeof e.onupdate&&n.push(s.bind(e.onupdate,t))}return M.prototype=Object.create(null),M.prototype.handleEvent=function(e){var t,n=this["on"+e.type];"function"==typeof n?t=n.call(e.currentTarget,e):"function"==typeof n.handleEvent&&n.handleEvent(e),this._&&!1!==e.redraw&&(0,this._)(),!1===t&&(e.preventDefault(),e.stopPropagation())},function(t,r,a){if(!t)throw new TypeError("DOM element being rendered to does not exist.");if(null!=O&&t.contains(O))throw new TypeError("Node is currently being rendered to and thus is locked.");var o=n,i=O,s=[],c=l(),u=t.namespaceURI;O=t,n="function"==typeof a?a:void 0;try{null==t.vnodes&&(t.textContent=""),r=e.normalizeChildren(Array.isArray(r)?r:[r]),h(t,t.vnodes,r,s,null,"http://www.w3.org/1999/xhtml"===u?void 0:u),t.vnodes=r,null!=c&&l()!==c&&"function"==typeof c.focus&&c.focus();for(var f=0;f<s.length;f++)s[f]()}finally{n=o,O=i}}},F}function Y(){return V?U:(V=1,U=X()("undefined"!=typeof window?window:null))}"undefined"!=typeof window?(void 0===window.Promise?window.Promise=z:window.Promise.prototype.finally||(window.Promise.prototype.finally=z.prototype.finally),D.exports=window.Promise):void 0!==m?(void 0===m.Promise?m.Promise=z:m.Promise.prototype.finally||(m.Promise.prototype.finally=z.prototype.finally),D.exports=m.Promise):D.exports=z;var H,W,q,$,K,J,Q=p(),Z=function(e,t,n){var r=[],a=!1,o=-1;function i(){for(o=0;o<r.length;o+=2)try{e(r[o],Q(r[o+1]),s)}catch(e){n.error(e)}o=-1}function s(){a||(a=!0,t((function(){a=!1,i()})))}return s.sync=i,{mount:function(t,n){if(null!=n&&null==n.view&&"function"!=typeof n)throw new TypeError("m.mount expects a component, not a vnode.");var a=r.indexOf(t);a>=0&&(r.splice(a,2),a<=o&&(o-=2),e(t,[])),null!=n&&(r.push(t,n),e(t,Q(n),s))},redraw:s}}(Y(),"undefined"!=typeof requestAnimationFrame?requestAnimationFrame:null,"undefined"!=typeof console?console:null);function ee(){return W?H:(W=1,H=function(e){if("[object Object]"!==Object.prototype.toString.call(e))return"";var t=[];for(var n in e)r(n,e[n]);return t.join("&");function r(e,n){if(Array.isArray(n))for(var a=0;a<n.length;a++)r(e+"["+a+"]",n[a]);else if("[object Object]"===Object.prototype.toString.call(n))for(var a in n)r(e+"["+a+"]",n[a]);else t.push(encodeURIComponent(e)+(null!=n&&""!==n?"="+encodeURIComponent(n):""))}})}function te(){if($)return q;$=1;var e=x();return q=Object.assign||function(t,n){for(var r in n)e.call(n,r)&&(t[r]=n[r])}}function ne(){if(J)return K;J=1;var e=ee(),t=te();return K=function(n,r){if(/:([^\/\.-]+)(\.{3})?:/.test(n))throw new SyntaxError("Template parameter names must be separated by either a '/', '-', or '.'.");if(null==r)return n;var a=n.indexOf("?"),o=n.indexOf("#"),i=o<0?n.length:o,s=a<0?i:a,l=n.slice(0,s),c={};t(c,r);var u=l.replace(/:([^\/\.-]+)(\.{3})?/g,(function(e,t,n){return delete c[t],null==r[t]?e:n?r[t]:encodeURIComponent(String(r[t]))})),f=u.indexOf("?"),d=u.indexOf("#"),h=d<0?u.length:d,m=f<0?h:f,p=u.slice(0,m);a>=0&&(p+=n.slice(a,i)),f>=0&&(p+=(a<0?"?":"&")+u.slice(f,h));var g=e(c);return g&&(p+=(a<0&&f<0?"?":"&")+g),o>=0&&(p+=n.slice(o)),d>=0&&(p+=(o<0?"":"&")+u.slice(d)),p},K}var re,ae,oe,ie,se,le,ce,ue,fe,de,he,me,pe=ne(),ge=x(),ve=D.exports,ye=function(e,t,n){var r=0;function a(e){return new t(e)}function o(e){return function(r,o){"string"!=typeof r?(o=r,r=r.url):null==o&&(o={});var i=new t((function(t,n){e(pe(r,o.params),o,(function(e){if("function"==typeof o.type)if(Array.isArray(e))for(var n=0;n<e.length;n++)e[n]=new o.type(e[n]);else e=new o.type(e);t(e)}),n)}));if(!0===o.background)return i;var s=0;function l(){0==--s&&"function"==typeof n&&n()}return function e(t){var n=t.then;return t.constructor=a,t.then=function(){s++;var r=n.apply(t,arguments);return r.then(l,(function(e){if(l(),0===s)throw e})),e(r)},t}(i)}}function i(e,t){for(var n in e.headers)if(ge.call(e.headers,n)&&n.toLowerCase()===t)return!0;return!1}return a.prototype=t.prototype,a.__proto__=t,{request:o((function(t,n,r,a){var o,s=null!=n.method?n.method.toUpperCase():"GET",l=n.body,c=(null==n.serialize||n.serialize===JSON.serialize)&&!(l instanceof e.FormData||l instanceof e.URLSearchParams),u=n.responseType||("function"==typeof n.extract?"":"json"),f=new e.XMLHttpRequest,d=!1,h=!1,m=f,p=f.abort;for(var g in f.abort=function(){d=!0,p.call(this)},f.open(s,t,!1!==n.async,"string"==typeof n.user?n.user:void 0,"string"==typeof n.password?n.password:void 0),c&&null!=l&&!i(n,"content-type")&&f.setRequestHeader("Content-Type","application/json; charset=utf-8"),"function"==typeof n.deserialize||i(n,"accept")||f.setRequestHeader("Accept","application/json, text/*"),n.withCredentials&&(f.withCredentials=n.withCredentials),n.timeout&&(f.timeout=n.timeout),f.responseType=u,n.headers)ge.call(n.headers,g)&&f.setRequestHeader(g,n.headers[g]);f.onreadystatechange=function(e){if(!d&&4===e.target.readyState)try{var o,i=e.target.status>=200&&e.target.status<300||304===e.target.status||/^file:\/\//i.test(t),s=e.target.response;if("json"===u){if(!e.target.responseType&&"function"!=typeof n.extract)try{s=JSON.parse(e.target.responseText)}catch(e){s=null}}else u&&"text"!==u||null==s&&(s=e.target.responseText);if("function"==typeof n.extract?(s=n.extract(e.target,n),i=!0):"function"==typeof n.deserialize&&(s=n.deserialize(s)),i)r(s);else{var l=function(){try{o=e.target.responseText}catch(e){o=s}var t=new Error(o);t.code=e.target.status,t.response=s,a(t)};0===f.status?setTimeout((function(){h||l()})):l()}}catch(e){a(e)}},f.ontimeout=function(e){h=!0;var t=new Error("Request timed out");t.code=e.target.status,a(t)},"function"==typeof n.config&&(f=n.config(f,n,t)||f)!==m&&(o=f.abort,f.abort=function(){d=!0,o.call(this)}),null==l?f.send():"function"==typeof n.serialize?f.send(n.serialize(l)):l instanceof e.FormData||l instanceof e.URLSearchParams?f.send(l):f.send(JSON.stringify(l))})),jsonp:o((function(t,n,a,o){var i=n.callbackName||"_mithril_"+Math.round(1e16*Math.random())+"_"+r++,s=e.document.createElement("script");e[i]=function(t){delete e[i],s.parentNode.removeChild(s),a(t)},s.onerror=function(){delete e[i],s.parentNode.removeChild(s),o(new Error("JSONP request failed"))},s.src=t+(t.indexOf("?")<0?"?":"&")+encodeURIComponent(n.callbackKey||"callback")+"="+encodeURIComponent(i),e.document.documentElement.appendChild(s)}))}}("undefined"!=typeof window?window:null,ve,Z.redraw);function be(){if(ae)return re;function e(e){try{return decodeURIComponent(e)}catch(t){return e}}return ae=1,re=function(t){if(""===t||null==t)return{};"?"===t.charAt(0)&&(t=t.slice(1));for(var n=t.split("&"),r={},a={},o=0;o<n.length;o++){var i=n[o].split("="),s=e(i[0]),l=2===i.length?e(i[1]):"";"true"===l?l=!0:"false"===l&&(l=!1);var c=s.split(/\]\[?|\[/),u=a;s.indexOf("[")>-1&&c.pop();for(var f=0;f<c.length;f++){var d=c[f],h=c[f+1],m=""==h||!isNaN(parseInt(h,10));if(""===d)null==r[s=c.slice(0,f).join()]&&(r[s]=Array.isArray(u)?u.length:0),d=r[s]++;else if("__proto__"===d)break;if(f===c.length-1)u[d]=l;else{var p=Object.getOwnPropertyDescriptor(u,d);null!=p&&(p=p.value),null==p&&(u[d]=p=m?[]:{}),u=p}}}return a}}function xe(){if(ie)return oe;ie=1;var e=be();return oe=function(t){var n=t.indexOf("?"),r=t.indexOf("#"),a=r<0?t.length:r,o=n<0?a:n,i=t.slice(0,o).replace(/\/{2,}/g,"/");return i?("/"!==i[0]&&(i="/"+i),i.length>1&&"/"===i[i.length-1]&&(i=i.slice(0,-1))):i="/",{path:i,params:n<0?{}:e(t.slice(n+1,a))}}}function we(){if(le)return se;le=1;var e=xe();return se=function(t){var n=e(t),r=Object.keys(n.params),a=[],o=new RegExp("^"+n.path.replace(/:([^\/.-]+)(\.{3}|\.(?!\.)|-)?|[\\^$*+.()|\[\]{}]/g,(function(e,t,n){return null==t?"\\"+e:(a.push({k:t,r:"..."===n}),"..."===n?"(.*)":"."===n?"([^/]+)\\.":"([^/]+)"+(n||""))}))+"$");return function(e){for(var t=0;t<r.length;t++)if(n.params[r[t]]!==e.params[r[t]])return!1;if(!a.length)return o.test(e.path);var i=o.exec(e.path);if(null==i)return!1;for(t=0;t<a.length;t++)e.params[a[t].k]=a[t].r?i[t+1]:decodeURIComponent(i[t+1]);return!0}},se}function Ee(){if(ue)return ce;ue=1;var e=x(),t=new RegExp("^(?:key|oninit|oncreate|onbeforeupdate|onupdate|onbeforeremove|onremove)$");return ce=function(n,r){var a={};if(null!=r)for(var o in n)e.call(n,o)&&!t.test(o)&&r.indexOf(o)<0&&(a[o]=n[o]);else for(var o in n)e.call(n,o)&&!t.test(o)&&(a[o]=n[o]);return a}}var Ie=M,Se=ye,Te=Z,_e=function(){return Ie.apply(this,arguments)};_e.m=Ie,_e.trust=Ie.trust,_e.fragment=Ie.fragment,_e.Fragment="[",_e.mount=Te.mount,_e.route=function(){if(me)return he;me=1;var e=Z;return he=function(){if(de)return fe;de=1;var e=p(),t=R,n=D.exports,r=ne(),a=xe(),o=we(),i=te(),s=Ee(),l={};function c(e){try{return decodeURIComponent(e)}catch(t){return e}}return fe=function(u,f){var d,h,m,p,g,v,y=null==u?null:"function"==typeof u.setImmediate?u.setImmediate:u.setTimeout,b=n.resolve(),x=!1,w=!1,E=0,I=l,S={onbeforeupdate:function(){return!(!(E=E?2:1)||l===I)},onremove:function(){u.removeEventListener("popstate",N,!1),u.removeEventListener("hashchange",_,!1)},view:function(){if(E&&l!==I){var t=[e(m,p.key,p)];return I&&(t=I.render(t[0])),t}}},T=R.SKIP={};function _(){x=!1;var e=u.location.hash;"#"!==R.prefix[0]&&(e=u.location.search+e,"?"!==R.prefix[0]&&"/"!==(e=u.location.pathname+e)[0]&&(e="/"+e));var t=e.concat().replace(/(?:%[a-f89][a-f0-9])+/gim,c).slice(R.prefix.length),n=a(t);function r(e){P(h,null,{replace:!0})}i(n.params,u.history.state),function e(a){for(;a<d.length;a++)if(d[a].check(n)){var o=d[a].component,i=d[a].route,s=o,l=v=function(r){if(l===v){if(r===T)return e(a+1);m=null==r||"function"!=typeof r.view&&"function"!=typeof r?"div":r,p=n.params,g=t,v=null,I=o.render?o:null,2===E?f.redraw():(E=2,f.redraw.sync())}};return void(o.view||"function"==typeof o?(o={},l(s)):o.onmatch?b.then((function(){return o.onmatch(n.params,t,i)})).then(l,t===h?null:r):l("div"))}if(t===h)throw new Error("Could not resolve default route "+h+".");P(h,null,{replace:!0})}(0)}function N(){x||(x=!0,y(_))}function P(e,t,n){if(e=r(e,t),w){N();var a=n?n.state:null,o=n?n.title:null;n&&n.replace?u.history.replaceState(a,o,R.prefix+e):u.history.pushState(a,o,R.prefix+e)}else u.location.href=R.prefix+e}function R(e,t,n){if(!e)throw new TypeError("DOM element being rendered to does not exist.");if(d=Object.keys(n).map((function(e){if("/"!==e[0])throw new SyntaxError("Routes must start with a '/'.");if(/:([^\/\.-]+)(\.{3})?:/.test(e))throw new SyntaxError("Route parameter names must be separated with either '/', '.', or '-'.");return{route:e,component:n[e],check:o(e)}})),h=t,null!=t){var r=a(t);if(!d.some((function(e){return e.check(r)})))throw new ReferenceError("Default route doesn't match any known routes.")}"function"==typeof u.history.pushState?u.addEventListener("popstate",N,!1):"#"===R.prefix[0]&&u.addEventListener("hashchange",_,!1),w=!0,f.mount(e,S),_()}return R.set=function(e,t,n){null!=v&&((n=n||{}).replace=!0),v=null,P(e,t,n)},R.get=function(){return g},R.prefix="#!",R.Link={view:function(e){var n,a,o,i=t(e.attrs.selector||"a",s(e.attrs,["options","params","selector","onclick"]),e.children);return(i.attrs.disabled=Boolean(i.attrs.disabled))?(i.attrs.href=null,i.attrs["aria-disabled"]="true"):(n=e.attrs.options,a=e.attrs.onclick,o=r(i.attrs.href,e.attrs.params),i.attrs.href=R.prefix+o,i.attrs.onclick=function(e){var t;"function"==typeof a?t=a.call(e.currentTarget,e):null==a||"object"!=typeof a||"function"==typeof a.handleEvent&&a.handleEvent(e),!1===t||e.defaultPrevented||0!==e.button&&0!==e.which&&1!==e.which||e.currentTarget.target&&"_self"!==e.currentTarget.target||e.ctrlKey||e.metaKey||e.shiftKey||e.altKey||(e.preventDefault(),e.redraw=!1,R.set(o,null,n))}),i}},R.param=function(e){return p&&null!=e?p[e]:p},R},fe}()("undefined"!=typeof window?window:null,e),he}(),_e.render=Y(),_e.redraw=Te.redraw,_e.request=Se.request,_e.jsonp=Se.jsonp,_e.parseQueryString=be(),_e.buildQueryString=ee(),_e.parsePathname=xe(),_e.buildPathname=ne(),_e.vnode=p(),_e.PromisePolyfill=B(),_e.censor=Ee();var Ne=_e;let Pe=null;function Re(e){Pe=e.io}class Ce{constructor(e,t=""){let n={event:e&&e.event,socket:null,cmdList:e&&e.commandList,isConnect:!1,host:e&&e.host,roomName:t};this.isConnect=()=>n.isConnect,this.setHost=e=>n.host=e,this.setCommandList=e=>n.cmdList=e,this.registerCommand=(e,t)=>{let r=n.socket;r&&r.on(e,t)},this.sendCommand=(e,t)=>{let r=n.socket;r&&r.compress(!0).emit(e,t)},this.setEvent=e=>{n.event=e},this.connect=e=>{let t,r=n.cmdList;if(n.socket)return!1;t=Pe(n.host+n.roomName,{transports:["websocket"]});let a={};if(e?(n.event=e,a.connect=e.connect,a.disconnect=e.disconnect):n.event&&(a.connect=n.event.connect,a.disconnect=n.event.disconnect),n.socket=t,t.on("connect",(()=>{n.isConnect=!0,a.connect&&(a.connect(),a.connect=null)})),t.on("disconnect",(()=>{n.isConnect=!1,a.disconnect&&(a.disconnect(),a.disconnect=null)})),r){Object.getOwnPropertyNames(r).forEach((e=>{t.on(e,r[e])}))}return!0},this.disconnect=()=>{let e=n.socket;e&&e.disconnect()}}}var Oe=Object.freeze({__proto__:null,init:Re,Network:Ce});let je,Le,Ae;class ke{static init(e){je=e.CMD,Le=e.RESULT,Ae=e.STATE}static create(e){let t,n=e.lobbyBuffer,r=e.gameBuffer,a=null,o={cmdList:null,gameProc:null,setEventMap(e){a=e}};t=(e=>{let t={},i=e.gameEvent;return t.checkData=(e,t,n,r)=>{let a=Ae.OK;return t.resultCode!==Le.OK?(a=Ae.ERROR,r&&r.error&&r.error(t)):r&&r.handle&&r.handle(t),a},t.gameProc=e=>{let t=i[e.gid];t&&t.recvGameData&&t.recvGameData(e.packet)},t.broadcastProc=e=>{Object.getOwnPropertyNames(i).forEach((t=>{let n=i[t];n&&n.recvBroadcast&&n.recvBroadcast(e)}))},o.gameProc=t.gameProc,{connect(e){let t=a&&a.connect;t&&t.handle&&t.handle(e)},reconnect(e){let t=a&&a.reconnect;t&&t.handle&&t.handle(e)},login(r){let o=a&&a.login;t.checkData(je.LOGIN,r,n,o)&&(e.connectionToken=r.connectionToken)},relogin(r){let o=a&&a.relogin;t.checkData(je.RELOGIN,r,n,o)&&(e.connectionToken=r.connectionToken)},inGame(e){let r=a&&a.inGame;t.checkData(je.IN_GAME,e,n,r)},exitGame(e){let r=a&&a.exitGame;t.checkData(je.EXIT_GAME,e,n,r)},toGame(e){let n=a&&a.toGame;t.checkData(je.TO_GAME,e,r,n),t.gameProc(e)},broadCastMsg(e){let n=a&&a.broadcast;n&&n.handle&&n.handle(e),t.broadcastProc(e)},ping(e){let t=a&&a.ping;t&&t.handle&&t.handle(e)},pong(e){let t=a&&a.pong;t&&t.handle&&t.handle(e)},disconnectMsg(e){let t=a&&a.disconnectMsg;t&&t.handle&&t.handle(e)},disconnect(e){let t=a&&a.disconnect;t&&t.handle&&t.handle(e)}}})(e),o.cmdList=t,e.commandManager=o}}let Me=null,De=[],Be=[],Fe=!1;function Ge(e){let t=!1;return e&&e.update&&(Object.prototype.hasOwnProperty.call(e,"__updateIndex")||(e.__updateIndex=De.length,De.push(e),t=!0)),t}function Ue(e){let t,n,r=De.length;if("number"==typeof e.__updateIndex){if(t=e.__updateIndex,t>=0&&t<r){let e=r-1;n=De[e],De[t]=n,n.__updateIndex=t,De.splice(e,1)}delete e.__updateIndex}}function Ve(e,t){let n={currentTime:0,func:e,update:e=>{n.currentTime>=t&&(Ue(n),n.func&&n.func(n.currentTime)),n.currentTime+=e}};return Ge(n),n}function ze(e,t){let n={currentTime:0,func:e,update:e=>{n.currentTime+=e,n.currentTime>=t&&(n.func&&n.func(n.currentTime),n.currentTime=0)}};return Ge(n),n}function Xe(e){e&&e.update&&(Be.push(e),Fe=!0)}function Ye(){De.forEach((e=>{delete e.__updateIndex})),De=[]}let He=-1;function We(e){let t,n=.001*performance.now();e.paused||(He<0?(t=0,He=n):(t=n-He,He=n),function(e){Fe&&(Be.forEach((t=>{t.update(e),t.pause&&t.pause()})),Be=[],Fe=!1),De.forEach((t=>{t.update(e)}))}(t))}let qe=!1,$e=!1;function Ke(){$e||($e=!0,Me=globalThis.createjs.Ticker,Me.timingMode=Me.TIMEOUT,Me.interval=1e3/60,Me.addEventListener("tick",We),Ye())}function Je(){qe||(qe=!0,He=-1,Me.paused=!1)}var Qe=Object.freeze({__proto__:null,add:Ge,remove:Ue,setTimeout:Ve,idle:function(e){return new Promise((t=>{Ve((function(){t()}),e)}))},setInterval:ze,clearInterval:function(e){Ue(e)},once:Xe,reset:Ye,init:Ke,play:Je,pause:function(){qe&&(qe=!1,Me.paused=!0)}});const Ze={ERROR:"error",CONNECT:"connect",RECONNECT:"reconnect",LOGIN:"login",RELOGIN:"relogin",IN_GAME:"inGame",EXIT_GAME:"exitGame",TO_GAME:"toGame",BROADCAST:"broadCastMsg",DISCONNECT_MSG:"disconnectMsg",DISCONNECT:"disconnect"},et={ERROR:0,OK:1},tt={SEND_LOCK:-3,CONNECT_TIMEOUT:-2,BUFFER_FULL:-1,ERROR:0,OK:1,LOGIN:3,ROOM:4,CONNECT:2};class nt extends Ce{constructor(e,t){let n={gameEvent:{},sendEvent:{},commandManager:null,connectionToken:null,timer:null,login:null,game:{configMap:{},template:null},lobbyBuffer:{sendCommandList:[],token:null},gameBuffer:{sendCommandList:[],token:null}};super(e,t);let r=this;ke.init({CMD:Ze,RESULT:et,STATE:tt}),n.timer||(n.timer=ze((function(){let e,t=n.lobbyBuffer,a=n.gameBuffer,o=t.sendCommandList;o.length>0&&(e=o.shift(),r.sendLobbyCommand(e)),o=a.sendCommandList,o.length>0&&(e=o.shift(),r.sendGameCommand(e))}),.1)),this.init=()=>{ke.create(n),r.setCommandList(n.commandManager.cmdList)},this.getGame=()=>n.game,this.getCommandManager=()=>n.commandManager,this.gameProc=e=>{n.commandManager&&n.commandManager.gameProc(e)},this.setEventMap=e=>{n.commandManager&&n.commandManager.setEventMap(e)},this.setSendEvent=e=>{n.sendEvent.game=e.game},this.login=e=>{let t=e;r.sendCommand("login",t)},this.relogin=()=>{let e={connectionToken:n.connectionToken};r.sendCommand("relogin",e)},this.registerGameEvent=(e,t)=>{t&&(n.gameEvent[t]=e)},this.unregisterGameEvent=e=>{n.gameEvent[e]=null},this.setLobbyCommand=(e,t)=>(n.lobbyBuffer.sendCommandList.push({name:e,data:t}),tt.OK),this.sendLobbyCommand=e=>{r.sendCommand(e.name,e.data)},this.setGameCommand=(e,t)=>(n.gameBuffer.sendCommandList.push({gid:t,packet:e}),tt.OK),this.sendGameCommand=e=>{let t=e.packet;"object"==typeof t.data&&(t.data=JSON.stringify(t.data));let a={gid:e.gid,packet:e.packet};r.sendCommand("toGame",a),n.sendEvent.game&&n.sendEvent.game(e.gid)}}static get STATE(){return tt}static get CMD(){return Ze}static get RESULT(){return et}}function rt(e,t){let n=e;if(n){let r=t&&t.split(".");r&&r.every((e=>{let t=n[e];return t?(n=t,!0):(n=null,!1)})),n===e&&(n=null)}return n}function at(e){return class extends e{constructor(e){super(e,!1),this.cloneIndex=0}clone(){this.cloneIndex+=1}addToScene(e){e.addChild(this)}removeFromScene(){this.parent&&this.parent.removeChild(this)}reload(){let e=this,t=e._game.textures,n=e.conf.resource,r=rt(t,n.group);r&&(e.texture=r[n.name]||PIXI.Texture.EMPTY)}}}var ot=Object.freeze({__proto__:null,debug:function(e,t){let n=e.getBounds(),r=e.graphics;if(!r){let a=e.anchor;r=new t.Graphics,e.graphics=r,e.addChild(r),r.x=0,r.y=0,r.lineStyle(1,16777215,1),r.beginFill(65280,.15),r.drawRect(-n.width*a.x,-n.height*a.y,n.width,n.height),r.endFill()}},getTextureGroup:rt,make:at,default:class{constructor(){this.cloneIndex=0}clone(){this.cloneIndex+=1}addToScene(e){e.addChild(this)}removeFromScene(){let e=this;e.parent&&e.parent.removeChild(e)}}});let it=null;let st=null;let lt=null;let ct=null;let ut=null;let ft=null,dt=null;const ht={CHAR_MAP:["0","1","2","3","4","5","6","7","8","9","."],DISPLAY:{TRANSVERSE:1,STRAIGHT:2},ALIGN_TYPE:{POS:1,RECT:2},OFFSET_TYPE:{STATIC:1,DYNAMIC:2},HORI_ALIGN:{LEFT:1,CENTER:2,RIGHT:3},VERTI_ALIGN:{TOP:1,CENTER:2,BOTTOM:3}};let mt=null;let pt=null;let gt=null;let vt={demo:{alpha:{start:1,end:0},scale:{start:.1,end:1.5},color:{start:"ffffff",end:"ffffff"},speed:{start:600,end:200},startRotation:{min:0,max:360},rotationSpeed:{min:0,max:20},lifetime:{min:.5,max:.7},blendMode:"normal",frequency:16e-6,emitterLifetime:-1,maxParticles:100,pos:{x:0,y:0},addAtBack:!1,spawnType:"point"}},yt=null;function bt(e){let t,n,r,a,o=e.lastIndexOf("/");return o>0&&(o+=1,t=e.slice(0,o),n=e.slice(o)),o=n.lastIndexOf("."),o>0&&(a=n.slice(0,o),o+=1,r=n.slice(o)),{dir:t,base:n,name:a,ext:r}}var xt=Object.freeze({__proto__:null,filenameInfo:bt,handleData:function(e,t,n){let r=null;r=n||(e=>e);let a,o=(e,t,n)=>{e.forEach((e=>{t.push(n(e))}))},i=(e,t,n)=>{let r;Object.getOwnPropertyNames(e).forEach((a=>{let s=e[a];"string"==typeof s?t[a]=n(s):Array.isArray(s)?(r=[],o(s,r,n),t[a]=r):"object"==typeof s&&(r={},i(s,r,n),t[a]=r)}))};a=Object.getOwnPropertyNames(e),a.forEach((n=>{let a,s=t[n];a=e[n],Array.isArray(a)?s?o(a,s,r):(s=[],o(a,s,r),t[n]=s):"object"==typeof a?s?i(a,s,r):(s={},i(a,s,r),t[n]=s):"string"==typeof a&&(t[n]=r(a))}))}});let wt=null,Et=null,It=null;const St={INFO:"info",GROUP:"group",SCROLLBAR:"scrollbar",BACKGROUND:"background",PARTICLE:"particle",TEXT:"text",IMAGE:"image",SPINE:"spine",BONE:"bone",ANMIMATION:"animation",NUMBER:"number",BUTTON:"button"};let Tt={event:{resBegin:null,resEnd:null,sceneResBegin:null,SceneResLoading:null,SceneResEnd:null},state:null,game:null,baseURL:"",base:0,baseProgress:0,baseIndex:0,baseMax:0,objectFactory:{},isBusy:!1,textures:null,spines:null,sounds:null,bonesFactory:null,soundMapList:[]},_t=rt,Nt=e=>{let t={};return t.conf=e,t.name=e.name,t.objName=e.objName,t};function Pt(e,t,n="#000000"){return PIXI.Texture.Draw((e=>{t?(e.width=t.width||140,e.height=t.height||40):(e.width=100,e.height=24);let r=e.getContext("2d");r.strokeStyle=n,r.strokeRect(0,0,e.width,e.height),r.fillStyle="#FFFFFF",r.fillRect(0,0,2,2),r.fillRect(e.width-2,0,2,2),r.fillRect(0,e.height-2,2,2),r.fillRect(e.width-2,e.height-2,2,2),r.beginPath(),r.lineCap="round",r.moveTo(0,0),r.lineTo(e.width,e.height),r.moveTo(e.width,0),r.lineTo(0,e.height),r.stroke(),r.fillStyle="#FFFFFF";let a=e.width/2,o=e.height/2;r.fillRect(a,o,2,2)}))}let Rt=(e,t)=>{let n=null,r=e.resource.group,a=e.resource.name,o=e.pos||{x:0,y:0},i=_t(Tt.textures,r),s=i&&i[a],l=yt.getConfig(e.config.name);if(s&&l){if(e.debug){let t=Pt(e.name,e);Array.isArray(s)||(s=[s]),s.push(t)}n=new yt({game:t,conf:e,name:e.name,objName:e.objName,isInScene:e.isInScene,setting:{type:e.type,config:l,art:s,useParticleContainer:e.useParticleContainer},pos:o})}return n},Ct=(e,t)=>{let n=null,r=e.pos||{x:0,y:0},a=(e=>{let t=Tt.spines,n=e&&e.split(".");return t&&n&&n.every((e=>{let n=t[e];return!!n&&(t=n,!0)})),t})(e.resource.spineData),o=_t(Tt.textures,e.resource.texture);return a&&(n=new ut({game:t,conf:e,name:e.name,objName:e.objName,isInScene:e.isInScene,spineDataGroup:a,textureGroup:o,pos:r})),n},Ot=(e,t)=>{let n,r=e.pos||{x:0,y:0},a={},o={timeScale:1};return e.resource&&"string"==typeof e.resource.name&&(a.name=e.resource.name),e.animation&&(o.name=e.animation.name,o.timeScale=e.animation.timeScale),n=new dt({game:t,conf:e,name:e.name,objName:e.objName,resource:a,animation:o,isInScene:e.isInScene,pos:r}),n},jt=(e,t)=>{let n,r=e.pos||{x:0,y:0},a=Tt.objectFactory;return n=new lt({game:t,conf:e,name:e.name,objName:e.objName,isInScene:e.isInScene,pivot:e.pivot,pos:r}),e.childList&&e.childList.forEach((e=>{let r,o=a[e.type];o&&(r=o(e,t),r&&(e.isInScene&&r&&n.addChild(r),n.childList.push(r)))})),n},Lt=(e,t)=>{let n,r=e.pos||{x:0,y:0},a=e.anchor||{x:0,y:0};return n=new gt({game:t,conf:e,name:e.name,objName:e.objName,isInScene:e.isInScene,pos:r,anchor:a,text:e.text||"文字訊息"}),n},At=(e,t)=>{let n,r=e.resource,a=r.group,o=_t(Tt.textures,a),i=PIXI.Texture.EMPTY,s=PIXI.Texture.EMPTY;return e.debug?s=Pt(e.name,e):o&&(i=o[r.slider]||i,s=o[r.background]||s),n=new pt({game:t,conf:e,name:e.name,objName:e.objName,isInScene:e.isInScene,pos:e.pos,anchor:e.anchor,slider:i,background:s}),n},kt=(e,t)=>{let n,r=e.resource.group,a=e.resource.name,o=e.pos||{x:0,y:0},i=e.anchor||{x:0,y:0},s=_t(Tt.textures,r);"number"==typeof a&&a<0&&(a=0);let l=s&&s[a]||PIXI.Texture.EMPTY;return e.debug&&(l=Pt(e.name,e)),n=new ct({game:t,conf:e,name:e.name,objName:e.objName,isInScene:e.isInScene,pos:o,anchor:i,texture:l}),n},Mt=(e,t)=>{let n,r=e.resource.group,a=e.resource.name,o=e.pos||{x:0,y:0},i=e.anchor||{x:0,y:0},s=_t(Tt.textures,r),l=e.blend;"number"==typeof a&&a<0&&(a=0);let c=s&&s[a]||PIXI.Texture.EMPTY;return"number"==typeof l?l<0&&(l=0):l=0,e.debug&&(c=Pt(e.name,e)),n=new ct({game:t,conf:e,name:e.name,objName:e.objName,isInScene:e.isInScene,pos:o,anchor:i,alpha:e.alpha||1,texture:c}),n.blendMode=l,n},Dt=(e,t)=>{let n,r=e.resource.group,a=e.resource.name,o=e.pos||{x:0,y:0},i=e.anchor||{x:0,y:0},s=e.speed||.33,l=e.loop,c=_t(Tt.textures,r),u=c&&c[a]||[PIXI.Texture.EMPTY];return e.debug&&(u=[Pt(e.name,e)]),n=new it({game:t,conf:e,name:e.name,objName:e.objName,isInScene:e.isInScene,speed:s,loop:l,pos:o,anchor:i,textures:u}),n},Bt=(e,t)=>{let n,r=e.resource,a=e.resource.texture,o=_t(Tt.textures,r.group),i=e.numCounts||4,s=e.offset,l=e.symbolOffset,c=e.charMap,u=e.autoHide,f={pos:{x:0,y:0},width:e.width,height:e.height},d=o&&o[e.resource.background]||PIXI.Texture.EMPTY;return e.debug&&(d=Pt(e.name,e)),n=new mt({game:t,conf:e,name:e.name,objName:e.objName,isInScene:e.isInScene,autoHide:u,fixVal:e.fixVal,useComma:e.useComma,useDash:e.useDash,useMoney:e.useMoney,pos:e.pos,anchor:e.anchor,pivot:e.pivot,rect:f,textureName:a,background:d,numCounts:i,charMap:c,symbolOffset:l,offset:s}),n},Ft=(e,t)=>{let n,r,a=e.resource,o=a.group,i=a.name,s=_t(Tt.textures,o),l={enter:PIXI.Texture.EMPTY,press:PIXI.Texture.EMPTY,leave:PIXI.Texture.EMPTY,disable:PIXI.Texture.EMPTY};return e.debug?(l.enter=Pt(e.name,e),l.press=l.enter,l.leave=l.enter,l.disable=l.enter):(n=s&&s[i],n&&(l.enter=n[a.enter]||l.enter,l.press=n[a.press]||l.press,l.leave=n[a.leave]||l.leave,l.disable=n[a.disable]||l.disable)),r=new st({game:t,conf:e,name:e.name,objName:e.objName,isInScene:e.isInScene,pos:e.pos,anchor:e.anchor,texture:l}),r};function Gt(e){Tt.objectFactory[St.INFO]=Nt,Tt.objectFactory[St.GROUP]=jt,Tt.objectFactory[St.SCROLLBAR]=At,Tt.objectFactory[St.BACKGROUND]=kt,Tt.objectFactory[St.TEXT]=Lt,Tt.objectFactory[St.IMAGE]=Mt,Tt.objectFactory[St.ANMIMATION]=Dt,Tt.objectFactory[St.NUMBER]=Bt,Tt.objectFactory[St.BUTTON]=Ft,Tt.objectFactory[St.SPINE]=Ct,Tt.objectFactory[St.PARTICLE]=Rt,It=e.jsyaml,Et=e.Loader,wt=e.dragon,wt&&(Tt.objectFactory[St.BONE]=Ot)}function Ut(e){let t,n,r=Tt.event;if(Tt.isBusy)return!1;Tt.isBusy=!0,Tt.game=e.game;let a=e.filename,o=e.proc,i=e.callback,s=e.finish,l=[],c=0,u=e=>{let a=i[c];a&&a(e),r.resEnd&&r.resEnd(c),c+=1,c<l.length?(r.resBegin&&r.resBegin(c),n()):t()};if(t=()=>{Tt.isBusy=!1,s&&s()},n=()=>{let e,t,n;e=o[c],t=l[c];try{n=It.load(t),e&&(Tt.baseIndex+=1,Tt.baseProgress=Tt.baseIndex/Tt.baseMax*100,e(n,u))}catch(e){}},!Array.isArray(a))return!1;if(!Array.isArray(o))return!1;if(!Array.isArray(i))return!1;if(a.length!==o.length)return!1;return function(){r.sceneResBegin&&r.sceneResBegin("config"),Tt.baseIndex=0,Tt.baseProgress=0,Tt.baseMax=1+a.length,Tt.baseProgress=Tt.baseIndex/Tt.baseMax*100,Tt.base=1/Tt.baseMax;let e=new Et(Tt.baseURL,50);a.forEach(((t,n)=>{e.add(n.toString(),t)})),e.onProgress.once((e=>{let t=e.progress;t>100&&(t=100);let n=Tt.baseProgress+t*Tt.base;r.sceneResLoading&&r.sceneResLoading({currentProgress:t,currentLength:a.length,totalProgress:n,state:Tt.state})})),e.load(((e,t)=>{Object.getOwnPropertyNames(t).forEach((e=>{let n=parseInt(e);l[n]=t[e].data})),r.sceneResEnd&&r.sceneResEnd("config"),c=0,n()}))}(),!0}function Vt(e){let t,n,r=Tt.event;if(Tt.isBusy)return!1;Tt.isBusy=!0,Tt.game=e.game;let a=e.objData,o=e.proc,i=e.callback,s=e.finish,l=0,c=e=>{let o=i[l];o&&o(e),r.resEnd&&r.resEnd(l),l+=1,l<a.length?(r.resBegin&&r.resBegin(l),n(l)):t()};if(t=()=>{Tt.isBusy=!1,s&&s()},n=e=>{let t,n;t=o[e],n=a[e],Tt.baseIndex=e,Tt.baseProgress=Tt.baseIndex/Tt.baseMax*100,t&&n&&t(n,c)},!Array.isArray(a))return!1;if(!Array.isArray(o))return!1;if(!Array.isArray(i))return!1;if(a.length!==o.length)return!1;return Tt.baseIndex=0,Tt.baseProgress=0,Tt.baseMax=a.length,Tt.base=1/Tt.baseMax,l=0,n(l),!0}function zt(e){let t=Tt.event;e?(t.resBegin=e.resBegin||t.resBegin,t.resEnd=e.resEnd||t.resEnd,t.sceneResBegin=e.sceneResBegin||t.sceneResBegin,t.sceneResLoading=e.sceneResLoading||t.sceneResLoading,t.sceneResEnd=e.sceneResEnd||t.sceneResEnd):(t.resBegin=null,t.resEnd=null,t.sceneResBegin=null,t.sceneResLoading=null,t.sceneResEnd=null)}function Xt(e){Tt.state=e}function Yt(e,t){"object"==typeof e.particle&&yt.setConfigMap(e.particle),t(e)}function Ht(e,t){let n=Tt.event,r=0,a={},o=t,i=e=>{let t=e.progress;t>100&&(t=100);let r={currentProgress:t,totalProgress:Tt.baseProgress+t*Tt.base,state:Tt.state};n.sceneResLoading&&n.sceneResLoading(r)},s=t=>{let r={};if(!t||!t.resources)return void o(r);let a=t.resources,i=e=>{let t=null;return a[e]&&a[e].spineData&&(t=a[e].spineData),t},s=(e,t,n)=>{let r;Object.getOwnPropertyNames(e).forEach((a=>{let o=e[a];"string"==typeof o?t[a]=n(o):Array.isArray(o)?(r=[],((e,t,n)=>{e.forEach((e=>{t.push(n(e))}))})(o,r,n),t[a]=r):"object"==typeof o&&(r={},s(o,r,n),t[a]=r)}))};e&&e.spines&&e.atlas&&e.spineDataMap?s(e.spineDataMap.spines,r,i):e&&e.spines&&s(e.spines,r,i),n.sceneResEnd&&n.sceneResEnd("spine"),Tt.spines=r,o(r)},l=e=>{a[e]=e},c=(e,t)=>{Object.getOwnPropertyNames(e).forEach((n=>{let r=e[n];"string"==typeof r?t(r):Array.isArray(r)?((e,t)=>{e.forEach((e=>{t(e)}))})(r,t):"object"==typeof r&&c(r,t)}))};(()=>{n.sceneResBegin&&n.sceneResBegin("spine");let t=function(){function e(e){this.index=0,this.lines=e.split(/\r\n|\r|\n/)}return e.prototype.readLine=function(){return this.index>=this.lines.length?null:this.lines[this.index++]},e.prototype.readValue=function(){var e=this.readLine(),t=e.indexOf(":");if(-1===t)throw new Error("Invalid line: "+e);return e.substring(t+1).trim()},e.prototype.readTuple=function(e){var t=this.readLine(),n=t.indexOf(":");if(-1===n)throw new Error("Invalid line: "+t);for(var r=0,a=n+1;r<3;r++){var o=t.indexOf(",",a);if(-1===o)break;e[r]=t.substr(a,o-a).trim(),a=o+1}return e[r]=t.substring(a).trim(),r+1},e}();if(e&&e.spines&&e.atlas){let n={},r={},a=e.atlas,o=Object.getOwnPropertyNames(a);o.forEach((e=>{let n=a[e],o=bt(e);if(!n)return;let i=new t(n);!function(){let e=!0;for(;;){let t=i.readLine();if(null===t)return;if(0!==t.length){if(t.length<=2&&t.indexOf(" ")>=0)e=!0;else if(e){e=!1;let n=o.dir+t;r[n]=1}}else e=!0}}()}));let l=Object.getOwnPropertyNames(r),c=null;c=PIXI.Loader?PIXI.Loader:PIXI.loaders.Loader;let u=new c(Tt.baseURL,50);u.onProgress.add(i),u.add(l),u.load((t=>{let r=PIXI.spine.TextureAtlas||PIXI.spine.core.TextureAtlas,i=PIXI.spine.AtlasAttachmentLoader||PIXI.spine.core.AtlasAttachmentLoader,l=PIXI.spine.SkeletonJson||PIXI.spine.core.SkeletonJson;o.forEach((o=>{let s=a[o],c=bt(o);if(!s)return;let u=new r(s,((e,n)=>{let r,a=c.dir+e,o=t.resources[a];r=o?o.texture:PIXI.Texture.EMPTY,n(r.baseTexture)})),f=new i(u),d=new l(f),h=`${c.dir}${c.name}.json`,m=e.spines[h];if(m){let e=d.readSkeletonData(m);n[h]={spineData:e}}})),s({resources:n})}))}else if(e&&e.spines){c(e.spines,l);let t=Object.getOwnPropertyNames(a);if(r=t.length,0===r)s();else{let e=null;e=PIXI.Loader?PIXI.Loader:PIXI.loaders.Loader;let n=new e(Tt.baseURL,50);t.forEach((e=>{n.add(e,e)})),n.onProgress.add(i),n.load(s)}}else s()})()}function Wt(e,t){let n=Tt.event,r={},a=t,o=e=>{let t=e.progress;t>100&&(t=100),t=Tt.baseProgress+t*Tt.base,n.sceneResLoading&&n.sceneResLoading({current:t,length:100,state:Tt.state})},i=t=>{let r=null;if(wt&&(r=new wt.dragonBones.PixiFactory),!t)return void a(r);let o=t.resources,i=(e,t,n)=>{e.forEach((e=>{t.push(n(e))}))};i(e.bones.data,[],(e=>{let t=o[e].data;return r&&r.parseDragonBonesData(t),t}));i(e.bones.resource,[],(e=>{let t=o[e.atlas]&&o[e.atlas].data;if(t=JSON.parse(t),r){let n=_t(Tt.textures,e.texture.group),a=n&&n[e.texture.name];a&&r.parseTextureAtlasData(t,a)}return t})),n.sceneResEnd&&n.sceneResEnd("bones"),Tt.bonesFactory=r,dt.setFactory(r),a(r)},s=e=>{r[e]=e},l=e=>{r[e.atlas]=e.atlas},c=(e,t)=>{e.forEach((e=>{t(e)}))},u=(e,t)=>{Object.getOwnPropertyNames(e).forEach((n=>{let r=e[n];"string"==typeof r?t(r):Array.isArray(r)?c(r,t):"object"==typeof r&&u(r,t)}))};(()=>{if(n.sceneResBegin&&n.sceneResBegin("bones"),e&&e.bones&&e.bones.data){u(e.bones.data,s),c(e.bones.resource,l);let t=Object.getOwnPropertyNames(r);if(0===t.length)i();else{let e=null;e=PIXI.Loader?PIXI.Loader:PIXI.loaders.Loader;let n=new e(Tt.baseURL,50);t.forEach((e=>{n.add(e,e)})),n.onProgress.add(o),n.load(i)}}else i()})()}function qt(e,t){let n,r=e.objects,a=Tt.objectFactory,o=[],i=0,s=0,l=Tt.event,c=[];l.sceneResBegin&&l.sceneResBegin("object"),s=r.length,r.forEach((e=>{let t=a[e.type];t?(n=t(e,Tt.game),n&&o.push(n)):c.push(e),i+=1;let r=i/s*100,u={currentProgress:r,totalProgress:Tt.baseProgress+r*Tt.base,state:Tt.state};l.sceneResLoading&&l.sceneResLoading(u)})),l.sceneResEnd&&l.sceneResEnd("object"),t&&t(o,c)}function $t(e,t){let n={},r=!1,a={},o=Tt.event,i={};Tt.textures=null;let s=0,l={currentProgress:0,totalProgress:Tt.baseProgress,state:Tt.state};o.sceneResLoading&&o.sceneResLoading(l);let c=e=>{let t=e.progress;t>100&&(t=100);let n=0;n=s>0?100*s+Tt.baseProgress+t*s:Tt.baseProgress+t*Tt.base;let r={currentProgress:t,totalProgress:n,state:Tt.state};o.sceneResLoading&&o.sceneResLoading(r)},u=r=>{let a,i=r.resources,s=e=>i[e].texture,l=(e,t,n)=>{e.forEach((e=>{t.push(n(e))}))},c=(e,t,n)=>{let r;Object.getOwnPropertyNames(e).forEach((a=>{let o=e[a];"string"==typeof o?t[a]=n(o):Array.isArray(o)?(r=[],l(o,r,n),t[a]=r):"object"==typeof o&&(r={},c(o,r,n),t[a]=r)}))};a=Object.getOwnPropertyNames(e.images),a.forEach((t=>{let r,a=n[t];r=e.images[t],Array.isArray(r)?a?l(r,a,s):(a=[],l(r,a,s),n[t]=a):"object"==typeof r?a?c(r,a,s):(a={},c(r,a,s),n[t]=a):"string"==typeof r&&(n[t]=s(r))})),o.sceneResEnd&&o.sceneResEnd("texture"),Tt.textures=n,t&&t(n)},f=e=>{let t=e.progress;t>100&&(t=100);let n=0;n=s>0?Tt.baseProgress+t*s:Tt.baseProgress+t*Tt.base;let r={currentProgress:t,totalProgress:n,state:Tt.state};o.sceneResLoading&&o.sceneResLoading(r)},d=null,h=()=>{o.sceneResEnd&&o.sceneResEnd("asset"),d(e)},m=t=>{let n=t.resources,r=t.assetNames,a=e.assets;r.forEach((e=>{let t=a[e],r=n[t.meta.filename].texture;if(r&&t){new PIXI.Spritesheet(r.baseTexture,t).parse((()=>{}))}})),o.sceneResEnd&&o.sceneResEnd("asset"),d(e)},p=e=>{a[e]=e},g=(e,t)=>{e.forEach((e=>{t(e)}))},v=(e,t)=>{if(!e)return;Object.getOwnPropertyNames(e).forEach((n=>{let r=e[n];"string"==typeof r?t(r):Array.isArray(r)?g(r,t):"object"==typeof r&&v(r,t)}))},y=e=>PIXI.utils.TextureCache[e],b=(e,t,n)=>{e.forEach((e=>{t.push(n(e))}))},x=(e,t,n)=>{Object.getOwnPropertyNames(e).forEach((r=>{let a=e[r],o=[];"string"==typeof a?t[r]=n(a):Array.isArray(a)?(b(a,o,n),t[r]=o):"object"==typeof a&&(t[r]=o,x(a,o,n))}))};if(d=e=>{let i,s,l;if(e.images){i=Object.getOwnPropertyNames(e.images),i.forEach((t=>{let n;n=e.images[t],Array.isArray(n)?g(n,p):"object"==typeof n?v(n,p):"string"==typeof n&&p(n)})),s=Object.getOwnPropertyNames(a),o.sceneResBegin&&o.sceneResBegin("texture");let t=null;t=PIXI.Loader?PIXI.Loader:PIXI.loaders.Loader;let n=new t(Tt.baseURL,50);s.forEach((e=>{n.add(e,e)})),n.onProgress.add(c),n.load(u)}else r=!0;e.frames&&(l=Object.getOwnPropertyNames(e.frames),l.forEach((t=>{let r,a=n[t];r=e.frames[t],Array.isArray(r)?a?b(r,a,y):(a=[],b(r,a,y),n[t]=a):"object"==typeof r?a?x(r,a,y):(a=[],x(r,a,y),n[t]=a):"string"==typeof r&&(n[t]=y(r))}))),r&&(Tt.textures=n,t&&t(n))},e&&e.assets){e.images&&(s=.5*Tt.base);let t=e.assets;if(Array.isArray(t)){o.sceneResBegin&&o.sceneResBegin("asset");let e=null;e=PIXI.Loader?PIXI.Loader:PIXI.loaders.Loader;let n=new e(Tt.baseURL,50);t.forEach((e=>{n.add(e)})),n.onProgress.add(f),n.load(h)}else if("object"==typeof t){let e=null;e=PIXI.Loader?PIXI.Loader:PIXI.loaders.Loader;let n=new e(Tt.baseURL,50),r=Object.getOwnPropertyNames(t);n.assetNames=r,r.forEach((e=>{let r,a,o,i=e.lastIndexOf("/");i>0&&(i+=1,r=e.slice(0,i),a=e.slice(i)),i=a.lastIndexOf("."),i>0&&(i+=1,o=a.slice(i));let s=t[e];a=r+(s.meta&&s.meta.image),s.meta.filename=a,n.add(a)})),n.onProgress.add(f),n.load(m)}}else d(e),i.textures=n;return i}function Kt(e){Tt.textures=e}function Jt(e){Tt.spines=e}function Qt(e,t){let n,r,a,o=0,i=0,s=Tt.event,l={},c=Tt.soundMapList;if(!globalThis.Howl||!e.sounds)return t&&t(null),!1;r=Object.getOwnPropertyNames(e.sounds),s.sceneResBegin&&s.sceneResBegin("sound");let u=0,f=0;o=0;let d=Tt.baseURL;return r.forEach((t=>{let r={};a=e.sounds[t],i=a.length,f+=i,a.forEach((e=>{let t=e.config.src;if(Array.isArray(e.config.src)){let t=[];e.config.src.forEach((e=>{t.push(d+e)})),e.config.src=t}n=new Howl(e.config),e.config.src=t,r[e.objName]=n,o+=1,u=o/f*100;let a=Tt.baseProgress+u*Tt.base,i={currentProgress:u,totalProgress:a,state:Tt.state};s.sceneResLoading&&s.sceneResLoading(i)})),a.length>0?l[t]=r:l[t]=null})),s.sceneResEnd&&s.sceneResEnd("sound"),c.push(l),t&&t(l),!0}function Zt(e){Object.getOwnPropertyNames(e).forEach((t=>{let n=e[t];n&&n.stop?(n.stop(),n.unload()):Zt(n),delete e[t]}))}class en{constructor(e){this.game=e,this.isInScene=!1}show(e){let t=this,n=t.game;t.isInScene||(t.isInScene=!0,e||(e=n.layer.main),t.objs&&t.objs.forEach((t=>{t&&(t._game=n,t.isInScene&&(t.addToScene?t.addToScene(e):e.addChild(t)))})))}hide(){let e=this;e.isInScene&&(e.isInScene=!1,e.objs&&e.objs.forEach((e=>{e&&(e.removeFromScene?e.removeFromScene():e.parent&&e.parent.removeChild(e))})))}init(e){let t={};function n(e){e.childList.forEach((t=>{if(t){let r=t.conf;if(r.objName){e[r.objName]=t;t.objName;St.GROUP===t.type&&n(t)}}}))}this.entity=t,e.forEach((e=>{let r="";e&&e.objName&&(t[e.objName]=e,r='set entity name"'+e.objName+'"',St.GROUP===e.type&&n(e))}))}}var tn=Object.freeze({__proto__:null,OBJ_TYPE:St,createDebugTxeture:Pt,createGroup:jt,init:Gt,registerFactory:function(e){Tt.objectFactory[e.type]=e.create},loadScene:Ut,loadSceneEx:Vt,setEvent:zt,setState:Xt,createRawData:Yt,createSpineData:Ht,createBonesData:Wt,createObject:qt,createTexture:$t,setTextures:Kt,setSpineData:Jt,setBaseURL:function(e){Tt.baseURL=e||""},getBaseURL:function(){return Tt.baseURL},getTextures:function(e,t){let n,r=e;return t.split(".").every((function(e){return n=r[e],!!n&&(r=n,!0)})),r},createSound:Qt,destroySound:Zt,destroyAllSound:function(){Tt.soundMapList.forEach((e=>{Object.getOwnPropertyNames(e).forEach((t=>{Zt(e[t]),delete e[t]}))}))},createScene:function(e,t){let n=new Promise(((n,r)=>{if(Tt.isBusy)return void r("忙碌中");let a=e.game,o=e.infoList,i=e.loading,s=e.loadingEvent,l=new en(a),c={data:{proc:Yt,callback(e){l.data=e,t&&t.eventRawData&&t.eventRawData(e)}},sound:{proc:Qt,callback(e){l.sounds=e,t&&t.eventSound&&t.eventSound(e)}},texture:{proc:$t,callback(e){l.textures=e,t&&t.eventTexture&&t.eventTexture(e)}},spine:{proc:Ht,callback(e){l.spines=e,t&&t.eventSpine&&t.eventSpine(e)}},object:{proc:qt,callback(e){l.objs?e.forEach((e=>{l.objs.push(e)})):l.objs=e,l.init(e),t&&t.eventObject&&t.eventObject(e)}}};s&&s.start&&s.start();let u={game:a,objData:[],proc:[],callback:[],finish:function(){i&&i.setState(!0),t&&t.finish&&t.finish(l),s&&s.finish&&s.finish(l),n(l)}};o&&Array.isArray(o)&&o.forEach((e=>{let t=c[e.eventName];t&&e.obj&&t.proc&&(u.objData.push(e.obj),u.proc.push(t.proc)),u.callback.push(t.callback)})),i?i.go({loadingEvent:s,game:a,layer:a.layer&&a.layer.overlay,load(){Vt(u)}}):Vt(u)}));return n}});let nn={isBusy:!1,game:null,loading:null,useLobbyState:!1,state:{currentIndex:0,totals:0}};var rn=Object.freeze({__proto__:null,go:function(e,t){if(nn.isBusy||!nn.game||!Array.isArray(e))return!1;let n,r,a=nn.game,o=nn.loading,i=0,s=e.length,l=t,c=e;return Xt(nn.state),n=()=>{if(!(i<s))return nn.isBusy=!1,nn.useLobbyState||o&&o.setState(!0),l&&l(),!1;{let e=c[i].scene;if(i+=1,e)return r(e);n()}},r=e=>{nn.state.currentIndex=i,nn.state.totals=s;let t=!1;return!e.isCreate()&&e.createScene?(t=!0,e.createScene(n)):n(),t},nn.isBusy=!0,nn.useLobbyState?n():o.go({game:a,layer:a.layer&&a.layer.overlay,load(){n()}}),!0},setUseLobbyState:function(e){nn.useLobbyState=e,e&&nn.game&&nn.game.scene?zt(nn.game.scene.loadingEvent):(nn.useLobbyState=!1,zt(null))},setGame:function(e){nn.game=e},setDisplayLoading:function(e){nn.loading=e}});let an={init:null,release:null,resource:null,eventResBegin:null,eventResCheck:null,eventResEnd:null,eventStart:null,eventEnter:null,eventLeave:null},on=null,sn=null;function ln(e){on&&on(e)}class cn{static resCreate(e){an.resource&&an.resource(e)}static frameStart(e){an.eventStart&&an.eventStart(e),on=cn.frameEnter}static frameFinish(e){an.release&&an.release(e),on=null,sn&&(sn(),sn=null)}static frameEnter(e){let t=!0;an.eventEnter&&(t=an.eventEnter(e)),t&&(on=cn.resBegin)}static frameLeave(e){let t=!0;an.eventLeave&&(t=an.eventLeave(e)),t&&(on=cn.frameFinish)}static resBegin(e){an.eventResBegin&&an.eventResBegin(e),cn.resCreate(),on=cn.resLoading}static resLoading(e){an.eventResCheck?an.eventResCheck(e)&&(on=cn.resEnd):on=cn.resEnd}static resEnd(e){an.eventResEnd&&an.eventResEnd(e),on=cn.frameLeave}}function un(e){return on||("object"==typeof e&&(an.init=e.init,an.release=e.release,an.resource=e.resource,an.eventResBegin=e.resBegin,an.eventResCheck=e.resCheck,an.eventResEnd=e.resEnd,an.eventStart=e.start,an.eventEnter=e.enter,an.eventLeave=e.leave,sn=e.finish),an.init&&an.init(),on=cn.frameStart),!0}var fn=Object.freeze({__proto__:null,refresh:ln,go:un});let dn={event:null,scene:{anim:null,message:null,percent:null},isInit:!1,strings:null,resList:null,state:!1},hn=null;var mn=Object.freeze({__proto__:null,init:function(){},setState:function(e){dn.state=e},setStrings:function(e){dn.strings=e},setPosition:function(e){let t=dn.scene.anim;t&&(t.x=e.x,t.y=e.y),dn.pos?(dn.pos.x=e.x,dn.pos.y=e.y):dn.pos={x:e.x,y:e.y}},setScene:function(e){dn.resList=e,dn.isInit=!1},go:function(e){if(!globalThis.PIXI)return!1;let t=globalThis.PIXI,n=e.loadingEvent||{},r=e.game,a=dn.strings;hn={resBegin(e){n.resBegin&&n.resBegin(e)},resEnd(e){n.resEnd&&n.resEnd(e)},sceneResBegin(e){let t=e;a&&a.get&&(t=a.get(e)),n.sceneResBegin&&n.sceneResBegin(e)},sceneResLoading(e){let t=e.state,r=e.totalProgress;if(t){r=(t.currentIndex-1)/t.totals*100+r/t.totals}let a=r.toFixed(0)+"%";n.sceneResLoading&&n.sceneResLoading(e),dn.percent&&(dn.percent.text=a)},sceneResEnd(e){let t=e;a&&a.get&&(t=a.get(e)),n.sceneResEnd&&n.sceneResEnd(e)}},zt(hn);let o={name:"loading",screen:{width:r.screen&&r.screen.width||1024,height:r.screen&&r.screen.height||768},movieClip:null,layer:e.layer||null,load:e.load,init:()=>{if(!dn.isInit){dn.isInit=!0;let e,n=dn.resList,r=[];n.forEach((n=>{e=t.Texture.from(n),r.push(e)}));let a=null;a=t.AnimatedSprite?new t.AnimatedSprite(r):new t.extras.AnimatedSprite(r),a.animationSpeed=.33,a.anchor.x=.5,a.anchor.y=.5,dn.scene.anim=a;let i=new t.Text("message");i.style.fill="#FFFFFF",i.style.stroke="#006600",i.style.strokeThickness=1,i.anchor.x=.5,i.anchor.y=.5,i.x=0,i.y=-44,dn.message=i;let s=new t.Text("init");s.style.fill="#FFFFFF",s.style.stroke="#aa0000",s.style.strokeThickness=1,s.anchor.x=.5,s.anchor.y=.5,s.x=0,s.y=24,dn.percent=s,a.addChild(i),a.addChild(s),dn.pos||(dn.pos={x:o.screen.width/2,y:o.screen.height/2}),dn.anchor=new t.Point(.5,.5)}r.addRefresh(o.name,ln)},release:()=>{null!==o.layer&&null!==dn.scene.anim&&o.layer.removeChild(dn.scene.anim),r.removeRefresh(o.name)},resource:()=>{o.load&&o.load()},resBegin:()=>{},resCheck:()=>dn.state,resEnd:()=>{},start:()=>{if(null!==o.layer&&null!==dn.scene.anim){dn.percent&&(dn.percent.text="start");let e=dn.scene.anim;e.x=dn.pos.x,e.y=dn.pos.y,e.anchor.x=dn.anchor.x,e.anchor.y=dn.anchor.y,e.alpha=0,e.gotoAndPlay(0),o.layer.addChild(e)}},enter:()=>{let e=!1,t=dn.scene.anim;return null!==t?t.alpha>=1?(t.alpha=1,e=!0):t.alpha+=.05:e=!0,e},leave:()=>{let e=!1,t=dn.scene.anim;return null!==t?(t.alpha<=0&&(t.alpha=0,e=!0),t.alpha-=.05,t.alpha<=0&&(t.alpha=0)):e=!0,e},finish:()=>{}};return dn.event=o,dn.state=!1,un(dn.event)}});class pn{constructor(){let e=this,t=null,n={autoUpdate:!0,debug:!1,timeBase:1,currentTime:-1,renderer:null,pause:!0,isInit:!1},r=null,a=[],o=[],i={};e.custom={},e.setEngine=e=>{r=e},e.setElement=e=>{n.element=e},e.getElement=()=>n.element,e.getCanvas=()=>n.canvas,e.update=e=>{n.debug&&t&&t.begin(),n.currentTime<0&&(e=0,n.currentTime=1),e*=n.timeBase,a.forEach((t=>{let n=i[t];n.update?n.update(e):n(e)})),o.forEach((t=>{t.update&&t.update(e)})),n.autoUpdate&&r&&r.render(e),n.debug&&t&&t.end()},n.debug=!1,e.addRefresh=(e,t)=>{i[e]=t,a=Object.getOwnPropertyNames(i)},e.removeRefresh=e=>{Object.prototype.hasOwnProperty.call(i,e)&&(delete i[e],a=Object.getOwnPropertyNames(i))},e.addUpdate=e=>{let t=!1;return e&&e.update&&!Object.prototype.hasOwnProperty.call(e,"__updateIndex")&&(e.__updateIndex=o.length,o[e.__updateIndex]=e,t=!0),t},e.removeUpdate=e=>{let t,n,r=o.length;if("number"==typeof e.__updateIndex){if(t=e.__updateIndex,t>=0&&t<r){let e=r-1;n=o[e],o[t]=n,n.__updateIndex=t,o.splice(e,1)}delete e.__updateIndex}},e.resetUpdate=()=>{o.forEach((e=>{delete e.__updateIndex})),o=[]},e.setTimeout=(t,n)=>{let r={currentTime:0,func:t,update:t=>{r.currentTime.toFixed(2)>=n&&(e.removeUpdate(r),r.func&&r.func(r.currentTime)),r.currentTime+=t}};return e.addUpdate(r),r},e.idle=t=>new Promise((n=>{e.setTimeout((function(){n()}),t)})),e.setInterval=(t,n)=>{let r=0,a={func:t,update:e=>{r+=e,r.toFixed(2)>=n&&(a.func&&a.func(r),r=0)}};return e.addUpdate(a),a},e.clearInterval=t=>{e.removeUpdate(t)},e.isPause=()=>n.pause,e.play=()=>{n.pause&&(n.pause=!1,n.currentTime=-1,Ge(e))},e.once=()=>{n.pause=!1,n.currentTime=-1,Xe(e)},e.pause=()=>{n.pause||(n.pause=!0,Ue(e))},e.stop=()=>{n.pause=!0,Ue(e),e.resetUpdate()},e.add=e=>{n.timeBase<1&&(n.timeBase=1),n.timeBase+=e,n.timeBase>4&&(n.timeBase=4)},e.dec=e=>{n.timeBase>1&&(n.timeBase=1),n.timeBase-=e,n.timeBase<.1&&(n.timeBase=.1)},e.reset=()=>{n.timeBase=1},e.getTimeBase=()=>n.timeBase,e.setTimeBase=e=>{n.timeBase=e,n.timeBase<.1?n.timeBase=.1:n.timeBase>4&&(n.timeBase=4)},e.init=t=>{if(n.isInit)return!1;n.isInit=!0,n.element=t.element,n.canvas=t.view,n.currentTime=-1;let r={width:t.width,height:t.height};return e.pause(),e.screen=r,!0},e.getRenderer=()=>r&&r.renderer,e.setAutoUpdate=e=>{n.autoUpdate=e},Object.defineProperty(e,"layer",{get:()=>r&&r.layer}),Object.defineProperty(e,"debug",{set(r){t||pn.Stats&&(t=new pn.Stats,e.stats=t),r?t&&n.element&&(t.dom.style.position="absolute",n.element.appendChild(t.dom)):t&&n.element&&t.dom.parentElement&&n.element.removeChild(t.dom),n.debug=r},get:()=>n.debug}),e.stats=null}}pn.Stats=null,pn.isInitial=!1;let gn=!1;let vn=null;function yn(e){vn=e.m,function(){if(gn)return;gn=!0;let e=globalThis.PIXI;e&&(e.Texture.Draw=t=>{let n=document.createElement("canvas");return"function"==typeof t&&t(n),e.Texture.fromCanvas(n)})}()}let bn={position:"absolute",left:"0%",top:"0%",width:"100%",height:"100%"},xn={zIndex:10,position:"absolute",left:"0%",top:"0%",width:"100%",height:"100%"},wn={oninit(e){let t=this,n=e.attrs,r=e.attrs.config;t.config=r,t.game=r.game,t.style=n.style||xn,t.ready=n.ready},oncreate(e){let t=this,n=t.config;n.view=e.instance.children[0].dom,n.element=e.dom;let r=t.game;r||(r=new pn,t.game=r),r.init(n);let a=function(e){if(!globalThis.PIXI)return null;let t,n,r={},a=e,o=globalThis.PIXI;return n=o.Renderer?new o.Renderer(a):new o.WebGLRenderer(a),t=new o.Container,r.stage=t,r.overlay=new o.Container,r.foreground=new o.Container,r.main=new o.Container,r.background=new o.Container,t.addChildAt(r.overlay,0),t.addChildAt(r.foreground,0),t.addChildAt(r.main,0),t.addChildAt(r.background,0),{renderer:n,stage:t,layer:r,render(){n.render(t)}}}(n);r.setEngine(a),n&&n.ready&&n.ready(r),t.ready&&t.ready(r)},onremove(){let e=this.game;e&&e.stop()},view(){return vn(".",{style:this.style},vn("canvas",{style:bn}))}};function En(e){!function(e){!pn.isInitial&&(e.Stats&&(pn.Stats=e.Stats.default||e.Stats),pn.isInitial=!0)}(e),yn(e)}var In=Object.freeze({__proto__:null,init:En,run:function(e){let t;if(t=new pn,window.parent&&window.parent!==window){let n,r;if(window.Howl=window.parent.Howl,window.Howler=window.parent.Howler,window.parent.scene){let a=e.id,o=e.event||{};n=window.parent.scene[a],Object.defineProperty(t,"scene",{get:()=>n}),n&&n.event&&(r={create(e){window.parent.lobby&&(t.table=window.parent.lobby.table[e.id],t.currentUser=window.parent.lobby.currentUser,t.command=window.parent.lobby.net.gameCommand,t.lobby={setEvent:window.parent.lobby.setEvent,setCommand:window.parent.lobby.net.setLobbyCommand,CMD:window.parent.lobby.net.CMD}),o.create&&(e.game=t,o.create(e))},play(e){t.play(),o.play&&(e.game=t,o.play(e))},pause(e){t.pause(),o.pause&&(e.game=t,o.pause(e))},enter(e){o.enter&&(e.game=t,o.enter(e))},leave(e){o.leave&&(e.game=t,o.leave(e))},focus(){o.focus&&o.focus()},blur(){o.blur&&o.blur()},lock(e){o.lock&&o.lock(e)},fullscreen(e){o.fullscreen&&o.fullscreen(e)},resize(e){o.resize&&o.resize(e)},music(e){o.music&&o.music(e)},sound(e){o.sound&&o.sound(e)}},n.setEvent(r),n.game=t)}}return t}});let Sn={utils:xt,Base:class{constructor(e){let t=this,n={name:e,root:null,game:null,center:{entity:{}},initMap:null,currentTime:0,isCreate:!1,isInScene:!1};t.properties=n,Object.defineProperty(t,"center",{get:()=>n.center}),Object.defineProperty(t,"entity",{get:()=>n.center.entity})}getName(){return this.properties.name}getGame(){return this.properties.game}isCreate(){return this.properties.isCreate}isInScene(){return this.properties.isInScene}getCurrentTime(){return this.properties.currentTime}getCenter(){return this.properties.center}getRoot(){return this.properties.root}setRoot(e){let t=this.properties;t.root=e,t.center=e.center}setInitMap(e){this.properties.initMap=e}setLayer(e){this.properties.center.layer=e}getLayer(){return this.properties.center.layer}getRawData(){return this.properties.center.rawdata}getSound(e){let t=this.properties.center.sounds;return t&&"string"==typeof e&&(t=t[e]),t}mute(e,t){let n=this.properties.center.sounds[e];if(n){Object.getOwnPropertyNames(n).forEach((e=>{n[e].mute(t)}))}}getTexture(e){let t=this.properties.center.textures;return t&&"string"==typeof e&&(t=t[e]),t}getObject(){return this.properties.center.objs}getEntity(){return this.properties.center.entity}eventFinish(){let e=this,t=e.properties,n=t.center;n.textures&&Kt(n.textures),n.spines&&Jt(n.spines),t.initMap&&t.initMap(e)}eventRawData(e){}eventSound(e){}eventTexture(e){}eventSpine(e){}eventBones(e){}eventObject(e){}refresh(e){let t=this.getCenter();t&&t.update&&t.update(e)}setGame(e,t){let n=this.properties;n.game=e,e.layer&&t&&Object.prototype.hasOwnProperty.call(e.layer,t)&&(n.center.layer=e.layer[t])}addToScene(e){let t=this,n=t.properties;if(n.isInScene)return!1;n.isInScene=!0;let r=n.center;n.currentTime=-1,n.game=e||n.game,n.game&&n.game.addRefresh(n.name,(function(e){n.currentTime<0?(n.currentTime=0,e=0):t.currentTime+=e,t.refresh(e)}));let a=r.layer;return!r||!r.objs||(r.objs.forEach((e=>{e&&(e._game=n.game||e._game,e.isInScene&&(e.addToScene?e.addToScene(a):a.addChild(e)))})),!0)}removeFromScene(){let e=this.properties;if(!e.isInScene)return!1;e.isInScene=!1,e.game&&e.game.removeRefresh(e.name);let t=e.center;return!t||!t.objs||(t.objs.forEach((e=>{e&&(e.removeFromScene?e.removeFromScene():e.parent&&e.parent.removeChild(e))})),!0)}init(e){let t=this.properties,n=t.center;const r=St;if(!n||!n.objs)return;let a=n.entity,o={},i=e=>{e.childList.forEach((n=>{if(n){n._game=t.game||n._game;let a=n.conf;if(a.objName){e[a.objName]=n;n.objName}r.GROUP===n.type&&i(n)}}))};if(n.objs.forEach((e=>{let n="";e&&(e._game=t.game||e._game,e.objName&&(a[e.objName]=e,n='set entity name"'+e.objName+'"'),r.GROUP===e.type&&i(e))})),!e)return;o=e.set||{};o.setupGroup=o.setupGroup||(e=>{e.childList.forEach((e=>{if(e){let t=e.conf;r.GROUP===e.type&&o.setupGroup(e),t&&Object.prototype.hasOwnProperty.call(o,t.init)&&o[t.init](e)}}))}),n.objs.forEach((e=>{let t,n="";e&&(t=e.conf,r.GROUP===e.type&&o.setupGroup(e),t&&Object.prototype.hasOwnProperty.call(o,t.init)&&(n=(e.name||e.objName)+" init : "+t.init,o[t.init](e,t)))}))}createScene(e,t){let n=this,r=n.properties;if(r.isCreate)return e&&e(),!1;let a=t.infoList,o=r.center,i={data:{proc:Yt,callback:e=>{o&&(o.rawdata=e),n.eventRawData(e)}},sound:{proc:Qt,callback:e=>{o&&(o.sounds=e),n.eventSound(e)}},texture:{proc:$t,callback:e=>{o&&(o.textures=e),n.eventTexture(e)}},spine:{proc:Ht,callback:e=>{o&&(o.spines=e),n.eventSpine(e)}},bone:{proc:Wt,callback:e=>{o&&(o.bonesFactory=e),n.eventBones(e)}},object:{proc:qt,callback:e=>{o&&(o.objs?e.forEach((e=>{o.objs.push(e)})):o.objs=e),n.eventObject(e)}}};function s(){r.isCreate=!0,o&&o.createFinish&&o.createFinish()}if(o&&(o.createFinish=e),t.isObject){let e={game:r.game,objData:[],proc:[],callback:[],finish:s};a&&Array.isArray(a)&&a.forEach((t=>{let n=i[t.eventName];n&&t.obj&&n.proc&&(e.objData.push(t.obj),e.proc.push(n.proc)),e.callback.push(n.callback)})),Vt(e)}else{let e={game:r.game,filename:[],proc:[],callback:[],finish:s};a&&Array.isArray(a)&&a.forEach((t=>{let n=i[t.eventName];n&&t.filename&&e.filename.push(t.filename),e.proc.push(n.proc),e.callback.push(n.callback)})),Ut(e)}return!0}destroyScene(){this.removeFromScene();let e=this.properties,t=e.center;if(!e.isCreate)return!1;if(t&&(t.bonesFactory&&(t.bonesFactory.clear(),t.bonesFactory=null),t.sounds)){Zt(t.sounds)}return t.objs&&(t.objs.forEach(((e,n)=>{e&&delete t.objs[n]})),t.objs=null),e.isCreate=!1,!0}},sceneManager:tn,loadingManager:rn,loading:fn,set:e=>{let t=St,n=e.game,r=e.scene,a=e.set;a.setupGroup=a.setupGroup||(e=>{e.childList.forEach((e=>{if(e){e._game=n;let r=e.conf;t.GROUP===e.type&&a.setupGroup(e),r&&Object.prototype.hasOwnProperty.call(a,r.init)&&a[r.init](e)}}))}),r.objs.forEach((e=>{let r,o="";e&&(e._game=n,r=e.conf,t.GROUP===e.type&&a.setupGroup(e),r&&Object.prototype.hasOwnProperty.call(a,r.init)&&(o=(e.name||e.objName)+" init : "+r.init,a[r.init](e,r)))}))}},Tn={loading:mn,base:ot},_n={game:{pixi:wn}},Nn=!1;var Pn=Object.freeze({__proto__:null,Lobby:nt,client:Oe,components:_n,game:In,init:function(e){let t=e||{},n=t.plugin||[];return Array.isArray(n)||(n=[]),!globalThis.PIXI&&e.PIXI&&(globalThis.PIXI=e.PIXI),new Promise((e=>{Nn&&e("!! init finish again !!"),function r(a){if(a&&a.Spine&&globalThis.PIXI&&(globalThis.PIXI.spine=a),n.length>0){let e=n.shift();window.System?System.import(e).then(r):r()}else t.sceneManager=tn,globalThis.PIXI&&(!function(){let e=globalThis.PIXI,t=null;t=e.AnimatedSprite?e.AnimatedSprite:e.extras.AnimatedSprite,it=class extends(at(t)){static get TYPE(){return"animation"}constructor(t){super(t.textures||[e.Texture.EMPTY],!1);let n=this;n._game=t.game,n.conf=t.conf,n.type="animation",n.name=t.name,n.objName=t.objName||null,n.isInScene=t.isInScene,t.pos&&(n.x=t.pos.x,n.y=t.pos.y),t.anchor&&(n.anchor.x=t.anchor.x||0,n.anchor.y=t.anchor.y||0),n.loop=t.loop,"number"==typeof t.speed&&(n.animationSpeed=t.speed)}clone(e){super.clone();let t={game:e||this._game,conf:this.conf,isInScene:this.isInScene,name:this.name+".clone."+this.cloneIndex,loop:this.loop,speed:this.animationSpeed,pos:this.position,anchor:this.anchor,textures:this.textures};return new it(t)}removeFromScene(){super.removeFromScene(),this._game&&this._game.removeUpdate(this)}addToScene(e){e.addChild(this),this.playing&&this._game&&this._game.addUpdate(this)}play(){this._game&&this._game.addUpdate(this),super.play()}stop(){this._game&&this._game.removeUpdate(this),super.stop()}update(e){super.update(60*e)}reload(){let t=this._game.textures,n=this.conf,r=this.conf.resource,a=rt(t,r.group);a&&(this.textures=a[r.name]||[e.Texture.EMPTY]),n.loop&&this.play()}}}(),function(){let e=globalThis.PIXI;st=class extends(at(e.Sprite)){static get TYPE(){return"button"}constructor(t){super(t.texture&&t.texture.leave||e.Texture.EMPTY);let n=this;n._game=t.game,n.type="button",n.conf=t.conf,n.objName=t.objName||null,n.name=t.name,n.isInScene=t.isInScene,t.pos&&(n.x=t.pos.x,n.y=t.pos.y),t.anchor&&(n.anchor.x=t.anchor.x||0,n.anchor.y=t.anchor.y||0),n.scale.x=1,n.buttonMode=!0,n.interactive=!0;let r={};n.custom=r,r.texture=t.texture||{enter:e.Texture.EMPTY,leave:e.Texture.EMPTY,press:e.Texture.EMPTY,disable:e.Texture.EMPTY},r.isPress=!1,r.flagDrag=!1,r.canMove=!1,r.timer=null,r.obj=null,n.touchstart=n.mousedown=e=>{r.flagDrag&&r.timer&&(n.dragEvent&&(n.dragEvent.curTimes=n.dragEvent.times,n.dragEvent.reset&&n.dragEvent.reset()),r.timer.restart()),n.eventPress(e)},n.touchend=n.mouseup=e=>{r.canMove=!1,r.flagDrag&&n.dragEvent&&n.dragEvent.reset&&n.dragEvent.reset(),n.eventRelease(e)},n.mouseover=e=>{r.flagDrag&&n.dragEvent&&n.dragEvent.reset&&n.dragEvent.reset(),n.eventEnter(e)},n.mouseout=e=>{r.canMove=!1,r.flagDrag&&n.dragEvent&&n.dragEvent.reset&&n.dragEvent.reset(),n.eventLeave(e)},n.touchendoutside=n.mouseupoutside=e=>{r.flagDrag&&n.dragEvent&&n.dragEvent.reset&&n.dragEvent.reset(),n.eventLeave(e)}}clone(e){super.clone();let t={game:e||this._game,conf:this.conf,isInScene:this.isInScene,name:this.name+".clone."+this.cloneIndex,pos:this.position,anchor:this.anchor,texture:this.custom.texture};return new st(t)}setTextures(t){let n=this.custom.texture;t&&(n.enter=t.enter||e.Texture.EMPTY,n.leave=t.leave||e.Texture.EMPTY,n.press=t.press||e.Texture.EMPTY,n.disable=t.disable||e.Texture.EMPTY),this.update()}setTexture(e){this.setTextures(e)}setClick(e,t){this.eventClick=e,this.obj=t}eventPress(){let e=this,t=e.custom.texture;e.texture=t.press,e.custom.isPress=!0}eventRelease(){let e=this,t=e.custom.texture;e.custom.isPress?(e.texture=t.leave,"function"==typeof e.eventClick&&e.eventClick(e,e.obj)):e.texture=t.leave,e.custom.isPress=!1}eventEnter(){let e=this,t=e.custom.texture;e.custom.isPress?e.texture=t.press:e.texture=t.enter}eventLeave(){let e=this,t=e.custom.texture;e.texture=t.leave,e.custom.isPress=!1}setDragEnable(e){let t=this,n=t.custom;n.flagDrag=!0,t.mousemove=t.touchmove=e=>{if(n.canMove){n.isPress=!1;let r={x:parseInt(e.data.global.x),y:parseInt(e.data.global.y)};t.x=r.x,t.y=r.y}},t.dragEvent=e,t.dragEvent||(t.dragEvent={},t.dragEvent.times=10),t.dragEvent.curTimes=t.dragEvent.times}setDragDisable(){let e=this;e.custom.flagDrag=!1,e.mousemove=e.touchmove=null}setEnable(e,t){e?this.enable(t):this.disable(t)}enable(e){this.interactive=!0;let t=this.custom.texture;e&&(this.texture=t.leave)}isEnabled(){return this.interactive}disable(e){this.interactive=!1;let t=this.custom.texture;e&&(this.texture=t.disable)}update(){let e=this.custom.texture;this.interactive?this.texture=e.leave:this.texture=e.disable}reload(){let e=this._game.textures,t=this.conf.resource,n=rt(e,t.group);n&&this.setTextures(n[t.name])}}}(),function(e){let t=globalThis.PIXI,n=e.sceneManager;lt=class extends(at(t.Container)){static get TYPE(){return"group"}constructor(e){super();let t=this;t._game=e.game,t.conf=e.conf,t.type="group",t.name=e.name,t.objName=e.objName||null,t.isInScene=e.isInScene,t.childList=[],e.pos&&(t.x=e.pos.x||0,t.y=e.pos.y||0),e.pivot&&(t.pivot.x=e.pivot.x||0,t.pivot.y=e.pivot.y||0)}clone(e){super.clone();let t=null;this.conf&&this.conf.childList&&(t=this.conf.childList);let r={game:e||this._game,childList:t,isInScene:this.isInScene,name:this.name+".clone."+this.cloneIndex,pivot:this.pivot,pos:this.position};return n.createGroup(r,this._game)}removeFromScene(){super.removeFromScene(),this.stop()}stop(){this.childList.forEach((e=>{e.stop&&e.stop()}))}reload(){this.childList.forEach((e=>{e.reload&&e.reload()}))}}}(t),function(){let e=globalThis.PIXI;ct=class extends(at(e.Sprite)){static get TYPE(){return"image"}constructor(t){super(t.texture||e.Texture.EMPTY);let n=this;n._game=t.game,n.conf=t.conf,n.type="image",n.name=t.name,n.objName=t.objName,n.isInScene=t.isInScene,t.pos&&(n.x=t.pos.x,n.y=t.pos.y),t.anchor&&(n.anchor.x=t.anchor.x||0,n.anchor.y=t.anchor.y||0)}clone(e){super.clone();let t={game:e||this._game,conf:this.conf,isInScene:this.isInScene,name:this.name+".clone."+this.cloneIndex,pos:this.position,anchor:this.anchor,alpha:this.alpha,texture:this.texture};return new ct(t)}}}(),function(){let e=globalThis.PIXI;mt=class extends(at(e.Sprite)){static get TYPE(){return"digit"}static get NUM(){return ht}constructor(t){super(t.background||e.Texture.EMPTY);let n,r=this;r._game=t.game,r.conf=t.conf,r.type="digit",r.name=t.name,r.objName=t.objName,r.isInScene=t.isInScene;let a,o,i,s,l,c,u,f={},d={};for(f.rect=d,f.event={},r.custom=f,d.pos=new e.Point(0,0),d.anchor=new e.Point(0,0),d.width=t.width||64,d.height=t.height||16,t.rect&&(t.rect.pos&&(d.x=t.rect.pos.x,d.y=t.rect.pos.y),t.rect.anchor&&(d.anchor.x=t.rect.anchor.x,d.anchor.y=t.rect.anchor.y),d.width=t.rect.width||d.width,d.height=t.rect.height||d.height),f.textureName=t.textureName||"",f.numCounts=t.numCounts||4,f.charMap=t.charMap||ht.CHAR_MAP,f.shift=1,"number"==typeof t.shift&&(f.shift=t.shift),f.enable=!1,f.display=t.display||ht.DISPLAY.TRANSVERSE,f.alignType=t.alignType||ht.ALIGN_TYPE.RECT,f.offsetType=t.offsetType||ht.OFFSET_TYPE.STATIC,f.horiType=t.horiType||ht.HORI_ALIGN.LEFT,f.vertiType=t.vertiType||ht.VERTI_ALIGN.TOP,f.alpha=1,f.anchor={x:0,y:0},t.anchor&&(f.anchor.x=t.anchor.x,f.anchor.y=t.anchor.y),f.lastCnt=0,f.value=0,f.currentValue=0,f.targetValue=0,f.offsetValue=0,f.background=t.background||e.Texture.EMPTY,f.autoHide=t.autoHide,f.useComma=t.useComma,f.useMoney=t.useMoney,f.useDash=t.useDash,"number"==typeof t.fixVal?f.fixVal=t.fixVal:f.fixVal=0,t.pos&&(r.x=t.pos.x,r.y=t.pos.y),t.pivot&&(r.pivot.x=t.pivot.x,r.pivot.y=t.pivot.y),f.numTe={},f.numSprite=[],u=f.charMap.length,a=0;a<u;a+=1)c=f.charMap[a],o=f.textureName+c,f.numTe[c]=e.utils.TextureCache[o]||e.Texture.EMPTY;for(i=f.numTe[f.charMap[0]],s=i.frame,f.offset=t.offset||s.width,f.symbolOffset=-1,"number"==typeof t.symbolOffset&&(f.symbolOffset=t.symbolOffset),u=f.numCounts,a=0;a<u;a+=1)n=new e.Texture(i.baseTexture,s.clone()),l=new e.Sprite(n),l.anchor.x=f.anchor.x,l.anchor.y=f.anchor.y,f.numSprite[a]=l;r._eventUpdate=r._animChange}clone(e){super.clone();let t=this.custom,n={game:e||this._game,conf:this.conf,isInScene:this.isInScene,name:this.name+".clone."+this.cloneIndex,pos:this.position,pivot:this.pivot,anchor:t.anchor,rect:t.rect,display:t.display,alignType:t.alignType,offsetType:t.offsetType,horiType:t.horiType,vertiType:t.vertiType,textureName:t.textureName,numCounts:t.numCounts,charMap:t.charMap,offset:t.offset,symbolOffset:t.symbolOffset,shift:t.shift,background:t.background,autoHide:t.autoHide,fixVal:t.fixVal,useComma:t.useComma,useDash:t.useDash,useMoney:t.useMoney};return new mt(n)}removeFromScene(){super.removeFromScene(),this._game.removeUpdate(this)}transverse(){this.setDisplay(ht.DISPLAY.TRANSVERSE)}straight(){this.setDisplay(ht.DISPLAY.TRANSVERSE)}setDisplay(e){if(e===ht.DISPLAY.TRANSVERSE)this.display=e;else{if(e!==ht.DISPLAY.STRAIGHT)return;this.display=e}this.setAlign(this.horiType,this.vertiType)}setBackground(e){this.texture=e}setAnchor(e){if(!e)return;let t,n=this.custom,r=n.anchor,a=n.numSprite.length;for(r.x=e.x,r.y=e.y,t=0;t<a;t+=1)r=n.numSprite[t].anchor,r.x=e.x,r.y=e.y}setAlign(e,t){let n=this.custom;n.alignType=ht.ALIGN_TYPE.RECT;let r,a,o=n.rect.pos,i={x:o.x,y:o.y},s=n.anchor,l=n.rect.width,c=n.rect.height,u=n.offset,f={w:0,h:0},d=this.children,h=d.length;if(n.lastCnt===h&&n.horiType===e&&n.vertiType===t)return;switch(n.lastCnt=h,n.horiType=e,n.vertiType=t,d.forEach((e=>{let t=e.texture.frame;"."===e.ch||","===e.ch?(f.w-=u,f.h-=u,a&&(f.w+=a.width,f.h+=a.height),f.w+=t.width,f.h+=t.height,f.w+=2*n.symbolOffset):(f.w+=u,f.h+=u),a=t})),n.horiType){case ht.HORI_ALIGN.LEFT:n.display,ht.DISPLAY.TRANSVERSE,i.x=o.x;break;case ht.HORI_ALIGN.CENTER:n.display===ht.DISPLAY.TRANSVERSE?i.x=o.x+.5*l-.5*f.w:i.x=o.x+.5*l;break;case ht.HORI_ALIGN.RIGHT:n.display===ht.DISPLAY.TRANSVERSE?i.x=o.x+l-f.w:i.x=o.x+l}switch(n.vertiType){case ht.VERTI_ALIGN.TOP:i.y=o.y;break;case ht.VERTI_ALIGN.CENTER:n.display===ht.DISPLAY.TRANSVERSE?i.y=o.y+.5*c:i.y=o.y+.5*c-.5*f.h;break;case ht.VERTI_ALIGN.BOTTOM:n.display===ht.DISPLAY.TRANSVERSE?i.y=o.y+c:i.y=o.y+c-f.h}let m=0,p={width:0,height:0};for(r=h-1;r>=0;r-=1){let e=d[r],t=e.position,o=e.texture.frame;n.display===ht.DISPLAY.TRANSVERSE?(t.x=m+i.x,t.y=i.y):(t.y=m+i.y,t.x=i.x),"."===e.ch||","===e.ch?n.display===ht.DISPLAY.TRANSVERSE?(m-=u,m+=p.width,t.x=m+i.x-p.width*s.x+o.width*s.x,m+=o.width+2*n.symbolOffset,t.x+=n.symbolOffset):m+=o.height:m+=u,a=o,p=o}}setAlpha(e){this.children.forEach((t=>{t.alpha=e})),this.custom.alpha=e}set shift(e){this.custom.shift=e}get shift(){return this.custom.shift}set fixVal(e){this.custom.fixVal=e}get fixVal(){return this.custom.fixVal}getValue(){return this.custom.value}setValue(e,t){let n=this,r=n.custom,a=r.event;if(r.currentValue=r.value,r.value=e||0,r.targetValue=e||0,r.currentValue<r.targetValue?r.offsetValue=r.shift:r.currentValue>r.targetValue&&(r.offsetValue=-r.shift),a.begin&&a.begin(n),t)return void n.enable();r.currentValue=r.value;let o,i,s=n,l=n.fixValueString(r.currentValue),c=l.length,u=r.alpha,f=r.numSprite.length-1,d=r.numTe[0].frame;for(;f>=0;){c-=1;let e=r.numSprite[f];c>=0?(i=l[c],o=r.numTe[i],e.ch=i,e.alpha=u,o&&e.texture.width>1&&e.texture.height>1&&(e.texture.frame=o.frame.clone()),s.addChild(e)):(e.ch="0",r.autoHide?s.removeChild(e):(e.texture.width>1&&e.texture.height>1&&(e.texture.frame=d.clone()),e.alpha=u,s.addChild(e))),f-=1}n.setAlign(r.horiType,r.vertiType)}setEvent(e){let t=this.custom.event;t.begin=e.begin||t.begin,t.end=e.end||t.end,t.changeString=e.changeString||t.changeString}_animChange(e){let t=this,n=t.custom,r=n.event,a=n.offsetValue*e*1e3;a<0?n.currentValue<=n.targetValue?(n.currentValue=n.targetValue,t.disable(),r.end&&r.end(t)):n.currentValue=n.currentValue+a:n.currentValue>=n.targetValue?(n.currentValue=n.targetValue,t.disable(),r.end&&r.end(t)):n.currentValue=n.currentValue+a;let o,i,s=t,l=t.fixValueString(n.currentValue),c=n.alpha,u=l.length,f=n.numSprite.length-1,d=n.numTe[0].frame;for(;f>=0;){u-=1;let e=n.numSprite[f];u>=0?(o=l[u],i=n.numTe[o],e.ch=o,e.alpha=c,i&&e.texture.width>1&&e.texture.height>1&&(e.texture.frame=i.frame.clone()),s.addChild(e)):(e.ch="0",n.autoHide?s.removeChild(e):(e.texture.width>1&&e.texture.height>1&&(e.texture.frame=d.clone()),e.alpha=c,s.addChild(e))),f-=1}t.setAlign(n.horiType,n.vertiType)}fixValueString(e){let t=this.custom,n=t.event,r=e.toString(),a=r.lastIndexOf(".");a<0&&t.fixVal>0?(r+=".",a=r.length):a>=0&&0===t.fixVal&&(a=r.lastIndexOf("."),r=r.substr(0,a),a=r.length);for(let e=a+1;e<=a+t.fixVal;e+=1)e>=r.length&&(r=r.concat("0"));let o=r;t.fixVal>0&&r.length>a+t.fixVal&&(o=r.substr(0,a+t.fixVal+1));let i,s,l,c,u=null,f=o.length,d=Math.floor(e);return t.fixVal>0&&(c=o.substr(f-(t.fixVal+1),t.fixVal+1),o=d.toString(),f=o.length),t.useComma?f>6?(i=o.substr(0,f-6),s=o.substr(f-6,3),l=o.substr(f-3,3),u=i+","+s+","+l):f>3?(i=o.substr(0,f-3),s=o.substr(f-3,3),u=i+","+s):u=o:u=o,t.useMoney&&(u="$"+u),t.useDash&&0===t.fixVal&&(u+="_"),t.fixVal>0&&(u+=c),n.changeString&&(u=n.changeString(u)),u}setTexture(e){this.setTextures(e)}setTextures(t){let n=this,r=n.custom;if(r.textureName!==t){let n,a,o,i,s;for(r.textureName=t,n=0,s=r.charMap.length;n<s;n++)i=r.charMap[n],a=r.textureName+i,r.numTe[i]=e.utils.TextureCache[a]||e.Texture.EMPTY;for(o=r.numTe[r.charMap[0]],n=0,s=r.numCounts;n<s;n++){let t=r.numSprite[n];t.texture=new e.Texture(o.baseTexture,o.frame.clone()),t.anchor.x=r.anchor.x,t.anchor.y=r.anchor.y}}r.lastCnt=0,n.setValue(n.custom.currentValue,!1)}enable(){let e=this,t=e.custom;t.enable||(t.enable=!0,e._game.addUpdate(e))}disable(){let e=this,t=e.custom;t.enable&&(t.enable=!1,e._game.removeUpdate(e))}stop(){this.disable()}update(e){this._eventUpdate&&this._eventUpdate(e)}reload(){let t=this,n=t._game.textures,r=t.conf.resource;if(t.custom.textureName="",this.setTextures(r.texture),r.group){let a=rt(n,r.group);a&&(t.texture=a[r.background]||e.Texture.EMPTY)}}}}(),function(){let e=globalThis.PIXI;pt=class extends(at(e.Sprite)){static get TYPE(){return"scrollbar"}constructor(t){super(t.background||e.Texture.EMPTY);let n=this;n._game=t.game,n.conf=t.conf,n.type="scrollbar",n.name=t.name,n.objName=t.objName,n.isInScene=t.isInScene,n.value={current:1,offset:1,min:1,max:10,range:9},n.value.range=n.value.max-n.value.min,n.eventScroll=null,n.slider=new e.Sprite(t.slider),n.slider.anchor.x=.5,n.addChild(n.slider),t.pos&&(n.x=t.pos.x||0,n.y=t.pos.y||0),t.anchor&&(n.anchor.x=t.anchor.x||0,n.anchor.y=t.anchor.y||0),n.limit={offset:0,min:.5*n.conf.slider.width,max:n.conf.width-.5*n.conf.slider.width},n.limit.length=n.limit.max-n.limit.min,n.slider.x=n.limit.min,n.slider.value=0,n.limit.offset=n.limit.length/n.value.range,n.hasMove=!1,n.buttonMode=!0,n.interactive=!0,n.obj=null,n.touchstart=n.mousedown=e=>{let t=parseInt(e.data.global.x);parseInt(e.data.global.y),n.hasMove=!0,n.slider.x=t-n.x,n.slider.x<n.limit.min?n.slider.x=n.limit.min:n.slider.x>=n.limit.max&&(n.slider.x=n.limit.max),n.slider.value=n.slider.x-n.limit.min,n.value.current=n.value.min+n.value.offset*parseInt(n.slider.value/n.limit.offset),n.eventScroll&&n.eventScroll(n.value.current,n)},n.touchend=n.mouseup=e=>{parseInt(e.data.global.x),parseInt(e.data.global.y),n.hasMove=!1},n.slider.buttonMode=!0,n.slider.interactive=!0,n.slider.mousedown=n.slider.touchstart=()=>{n.hasMove=!0},n.slider.mouseup=n.slider.mouseupoutside=n.slider.touchend=n.slider.touchendoutside=()=>{n.hasMove=!1},n.slider.mousemove=n.slider.touchmove=e=>{if(0===e.which&&(n.hasMove=!1),n.hasMove){let t={x:parseInt(e.data.global.x),y:parseInt(e.data.global.y)};n.slider.x=t.x-n.x,n.slider.x<n.limit.min?n.slider.x=n.limit.min:n.slider.x>=n.limit.max&&(n.slider.x=n.limit.max),n.slider.value=n.slider.x-n.limit.min,n.value.current=n.value.min+n.value.offset*parseInt(n.slider.value/n.limit.offset),n.eventScroll&&n.eventScroll(n.value.current,n)}}}clone(){return null}setBindScrollEvent(e){this.eventScroll=e}reset(){this.hasMove=!1}setRange(e){"number"==typeof e.current&&(this.value.current=e.current),"number"==typeof e.offset&&(this.value.offset=e.offset),"number"==typeof e.min&&(this.value.min=e.min),"number"==typeof e.max&&(this.value.max=e.max),"number"==typeof e.range&&(this.value.range=e.range),this.value.current<this.value.min?this.value.current=this.value.min:this.value.current>this.value.max&&(this.value.current=this.value.max),this.value.offset=(this.value.max-this.value.min)/this.value.range,this.limit.offset=this.limit.length/this.value.range,this.slider.value=this.limit.offset*(this.value.current-this.value.min),this.slider.x=this.limit.min+this.slider.value,this.eventScroll&&this.eventScroll(this.value.current,this)}setValue(e){e>=this.value.min&&e<=this.value.max&&(this.value.current=e,this.slider.value=this.limit.offset*((this.value.current-this.value.min)/this.value.range),this.slider.x=this.limit.min+this.slider.value,this.eventScroll&&this.eventScroll(this.value.current,this))}getValue(){return this.value.current}}}(),function(){let e=globalThis.PIXI;ut=class extends(at(e.Container)){static get TYPE(){return"spine"}static getChild(e,t){let n=null,r=e.spineData.slots,a=-1;return r.some(((e,n)=>e.name===t&&(a=n,!0))),a>=0&&(n=e.children[a],n&&n.children[0]&&(n=n.children[0])),n}static getRect(t,n){let r=t.getBounds();if(n){let n=new e.Graphics;t.addChild(n),n.x=0,n.y=0,n.lineStyle(1,255,.75),n.beginFill(65291,.15),n.drawRect(.5*-r.width,.5*-r.height,r.width,r.height),n.endFill(),n.lineStyle(1,0),n.moveTo(0,0),n.lineTo(r.width,r.height),n.moveTo(r.width,0),n.lineTo(0,r.height)}return r}constructor(t){super();let n=this,r=t.spineDataGroup,a=t.textureGroup;n._game=t.game,n.conf=t.conf,n.type="spine",n.name=t.name,n.objName=t.objName||null,n.isInScene=t.isInScene;let o={};n.custom=o,o.childList=[],o.spineAnimList=[],o.group={},o.spineDataGroup=r,o.textureGroup=a,o.configList=t.configList||t.conf&&t.conf.configList,t.pos&&(n.x=t.pos.x||0,n.y=t.pos.y||0),e.spine&&(o.configList.forEach(((t,n)=>{let a,i,s,l;if(i=new e.Sprite(e.Texture.EMPTY),a=new e.spine.Spine(r[t.dataName]),s={x:0,y:0},l=a.getLocalBounds(),a.skeleton.setToSetupPose(),a.autoUpdate=!1,a.state.timeScale=0,a.x=.01,a.y=.01,a.childMap={},a.getChild=e=>a.childMap[e],a.spineData.slots.forEach(((e,t)=>{let n=a.children[t];n&&n.children&&(n=n.children[0],a.childMap[e.name]=n)})),i.name=t.name,i.addChild(a),o.childList[n]=i,t.anchor&&(a.x=-a.width*t.anchor.x+.01,a.y=-a.height*t.anchor.y+.01),s.x=l.x,s.y=l.y,t.fixPosition){let e=t.fixPosition,n=e.offset||{x:0,y:0},r=null;e.childName&&(r=a.getChild(e.childName)),r||(r=a.children[e.childIndex||0].children[0]),l=r.getBounds(),a.x=-l.x+.5*-l.width,a.y=-l.y+.5*-l.height,s.x=a.x+l.x,s.y=a.y+l.y,a.x=a.x+n.x,a.y=a.y+n.y}if(t.debug){let t=new e.Graphics;i.addChild(t),t.x=0,t.y=0,t.lineStyle(1,16711680,.9),t.beginFill(16740363,.1),t.drawRect(a.x+l.x,a.y+l.y,l.width,l.height),t.endFill(),t.lineStyle(0),t.beginFill(0,1),t.drawCircle(s.x,s.y,3),t.endFill(),t.beginFill(16777215,1),t.drawCircle(s.x,s.y,1),t.endFill(),a.children.forEach((t=>{let n=t.children[0];if(n&&n.getBounds||(n=t),n&&n.getBounds){let t=n.getBounds(),r=new e.Graphics;n.addChild(r),r.x=0,r.y=0,r.lineStyle(1,65280,.75),r.beginFill(786288,.15),r.drawRect(.5*-t.width,.5*-t.height,t.width,t.height),r.endFill(),r.lineStyle(0),r.beginFill(0,1),r.drawCircle(0,0,3),r.endFill(),r.beginFill(16777215,1),r.drawCircle(0,0,1),r.endFill()}}))}t.name&&(o.group[t.name]={sprite:i,spine:a,entry:null,animConfig:{animationName:t.animationName,timeScale:t.timeScale,loop:t.loop}}),o.spineAnimList.push(a)})),o.configList.forEach((t=>{let n=o.group[t.name].spine;if(n&&t.mask){let r=e.Texture.EMPTY;a&&(r=a[t.mask.name]||e.Texture.EMPTY);let i=new e.Sprite(r),s=n;if(n.mask=i,t.mask.follow&&(s=o.group[t.mask.follow]),s){let e=s.getLocalBounds();t.mask.local?(i.x=e.x,i.y=e.y):(i.x=0,i.y=0),s.addChild(i)}let l=t.mask.fixPosition;if(l&&s){let e,t=l.offset||{x:0,y:0};l.childName&&(e=s.getChild(l.childName)),e||(e=s.children[l.childIndex||0].children[0]);let n=e.getBounds(),r=s.getBounds(),a=s.getLocalBounds();i.x=a.x+(n.x-r.x)+t.y,i.y=a.y+(n.y-r.y)+t.y}if(t.mask.debug){let t=new e.Graphics,n={x:0,y:0};s&&(n.x=s.x,n.y=s.y,s.parent.addChild(t)),t.x=n.x+i.x,t.y=n.y+i.y,t.lineStyle(1,255,.75),t.beginFill(16740363,.15),t.drawRect(0,0,i.width,i.height),t.endFill(),t.lineStyle(1,0),t.moveTo(0,0),t.lineTo(i.width,i.height),t.moveTo(i.width,0),t.lineTo(0,i.height)}}n&&t.maskList&&t.maskList.forEach((t=>{let r,o,i=e.Texture.EMPTY;a&&(i=a[t.name]||e.Texture.EMPTY);let s=new e.Sprite(i),l=null;t.followName&&(l=n.getChild(t.followName)),l||(l=n.children[t.follow]&&n.children[t.follow].children[0]),r=l,l=null,t.targetName&&(l=n.getChild(t.targetName)),l||(l=n.children[t.target]&&n.children[t.target].children[0]),o=l,o&&(o.mask=s),r&&(s.x=-r.width/2,s.y=-r.height/2,r.addChild(s))}))})))}clone(e){super.clone();let t=this.custom,n={game:e||this._game,conf:this.conf,isInScene:this.isInScene,name:this.name+".clone."+this.cloneIndex,textureGroup:t.textureGroup,spineDataGroup:t.spineDataGroup,configList:t.configList,pos:this.position};return new ut(n)}removeFromScene(){this.parent&&this.parent.removeChild(this),this._game.removeUpdate(this)}getGroup(e){return this.custom.group[e]}getSpine(e){let t,n=this.custom.group[e];return n&&(t=n.spine),t}getEntry(e){let t,n=this.custom.group[e];return n&&(t=n.entry),t}getAnimConfig(e){let t,n=this.custom.group[e];return n&&(t=n.animConfig),t}play(e){let t=this,n=t.custom,r=[];e&&Array.isArray(e)?(n.childList.forEach((e=>{t.removeChild(e)})),e.forEach((e=>{let a=n.group[e.name];if(a){let n=a.spine,o=a.sprite,i=a.animConfig;n&&(a.entry=n.state.setAnimation(0,e.animationName||i.animationName,e.loop),n.update(0),n.state.timeScale=e.timeScale||i.timeScale,r.push(n)),t.addChild(o)}}))):Object.getOwnPropertyNames(n.group).forEach((e=>{let a=n.group[e];if(a){let e=a.spine,n=a.sprite,o=a.animConfig;e&&(a.entry=e.state.setAnimation(0,o.animationName,o.loop),e.update(0),e.state.timeScale=o.timeScale,r.push(e)),t.addChild(n)}})),n.spineAnimList=r,t._game.addUpdate(t)}pause(){let e=this.custom;Object.getOwnPropertyNames(e.group).forEach((t=>{let n=e.group[t].spine;n&&(n.state.timeScale=0)}))}resume(){let e=this.custom;Object.getOwnPropertyNames(e.group).forEach((t=>{let n=e.group[t],r=n.spine,a=n.animConfig;r&&(r.state.timeScale=a.timeScale)}))}stop(e){let t=this,n=t.custom;e&&Array.isArray(e)?e.forEach((e=>{let t=n.group[e.name],r=t.spine,a=t.animConfig;a.animationName=e.animationName||a.animationName,r&&(r.state.timeScale=0)})):(Object.getOwnPropertyNames(n.group).forEach((e=>{let t=n.group[e].spine;t&&(t.state.timeScale=0)})),t._game.removeUpdate(t))}update(e){this.custom.spineAnimList.forEach((t=>{t.update(e)}))}reload(){}}}(),function(){let e=globalThis.PIXI;dt=class extends(at(e.Sprite)){static get TYPE(){return"bone"}static setFactory(e){ft=e}static getFactory(){return ft}constructor(t){super(e.Texture.EMPTY);let n=this;n._game=t.game,n.conf=t.conf,n.type="bone",n.name=t.name,n.objName=t.objName||null,n.resource={},n.animation={timeScale:1},n.isInScene=t.isInScene,n.isUpdate=!1,t.animation&&(n.animation.name=t.animation.name,n.animation.timeScale=t.animation.timeScale),t.resource&&(n.resource.name=t.resource.name),t.pos&&(n.x=t.pos.x||0,n.y=t.pos.y||0),t.anchor&&(n.anchor.x=t.anchor.x||.5,n.anchor.y=t.anchor.y||.5);let r=ft&&ft.buildArmature(n.resource.name);if(r){let e=r.display;e.scale.set(1,1),n.addChild(e)}n.armature=r,n.state=null}clone(e){super.clone();let t=this.cloneIndex,n={game:e||this._game,conf:this.conf,isInScene:this.isInScene,resource:this.resource,animation:this.animation,name:this.name+".clone."+t,pos:this.sprite.position};return new dt(n)}removeFromScene(){let e=this;e.parent&&e.parent.removeChild(e),e.stop()}play(e){let t=this.armature,n=this.animation;t&&(n.name=e||n.name,this.state=t.animation.play(n.name),this.state&&(this.state.timeScale=n.timeScale),this.isUpdate||(this.isUpdate=!0,this._game.addUpdate(this)))}stop(){this.armature&&this.isUpdate&&(this.isUpdate=!1,this._game.removeUpdate(this))}set timeScale(e){this.animation.timeScale=e,this.state&&(this.state.timeScale=e)}get timeScale(){return this.animation.timeScale}update(e){let t=this.armature;t&&t.advanceTime(e)}reload(){}}}(),function(){let e=globalThis.PIXI;gt=class extends(at(e.Text)){static get TYPE(){return"text"}constructor(e){super(e.text||"test used");let t=this;t._game=e.game,t.conf=e.conf,t.type="text",t.name=e.name,t.objName=e.objName,t.isInScene=e.isInScene;let n={fill:"#FFFFFF",stroke:"#000000",strokeThickness:0};e.style&&(n.fill=e.style.fill||"#FFFFFF",n.stroke=e.style.stroke||"#000000",n.strokeThickness=e.style.strokeThickness||0),t.style=n,e.pos&&(t.x=e.pos.x,t.y=e.pos.y),e.anchor&&(t.anchor.x=e.anchor.x||0,t.anchor.y=e.anchor.y||0)}clone(e){super.clone();let t={game:e||this._game,conf:this.conf,isInScene:this.isInScene,name:this.name+".clone."+this.cloneIndex,pos:this.position,anchor:this.anchor,style:this.style,text:this.text};return new gt(t)}reload(){}}}(),function(){let e=globalThis.PIXI,t=null;e.ParticleContainer?t=e.ParticleContainer:e.particles&&e.particles.ParticleContainer&&(t=e.particles.ParticleContainer),t&&(yt=class extends(at(t)){static get TYPE(){return"particle"}static setConfigMap(e){vt=e||vt}static getConfig(e){return vt[e]}constructor(t){super();let n,r=this,a={};r.custom=a,r._game=t.game,r.conf=t.conf,r.type="particle",r.name=t.name,r.objName=t.objName,r.isInScene=t.isInScene;let o=t.setting;a.type=o.type,a.config=o.config,a.art=o.art,a.ownerPos=new e.Point(0,0),r.setProperties({scale:!0,position:!0,rotation:!0,uvs:!0,alpha:!0}),e.particles&&e.particles.Emitter&&(n=new e.particles.Emitter(r,a.art,a.config)),n&&("path"===a.type?n.particleConstructor=e.particles.PathParticle:"anim"===a.type&&(n.particleConstructor=e.particles.AnimatedParticle)),t.pos&&(r.x=t.pos.x,r.y=t.pos.y),r.emitter=n}clone(e){super.clone();let t=this.cloneIndex,n=this.custom,r={game:e||this._game,conf:this.conf,isInScene:this.isInScene,name:this.name+".clone."+t,pos:this.position,setting:{type:n.type,config:n.config,art:n.art}};return new yt(r)}removeFromScene(){super.removeFromScene(),this._game.removeUpdate(this)}play(e,t=0){let n=this,r=n.emitter,a=e||n.custom.ownerPos;r&&(r.emit=!0,r.resetPositionTracking(),r.updateOwnerPos(a.x,a.y),r.update(t),n._game.addUpdate(n))}stop(){this._game.removeUpdate(this)}update(e){this.emitter.update(e)}reload(){}})}(),Tn.Animation=it,Tn.Button=st,Tn.Group=lt,Tn.Image=ct,Tn.Number=mt,Tn.Scrollbar=pt,Tn.Spine=ut,Tn.Bone=dt,Tn.Text=gt,Tn.Particle=yt,Gt(t)),En(t),Ke(),Je(),Re(t),Nn=!0,e("!! init finish !!")}(null)}))},scene:Sn,ui:Tn,updateManager:Qe});let Rn={name:"",currentURL:""},Cn={client:{eventList:[],errorList:[]}},On=!0;async function jn(){if(Cn.client.id)return;const e=(await import("./agent.6048cfd6.js").then((function(e){return e.f}))).default;let t=(await e.getPromise({excludes:{webglVendorAndRenderer:!0,language:!0,canvas:!0,hasLiedOs:!0,hasLiedBrowser:!0,availableScreenResolution:!0,webdriver:!0,deviceMemory:!0,hardwareConcurrency:!0,timezoneOffset:!0,timezone:!0,sessionStorage:!0,localStorage:!0,indexedDb:!0,addBehavior:!0,openDatabase:!0,cpuClass:!0,platform:!0,doNotTrack:!0,plugins:!0,adBlock:!0,hasLiedLanguages:!0,hasLiedResolution:!0,fonts:!0,fontsFlash:!0,audio:!0,enumerateDevices:!0}})).map((e=>e.value)),n=e.x64hash128(t.join(""),31),r=Cn.client;r.id=n,r.group=i.group,r.game=i.game}let Ln=1;var An={getIP:async function(){try{if(!Cn.ip){let e=await Ne.request({method:"GET",url:"//pro.ip-api.com/json?key=5SgCadGS9fH36ub",responseType:"json",params:{v:Date.now()}});Cn.ip=e}}catch(e){}return Cn.ip},statistic:Cn,send:async function(){if(a)return;let e=i,t=[],n=[];if(On){let{getGameCard:r}=await import("./agent.7d26dc97.js").then((function(e){return e.n}));Array.isArray(globalThis.CDN_LIST)&&globalThis.CDN_LIST.forEach((t=>{let a={};a.id=t.id,a.url=t.url,a.target=t.target,a.timestamp=Math.round(performance.now()),a.timeOnload=0,a.timeInit=0,a.timeScene=0,a.timeReady=9999,a.gamecard=null,a.icon="",a.useTest=!0;let o=new Promise((t=>{a.timeout=Qe.setTimeout((()=>{a.timeout=null,t(a)}),5),r(e,a,!0).then((()=>{a.timeout&&(Qe.remove(a.timeout),a.timeout=null),t(a)}))}));n.push(o)})),(await Promise.all(n)).forEach((e=>{let n={id:e.id,target:e.target,responseTimeList:[e.timeReady]};t.push(n)})),Cn.cdnList=t}Cn.url=globalThis.BASE_URL||"",Cn.timestamp=Date.now(),Cn.recordIndex="<client-detection-web_{now/d}>",Cn.recordType="_doc",Cn.deviceType="web",await jn(),Cn.client.eventList.forEach((e=>{e.label=Rn.name})),Cn.cdnList=[],Cn.client.eventList=[],Cn.client.errorList=[],On=!1},sendVideo:async function(){a||await jn()},error:function(e){e&&globalThis.gtag&&gtag("event",e.eventName||"錯誤",{event_category:e.category,event_label:e.label,value:e.value||-1,non_interaction:!0})},report:Rn,serviceBegin:function(e){e.time=Math.round(performance.now())},serviceEnd:function(e,t){t||(e.time=Math.round(performance.now())-e.time),globalThis.gtag&&gtag("event","timing_complete",{name:e.name||"後台服務",value:e.time,event_category:e.category,event_label:e.getLabel()});let n={name:e.name||"後台服務",label:e.getLabel(),category:e.category,value:e.time};Cn.client.eventList.push(n)},loadBegin:function(e){e.time=Math.round(performance.now())},loadEnd:function(e){e.time=Math.round(performance.now())-e.time,globalThis.gtag&&gtag("event","timing_complete",{name:e.name||"加載服務",value:e.time,event_category:e.category,event_label:e.getLabel()});let t={name:e.name||"加載服務",label:e.getLabel(),category:e.category,value:e.time};Cn.client.eventList.push(t)},log0:function(e){},log:function(e){e&&(globalThis.gtag&&gtag("event",e.eventName||"歷程",{event_category:e.category,event_label:`${e.label}`,value:e.value||-1,non_interaction:!0}),Ln+=1)}};function kn(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Mn={exports:{}},Dn=Mn.exports=function e(t,n,r){function a(i,s){if(!n[i]){if(!t[i]){if(!s&&kn)return kn(i);if(o)return o(i,!0);var l=new Error("Cannot find module '"+i+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[i]={exports:{}};t[i][0].call(c.exports,(function(e){var n=t[i][1][e];return a(n||e)}),c,c.exports,e,t,n,r)}return n[i].exports}for(var o=kn,i=0;i<r.length;i++)a(r[i]);return a}({1:[function(e,t,n){(function(e){var n,r,a=e.MutationObserver||e.WebKitMutationObserver;if(a){var o=0,i=new a(u),s=e.document.createTextNode("");i.observe(s,{characterData:!0}),n=function(){s.data=o=++o%2}}else if(e.setImmediate||void 0===e.MessageChannel)n="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){u(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(u,0)};else{var l=new e.MessageChannel;l.port1.onmessage=u,n=function(){l.port2.postMessage(0)}}var c=[];function u(){var e,t;r=!0;for(var n=c.length;n;){for(t=c,c=[],e=-1;++e<n;)t[e]();n=c.length}r=!1}function f(e){1!==c.push(e)||r||n()}t.exports=f}).call(this,void 0!==m?m:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,n){var r=e(1);function a(){}var o={},i=["REJECTED"],s=["FULFILLED"],l=["PENDING"];function c(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=l,this.queue=[],this.outcome=void 0,e!==a&&h(this,e)}function u(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function f(e,t,n){r((function(){var r;try{r=t(n)}catch(t){return o.reject(e,t)}r===e?o.reject(e,new TypeError("Cannot resolve promise with itself")):o.resolve(e,r)}))}function d(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function h(e,t){var n=!1;function r(t){n||(n=!0,o.reject(e,t))}function a(t){n||(n=!0,o.resolve(e,t))}function i(){t(a,r)}var s=m(i);"error"===s.status&&r(s.value)}function m(e,t){var n={};try{n.value=e(t),n.status="success"}catch(e){n.status="error",n.value=e}return n}function p(e){return e instanceof this?e:o.resolve(new this(a),e)}function g(e){var t=new this(a);return o.reject(t,e)}function v(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return this.resolve([]);for(var i=new Array(n),s=0,l=-1,c=new this(a);++l<n;)u(e[l],l);return c;function u(e,a){function l(e){i[a]=e,++s!==n||r||(r=!0,o.resolve(c,i))}t.resolve(e).then(l,(function(e){r||(r=!0,o.reject(c,e))}))}}function y(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return this.resolve([]);for(var i=-1,s=new this(a);++i<n;)l(e[i]);return s;function l(e){t.resolve(e).then((function(e){r||(r=!0,o.resolve(s,e))}),(function(e){r||(r=!0,o.reject(s,e))}))}}t.exports=c,c.prototype.catch=function(e){return this.then(null,e)},c.prototype.then=function(e,t){if("function"!=typeof e&&this.state===s||"function"!=typeof t&&this.state===i)return this;var n=new this.constructor(a);return this.state!==l?f(n,this.state===s?e:t,this.outcome):this.queue.push(new u(n,e,t)),n},u.prototype.callFulfilled=function(e){o.resolve(this.promise,e)},u.prototype.otherCallFulfilled=function(e){f(this.promise,this.onFulfilled,e)},u.prototype.callRejected=function(e){o.reject(this.promise,e)},u.prototype.otherCallRejected=function(e){f(this.promise,this.onRejected,e)},o.resolve=function(e,t){var n=m(d,t);if("error"===n.status)return o.reject(e,n.value);var r=n.value;if(r)h(e,r);else{e.state=s,e.outcome=t;for(var a=-1,i=e.queue.length;++a<i;)e.queue[a].callFulfilled(t)}return e},o.reject=function(e,t){e.state=i,e.outcome=t;for(var n=-1,r=e.queue.length;++n<r;)e.queue[n].callRejected(t);return e},c.resolve=p,c.reject=g,c.all=v,c.race=y},{1:1}],3:[function(e,t,n){(function(t){"function"!=typeof t.Promise&&(t.Promise=e(2))}).call(this,void 0!==m?m:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(e,t,n){var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(e){return}}var i=o();function s(){try{if(!i||!i.open)return!1;var e="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),t="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!e||t)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(e){return!1}}function l(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(a){if("TypeError"!==a.name)throw a;for(var n=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),r=0;r<e.length;r+=1)n.append(e[r]);return n.getBlob(t.type)}}"undefined"==typeof Promise&&e(3);var c=Promise;function u(e,t){t&&e.then((function(e){t(null,e)}),(function(e){t(e)}))}function f(e,t,n){"function"==typeof t&&e.then(t),"function"==typeof n&&e.catch(n)}function d(e){return"string"!=typeof e&&(e=String(e)),e}function h(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var m="local-forage-detect-blob-support",p=void 0,g={},v=Object.prototype.toString,y="readonly",b="readwrite";function x(e){for(var t=e.length,n=new ArrayBuffer(t),r=new Uint8Array(n),a=0;a<t;a++)r[a]=e.charCodeAt(a);return n}function w(e){return new c((function(t){var n=e.transaction(m,b),r=l([""]);n.objectStore(m).put(r,"key"),n.onabort=function(e){e.preventDefault(),e.stopPropagation(),t(!1)},n.oncomplete=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/),n=navigator.userAgent.match(/Edge\//);t(n||!e||parseInt(e[1],10)>=43)}})).catch((function(){return!1}))}function E(e){return"boolean"==typeof p?c.resolve(p):w(e).then((function(e){return p=e}))}function I(e){var t=g[e.name],n={};n.promise=new c((function(e,t){n.resolve=e,n.reject=t})),t.deferredOperations.push(n),t.dbReady?t.dbReady=t.dbReady.then((function(){return n.promise})):t.dbReady=n.promise}function S(e){var t=g[e.name].deferredOperations.pop();if(t)return t.resolve(),t.promise}function T(e,t){var n=g[e.name].deferredOperations.pop();if(n)return n.reject(t),n.promise}function _(e,t){return new c((function(n,r){if(g[e.name]=g[e.name]||M(),e.db){if(!t)return n(e.db);I(e),e.db.close()}var a=[e.name];t&&a.push(e.version);var o=i.open.apply(i,a);t&&(o.onupgradeneeded=function(t){var n=o.result;try{n.createObjectStore(e.storeName),t.oldVersion<=1&&n.createObjectStore(m)}catch(e){if("ConstraintError"!==e.name)throw e}}),o.onerror=function(e){e.preventDefault(),r(o.error)},o.onsuccess=function(){var t=o.result;t.onversionchange=function(e){e.target.close()},n(t),S(e)}}))}function N(e){return _(e,!1)}function P(e){return _(e,!0)}function R(e,t){if(!e.db)return!0;var n=!e.db.objectStoreNames.contains(e.storeName),r=e.version<e.db.version,a=e.version>e.db.version;if(r&&(e.version,e.version=e.db.version),a||n){if(n){var o=e.db.version+1;o>e.version&&(e.version=o)}return!0}return!1}function C(e){return new c((function(t,n){var r=new FileReader;r.onerror=n,r.onloadend=function(n){var r=btoa(n.target.result||"");t({__local_forage_encoded_blob:!0,data:r,type:e.type})},r.readAsBinaryString(e)}))}function O(e){return l([x(atob(e.data))],{type:e.type})}function j(e){return e&&e.__local_forage_encoded_blob}function L(e){var t=this,n=t._initReady().then((function(){var e=g[t._dbInfo.name];if(e&&e.dbReady)return e.dbReady}));return f(n,e,e),n}function A(e){I(e);for(var t=g[e.name],n=t.forages,r=0;r<n.length;r++){var a=n[r];a._dbInfo.db&&(a._dbInfo.db.close(),a._dbInfo.db=null)}return e.db=null,N(e).then((function(t){return e.db=t,R(e)?P(e):t})).then((function(r){e.db=t.db=r;for(var a=0;a<n.length;a++)n[a]._dbInfo.db=r})).catch((function(t){throw T(e,t),t}))}function k(e,t,n,r){void 0===r&&(r=1);try{var a=e.db.transaction(e.storeName,t);n(null,a)}catch(a){if(r>0&&(!e.db||"InvalidStateError"===a.name||"NotFoundError"===a.name))return c.resolve().then((function(){if(!e.db||"NotFoundError"===a.name&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),P(e)})).then((function(){return A(e).then((function(){k(e,t,n,r-1)}))})).catch(n);n(a)}}function M(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function D(e){var t=this,n={db:null};if(e)for(var r in e)n[r]=e[r];var a=g[n.name];a||(a=M(),g[n.name]=a),a.forages.push(t),t._initReady||(t._initReady=t.ready,t.ready=L);var o=[];function i(){return c.resolve()}for(var s=0;s<a.forages.length;s++){var l=a.forages[s];l!==t&&o.push(l._initReady().catch(i))}var u=a.forages.slice(0);return c.all(o).then((function(){return n.db=a.db,N(n)})).then((function(e){return n.db=e,R(n,t._defaultConfig.version)?P(n):e})).then((function(e){n.db=a.db=e,t._dbInfo=n;for(var r=0;r<u.length;r++){var o=u[r];o!==t&&(o._dbInfo.db=n.db,o._dbInfo.version=n.version)}}))}function B(e,t){var n=this;e=d(e);var r=new c((function(t,r){n.ready().then((function(){k(n._dbInfo,y,(function(a,o){if(a)return r(a);try{var i=o.objectStore(n._dbInfo.storeName).get(e);i.onsuccess=function(){var e=i.result;void 0===e&&(e=null),j(e)&&(e=O(e)),t(e)},i.onerror=function(){r(i.error)}}catch(e){r(e)}}))})).catch(r)}));return u(r,t),r}function F(e,t){var n=this,r=new c((function(t,r){n.ready().then((function(){k(n._dbInfo,y,(function(a,o){if(a)return r(a);try{var i=o.objectStore(n._dbInfo.storeName).openCursor(),s=1;i.onsuccess=function(){var n=i.result;if(n){var r=n.value;j(r)&&(r=O(r));var a=e(r,n.key,s++);void 0!==a?t(a):n.continue()}else t()},i.onerror=function(){r(i.error)}}catch(e){r(e)}}))})).catch(r)}));return u(r,t),r}function G(e,t,n){var r=this;e=d(e);var a=new c((function(n,a){var o;r.ready().then((function(){return o=r._dbInfo,"[object Blob]"===v.call(t)?E(o.db).then((function(e){return e?t:C(t)})):t})).then((function(t){k(r._dbInfo,b,(function(o,i){if(o)return a(o);try{var s=i.objectStore(r._dbInfo.storeName);null===t&&(t=void 0);var l=s.put(t,e);i.oncomplete=function(){void 0===t&&(t=null),n(t)},i.onabort=i.onerror=function(){var e=l.error?l.error:l.transaction.error;a(e)}}catch(e){a(e)}}))})).catch(a)}));return u(a,n),a}function U(e,t){var n=this;e=d(e);var r=new c((function(t,r){n.ready().then((function(){k(n._dbInfo,b,(function(a,o){if(a)return r(a);try{var i=o.objectStore(n._dbInfo.storeName).delete(e);o.oncomplete=function(){t()},o.onerror=function(){r(i.error)},o.onabort=function(){var e=i.error?i.error:i.transaction.error;r(e)}}catch(e){r(e)}}))})).catch(r)}));return u(r,t),r}function V(e){var t=this,n=new c((function(e,n){t.ready().then((function(){k(t._dbInfo,b,(function(r,a){if(r)return n(r);try{var o=a.objectStore(t._dbInfo.storeName).clear();a.oncomplete=function(){e()},a.onabort=a.onerror=function(){var e=o.error?o.error:o.transaction.error;n(e)}}catch(e){n(e)}}))})).catch(n)}));return u(n,e),n}function z(e){var t=this,n=new c((function(e,n){t.ready().then((function(){k(t._dbInfo,y,(function(r,a){if(r)return n(r);try{var o=a.objectStore(t._dbInfo.storeName).count();o.onsuccess=function(){e(o.result)},o.onerror=function(){n(o.error)}}catch(e){n(e)}}))})).catch(n)}));return u(n,e),n}function X(e,t){var n=this,r=new c((function(t,r){e<0?t(null):n.ready().then((function(){k(n._dbInfo,y,(function(a,o){if(a)return r(a);try{var i=o.objectStore(n._dbInfo.storeName),s=!1,l=i.openKeyCursor();l.onsuccess=function(){var n=l.result;n?0===e||s?t(n.key):(s=!0,n.advance(e)):t(null)},l.onerror=function(){r(l.error)}}catch(e){r(e)}}))})).catch(r)}));return u(r,t),r}function Y(e){var t=this,n=new c((function(e,n){t.ready().then((function(){k(t._dbInfo,y,(function(r,a){if(r)return n(r);try{var o=a.objectStore(t._dbInfo.storeName).openKeyCursor(),i=[];o.onsuccess=function(){var t=o.result;t?(i.push(t.key),t.continue()):e(i)},o.onerror=function(){n(o.error)}}catch(e){n(e)}}))})).catch(n)}));return u(n,e),n}function H(e,t){t=h.apply(this,arguments);var n=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||n.name,e.storeName=e.storeName||n.storeName);var r,a=this;if(e.name){var o=e.name===n.name&&a._dbInfo.db?c.resolve(a._dbInfo.db):N(e).then((function(t){var n=g[e.name],r=n.forages;n.db=t;for(var a=0;a<r.length;a++)r[a]._dbInfo.db=t;return t}));r=e.storeName?o.then((function(t){if(t.objectStoreNames.contains(e.storeName)){var n=t.version+1;I(e);var r=g[e.name],a=r.forages;t.close();for(var o=0;o<a.length;o++){var s=a[o];s._dbInfo.db=null,s._dbInfo.version=n}var l=new c((function(t,r){var a=i.open(e.name,n);a.onerror=function(e){a.result.close(),r(e)},a.onupgradeneeded=function(){a.result.deleteObjectStore(e.storeName)},a.onsuccess=function(){var e=a.result;e.close(),t(e)}}));return l.then((function(e){r.db=e;for(var t=0;t<a.length;t++){var n=a[t];n._dbInfo.db=e,S(n._dbInfo)}})).catch((function(t){throw(T(e,t)||c.resolve()).catch((function(){})),t}))}})):o.then((function(t){I(e);var n=g[e.name],r=n.forages;t.close();for(var a=0;a<r.length;a++)r[a]._dbInfo.db=null;var o=new c((function(t,n){var r=i.deleteDatabase(e.name);r.onerror=function(){var e=r.result;e&&e.close(),n(r.error)},r.onblocked=function(){},r.onsuccess=function(){var e=r.result;e&&e.close(),t(e)}}));return o.then((function(e){n.db=e;for(var t=0;t<r.length;t++)S(r[t]._dbInfo)})).catch((function(t){throw(T(e,t)||c.resolve()).catch((function(){})),t}))}))}else r=c.reject("Invalid arguments");return u(r,t),r}var W={_driver:"asyncStorage",_initStorage:D,_support:s(),iterate:F,getItem:B,setItem:G,removeItem:U,clear:V,length:z,key:X,keys:Y,dropInstance:H};function q(){return"function"==typeof openDatabase}var $="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",K="~~local_forage_type~",J=/^~~local_forage_type~([^~]+)~/,Q="__lfsc__:",Z=Q.length,ee="arbf",te="blob",ne="si08",re="ui08",ae="uic8",oe="si16",ie="si32",se="ur16",le="ui32",ce="fl32",ue="fl64",fe=Z+ee.length,de=Object.prototype.toString;function he(e){var t,n,r,a,o,i=.75*e.length,s=e.length,l=0;"="===e[e.length-1]&&(i--,"="===e[e.length-2]&&i--);var c=new ArrayBuffer(i),u=new Uint8Array(c);for(t=0;t<s;t+=4)n=$.indexOf(e[t]),r=$.indexOf(e[t+1]),a=$.indexOf(e[t+2]),o=$.indexOf(e[t+3]),u[l++]=n<<2|r>>4,u[l++]=(15&r)<<4|a>>2,u[l++]=(3&a)<<6|63&o;return c}function me(e){var t,n=new Uint8Array(e),r="";for(t=0;t<n.length;t+=3)r+=$[n[t]>>2],r+=$[(3&n[t])<<4|n[t+1]>>4],r+=$[(15&n[t+1])<<2|n[t+2]>>6],r+=$[63&n[t+2]];return n.length%3==2?r=r.substring(0,r.length-1)+"=":n.length%3==1&&(r=r.substring(0,r.length-2)+"=="),r}function pe(e,t){var n="";if(e&&(n=de.call(e)),e&&("[object ArrayBuffer]"===n||e.buffer&&"[object ArrayBuffer]"===de.call(e.buffer))){var r,a=Q;e instanceof ArrayBuffer?(r=e,a+=ee):(r=e.buffer,"[object Int8Array]"===n?a+=ne:"[object Uint8Array]"===n?a+=re:"[object Uint8ClampedArray]"===n?a+=ae:"[object Int16Array]"===n?a+=oe:"[object Uint16Array]"===n?a+=se:"[object Int32Array]"===n?a+=ie:"[object Uint32Array]"===n?a+=le:"[object Float32Array]"===n?a+=ce:"[object Float64Array]"===n?a+=ue:t(new Error("Failed to get type for BinaryArray"))),t(a+me(r))}else if("[object Blob]"===n){var o=new FileReader;o.onload=function(){var n=K+e.type+"~"+me(this.result);t(Q+te+n)},o.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(e){t(null,e)}}function ge(e){if(e.substring(0,Z)!==Q)return JSON.parse(e);var t,n=e.substring(fe),r=e.substring(Z,fe);if(r===te&&J.test(n)){var a=n.match(J);t=a[1],n=n.substring(a[0].length)}var o=he(n);switch(r){case ee:return o;case te:return l([o],{type:t});case ne:return new Int8Array(o);case re:return new Uint8Array(o);case ae:return new Uint8ClampedArray(o);case oe:return new Int16Array(o);case se:return new Uint16Array(o);case ie:return new Int32Array(o);case le:return new Uint32Array(o);case ce:return new Float32Array(o);case ue:return new Float64Array(o);default:throw new Error("Unkown type: "+r)}}var ve={serialize:pe,deserialize:ge,stringToBuffer:he,bufferToString:me};function ye(e,t,n,r){e.executeSql("CREATE TABLE IF NOT EXISTS "+t.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],n,r)}function be(e){var t=this,n={db:null};if(e)for(var r in e)n[r]="string"!=typeof e[r]?e[r].toString():e[r];var a=new c((function(e,r){try{n.db=openDatabase(n.name,String(n.version),n.description,n.size)}catch(e){return r(e)}n.db.transaction((function(a){ye(a,n,(function(){t._dbInfo=n,e()}),(function(e,t){r(t)}))}),r)}));return n.serializer=ve,a}function xe(e,t,n,r,a,o){e.executeSql(n,r,a,(function(e,i){i.code===i.SYNTAX_ERR?e.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[t.storeName],(function(e,s){s.rows.length?o(e,i):ye(e,t,(function(){e.executeSql(n,r,a,o)}),o)}),o):o(e,i)}),o)}function we(e,t){var n=this;e=d(e);var r=new c((function(t,r){n.ready().then((function(){var a=n._dbInfo;a.db.transaction((function(n){xe(n,a,"SELECT * FROM "+a.storeName+" WHERE key = ? LIMIT 1",[e],(function(e,n){var r=n.rows.length?n.rows.item(0).value:null;r&&(r=a.serializer.deserialize(r)),t(r)}),(function(e,t){r(t)}))}))})).catch(r)}));return u(r,t),r}function Ee(e,t){var n=this,r=new c((function(t,r){n.ready().then((function(){var a=n._dbInfo;a.db.transaction((function(n){xe(n,a,"SELECT * FROM "+a.storeName,[],(function(n,r){for(var o=r.rows,i=o.length,s=0;s<i;s++){var l=o.item(s),c=l.value;if(c&&(c=a.serializer.deserialize(c)),void 0!==(c=e(c,l.key,s+1)))return void t(c)}t()}),(function(e,t){r(t)}))}))})).catch(r)}));return u(r,t),r}function Ie(e,t,n,r){var a=this;e=d(e);var o=new c((function(o,i){a.ready().then((function(){void 0===t&&(t=null);var s=t,l=a._dbInfo;l.serializer.serialize(t,(function(t,c){c?i(c):l.db.transaction((function(n){xe(n,l,"INSERT OR REPLACE INTO "+l.storeName+" (key, value) VALUES (?, ?)",[e,t],(function(){o(s)}),(function(e,t){i(t)}))}),(function(t){if(t.code===t.QUOTA_ERR){if(r>0)return void o(Ie.apply(a,[e,s,n,r-1]));i(t)}}))}))})).catch(i)}));return u(o,n),o}function Se(e,t,n){return Ie.apply(this,[e,t,n,1])}function Te(e,t){var n=this;e=d(e);var r=new c((function(t,r){n.ready().then((function(){var a=n._dbInfo;a.db.transaction((function(n){xe(n,a,"DELETE FROM "+a.storeName+" WHERE key = ?",[e],(function(){t()}),(function(e,t){r(t)}))}))})).catch(r)}));return u(r,t),r}function _e(e){var t=this,n=new c((function(e,n){t.ready().then((function(){var r=t._dbInfo;r.db.transaction((function(t){xe(t,r,"DELETE FROM "+r.storeName,[],(function(){e()}),(function(e,t){n(t)}))}))})).catch(n)}));return u(n,e),n}function Ne(e){var t=this,n=new c((function(e,n){t.ready().then((function(){var r=t._dbInfo;r.db.transaction((function(t){xe(t,r,"SELECT COUNT(key) as c FROM "+r.storeName,[],(function(t,n){var r=n.rows.item(0).c;e(r)}),(function(e,t){n(t)}))}))})).catch(n)}));return u(n,e),n}function Pe(e,t){var n=this,r=new c((function(t,r){n.ready().then((function(){var a=n._dbInfo;a.db.transaction((function(n){xe(n,a,"SELECT key FROM "+a.storeName+" WHERE id = ? LIMIT 1",[e+1],(function(e,n){var r=n.rows.length?n.rows.item(0).key:null;t(r)}),(function(e,t){r(t)}))}))})).catch(r)}));return u(r,t),r}function Re(e){var t=this,n=new c((function(e,n){t.ready().then((function(){var r=t._dbInfo;r.db.transaction((function(t){xe(t,r,"SELECT key FROM "+r.storeName,[],(function(t,n){for(var r=[],a=0;a<n.rows.length;a++)r.push(n.rows.item(a).key);e(r)}),(function(e,t){n(t)}))}))})).catch(n)}));return u(n,e),n}function Ce(e){return new c((function(t,n){e.transaction((function(r){r.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],(function(n,r){for(var a=[],o=0;o<r.rows.length;o++)a.push(r.rows.item(o).name);t({db:e,storeNames:a})}),(function(e,t){n(t)}))}),(function(e){n(e)}))}))}function Oe(e,t){t=h.apply(this,arguments);var n=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||n.name,e.storeName=e.storeName||n.storeName);var r,a=this;return r=e.name?new c((function(t){var r;r=e.name===n.name?a._dbInfo.db:openDatabase(e.name,"","",0),e.storeName?t({db:r,storeNames:[e.storeName]}):t(Ce(r))})).then((function(e){return new c((function(t,n){e.db.transaction((function(r){function a(e){return new c((function(t,n){r.executeSql("DROP TABLE IF EXISTS "+e,[],(function(){t()}),(function(e,t){n(t)}))}))}for(var o=[],i=0,s=e.storeNames.length;i<s;i++)o.push(a(e.storeNames[i]));c.all(o).then((function(){t()})).catch((function(e){n(e)}))}),(function(e){n(e)}))}))})):c.reject("Invalid arguments"),u(r,t),r}var je={_driver:"webSQLStorage",_initStorage:be,_support:q(),iterate:Ee,getItem:we,setItem:Se,removeItem:Te,clear:_e,length:Ne,key:Pe,keys:Re,dropInstance:Oe};function Le(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(e){return!1}}function Ae(e,t){var n=e.name+"/";return e.storeName!==t.storeName&&(n+=e.storeName+"/"),n}function ke(){var e="_localforage_support_test";try{return localStorage.setItem(e,!0),localStorage.removeItem(e),!1}catch(e){return!0}}function Me(){return!ke()||localStorage.length>0}function De(e){var t=this,n={};if(e)for(var r in e)n[r]=e[r];return n.keyPrefix=Ae(e,t._defaultConfig),Me()?(t._dbInfo=n,n.serializer=ve,c.resolve()):c.reject()}function Be(e){var t=this,n=t.ready().then((function(){for(var e=t._dbInfo.keyPrefix,n=localStorage.length-1;n>=0;n--){var r=localStorage.key(n);0===r.indexOf(e)&&localStorage.removeItem(r)}}));return u(n,e),n}function Fe(e,t){var n=this;e=d(e);var r=n.ready().then((function(){var t=n._dbInfo,r=localStorage.getItem(t.keyPrefix+e);return r&&(r=t.serializer.deserialize(r)),r}));return u(r,t),r}function Ge(e,t){var n=this,r=n.ready().then((function(){for(var t=n._dbInfo,r=t.keyPrefix,a=r.length,o=localStorage.length,i=1,s=0;s<o;s++){var l=localStorage.key(s);if(0===l.indexOf(r)){var c=localStorage.getItem(l);if(c&&(c=t.serializer.deserialize(c)),void 0!==(c=e(c,l.substring(a),i++)))return c}}}));return u(r,t),r}function Ue(e,t){var n=this,r=n.ready().then((function(){var t,r=n._dbInfo;try{t=localStorage.key(e)}catch(e){t=null}return t&&(t=t.substring(r.keyPrefix.length)),t}));return u(r,t),r}function Ve(e){var t=this,n=t.ready().then((function(){for(var e=t._dbInfo,n=localStorage.length,r=[],a=0;a<n;a++){var o=localStorage.key(a);0===o.indexOf(e.keyPrefix)&&r.push(o.substring(e.keyPrefix.length))}return r}));return u(n,e),n}function ze(e){var t=this.keys().then((function(e){return e.length}));return u(t,e),t}function Xe(e,t){var n=this;e=d(e);var r=n.ready().then((function(){var t=n._dbInfo;localStorage.removeItem(t.keyPrefix+e)}));return u(r,t),r}function Ye(e,t,n){var r=this;e=d(e);var a=r.ready().then((function(){void 0===t&&(t=null);var n=t;return new c((function(a,o){var i=r._dbInfo;i.serializer.serialize(t,(function(t,r){if(r)o(r);else try{localStorage.setItem(i.keyPrefix+e,t),a(n)}catch(e){"QuotaExceededError"!==e.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==e.name||o(e),o(e)}}))}))}));return u(a,n),a}function He(e,t){if(t=h.apply(this,arguments),!(e="function"!=typeof e&&e||{}).name){var n=this.config();e.name=e.name||n.name,e.storeName=e.storeName||n.storeName}var r,a=this;return r=e.name?new c((function(t){e.storeName?t(Ae(e,a._defaultConfig)):t(e.name+"/")})).then((function(e){for(var t=localStorage.length-1;t>=0;t--){var n=localStorage.key(t);0===n.indexOf(e)&&localStorage.removeItem(n)}})):c.reject("Invalid arguments"),u(r,t),r}var We={_driver:"localStorageWrapper",_initStorage:De,_support:Le(),iterate:Ge,getItem:Fe,setItem:Ye,removeItem:Xe,clear:Be,length:ze,key:Ue,keys:Ve,dropInstance:He},qe=function(e,t){return e===t||"number"==typeof e&&"number"==typeof t&&isNaN(e)&&isNaN(t)},$e=function(e,t){for(var n=e.length,r=0;r<n;){if(qe(e[r],t))return!0;r++}return!1},Ke=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},Je={},Qe={},Ze={INDEXEDDB:W,WEBSQL:je,LOCALSTORAGE:We},et=[Ze.INDEXEDDB._driver,Ze.WEBSQL._driver,Ze.LOCALSTORAGE._driver],tt=["dropInstance"],nt=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(tt),rt={description:"",driver:et.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function at(e,t){e[t]=function(){var n=arguments;return e.ready().then((function(){return e[t].apply(e,n)}))}}function ot(){for(var e=1;e<arguments.length;e++){var t=arguments[e];if(t)for(var n in t)t.hasOwnProperty(n)&&(Ke(t[n])?arguments[0][n]=t[n].slice():arguments[0][n]=t[n])}return arguments[0]}var it=function(){function e(t){for(var n in a(this,e),Ze)if(Ze.hasOwnProperty(n)){var r=Ze[n],o=r._driver;this[n]=o,Je[o]||this.defineDriver(r)}this._defaultConfig=ot({},rt),this._config=ot({},this._defaultConfig,t),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch((function(){}))}return e.prototype.config=function(e){if("object"===(void 0===e?"undefined":r(e))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var t in e){if("storeName"===t&&(e[t]=e[t].replace(/\W/g,"_")),"version"===t&&"number"!=typeof e[t])return new Error("Database version must be a number.");this._config[t]=e[t]}return!("driver"in e)||!e.driver||this.setDriver(this._config.driver)}return"string"==typeof e?this._config[e]:this._config},e.prototype.defineDriver=function(e,t,n){var r=new c((function(t,n){try{var r=e._driver,a=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!e._driver)return void n(a);for(var o=nt.concat("_initStorage"),i=0,s=o.length;i<s;i++){var l=o[i];if((!$e(tt,l)||e[l])&&"function"!=typeof e[l])return void n(a)}var f=function(){for(var t=function(e){return function(){var t=new Error("Method "+e+" is not implemented by the current driver"),n=c.reject(t);return u(n,arguments[arguments.length-1]),n}},n=0,r=tt.length;n<r;n++){var a=tt[n];e[a]||(e[a]=t(a))}};f();var d=function(n){Je[r],Je[r]=e,Qe[r]=n,t()};"_support"in e?e._support&&"function"==typeof e._support?e._support().then(d,n):d(!!e._support):d(!0)}catch(e){n(e)}}));return f(r,t,n),r},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(e,t,n){var r=Je[e]?c.resolve(Je[e]):c.reject(new Error("Driver not found."));return f(r,t,n),r},e.prototype.getSerializer=function(e){var t=c.resolve(ve);return f(t,e),t},e.prototype.ready=function(e){var t=this,n=t._driverSet.then((function(){return null===t._ready&&(t._ready=t._initDriver()),t._ready}));return f(n,e,e),n},e.prototype.setDriver=function(e,t,n){var r=this;Ke(e)||(e=[e]);var a=this._getSupportedDrivers(e);function o(){r._config.driver=r.driver()}function i(e){return r._extend(e),o(),r._ready=r._initStorage(r._config),r._ready}function s(e){return function(){var t=0;function n(){for(;t<e.length;){var a=e[t];return t++,r._dbInfo=null,r._ready=null,r.getDriver(a).then(i).catch(n)}o();var s=new Error("No available storage method found.");return r._driverSet=c.reject(s),r._driverSet}return n()}}var l=null!==this._driverSet?this._driverSet.catch((function(){return c.resolve()})):c.resolve();return this._driverSet=l.then((function(){var e=a[0];return r._dbInfo=null,r._ready=null,r.getDriver(e).then((function(e){r._driver=e._driver,o(),r._wrapLibraryMethodsWithReady(),r._initDriver=s(a)}))})).catch((function(){o();var e=new Error("No available storage method found.");return r._driverSet=c.reject(e),r._driverSet})),f(this._driverSet,t,n),this._driverSet},e.prototype.supports=function(e){return!!Qe[e]},e.prototype._extend=function(e){ot(this,e)},e.prototype._getSupportedDrivers=function(e){for(var t=[],n=0,r=e.length;n<r;n++){var a=e[n];this.supports(a)&&t.push(a)}return t},e.prototype._wrapLibraryMethodsWithReady=function(){for(var e=0,t=nt.length;e<t;e++)at(this,nt[e])},e.prototype.createInstance=function(t){return new e(t)},e}(),st=new it;t.exports=st},{3:3}]},{},[4])(4);
/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/globalThis.setLobbyName=e=>{c.lobbyName=e},globalThis.disableNetwork=()=>{c.disableNet=!0},globalThis.setLoadingEvent=e=>{l.loadingEvent=e},globalThis.setBaseURL=e=>{globalThis.BASE_URL=e};let Bn=!1;async function Fn(){function e(t){globalThis.setCheckGameEvent?(globalThis.setCheckGameEvent({getIP:An.getIP,setLoadingEvent:globalThis.setLoadingEvent,setBaseURL:globalThis.setBaseURL}),globalThis.parent.isCheckGameCDN&&(globalThis.disableNetwork(),globalThis.CDN_LIST=[]),t()):setTimeout((()=>{e(t)}),100)}if(globalThis.parent!==globalThis)return c.isCheckGameCDN=globalThis.parent.isCheckGameCDN,l.isCheckGameCDN=c.isCheckGameCDN,new Promise((t=>{globalThis.parent.isCheckGameCDN||globalThis.parent.isGameManager?e(t):t()}))}!async function(){let{start:e,checkCDN:t}=await import("./agent.82d551a2.js");await e();let n=c;n.res&&("v1"===n.res?n.useAvif=!1:"v2"===n.res&&(n.useAvif=!0));let r="common";An.log({label:r,category:"啟動程式"});let o={category:"初始化 主網址",getLabel:()=>"common"};if(An.loadBegin(o),"check"===n.lobbyName)try{await Fn()}catch(e){}try{await async function(){let e=null;if(c.useCache){if(navigator.serviceWorker&&navigator.serviceWorker.register)return e=await navigator.serviceWorker.register("/lib.sw.js",{scope:"/"}),c.registration=e,c.hasCache=!0,e.addEventListener("updatefound",(function(){e.update();let t=e.installing;t.addEventListener("statechange",(()=>{"installed"===t.state&&globalThis.location.reload()}))})),navigator.serviceWorker.addEventListener("message",(e=>{})),new Promise((t=>{!function(){if(e&&e.active&&navigator.serviceWorker.controller){let e={};e.config={BASE_URL:globalThis.BASE_URL,CDN_LIST:globalThis.CDN_LIST},navigator.serviceWorker.controller.postMessage(e),t()}else t()}()}))}else navigator.serviceWorker&&navigator.serviceWorker.register&&(e=await navigator.serviceWorker.register("/lib.sw.js?v=2.0.0",{scope:"/"}),e&&e.unregister&&await e.unregister())}()}catch(e){}An.log({eventName:n.hasCache?"使用":"不使用",label:r,category:"確認快取功能"});let i=null,s=null;try{await Dn.setDriver(Dn.LOCALSTORAGE),s=Dn.createInstance({name:"mygames",storeName:"agent2"}),s&&(n.isCheckGameCDN||a||(i=await s.getItem("baseURL"))),n.store=s}catch(e){}if(i)globalThis.BASE_URL=i,An.report.currentURL=i,n.selectCDN=!0;else if(!n.hasCache)try{await t()}catch(e){}An.log({eventName:n.hasCDN?"使用":"不使用",label:r,category:"確認服務線路"});try{const{Howl:e,Howler:r,IsMobile:a,m:o,nuts:i,component:s,load:l}=await import("./agent.15c09e3b.js");await l(),globalThis.Howl=e,globalThis.Howler=r,globalThis.Howler&&(globalThis.Howler.autoSuspend=!1),globalThis.isMobile=a(globalThis.navigator.userAgent);let c=[],u={PIXI:globalThis.PIXI,m:o,io:globalThis.io,Stats:null,plugin:c};await i.init(u);let f=i.ui.loading,d=async e=>{let t=await e.get(n.langID);n.images=t.images,t.images&&t.images.loading&&f.setScene(t.images.loading)};if(n.useAvif?import("./agent.0efb1037.js").then((e=>{d(e)})):await import("./agent.caf9ca6f.js").then((e=>{d(e)})),Bn)return;Bn=!0;let h=globalThis.createjs.Ticker;h.timingMode=h.TIMEOUT,s.run({checkCDN:t,element:document.body})}catch(e){}An.loadEnd(o),An.log({label:r,category:"初始化 主網址"})}();export{e as G,nt as L,n as M,t as O,r as T,i as a,_n as b,m as c,l as d,u as e,h as f,o as g,a as i,Dn as l,Ne as m,Pn as n,s as o,An as r,c as s,Qe as u};
