import e from"mithril";import{f as n,j as r,b as o,k as a,C as t,l as i}from"./agent.9b975543.js";import*as c from"nuts";import{r as d,a as l,s,d as m}from"./agent.95d98b24.js";import{C as g,n as h,a as G}from"./agent.1a95efd2.js";import"./agent.88ba4f34.js";let p=!0,u={handle(){if(!p)return;p=!1;let a=m;a.state="已連線",e.redraw(),n(),d.serviceBegin(g.report);let t=r(),i=l.info;t.login(i),c.updateManager.setTimeout((function(){a.isError||a.isLogin||o({title:"errorLow",msg:"disconnect"})}),s.commandTimeout)}},f={handle(){}},w={handle(e){}},b={handle(){},error:a.low},x={handle(e){},error:a.low},M={},j=null,T=!0,C={game(){h&&T&&(T=!1)}};function L(e){M.connect=e.connect||M.connect,M.disconnect=e.disconnect||M.disconnect,M.disconnectMsg=e.disconnectMsg||M.disconnectMsg,M.reconnect=e.reconnect||M.reconnect,M.broadcast=e.broadcast||M.broadcast,M.login=e.login||M.login,M.relogin=e.relogin||M.relogin,M.inGame=e.inGame||M.inGame,M.toGame=e.toGame||M.toGame,M.exitGame=e.exitGame||M.exitGame}function k(){return j||(j={connect:{handle(e){u.handle(e),M.connect&&M.connect.handle(e)}},login:{handle(e){g.handle(e),M.login&&M.login.handle(e)},error:g.error},relogin:{handle(e){g.handle(e),M.relogin&&M.relogin.handle(e)},error:g.error},inGame:{handle(e){t.handle(e),M.inGame&&M.inGame.handle(e)},error:t.error},toGame:{handle(e){M.toGame&&M.toGame.handle(e)},error:b.error},exitGame:{handle(e){x.handle(e),M.exitGame&&M.exitGame.handle(e)},error:x.error},broadcast:{handle(e){G.handle(e),M.broadcast&&M.broadcast.handle(e)}},ping:{handle(){},error:a.low},pong:{handle(n){s.ping?(l.ping=n,s.msg="ping:"+n,e.redraw()):s.msg=""},error:a.low},reconnect:{handle(e){f.handle(e),M.reconnect&&M.reconnect.handle(e)},error:a.low},disconnectMsg:{handle(n){s.ping&&(s.msg="disconnect:"+(new Date).toTimeString(),e.redraw()),w.handle(n),M.disconnectMsg&&M.disconnectMsg.handle(n)}},disconnect:{handle(e){i.handle(e),M.disconnect&&M.disconnect.handle(e)}}}),j}function v(){return C}export{k as getCommandList,v as getSendEvent,T as isFirst,L as setEvent};
