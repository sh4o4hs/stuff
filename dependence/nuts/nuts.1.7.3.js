define(["exports"],function(e){"use strict";var t=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},n=null;function r(e){n=e.io}var a=function e(r){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";t(this,e);var i={event:r&&r.event,socket:null,cmdList:r&&r.commandList,isConnect:!1,host:r&&r.host,roomName:a};this.isConnect=function(){return i.isConnect},this.setHost=function(e){return i.host=e},this.setCommandList=function(e){return i.cmdList=e},this.registerCommand=function(e,t){var n=i.socket;n&&n.on(e,t)},this.sendCommand=function(e,t){var n=i.socket;n&&n.compress(!0).emit(e,t)},this.setEvent=function(e){i.event=e},this.connect=function(e){var t=void 0,r=i.cmdList;if(i.socket)return!1;t=n.connect(i.host+i.roomName,{pingTimeout:15e3,pingInterval:3e4,secure:!0,transports:["websocket"]});var a={};(e?(i.event=e,a.connect=e.connect,a.disconnect=e.disconnect):i.event&&(a.connect=i.event.connect,a.disconnect=i.event.disconnect),i.socket=t,t.on("connect",function(){i.isConnect=!0,a.connect&&(a.connect(),a.connect=null)}),t.on("disconnect",function(){i.isConnect=!1,a.disconnect&&(a.disconnect(),a.disconnect=null)}),r)&&Object.getOwnPropertyNames(r).forEach(function(e){t.on(e,r[e])});return!0},this.disconnect=function(){var e=i.socket;e&&e.disconnect()}},i=Object.freeze({init:r,Network:a}),o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},c=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},u=void 0,l=void 0,f=void 0,h=function(){function e(){t(this,e)}return o(e,null,[{key:"init",value:function(e){u=e.CMD,l=e.RESULT,f=e.STATE}},{key:"create",value:function(e){var t,n=e.lobbyBuffer,r=e.gameBuffer,a=null,i={cmdList:null,gameProc:null,setEventMap:function(e){a=e}};t=function(e){var t={},o=e.gameEvent;return t.checkData=function(e,t,n,r){var a=f.OK;return t.resultCode!==l.OK?(a=f.ERROR,r&&r.error&&r.error(t)):r&&r.handle&&r.handle(t),a},t.gameProc=function(e){var t=o[e.gid];t&&t.recvGameData&&t.recvGameData(e.packet)},t.broadcastProc=function(e){Object.getOwnPropertyNames(o).forEach(function(t){var n=o[t];n&&n.recvBroadcast&&n.recvBroadcast(e)})},i.gameProc=t.gameProc,{connect:function(e){var t=a&&a.connect;t&&t.handle&&t.handle(e)},reconnect:function(e){var t=a&&a.reconnect;t&&t.handle&&t.handle(e)},login:function(r){var i=a&&a.login;t.checkData(u.LOGIN,r,n,i)&&(e.connectionToken=r.connectionToken)},relogin:function(r){var i=a&&a.relogin;t.checkData(u.RELOGIN,r,n,i)&&(e.connectionToken=r.connectionToken)},inGame:function(e){var r=a&&a.inGame;t.checkData(u.IN_GAME,e,n,r)},exitGame:function(e){var r=a&&a.exitGame;t.checkData(u.EXIT_GAME,e,n,r)},toGame:function(e){var n=a&&a.toGame;t.checkData(u.TO_GAME,e,r,n),t.gameProc(e)},broadCastMsg:function(e){var n=a&&a.broadcast;n&&n.handle&&n.handle(e),t.broadcastProc(e)},ping:function(e){var t=a&&a.ping;t&&t.handle&&t.handle(e)},pong:function(e){var t=a&&a.pong;t&&t.handle&&t.handle(e)},disconnectMsg:function(e){var t=a&&a.disconnectMsg;t&&t.handle&&t.handle(e)},disconnect:function(e){var t=a&&a.disconnect;t&&t.handle&&t.handle(e)}}}(e),i.cmdList=t,e.commandManager=i}}]),e}(),d=null,m=[],p=[],v=!1;function g(e){var t=!1;return e&&e.update&&(e.hasOwnProperty("__updateIndex")||(e.__updateIndex=m.length,m.push(e),t=!0)),t}function y(e){var t=void 0,n=m.length,r=void 0;if("number"==typeof e.__updateIndex){if((t=e.__updateIndex)>=0&&t<n){var a=n-1;r=m[a],m[t]=r,r.__updateIndex=t,m.splice(a,1)}delete e.__updateIndex}}function b(e,t){var n={currentTime:0,func:e,update:function(e){n.currentTime+=e,n.currentTime>=t&&(n.func&&n.func(n.currentTime),n.currentTime=0)}};return g(n),n}function x(e){e&&e.update&&(p.push(e),v=!0)}function E(){m.forEach(function(e){delete e.__updateIndex}),m=[]}var I=-1;function S(e){var t=.001*performance.now(),n=void 0;e.paused||(I<0?(n=0,I=t):(n=t-I,I=t),function(e){v&&(p.forEach(function(t){t.update(e),t.pause&&t.pause()}),p=[],v=!1),m.forEach(function(t){t.update(e)})}(n))}var T=!1,P=!1;function k(){P||(P=!0,(d=createjs.Ticker).timingMode=d.RAF,d.interval=1e3/60,d.addEventListener("tick",S),E())}function w(){T||(T=!0,I=-1,d.paused=!1)}var _=Object.freeze({add:g,remove:y,setTimeout:function(e,t){var n={currentTime:0,func:e,update:function(e){n.currentTime>=t&&(y(n),n.func&&n.func(n.currentTime)),n.currentTime+=e}};return g(n),n},setInterval:b,clearInterval:function(e){y(e)},once:x,reset:E,init:k,play:w,pause:function(){T&&(T=!1,d.paused=!0)}}),O="login",R="relogin",C="toGame",j={ERROR:"error",CONNECT:"connect",RECONNECT:"reconnect",LOGIN:O,RELOGIN:R,IN_GAME:"inGame",EXIT_GAME:"exitGame",TO_GAME:C,BROADCAST:"broadCastMsg",DISCONNECT_MSG:"disconnectMsg",DISCONNECT:"disconnect"},N={ERROR:0,OK:1},L={SEND_LOCK:-3,CONNECT_TIMEOUT:-2,BUFFER_FULL:-1,ERROR:0,OK:1,LOGIN:3,ROOM:4,CONNECT:2},A=function(e){function n(e,r){t(this,n);var a={gameEvent:{},sendEvent:{},commandManager:null,connectionToken:null,timer:null,login:null,game:{configMap:{},template:null},lobbyBuffer:{sendCommandList:[],token:null},gameBuffer:{sendCommandList:[],token:null}},i=e.Loader,o=s(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e,r)),c=o;return h.init({CMD:j,RESULT:N,STATE:L}),a.timer||(a.timer=b(function(){var e=a.lobbyBuffer,t=a.gameBuffer,n=e.sendCommandList,r=void 0;n.length>0&&(r=n.shift(),c.sendLobbyCommand(r)),(n=t.sendCommandList).length>0&&(r=n.shift(),c.sendGameCommand(r))},.2)),o.init=function(e,t){var n={},r=new i;if(h.create(a),c.setCommandList(a.commandManager.cmdList),e){if(e.gameTemplate)Object.getOwnPropertyNames(e.gameTemplate).forEach(function(t){r.add(t,e.gameTemplate[t]),n[t]=!0});e.login&&r.add("login",e.login),e.gameList&&r.add("gamelist",e.gameList),r.load(function(e,r){r&&(a.game.template={},Object.getOwnPropertyNames(n).forEach(function(e){r[e]&&(a.game.template[e]=r[e].data)}),r.login&&(a.login=JSON.parse(r.login.data)),r.gamelist&&JSON.parse(r.gamelist.data).forEach(function(e){a.game.configMap[e.id]=e}));a.login&&a.login.server&&a.login.server.host&&c.setHost(a.login.server.host),t&&t({login:a.login})})}else t&&t({login:null})},o.getGame=function(){return a.game},o.getCommandManager=function(){return a.commandManager},o.gameProc=function(e){a.commandManager&&a.commandManager.gameProc(e)},o.setEventMap=function(e){a.commandManager&&a.commandManager.setEventMap(e)},o.setSendEvent=function(e){a.sendEvent.game=e.game},o.login=function(e){var t={token:e.token};c.sendCommand(O,t)},o.relogin=function(){var e={connectionToken:a.connectionToken};c.sendCommand(R,e)},o.registerGameEvent=function(e,t){t&&(a.gameEvent[t]=e)},o.unregisterGameEvent=function(e){a.gameEvent[e]=null},o.setLobbyCommand=function(e,t){return a.lobbyBuffer.sendCommandList.push({name:e,data:t}),L.OK},o.sendLobbyCommand=function(e){c.sendCommand(e.name,e.data)},o.setGameCommand=function(e,t){return a.gameBuffer.sendCommandList.push({gid:t,packet:e}),L.OK},o.sendGameCommand=function(e){var t={gid:e.gid,packet:e.packet};c.sendCommand(C,t),a.sendEvent.game&&a.sendEvent.game(e.gid)},o}return c(n,a),o(n,null,[{key:"STATE",get:function(){return L}},{key:"CMD",get:function(){return j}},{key:"RESULT",get:function(){return N}}]),n}(),M=function e(t,n,r){null===t&&(t=Function.prototype);var a=Object.getOwnPropertyDescriptor(t,n);if(void 0===a){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in a)return a.value;var o=a.get;return void 0!==o?o.call(r):void 0};function F(e){return function(n){function r(e){t(this,r);var n=s(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e,!1));return n.cloneIndex=0,n}return c(r,e),o(r,[{key:"clone",value:function(){this.cloneIndex+=1}},{key:"addToScene",value:function(e){e.addChild(this)}},{key:"removeFromScene",value:function(){this.parent&&this.parent.removeChild(this)}}]),r}()}var B=function(){function e(){t(this,e),this.cloneIndex=0}return o(e,[{key:"clone",value:function(){this.cloneIndex+=1}},{key:"addToScene",value:function(e){e.addChild(this)}},{key:"removeFromScene",value:function(){this.parent&&this.parent.removeChild(this)}}]),e}(),D=Object.freeze({debug:function(e,t){var n=e.getBounds(),r=e.graphics;if(!r){var a=e.anchor;r=new t.Graphics,e.graphics=r,e.addChild(r),r.x=0,r.y=0,r.lineStyle(1,16777215,1),r.beginFill(65280,.15),r.drawRect(-n.width*a.x,-n.height*a.y,n.width,n.height),r.endFill()}},make:F,default:B}),G="animation",V=null;var U="button",Y=null;var X="group",H=null;var z="image",K=null;var J="spine",q=null;var $="bone",Q=null,W=null;var Z="digit",ee={CHAR_MAP:["0","1","2","3","4","5","6","7","8","9","."],DISPLAY:{TRANSVERSE:1,STRAIGHT:2},ALIGN_TYPE:{POS:1,RECT:2},OFFSET_TYPE:{STATIC:1,DYNAMIC:2},HORI_ALIGN:{LEFT:1,CENTER:2,RIGHT:3},VERTI_ALIGN:{TOP:1,CENTER:2,BOTTOM:3}},te=null;var ne="scrollbar",re=null;var ae="text",ie=null;var oe="particle",se={demo:{alpha:{start:1,end:0},scale:{start:.1,end:1.5},color:{start:"ffffff",end:"ffffff"},speed:{start:600,end:200},startRotation:{min:0,max:360},rotationSpeed:{min:0,max:20},lifetime:{min:.5,max:.7},blendMode:"normal",frequency:16e-6,emitterLifetime:-1,maxParticles:100,pos:{x:0,y:0},addAtBack:!1,spawnType:"point"}},ce=null;var ue=null,le=null,fe=null,he="config",de="sound",me="texture",pe="object",ve="asset",ge="spine",ye="bones",be={INFO:"info",GROUP:"group",SCROLLBAR:"scrollbar",BACKGROUND:"background",PARTICLE:"particle",TEXT:"text",IMAGE:"image",SPINE:"spine",BONE:"bone",ANMIMATION:"animation",NUMBER:"number",BUTTON:"button"},xe={event:{resBegin:null,resEnd:null,sceneResBegin:null,SceneResLoading:null,SceneResEnd:null},state:null,game:null,baseURL:"",base:0,baseProgress:0,baseIndex:0,baseMax:0,objectFactory:{},isBusy:!1,textures:null,spines:null,bonesFactory:null,soundMapList:[]},Ee=function(e){var t=xe.textures,n=e&&e.split(".");return n&&n.every(function(e){var n=t[e];return!!n&&(t=n,!0)}),t},Ie=function(e){var t={};return t.conf=e,t.name=e.name,t.objName=e.objName,t};function Se(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#000000";return PIXI.Texture.Draw(function(e){t?(e.width=t.width||140,e.height=t.height||40):(e.width=100,e.height=24);var r=e.getContext("2d");r.strokeStyle=n,r.strokeRect(0,0,e.width,e.height),r.fillStyle="#FFFFFF",r.fillRect(0,0,2,2),r.fillRect(e.width-2,0,2,2),r.fillRect(0,e.height-2,2,2),r.fillRect(e.width-2,e.height-2,2,2),r.beginPath(),r.lineCap="round",r.moveTo(0,0),r.lineTo(e.width,e.height),r.moveTo(e.width,0),r.lineTo(0,e.height),r.stroke(),r.fillStyle="#FFFFFF";var a=e.width/2,i=e.height/2;r.fillRect(a,i,2,2)})}var Te=function(e,t){var n=null,r=e.resource.group,a=e.resource.name,i=e.pos||{x:0,y:0},o=Ee(r)[a];if(e.debug){var s=Se(e.name,e);Array.isArray(o)||(o=[o]),o.push(s)}var c=ce.getConfig(e.config.name);return o&&c&&(n=new ce({game:t,conf:e,name:e.name,objName:e.objName,isInScene:e.isInScene,setting:{type:e.type,config:c,art:o,useParticleContainer:e.useParticleContainer},pos:i})),n},Pe=function(e,t){var n,r,a,i=e.pos||{x:0,y:0},o=(n=e.resource.spineData,r=xe.spines,(a=n&&n.split("."))&&a.every(function(e){var t=r[e];return!!t&&(r=t,!0)}),r),s=Ee(e.resource.texture);return new q({game:t,conf:e,name:e.name,objName:e.objName,isInScene:e.isInScene,spineDataGroup:o,textureGroup:s,pos:i})},ke=function(e,t){var n=e.pos||{x:0,y:0},r={},a={timeScale:1};return e.resource&&"string"==typeof e.resource.name&&(r.name=e.resource.name),e.animation&&(a.name=e.animation.name,a.timeScale=e.animation.timeScale),new W({game:t,conf:e,name:e.name,objName:e.objName,resource:r,animation:a,isInScene:e.isInScene,pos:n})},we=function(e,t){var n=void 0,r=e.pos||{x:0,y:0},a=xe.objectFactory;return n=new H({game:t,conf:e,name:e.name,objName:e.objName,isInScene:e.isInScene,pivot:e.pivot,pos:r}),e.childList&&e.childList.forEach(function(e){var r=a[e.type],i=void 0;r&&(i=r(e,t))&&(e.isInScene&&i&&n.addChild(i),n.childList.push(i))}),n},_e=function(e,t){var n=e.pos||{x:0,y:0},r=e.anchor||{x:0,y:0};return new ie({game:t,conf:e,name:e.name,objName:e.objName,isInScene:e.isInScene,pos:n,anchor:r,text:e.text||"文字訊息"})},Oe=function(e,t){var n=e.resource,r=n.group,a=Ee(r),i=PIXI.Texture.EMPTY,o=PIXI.Texture.EMPTY;return e.debug?o=Se(e.name,e):a&&(i=a[n.slider]||i,o=a[n.background]||o),new re({game:t,conf:e,name:e.name,objName:e.objName,isInScene:e.isInScene,pos:e.pos,anchor:e.anchor,slider:i,background:o})},Re=function(e,t){var n=e.resource.group,r=e.resource.name,a=e.pos||{x:0,y:0},i=e.anchor||{x:0,y:0},o=Ee(n),s=PIXI.Texture.EMPTY;return"number"==typeof r&&r<0&&(r=0),e.debug?s=Se(e.name,e):o&&(s=o[r]||s),new K({game:t,conf:e,name:e.name,objName:e.objName,isInScene:e.isInScene,pos:a,anchor:i,texture:s})},Ce=function(e,t){var n=e.resource.group,r=e.resource.name,a=e.pos||{x:0,y:0},i=e.anchor||{x:0,y:0},o=Ee(n),s=e.blend,c=void 0,u=PIXI.Texture.EMPTY;return"number"==typeof r&&r<0&&(r=0),"number"==typeof s?s<0&&(s=0):s=0,e.debug?u=Se(e.name,e):o&&(u=o[r]||u),(c=new K({game:t,conf:e,name:e.name,objName:e.objName,isInScene:e.isInScene,pos:a,anchor:i,alpha:e.alpha||1,texture:u})).blendMode=s,c},je=function(e,t){var n=e.resource.group,r=e.resource.name,a=e.pos||{x:0,y:0},i=e.anchor||{x:0,y:0},o=e.speed||.33,s=e.loop,c=Ee(n),u=[PIXI.Texture.EMPTY];return e.debug?u=[Se(e.name,e)]:c&&(u=c[r]||u),new V({game:t,conf:e,name:e.name,objName:e.objName,isInScene:e.isInScene,speed:o,loop:s,pos:a,anchor:i,textures:u})},Ne=function(e,t){var n=e.resource.texture,r=Ee(e.resource.group),a=e.numCounts||4,i=e.offset,o=e.symbolOffset,s=e.charMap,c=e.autoHide,u={pos:{x:0,y:0},width:e.width,height:e.height},l=PIXI.Texture.EMPTY;return e.debug?l=Se(e.name,e):r&&(l=r[e.resource.background]||l),new te({game:t,conf:e,name:e.name,objName:e.objName,isInScene:e.isInScene,autoHide:c,fixVal:e.fixVal,useComma:e.useComma,useDash:e.useDash,useMoney:e.useMoney,pos:e.pos,anchor:e.anchor,pivot:e.pivot,rect:u,textureName:n,background:l,numCounts:a,charMap:s,symbolOffset:o,offset:i})},Le=function(e,t){var n=e.resource,r=n.group,a=n.name,i=Ee(r),o=void 0,s={enter:PIXI.Texture.EMPTY,press:PIXI.Texture.EMPTY,leave:PIXI.Texture.EMPTY,disable:PIXI.Texture.EMPTY};return e.debug?(s.enter=Se(e.name,e),s.press=s.enter,s.leave=s.enter,s.disable=s.enter):i&&i[a]&&(o=i[a],s.enter=o[n.enter]||s.enter,s.press=o[n.press]||s.press,s.leave=o[n.leave]||s.leave,s.disable=o[n.disable]||s.disable),new Y({game:t,conf:e,name:e.name,objName:e.objName,isInScene:e.isInScene,pos:e.pos,anchor:e.anchor,texture:s})};function Ae(e){xe.objectFactory[be.INFO]=Ie,xe.objectFactory[be.GROUP]=we,xe.objectFactory[be.SCROLLBAR]=Oe,xe.objectFactory[be.BACKGROUND]=Re,xe.objectFactory[be.TEXT]=_e,xe.objectFactory[be.IMAGE]=Ce,xe.objectFactory[be.ANMIMATION]=je,xe.objectFactory[be.NUMBER]=Ne,xe.objectFactory[be.BUTTON]=Le,xe.objectFactory[be.SPINE]=Pe,xe.objectFactory[be.PARTICLE]=Te,fe=e.jsyaml,le=e.Loader,(ue=e.dragon)&&(xe.objectFactory[be.BONE]=ke)}function Me(e){var t=xe.event,n=void 0,r=void 0;if(xe.isBusy)return!1;xe.isBusy=!0,xe.game=e.game;var a=e.filename,i=e.proc,o=e.callback,s=e.finish,c=[],u=0,l=function(e){var a=o[u];a&&a(e),0!==u&&t.resEnd&&t.resEnd(u),(u+=1)<c.length?(t.resBegin&&t.resBegin(u),r()):n()};if(n=function(){xe.isBusy=!1,s&&s()},r=function(){var e,t=void 0,n=void 0;t=i[u],e=c[u];try{n=fe.load(e),t&&(xe.baseIndex+=1,xe.baseProgress=xe.baseIndex/xe.baseMax*100,t(n,l))}catch(e){}},!Array.isArray(a))return!1;if(!Array.isArray(i))return!1;if(!Array.isArray(o))return!1;if(a.length!==i.length)return!1;return function(){t.sceneResBegin&&t.sceneResBegin(he),xe.baseIndex=0,xe.baseProgress=0,xe.baseMax=1+a.length,xe.baseProgress=xe.baseIndex/xe.baseMax*100,xe.base=1/xe.baseMax;var e=new le(xe.baseURL);a.forEach(function(t,n){e.add(n.toString(),t)}),e.onProgress.once(function(e){var n=e.progress;n>100&&(n=100);var r=xe.baseProgress+n*xe.base;t.sceneResLoading&&t.sceneResLoading({currentProgress:n,currentLength:a.length,totalProgress:r,state:xe.state})}),e.load(function(e,n){Object.getOwnPropertyNames(n).forEach(function(e){var t=parseInt(e);c[t]=n[e].data}),t.sceneResEnd&&t.sceneResEnd(he),u=0,r()})}(),!0}function Fe(e){var t=xe.event,n=void 0,r=void 0;if(xe.isBusy)return!1;xe.isBusy=!0,xe.game=e.game;var a=e.objData,i=e.proc,o=e.callback,s=e.finish,c=0,u=function(e){var i=o[c];i&&i(e),0!==c&&t.resEnd&&t.resEnd(c),(c+=1)<a.length?(t.resBegin&&t.resBegin(c),r(c)):n()};if(n=function(){xe.isBusy=!1,s&&s()},r=function(e){var t,n=void 0;n=i[e],t=a[e],xe.baseIndex=e,xe.baseProgress=xe.baseIndex/xe.baseMax*100,n&&t&&n(t,u)},!Array.isArray(a))return!1;if(!Array.isArray(i))return!1;if(!Array.isArray(o))return!1;if(a.length!==i.length)return!1;return xe.baseIndex=0,xe.baseProgress=0,xe.baseMax=a.length,xe.base=1/xe.baseMax,r(c=0),!0}function Be(e){var t=xe.event;e?(t.resBegin=e.resBegin||t.resBegin,t.resEnd=e.resEnd||t.resEnd,t.sceneResBegin=e.sceneResBegin||t.sceneResBegin,t.sceneResLoading=e.sceneResLoading||t.sceneResLoading,t.sceneResEnd=e.sceneResEnd||t.sceneResEnd):(t.resBegin=null,t.resEnd=null,t.sceneResBegin=null,t.sceneResLoading=null,t.sceneResEnd=null)}function De(e){xe.state=e}function Ge(e,t){"object"==typeof e.particle&&ce.setConfigMap(e.particle),t(e)}function Ve(e,t){var n=xe.event,r={},a=t,i=function(e){var t=e.progress;t>100&&(t=100);var r={currentProgress:t,totalProgress:xe.baseProgress+t*xe.base,state:xe.state};n.sceneResLoading&&n.sceneResLoading(r)},o=function(t){var r={};if(t){var i=t.resources;!function e(t,n,r){var a=Object.getOwnPropertyNames(t),i=void 0;a.forEach(function(a){var o=t[a];"string"==typeof o?n[a]=r(o):Array.isArray(o)?(function(e,t,n){e.forEach(function(e){t.push(n(e))})}(o,i=[],r),n[a]=i):"object"==typeof o&&(e(o,i={},r),n[a]=i)})}(e.spines,r,function(e){return i[e].spineData}),n.sceneResEnd&&n.sceneResEnd(ge),xe.spines=r,a(r)}else a(r)},s=function(e){r[e]=e};!function(){if(n.sceneResBegin&&n.sceneResBegin(ge),e&&e.spines){!function e(t,n){Object.getOwnPropertyNames(t).forEach(function(r){var a=t[r];"string"==typeof a?n(a):Array.isArray(a)?function(e,t){e.forEach(function(e){t(e)})}(a,n):"object"==typeof a&&e(a,n)})}(e.spines,s);var t=Object.getOwnPropertyNames(r);if(0===t.length)o();else{var a=new PIXI.loaders.Loader(xe.baseURL);t.forEach(function(e){a.add(e,e)}),a.on?(a.on("progress",i),a.once("complete",o),a.load()):(a.onProgress.add(i),a.load(o))}}else o()}()}function Ue(e,t){var n=xe.event,r={},a=t,i=function(e){var t=e.progress;t>100&&(t=100),t=xe.baseProgress+t*xe.base,n.sceneResLoading&&n.sceneResLoading({current:t,length:100,state:xe.state})},o=function(t){var r=null;if(ue&&(r=new ue.dragonBones.PixiFactory),t){var i=t.resources,o=function(e,t,n){e.forEach(function(e){t.push(n(e))})};o(e.bones.data,[],function(e){var t=i[e].data;return r&&r.parseDragonBonesData(t),t});o(e.bones.resource,[],function(e){var t=i[e.atlas]&&i[e.atlas].data;if(t=JSON.parse(t),r){var n=Ee(e.texture.group)[e.texture.name];r.parseTextureAtlasData(t,n)}return t}),n.sceneResEnd&&n.sceneResEnd(ye),xe.bonesFactory=r,W.setFactory(r),a(r)}else a(r)},s=function(e){r[e]=e},c=function(e){r[e.atlas]=e.atlas},u=function(e,t){e.forEach(function(e){t(e)})};!function(){if(n.sceneResBegin&&n.sceneResBegin(ye),e&&e.bones&&e.bones.data){!function e(t,n){Object.getOwnPropertyNames(t).forEach(function(r){var a=t[r];"string"==typeof a?n(a):Array.isArray(a)?u(a,n):"object"==typeof a&&e(a,n)})}(e.bones.data,s),u(e.bones.resource,c);var t=Object.getOwnPropertyNames(r);if(0===t.length)o();else{var a=new PIXI.loaders.Loader(xe.baseURL);t.forEach(function(e){a.add(e,e)}),a.on?(a.on("progress",i),a.once("complete",o),a.load()):(a.onProgress.add(i),a.load(o))}}else o()}()}function Ye(e,t){var n,r=e.objects,a=xe.objectFactory,i=void 0,o=[],s=0,c=xe.event,u=[];c.sceneResBegin&&c.sceneResBegin(pe),n=r.length,r.forEach(function(e){var t=a[e.type];t?(i=t(e,xe.game))&&o.push(i):u.push(e);var r=(s+=1)/n*100,l={currentProgress:r,totalProgress:xe.baseProgress+r*xe.base,state:xe.state};c.sceneResLoading&&c.sceneResLoading(l)}),c.sceneResEnd&&c.sceneResEnd(pe),t&&t(o,u)}function Xe(e,t){var n={},r=!1,a={},i=xe.event,o={};xe.textures=null;var s=0,c={currentProgress:0,totalProgress:xe.baseProgress,state:xe.state};i.sceneResLoading&&i.sceneResLoading(c);var u=function(e){var t=e.progress;t>100&&(t=100);var n={currentProgress:t,totalProgress:s>0?100*s+xe.baseProgress+t*s:xe.baseProgress+t*xe.base,state:xe.state};i.sceneResLoading&&i.sceneResLoading(n)},l=function(){var r=function(e){var t=PIXI.Texture.fromImage(xe.baseURL+e,!0);return t.baseTexture.scaleMode=PIXI.SCALE_MODES.NEAREST,t},a=function(e,t,n){e.forEach(function(e){t.push(n(e))})},o=function e(t,n,r){var i=Object.getOwnPropertyNames(t),o=void 0;i.forEach(function(i){var s=t[i];"string"==typeof s?n[i]=r(s):Array.isArray(s)?(a(s,o=[],r),n[i]=o):"object"==typeof s&&(e(s,o={},r),n[i]=o)})};Object.getOwnPropertyNames(e.images).forEach(function(t){var i,s=n[t];i=e.images[t],Array.isArray(i)?s?a(i,s,r):(a(i,s=[],r),n[t]=s):"object"==typeof i?s?o(i,s,r):(o(i,s={},r),n[t]=s):"string"==typeof i&&(n[t]=r(i))}),i.sceneResEnd&&i.sceneResEnd(me),xe.textures=n,t&&t(n)},f=function(e){var t=e.progress;t>100&&(t=100);var n={currentProgress:t,totalProgress:s>0?xe.baseProgress+t*s:xe.baseProgress+t*xe.base,state:xe.state};i.sceneResLoading&&i.sceneResLoading(n)},h=null,d=function(){i.sceneResEnd&&i.sceneResEnd(ve),h(e)},m=function(e){a[e]=e},p=function(e,t){e.forEach(function(e){t(e)})},v=function(e){return PIXI.Texture.fromFrame(e)},g=function(e,t,n){e.forEach(function(e){t.push(n(e))})},y=function e(t,n,r){Object.getOwnPropertyNames(t).forEach(function(a){var i=t[a],o=[];"string"==typeof i?n[a]=r(i):Array.isArray(i)?(g(i,o,r),n[a]=o):"object"==typeof i&&(n[a]=o,e(i,o,r))})};if(h=function(e){var o=void 0;if(e.images){Object.getOwnPropertyNames(e.images).forEach(function(t){var n;n=e.images[t],Array.isArray(n)?p(n,m):"object"==typeof n?function e(t,n){t&&Object.getOwnPropertyNames(t).forEach(function(r){var a=t[r];"string"==typeof a?n(a):Array.isArray(a)?p(a,n):"object"==typeof a&&e(a,n)})}(n,m):"string"==typeof n&&m(n)}),o=Object.getOwnPropertyNames(a),i.sceneResBegin&&i.sceneResBegin(me);var s=new PIXI.loaders.Loader(xe.baseURL);o.forEach(function(e){s.add(e,e)}),s.on?(s.on("progress",u),s.once("complete",l),s.load()):(s.onProgress.add(u),s.load(l))}else r=!0;e.frames&&Object.getOwnPropertyNames(e.frames).forEach(function(t){var r,a=n[t];r=e.frames[t],Array.isArray(r)?a?g(r,a,v):(g(r,a=[],v),n[t]=a):"object"==typeof r?a?y(r,a,v):(y(r,a=[],v),n[t]=a):"string"==typeof r&&(n[t]=v(r))}),r&&(xe.textures=n,t&&t(n))},e&&Array.isArray(e.assets)){e.images&&(s=.5*xe.base),i.sceneResBegin&&i.sceneResBegin(ve);var b=new PIXI.loaders.Loader(xe.baseURL);e.assets.forEach(function(e){b.add(e)}),b.on?(b.on("progress",f),b.once("complete",d),b.load()):(b.onProgress.add(f),b.load(d))}else h(e),o.textures=n;return o}function He(e){xe.textures=e}function ze(e){xe.spines=e}function Ke(e,t){var n=void 0,r=void 0,a=0,i=0,o=void 0,s=xe.event,c={},u=xe.soundMapList;if(!Howl||!e.sounds)return t&&t(null),!1;r=Object.getOwnPropertyNames(e.sounds),s.sceneResBegin&&s.sceneResBegin(de);var l=0,f=0;a=0;var h=xe.baseURL;return r.forEach(function(t){var r={};o=e.sounds[t],i=o.length,f+=i,o.forEach(function(e){var t=e.config.src;if(Array.isArray(e.config.src)){var i=[];e.config.src.forEach(function(e){i.push(h+e)}),e.config.src=i}n=new Howl(e.config),e.config.src=t,r[e.objName]=n,l=(a+=1)/f*100;var o=xe.baseProgress+l*xe.base,c={currentProgress:l,totalProgress:o,state:xe.state};s.sceneResLoading&&s.sceneResLoading(c)}),o.length>0?c[t]=r:c[t]=null}),s.sceneResEnd&&s.sceneResEnd(de),u.push(c),t&&t(c),!0}function Je(e){Object.getOwnPropertyNames(e).forEach(function(t){var n=e[t];n&&n.stop?(n.stop(),n.unload()):Je(n),delete e[t]})}var qe=Object.freeze({OBJ_TYPE:be,createDebugTxeture:Se,createGroup:we,init:Ae,registerFactory:function(e){xe.objectFactory[e.type]=e.create},loadScene:Me,loadSceneEx:Fe,setEvent:Be,setState:De,createRawData:Ge,createSpineData:Ve,createBonesData:Ue,createObject:Ye,createTexture:Xe,setTextures:He,setSpineData:ze,setBaseURL:function(e){xe.baseURL=e||""},getBaseURL:function(){return xe.baseURL},getTextures:function(e,t){var n=e,r=void 0;return t.split(".").every(function(e){return!!(r=n[e])&&(n=r,!0)}),n},createSound:Ke,destroySound:Je,destroyAllSound:function(){xe.soundMapList.forEach(function(e){Object.getOwnPropertyNames(e).forEach(function(t){Je(e[t]),delete e[t]})})}}),$e={isBusy:!1,game:null,loading:null,useLobbyState:!1,state:{currentIndex:0,totals:0}};var Qe=Object.freeze({go:function(e,t){if($e.isBusy||!$e.game||!Array.isArray(e))return!1;var n=$e.game,r=$e.loading,a=0,i=e.length,o=void 0,s=void 0,c=t,u=e;return De($e.state),o=function(){if(a<i){var e=u[a].scene;a+=1,e?s(e):o()}else $e.isBusy=!1,$e.useLobbyState||r&&r.setState(!0),c&&c()},s=function(e){$e.state.currentIndex=a,$e.state.totals=i,$e.useLobbyState?!e.isCreate()&&e.createScene?e.createScene(o):o():!e.isCreate()&&e.createScene?r.go({game:n,layer:n.layer&&n.layer.overlay,load:function(t){e.createScene(t)},resourceFinish:o}):o()},$e.isBusy=!0,o(),!0},setUseLobbyState:function(e){$e.useLobbyState=e,e&&$e.game&&$e.game.scene?Be($e.game.scene.loadingEvent):$e.useLobbyState=!1},setGame:function(e){$e.game=e},setDisplayLoading:function(e){$e.loading=e}}),We={init:null,release:null,resource:null,eventResBegin:null,eventResCheck:null,eventResEnd:null,eventStart:null,eventEnter:null,eventLeave:null},Ze=null,et=null;function tt(e){Ze&&Ze(e)}var nt=function(){function e(){t(this,e)}return o(e,null,[{key:"resCreate",value:function(e){We.resource&&We.resource(e)}},{key:"frameStart",value:function(t){We.eventStart&&We.eventStart(t),Ze=e.frameEnter}},{key:"frameFinish",value:function(e){We.release&&We.release(e),Ze=null,et&&(et(),et=null)}},{key:"frameEnter",value:function(t){var n=!0;We.eventEnter&&(n=We.eventEnter(t)),n&&(Ze=e.resBegin)}},{key:"frameLeave",value:function(t){var n=!0;We.eventLeave&&(n=We.eventLeave(t)),n&&(Ze=e.frameFinish)}},{key:"resBegin",value:function(t){We.eventResBegin&&We.eventResBegin(t),e.resCreate(),Ze=e.resLoading}},{key:"resLoading",value:function(t){We.eventResCheck?We.eventResCheck(t)&&(Ze=e.resEnd):Ze=e.resEnd}},{key:"resEnd",value:function(t){We.eventResEnd&&We.eventResEnd(t),Ze=e.frameLeave}}]),e}();function rt(e){return"object"==typeof e&&(We.init=e.init,We.release=e.release,We.resource=e.resource,We.eventResBegin=e.resBegin,We.eventResCheck=e.resCheck,We.eventResEnd=e.resEnd,We.eventStart=e.start,We.eventEnter=e.enter,We.eventLeave=e.leave,et=e.finish),We.init&&We.init(),Ze=nt.frameStart,!0}var at=Object.freeze({refresh:tt,go:rt}),it={event:null,scene:{anim:null,message:null,percent:null},isInit:!1,strings:null,resList:null,state:!1};var ot=Object.freeze({setState:function(e){it.state=e},setStrings:function(e){it.strings=e},setPosition:function(e){var t=it.scene.anim;t&&(t.x=e.x,t.y=e.y),it.pos?(it.pos.x=e.x,it.pos.y=e.y):it.pos={x:e.x,y:e.y}},setScene:function(e){it.resList=e,it.isInit=!1},go:function(e){var t=e.loadingEvent||{},n=e.resourceFinish||null,r=e.game,a=it.strings;Be({resBegin:function(e){t.resBegin&&t.resBegin(e),it.percent&&(it.percent.text="0%")},resEnd:function(e){t.resEnd&&t.resEnd(e)},sceneResBegin:function(e){a&&a.get&&a.get(e),t.sceneResBegin&&t.sceneResBegin(e)},sceneResLoading:function(e){var n=e.state,r=e.totalProgress;n&&(r=(n.currentIndex-1)/n.totals*100+r/n.totals);var a=r.toFixed(0)+"%";t.sceneResLoading&&t.sceneResLoading(e),it.percent&&(it.percent.text=a)},sceneResEnd:function(e){a&&a.get&&a.get(e),t.sceneResEnd&&t.sceneResEnd(e)}});var i={name:"loading",screen:{width:r.screen&&r.screen.width||1024,height:r.screen&&r.screen.height||768},movieClip:null,layer:e.layer||null,load:e.load,init:function(){if(!it.isInit){it.isInit=!0;var e=it.resList,t=void 0,n=[];e.forEach(function(e){t=PIXI.Texture.fromImage(e),n.push(t)});var a=new PIXI.extras.AnimatedSprite(n);a.animationSpeed=.33,a.anchor.x=.5,a.anchor.y=.5,it.scene.anim=a;var o=new PIXI.Text("message");o.style.fill="#FFFFFF",o.style.stroke="#006600",o.style.strokeThickness=1,o.anchor.x=.5,o.anchor.y=.5,o.x=0,o.y=-44,it.message=o;var s=new PIXI.Text("init");s.style.fill="#FFFFFF",s.style.stroke="#aa0000",s.style.strokeThickness=1,s.anchor.x=.5,s.anchor.y=.5,s.x=0,s.y=24,it.percent=s,a.addChild(o),a.addChild(s),it.pos||(it.pos={x:i.screen.width/2,y:i.screen.height/2}),it.anchor=new PIXI.Point(.5,.5)}r.addRefresh(i.name,tt)},release:function(){null!==i.layer&&null!==it.scene.anim&&i.layer.removeChild(it.scene.anim),r.removeRefresh(i.name)},resource:function(){i.load?i.load(n):n&&n()},resBegin:function(){},resCheck:function(){return it.state},resEnd:function(){},start:function(){if(null!==i.layer&&null!==it.scene.anim){var e=it.scene.anim;e.x=it.pos.x,e.y=it.pos.y,e.anchor.x=it.anchor.x,e.anchor.y=it.anchor.y,e.alpha=0,e.gotoAndPlay(0),i.layer.addChild(e)}},enter:function(){var e=!1,t=it.scene.anim;return null!==t?t.alpha>=1?(t.alpha=1,e=!0):t.alpha+=.05:e=!0,e},leave:function(){var e=!1,t=it.scene.anim;return null!==t?(t.alpha<=0&&(t.alpha=0,e=!0),t.alpha-=.05,t.alpha<=0&&(t.alpha=0)):e=!0,e},finish:function(){}};return it.event=i,it.state=!1,rt(it.event)}}),st=!1,ct=null;var ut=function e(){t(this,e);var n=this,r=null,a={debug:!1,timeBase:1,currentTime:-1,renderer:null,pause:!0,isInit:!1},i=null,o=[],s=[],c={};n.custom={},n.setEngine=function(e){i=e},n.setElement=function(e){a.element=e},n.update=function(e){a.debug&&r&&r.begin(),a.currentTime<0&&(e=0,a.currentTime=1),e*=a.timeBase,o.forEach(function(t){var n=c[t];n.update?n.update(e):n(e)}),s.forEach(function(t){t.update&&t.update(e)}),!a.pause&&i&&i.render(e),a.debug&&r&&r.end()},a.debug=!1,n.addRefresh=function(e,t){c[e]=t,o=Object.getOwnPropertyNames(c)},n.removeRefresh=function(e){c.hasOwnProperty(e)&&(delete c[e],o=Object.getOwnPropertyNames(c))},n.addUpdate=function(e){var t=!1;return e&&e.update&&!e.hasOwnProperty("__updateIndex")&&(e.__updateIndex=s.length,s[e.__updateIndex]=e,t=!0),t},n.removeUpdate=function(e){var t=void 0,n=s.length,r=void 0;if("number"==typeof e.__updateIndex){if((t=e.__updateIndex)>=0&&t<n){var a=n-1;r=s[a],s[t]=r,r.__updateIndex=t,s.splice(a,1)}delete e.__updateIndex}},n.resetUpdate=function(){s.forEach(function(e){delete e.__updateIndex}),s=[]},n.setTimeout=function(e,t){var r={currentTime:0,func:e,update:function(e){r.currentTime.toFixed(2)>=t&&(n.removeUpdate(r),r.func&&r.func(r.currentTime)),r.currentTime+=e}};return n.addUpdate(r),r},n.setInterval=function(e,t){var r=0,a={func:e,update:function(e){(r+=e).toFixed(2)>=t&&(a.func&&a.func(r),r=0)}};return n.addUpdate(a),a},n.clearInterval=function(e){n.removeUpdate(e)},n.isPause=function(){return a.pause},n.play=function(){a.pause&&(a.pause=!1,a.currentTime=-1,g(n))},n.once=function(){a.pause=!1,a.currentTime=-1,x(n)},n.pause=function(){a.pause||(a.pause=!0,y(n))},n.stop=function(){a.pause=!0,y(n),n.resetUpdate()},n.add=function(e){a.timeBase<1&&(a.timeBase=1),a.timeBase+=e,a.timeBase>4&&(a.timeBase=4)},n.dec=function(e){a.timeBase>1&&(a.timeBase=1),a.timeBase-=e,a.timeBase<.1&&(a.timeBase=.1)},n.reset=function(){a.timeBase=1},n.getTimeBase=function(){return a.timeBase},n.setTimeBase=function(e){a.timeBase=e,a.timeBase<.1?a.timeBase=.1:a.timeBase>4&&(a.timeBase=4)},n.init=function(e){if(a.isInit)return!1;a.isInit=!0,a.element=e.element,a.currentTime=-1;var t={width:e.width,height:e.height};return n.pause(),n.screen=t,!0},n.getRenderer=function(){return i&&i.renderer},Object.defineProperty(n,"layer",{get:function(){return i&&i.layer}}),Object.defineProperty(n,"debug",{set:function(e){r||ct&&(r=new ct,n.stats=r),e?r&&a.element&&(r.dom.style.position="absolute",a.element.appendChild(r.dom)):r&&a.element&&r.dom.parentElement&&a.element.removeChild(r.dom),a.debug=e},get:function(){return a.debug}}),n.stats=null},lt=!1;var ft=null;var ht={position:"absolute",left:"0%",top:"0%",width:"100%",height:"100%"},dt={zIndex:10,position:"absolute",left:"0%",top:"0%",width:"100%",height:"100%"},mt={oninit:function(e){var t=e.attrs,n=e.attrs.config;lt||(lt=!0,PIXI.Texture.Draw=function(e){var t=document.createElement("canvas");return"function"==typeof e&&e(t),PIXI.Texture.fromCanvas(t)}),this.config=n,this.game=n.game,this.style=t.style||dt,this.ready=t.ready},oncreate:function(e){var t=this.config;t.canvas=e.instance.children[0].dom,t.element=e.dom;var n=this.game;n||(n=new ut,this.game=n),n.init(t);var r=function(e){var t=void 0,n=void 0,r={},a={width:e.width,height:e.height,view:e.canvas,resolution:e.resolution,antialias:e.antialias,transparent:e.transparent};return n=PIXI.autoDetectRenderer(a),t=new PIXI.Container,r.stage=t,r.overlay=new PIXI.Container,r.foreground=new PIXI.Container,r.main=new PIXI.Container,r.background=new PIXI.Container,t.addChildAt(r.overlay,0),t.addChildAt(r.foreground,0),t.addChildAt(r.main,0),t.addChildAt(r.background,0),{renderer:n,stage:t,layer:r,render:function(){n.render(t)}}}(t);n.setEngine(r),t&&t.ready&&t.ready(n),this.ready&&this.ready(n)},onremove:function(){var e=this.game;e&&e.stop()},view:function(){return ft(".",{style:this.style},ft("canvas",{style:ht}))}};function pt(e){!function(e){!st&&(ct=e.Stats,st=!0)}(e),Ae(e),ft=e.m}var vt=Object.freeze({init:pt,run:function(e){var t=void 0;if(t=new ut,window.parent&&window.parent!==window){var n=void 0,r=void 0;if(window.Howl=window.parent.Howl,window.Howler=window.parent.Howler,window.parent.scene){var a=e.id,i=e.event||{};n=window.parent.scene[a],Object.defineProperty(t,"scene",{get:function(){return n}}),n&&n.event&&(r={create:function(e){window.parent.lobby&&(t.table=window.parent.lobby.table[e.id],t.currentUser=window.parent.lobby.currentUser,t.command=window.parent.lobby.net.gameCommand,t.lobby={setEvent:window.parent.lobby.setEvent,setCommand:window.parent.lobby.net.setLobbyCommand,CMD:window.parent.lobby.net.CMD}),i.create&&(e.game=t,i.create(e))},play:function(e){t.play(),i.play&&(e.game=t,i.play(e))},pause:function(e){t.pause(),i.pause&&(e.game=t,i.pause(e))},enter:function(e){i.enter&&(e.game=t,i.enter(e))},leave:function(e){i.leave&&(e.game=t,i.leave(e))},focus:function(){i.focus&&i.focus()},blur:function(){i.blur&&i.blur()},lock:function(e){i.lock&&i.lock(e)},fullscreen:function(e){i.fullscreen&&i.fullscreen(e)},resize:function(e){i.resize&&i.resize(e)},music:function(e){i.music&&i.music(e)},sound:function(e){i.sound&&i.sound(e)}},n.setEvent(r),n.game=t)}}return t}}),gt={Base:function(){function e(n){t(this,e);var r={name:n,root:null,game:null,center:{entity:{}},initMap:null,currentTime:0,isCreate:!1,isInScene:!1};this.properties=r,Object.defineProperty(this,"center",{get:function(){return r.center}}),Object.defineProperty(this,"entity",{get:function(){return r.center.entity}})}return o(e,[{key:"getName",value:function(){return this.properties.name}},{key:"getGame",value:function(){return this.properties.game}},{key:"isCreate",value:function(){return this.properties.isCreate}},{key:"isInScene",value:function(){return this.properties.isInScene}},{key:"getCurrentTime",value:function(){return this.properties.currentTime}},{key:"getCenter",value:function(){return this.properties.center}},{key:"getRoot",value:function(){return this.properties.root}},{key:"setRoot",value:function(e){var t=this.properties;t.root=e,t.center=e.center}},{key:"setInitMap",value:function(e){this.properties.initMap=e}},{key:"setLayer",value:function(e){this.properties.center.layer=e}},{key:"getLayer",value:function(){return this.properties.center.layer}},{key:"getRawData",value:function(){return this.properties.center.rawdata}},{key:"getSound",value:function(e){var t=this.properties.center.sounds;return t&&"string"==typeof e&&(t=t[e]),t}},{key:"mute",value:function(e,t){var n=this.properties.center.sounds[e];n&&Object.getOwnPropertyNames(n).forEach(function(e){n[e].mute(t)})}},{key:"getTexture",value:function(e){var t=this.properties.center.textures;return t&&"string"==typeof e&&(t=t[e]),t}},{key:"getObject",value:function(){return this.properties.center.objs}},{key:"getEntity",value:function(){return this.properties.center.entity}},{key:"eventFinish",value:function(){var e=this.properties;He(e.center.textures),ze(e.center.spines),e.initMap&&e.initMap(this)}},{key:"eventRawData",value:function(e){}},{key:"eventSound",value:function(e){}},{key:"eventTexture",value:function(e){}},{key:"eventSpine",value:function(e){}},{key:"eventBones",value:function(e){}},{key:"eventObject",value:function(e){}},{key:"refresh",value:function(e){var t=this.getCenter();t&&t.update&&t.update(e)}},{key:"setGame",value:function(e,t){var n=this.properties;n.game=e,e.layer.hasOwnProperty(t)&&(n.center.layer=e.layer[t])}},{key:"addToScene",value:function(e){var t=this,n=t.properties;if(n.isInScene)return!1;n.isInScene=!0;var r=n.center;n.currentTime=-1,n.game=e||n.game,n.game&&n.game.addRefresh(n.name,function(e){n.currentTime<0?(n.currentTime=0,e=0):t.currentTime+=e,t.refresh(e)});var a=r.layer;return!r||!r.objs||(r.objs.forEach(function(e){e&&(e._game=n.game||e._game,e.isInScene&&(e.addToScene?e.addToScene(a):a.addChild(e)))}),!0)}},{key:"removeFromScene",value:function(){var e=this.properties;if(!e.isInScene)return!1;e.isInScene=!1,e.game&&e.game.removeRefresh(e.name);var t=e.center;return!t||!t.objs||(t.objs.forEach(function(e){e&&(e.removeFromScene?e.removeFromScene():e.parent&&e.parent.removeChild(e))}),!0)}},{key:"init",value:function(e){var t=this.properties.center,n=be;if(t&&t.objs){var r=t.entity,a={};e&&(a=e.set||{}),a.setupGroup=a.setupGroup||function(e){e.childList.forEach(function(t){if(t){var n=t.conf;n.objName&&(e[n.objName]=t,t.objName)}}),e.childList.forEach(function(e){if(e){var t=e.conf;n.GROUP===e.type&&a.setupGroup(e,t),t&&a.hasOwnProperty(t.init)&&a[t.init](e)}})},t.objs.forEach(function(e){e&&e.objName&&(r[e.objName]=e,e.objName)}),t.objs.forEach(function(e){var t=void 0;e&&(t=e.conf,n.GROUP===e.type&&a.setupGroup(e,t),t&&a.hasOwnProperty(t.init)&&((e.name||e.objName)+" init : "+t.init,a[t.init](e,t)))})}}},{key:"createScene",value:function(e,t){var n=this,r=n.properties;if(r.isCreate)return e&&e(),!1;var a=t.infoList,i=r.center,o={data:{proc:Ge,callback:function(e){i&&(i.rawdata=e),n.eventRawData(e)}},sound:{proc:Ke,callback:function(e){i&&(i.sounds=e),n.eventSound(e)}},texture:{proc:Xe,callback:function(e){i&&(i.textures=e),n.eventTexture(e)}},spine:{proc:Ve,callback:function(e){i&&(i.spines=e),n.eventSpine(e)}},bone:{proc:Ue,callback:function(e){i&&(i.bonesFactory=e),n.eventBones(e)}},object:{proc:Ye,callback:function(e){i&&(i.objs?e.forEach(function(e){i.objs.push(e)}):i.objs=e),n.eventObject(e)}}};function s(){r.isCreate=!0,i&&i.createFinish&&i.createFinish()}if(i&&(i.createFinish=e),t.isObject){var c={game:r.game,objData:[],proc:[],callback:[],finish:s};a&&Array.isArray(a)&&a.forEach(function(e){var t=o[e.eventName];t&&e.obj&&t.proc&&(c.objData.push(e.obj),c.proc.push(t.proc)),c.callback.push(t.callback)}),Fe(c)}else{var u={game:r.game,filename:[],proc:[],callback:[],finish:s};a&&Array.isArray(a)&&a.forEach(function(e){var t=o[e.eventName];t&&e.filename&&u.filename.push(e.filename),u.proc.push(t.proc),u.callback.push(t.callback)}),Me(u)}return!0}},{key:"destroyScene",value:function(){this.removeFromScene();var e=this.properties,t=e.center;if(!e.isCreate)return!1;t&&(t.bonesFactory&&(t.bonesFactory.clear(),t.bonesFactory=null),t.sounds&&Je(t.sounds));return t.objs&&(t.objs.forEach(function(e,n){e&&delete t.objs[n]}),t.objs=null),e.isCreate=!1,!0}}]),e}(),sceneManager:qe,loadingManager:Qe,loading:at},yt={loading:ot,base:D},bt={game:{pixi:mt}},xt=!1;e.init=function(e){var n=e||{},a=n.plugin||[];return Array.isArray(a)||(a=[]),new Promise(function(e){xt&&e("!! init finish again !!"),function i(u){if(u&&u.Spine&&(PIXI.spine=u),a.length>0){var l=a.shift();SystemJS.import(l).then(i)}else n.sceneManager=qe,n.PIXI&&(function(e){var n=e.PIXI;V=function(e){function r(e){t(this,r);var a=s(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e.textures||[n.Texture.EMPTY],!1)),i=a;return i._game=e.game,i.conf=e.conf,i.type=G,i.name=e.name,i.objName=e.objName||null,i.isInScene=e.isInScene,e.pos&&(i.x=e.pos.x,i.y=e.pos.y),e.anchor&&(i.anchor.x=e.anchor.x||0,i.anchor.y=e.anchor.y||0),i.loop=e.loop,"number"==typeof e.speed&&(i.animationSpeed=e.speed),a}return c(r,e),o(r,null,[{key:"TYPE",get:function(){return G}}]),o(r,[{key:"clone",value:function(e){M(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"clone",this).call(this);var t={game:e||this._game,conf:this.conf,isInScene:this.isInScene,name:this.name+".clone."+this.cloneIndex,loop:this.loop,speed:this.animationSpeed,pos:this.position,anchor:this.anchor,textures:this.textures};return new V(t)}},{key:"removeFromScene",value:function(){M(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"removeFromScene",this).call(this),this._game&&this._game.removeUpdate(this)}},{key:"addToScene",value:function(e){e.addChild(this),this.playing&&this._game&&this._game.addUpdate(this)}},{key:"play",value:function(){this._game&&this._game.addUpdate(this),M(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"play",this).call(this)}},{key:"stop",value:function(){this._game&&this._game.removeUpdate(this),M(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"stop",this).call(this)}},{key:"update",value:function(e){M(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"update",this).call(this,60*e)}}]),r}(F(n.extras.AnimatedSprite))}(n),function(e){var n=e.PIXI;Y=function(e){function r(e){t(this,r);var a=s(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e.texture&&e.texture.leave||n.Texture.EMPTY)),i=a;i._game=e.game,i.type=U,i.conf=e.conf,i.objName=e.objName||null,i.name=e.name,i.isInScene=e.isInScene,e.pos&&(i.x=e.pos.x,i.y=e.pos.y),e.anchor&&(i.anchor.x=e.anchor.x||0,i.anchor.y=e.anchor.y||0),i.scale.x=1,i.buttonMode=!0,i.interactive=!0;var o={};return i.custom=o,o.texture=e.texture||{enter:n.Texture.EMPTY,leave:n.Texture.EMPTY,press:n.Texture.EMPTY,disable:n.Texture.EMPTY},o.isPress=!1,o.flagDrag=!1,o.canMove=!1,o.timer=null,o.obj=null,i.touchstart=i.mousedown=function(e){o.flagDrag&&o.timer&&(i.dragEvent&&(i.dragEvent.curTimes=i.dragEvent.times,i.dragEvent.reset&&i.dragEvent.reset()),o.timer.restart()),i.eventPress(e)},i.touchend=i.mouseup=function(e){o.canMove=!1,o.flagDrag&&i.dragEvent&&i.dragEvent.reset&&i.dragEvent.reset(),i.eventRelease(e)},i.mouseover=function(e){o.flagDrag&&i.dragEvent&&i.dragEvent.reset&&i.dragEvent.reset(),i.eventEnter(e)},i.mouseout=function(e){o.canMove=!1,o.flagDrag&&i.dragEvent&&i.dragEvent.reset&&i.dragEvent.reset(),i.eventLeave(e)},i.touchendoutside=i.mouseupoutside=function(e){o.flagDrag&&i.dragEvent&&i.dragEvent.reset&&i.dragEvent.reset(),i.eventLeave(e)},a}return c(r,e),o(r,null,[{key:"TYPE",get:function(){return U}}]),o(r,[{key:"clone",value:function(e){M(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"clone",this).call(this);var t={game:e||this._game,conf:this.conf,isInScene:this.isInScene,name:this.name+".clone."+this.cloneIndex,pos:this.position,anchor:this.anchor,texture:this.custom.texture};return new Y(t)}},{key:"setTexture",value:function(e){var t=this.custom.texture;t.enter=e.enter||n.Texture.EMPTY,t.leave=e.leave||n.Texture.EMPTY,t.press=e.press||n.Texture.EMPTY,t.disable=e.disable||n.Texture.EMPTY,this.update()}},{key:"setClick",value:function(e,t){this.eventClick=e,this.obj=t}},{key:"eventPress",value:function(){var e=this.custom.texture;this.texture=e.press,this.custom.isPress=!0}},{key:"eventRelease",value:function(){var e=this.custom.texture;this.custom.isPress?(this.texture=e.leave,"function"==typeof this.eventClick&&this.eventClick(this,this.obj)):this.texture=e.leave,this.custom.isPress=!1}},{key:"eventEnter",value:function(){var e=this.custom.texture;this.custom.isPress?this.texture=e.press:this.texture=e.enter}},{key:"eventLeave",value:function(){var e=this.custom.texture;this.texture=e.leave,this.custom.isPress=!1}},{key:"setDragEnable",value:function(e){var t=this,n=t.custom;n.flagDrag=!0,t.mousemove=t.touchmove=function(e){if(n.canMove){n.isPress=!1;var r={x:parseInt(e.data.global.x),y:parseInt(e.data.global.y)};t.x=r.x,t.y=r.y}},t.dragEvent=e,t.dragEvent||(t.dragEvent={},t.dragEvent.times=10),t.dragEvent.curTimes=t.dragEvent.times}},{key:"setDragDisable",value:function(){this.custom.flagDrag=!1,this.mousemove=this.touchmove=null}},{key:"setEnable",value:function(e,t){e?this.enable(t):this.disable(t)}},{key:"enable",value:function(e){this.interactive=!0;var t=this.custom.texture;e&&(this.texture=t.leave)}},{key:"isEnabled",value:function(){return this.interactive}},{key:"disable",value:function(e){this.interactive=!1;var t=this.custom.texture;e&&(this.texture=t.disable)}},{key:"update",value:function(){var e=this.custom.texture;this.interactive?this.texture=e.leave:this.texture=e.disable}}]),r}(F(n.Sprite))}(n),function(e){var n=e.PIXI,r=e.sceneManager;H=function(e){function n(e){t(this,n);var r=s(this,(n.__proto__||Object.getPrototypeOf(n)).call(this)),a=r;return a._game=e.game,a.conf=e.conf,a.type=X,a.name=e.name,a.objName=e.objName||null,a.isInScene=e.isInScene,a.childList=[],e.pos&&(a.x=e.pos.x||0,a.y=e.pos.y||0),e.pivot&&(a.pivot.x=e.pivot.x||0,a.pivot.y=e.pivot.y||0),r}return c(n,e),o(n,null,[{key:"TYPE",get:function(){return X}}]),o(n,[{key:"clone",value:function(e){M(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"clone",this).call(this);var t=null;this.conf&&this.conf.childList&&(t=this.conf.childList);var a={game:e||this._game,childList:t,isInScene:this.isInScene,name:this.name+".clone."+this.cloneIndex,pivot:this.pivot,pos:this.position};return r.createGroup(a,this._game)}},{key:"removeFromScene",value:function(){M(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"removeFromScene",this).call(this),this.stop()}},{key:"stop",value:function(){this.childList.forEach(function(e){e.stop&&e.stop()})}}]),n}(F(n.Container))}(n),function(e){var n=e.PIXI;K=function(e){function r(e){t(this,r);var a=s(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e.texture||n.Texture.EMPTY)),i=a;return i._game=e.game,i.conf=e.conf,i.type=z,i.name=e.name,i.objName=e.objName,i.isInScene=e.isInScene,e.pos&&(i.x=e.pos.x,i.y=e.pos.y),e.anchor&&(i.anchor.x=e.anchor.x||0,i.anchor.y=e.anchor.y||0),a}return c(r,e),o(r,null,[{key:"TYPE",get:function(){return z}}]),o(r,[{key:"clone",value:function(e){M(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"clone",this).call(this);var t={game:e||this._game,conf:this.conf,isInScene:this.isInScene,name:this.name+".clone."+this.cloneIndex,pos:this.position,anchor:this.anchor,alpha:this.alpha,texture:this.texture};return new K(t)}}]),r}(F(n.Sprite))}(n),function(e){var n=e.PIXI;te=function(e){function r(e){t(this,r);var a=s(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e.background||n.Texture.EMPTY)),i=a,o=void 0;i._game=e.game,i.conf=e.conf,i.type=Z,i.name=e.name,i.objName=e.objName,i.isInScene=e.isInScene;var c={},u={};c.rect=u,c.event={},i.custom=c,u.pos=new n.Point(0,0),u.anchor=new n.Point(0,0),u.width=e.width||64,u.height=e.height||16,e.rect&&(e.rect.pos&&(u.x=e.rect.pos.x,u.y=e.rect.pos.y),e.rect.anchor&&(u.anchor.x=e.rect.anchor.x,u.anchor.y=e.rect.anchor.y),u.width=e.rect.width||u.width,u.height=e.rect.height||u.height),c.textureName=e.textureName||"",c.numCounts=e.numCounts||4,c.charMap=e.charMap||ee.CHAR_MAP,c.shift=1,"number"==typeof e.shift&&(c.shift=e.shift),c.enable=!1,c.display=e.display||ee.DISPLAY.TRANSVERSE,c.alignType=e.alignType||ee.ALIGN_TYPE.RECT,c.offsetType=e.offsetType||ee.OFFSET_TYPE.STATIC,c.horiType=e.horiType||ee.HORI_ALIGN.LEFT,c.vertiType=e.vertiType||ee.VERTI_ALIGN.TOP,c.alpha=1,c.anchor={x:0,y:0},e.anchor&&(c.anchor.x=e.anchor.x,c.anchor.y=e.anchor.y),c.lastCnt=0,c.value=0,c.currentValue=0,c.targetValue=0,c.offsetValue=0,c.background=e.background||n.Texture.EMPTY,c.autoHide=e.autoHide,c.useComma=e.useComma,c.useMoney=e.useMoney,c.useDash=e.useDash,"number"==typeof e.fixVal?c.fixVal=e.fixVal:c.fixVal=0,e.pos&&(i.x=e.pos.x,i.y=e.pos.y),e.pivot&&(i.pivot.x=e.pivot.x,i.pivot.y=e.pivot.y),c.numTe=[],c.numSprite=[];var l,f=void 0,h=void 0,d=void 0,m=void 0,p=void 0,v=void 0;for(v=c.charMap.length,f=0;f<v;f+=1)p=c.charMap[f],h=c.textureName+p,c.numTe[p]=n.Texture.fromFrame(h);for(d=(l=c.numTe[c.charMap[0]]).frame,c.offset=e.offset||d.width,c.symbolOffset=-1,"number"==typeof e.symbolOffset&&(c.symbolOffset=e.symbolOffset),v=c.numCounts,f=0;f<v;f+=1)o=new n.Texture(l,d.clone()),(m=new n.Sprite(o)).anchor.x=c.anchor.x,m.anchor.y=c.anchor.y,c.numSprite[f]=m;return i._eventUpdate=i._animChange,a}return c(r,e),o(r,null,[{key:"TYPE",get:function(){return Z}},{key:"NUM",get:function(){return ee}}]),o(r,[{key:"clone",value:function(e){M(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"clone",this).call(this);var t=this.custom,n={game:e||this._game,conf:this.conf,isInScene:this.isInScene,name:this.name+".clone."+this.cloneIndex,pos:this.position,pivot:this.pivot,anchor:t.anchor,rect:t.rect,display:t.display,alignType:t.alignType,offsetType:t.offsetType,horiType:t.horiType,vertiType:t.vertiType,textureName:t.textureName,numCounts:t.numCounts,charMap:t.charMap,offset:t.offset,symbolOffset:t.symbolOffset,shift:t.shift,background:t.background,autoHide:t.autoHide,fixVal:t.fixVal,useComma:t.useComma,useDash:t.useDash,useMoney:t.useMoney};return new te(n)}},{key:"removeFromScene",value:function(){M(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"removeFromScene",this).call(this),this._game.removeUpdate(this)}},{key:"transverse",value:function(){this.setDisplay(ee.DISPLAY.TRANSVERSE)}},{key:"straight",value:function(){this.setDisplay(ee.DISPLAY.TRANSVERSE)}},{key:"setDisplay",value:function(e){if(e===ee.DISPLAY.TRANSVERSE)this.display=e;else{if(e!==ee.DISPLAY.STRAIGHT)return;this.display=e}this.setAlign(this.horiType,this.vertiType)}},{key:"setBackground",value:function(e){this.texture=e}},{key:"setAnchor",value:function(e){if(e){var t=this.custom,n=void 0,r=t.anchor,a=t.numSprite.length;for(r.x=e.x,r.y=e.y,n=0;n<a;n+=1)(r=t.numSprite[n].anchor).x=e.x,r.y=e.y}}},{key:"setAlign",value:function(e,t){var n=this.custom;n.alignType=ee.ALIGN_TYPE.RECT;var r=n.rect.pos,a={x:r.x,y:r.y},i=n.anchor,o=n.rect.width,s=n.rect.height,c=n.offset,u={w:0,h:0},l=this.children,f=void 0,h=l.length;if(n.lastCnt!==h||n.horiType!==e||n.vertiType!==t){n.lastCnt=h,n.horiType=e,n.vertiType=t;var d=void 0;switch(l.forEach(function(e){var t=e.texture.frame;"."===e.ch||","===e.ch?(u.w-=c,u.h-=c,d&&(u.w+=d.width,u.h+=d.height,d=null),u.w+=t.width,u.h+=t.height,u.w+=2*n.symbolOffset):(u.w+=c,u.h+=c),d=t}),n.horiType){case ee.HORI_ALIGN.LEFT:n.display,ee.DISPLAY.TRANSVERSE,a.x=r.x;break;case ee.HORI_ALIGN.CENTER:n.display===ee.DISPLAY.TRANSVERSE?a.x=r.x+.5*o-.5*u.w:a.x=r.x+.5*o;break;case ee.HORI_ALIGN.RIGHT:n.display===ee.DISPLAY.TRANSVERSE?a.x=r.x+o-u.w:a.x=r.x+o}switch(n.vertiType){case ee.VERTI_ALIGN.TOP:a.y=r.y;break;case ee.VERTI_ALIGN.CENTER:n.display===ee.DISPLAY.TRANSVERSE?a.y=r.y+.5*s:a.y=r.y+.5*s-.5*u.h;break;case ee.VERTI_ALIGN.BOTTOM:n.display===ee.DISPLAY.TRANSVERSE?a.y=r.y+s:a.y=r.y+s-u.h}var m=0,p={width:0,height:0};for(f=h-1;f>=0;f-=1){var v=l[f],g=v.position,y=v.texture.frame;n.display===ee.DISPLAY.TRANSVERSE?(g.x=m+a.x,g.y=a.y):(g.y=m+a.y,g.x=a.x),"."===v.ch||","===v.ch?n.display===ee.DISPLAY.TRANSVERSE?(m-=c,m+=p.width,g.x=m+a.x-p.width*i.x+y.width*i.x,m+=y.width+2*n.symbolOffset,g.x+=n.symbolOffset):m+=y.height:m+=c,d=y,p=y}}}},{key:"setAlpha",value:function(e){this.children.forEach(function(t){t.alpha=e}),this.custom.alpha=e}},{key:"getValue",value:function(){return this.custom.value}},{key:"setValue",value:function(e,t){var n=this.custom,r=n.event;if(n.currentValue=n.value,n.value=e||0,n.targetValue=e||0,n.currentValue<n.targetValue?n.offsetValue=n.shift:n.currentValue>n.targetValue&&(n.offsetValue=-n.shift),r.begin&&r.begin(this),t)this.enable();else{n.currentValue=n.value;for(var a=this,i=this.fixValueString(n.currentValue),o=void 0,s=void 0,c=i.length,u=n.alpha,l=void 0,f=n.numSprite.length-1,h=n.numTe[0].frame;f>=0;){c-=1;var d=n.numSprite[f];c>=0?(s=i[c],o=n.numTe[s],d.ch=s,d.alpha=u,o&&((l=d.texture.frame).copy(o.frame),d.texture.frame=l),a.addChild(d)):(d.ch="0",n.autoHide?a.removeChild(d):((l=d.texture.frame).copy(h),d.texture.frame=l,d.alpha=u,a.addChild(d))),f-=1}this.setAlign(n.horiType,n.vertiType)}}},{key:"setEvent",value:function(e){var t=this.custom.event;t.begin=e.begin||t.begin,t.end=e.end||t.end,t.changeString=e.changeString||t.changeString}},{key:"_animChange",value:function(e){var t=this.custom,n=t.event,r=t.offsetValue*e*1e3;r<0?t.currentValue<=t.targetValue?(t.currentValue=t.targetValue,this.disable(),n.end&&n.end(this)):t.currentValue=t.currentValue+r:t.currentValue>=t.targetValue?(t.currentValue=t.targetValue,this.disable(),n.end&&n.end(this)):t.currentValue=t.currentValue+r;for(var a=this,i=this.fixValueString(t.currentValue),o=void 0,s=void 0,c=void 0,u=t.alpha,l=i.length,f=t.numSprite.length-1,h=t.numTe[0].frame;f>=0;){l-=1;var d=t.numSprite[f];l>=0?(o=i[l],s=t.numTe[o],d.ch=o,d.alpha=u,s&&((c=d.texture.frame).copy(s.frame),d.texture.frame=c),a.addChild(d)):(d.ch="0",t.autoHide?a.removeChild(d):((c=d.texture.frame).copy(h),d.texture.frame=c,d.alpha=u,a.addChild(d))),f-=1}this.setAlign(t.horiType,t.vertiType)}},{key:"fixValueString",value:function(e){var t=this.custom,n=t.event,r=e.toString(),a=r.lastIndexOf(".");a<0&&t.fixVal>0?a=(r+=".").length:a>=0&&0===t.fixVal&&(a=r.lastIndexOf("."),a=(r=r.substr(0,a)).length);for(var i=a+1;i<=a+t.fixVal;i+=1)i>=r.length&&(r=r.concat("0"));var o=r;t.fixVal>0&&r.length>a+t.fixVal&&(o=r.substr(0,a+t.fixVal+1));var s=null,c=void 0,u=o.length,l=Math.floor(e);return t.fixVal>0&&(c=o.substr(u-(t.fixVal+1),t.fixVal+1),u=(o=l.toString()).length),s=t.useComma?u>6?o.substr(0,u-6)+","+o.substr(u-6,3)+","+o.substr(u-3,3):u>3?o.substr(0,u-3)+","+o.substr(u-3,3):o:o,t.useMoney&&(s="$"+s),t.useDash&&0===t.fixVal&&(s+="_"),t.fixVal>0&&(s+=c),n.changeString&&(s=n.changeString(s)),s}},{key:"setTextures",value:function(e){var t=this.custom;if(t.textureName!==e){t.textureName=e;var r,a=void 0,i=void 0,o=void 0,s=void 0,c=void 0,u=void 0;for(a=0,u=t.charMap.length;a<u;a++)c=t.charMap[a],i=t.textureName+c,t.numTe[c]=n.Texture.fromFrame(i);for(o=(r=t.numTe[t.charMap[0]]).frame,a=0,u=t.numCounts;a<u;a++){var l=new n.Texture(r,o.clone());(s=t.numSprite[a]).texture=l,s.anchor.x=t.anchor.x,s.anchor.y=t.anchor.y}}}},{key:"enable",value:function(){var e=this.custom;e.enable||(e.enable=!0,this._game.addUpdate(this))}},{key:"disable",value:function(){var e=this.custom;e.enable&&(e.enable=!1,this._game.removeUpdate(this))}},{key:"stop",value:function(){this.disable()}},{key:"update",value:function(e){this._eventUpdate&&this._eventUpdate(e)}},{key:"shift",set:function(e){this.custom.shift=e},get:function(){return this.custom.shift}},{key:"fixVal",set:function(e){this.custom.fixVal=e},get:function(){return this.custom.fixVal}}]),r}(F(n.Sprite))}(n),function(e){var n=e.PIXI;re=function(e){function r(e){t(this,r);var a=s(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e.background||n.Texture.EMPTY)),i=a;return i._game=e.game,i.conf=e.conf,i.type=ne,i.name=e.name,i.objName=e.objName,i.isInScene=e.isInScene,i.value={current:1,offset:1,min:1,max:10,range:9},i.value.range=i.value.max-i.value.min,i.eventScroll=null,i.slider=new n.Sprite(e.slider),i.slider.anchor.x=.5,i.addChild(i.slider),e.pos&&(i.x=e.pos.x||0,i.y=e.pos.y||0),e.anchor&&(i.anchor.x=e.anchor.x||0,i.anchor.y=e.anchor.y||0),i.limit={offset:0,min:.5*i.conf.slider.width,max:i.conf.width-.5*i.conf.slider.width},i.limit.length=i.limit.max-i.limit.min,i.slider.x=i.limit.min,i.slider.value=0,i.limit.offset=i.limit.length/i.value.range,i.hasMove=!1,i.buttonMode=!0,i.interactive=!0,i.obj=null,i.touchstart=i.mousedown=function(e){var t=parseInt(e.data.global.x);parseInt(e.data.global.y),i.hasMove=!0,i.slider.x=t-i.x,i.slider.x<i.limit.min?i.slider.x=i.limit.min:i.slider.x>=i.limit.max&&(i.slider.x=i.limit.max),i.slider.value=i.slider.x-i.limit.min,i.value.current=i.value.min+i.value.offset*parseInt(i.slider.value/i.limit.offset),i.eventScroll&&i.eventScroll(i.value.current,i)},i.touchend=i.mouseup=function(e){parseInt(e.data.global.x),parseInt(e.data.global.y),i.hasMove=!1},i.slider.buttonMode=!0,i.slider.interactive=!0,i.slider.mousedown=i.slider.touchstart=function(){i.hasMove=!0},i.slider.mouseup=i.slider.mouseupoutside=i.slider.touchend=i.slider.touchendoutside=function(){i.hasMove=!1},i.slider.mousemove=i.slider.touchmove=function(e){if(0===e.which&&(i.hasMove=!1),i.hasMove){var t={x:parseInt(e.data.global.x),y:parseInt(e.data.global.y)};i.slider.x=t.x-i.x,i.slider.x<i.limit.min?i.slider.x=i.limit.min:i.slider.x>=i.limit.max&&(i.slider.x=i.limit.max),i.slider.value=i.slider.x-i.limit.min,i.value.current=i.value.min+i.value.offset*parseInt(i.slider.value/i.limit.offset),i.eventScroll&&i.eventScroll(i.value.current,i)}},a}return c(r,e),o(r,null,[{key:"TYPE",get:function(){return ne}}]),o(r,[{key:"clone",value:function(){return null}},{key:"setBindScrollEvent",value:function(e){this.eventScroll=e}},{key:"reset",value:function(){this.hasMove=!1}},{key:"setRange",value:function(e){"number"==typeof e.current&&(this.value.current=e.current),"number"==typeof e.offset&&(this.value.offset=e.offset),"number"==typeof e.min&&(this.value.min=e.min),"number"==typeof e.max&&(this.value.max=e.max),"number"==typeof e.range&&(this.value.range=e.range),this.value.current<this.value.min?this.value.current=this.value.min:this.value.current>this.value.max&&(this.value.current=this.value.max),this.value.offset=(this.value.max-this.value.min)/this.value.range,this.limit.offset=this.limit.length/this.value.range,this.slider.value=this.limit.offset*(this.value.current-this.value.min),this.slider.x=this.limit.min+this.slider.value,this.eventScroll&&this.eventScroll(this.value.current,this)}},{key:"setValue",value:function(e){e>=this.value.min&&e<=this.value.max&&(this.value.current=e,this.slider.value=this.limit.offset*((this.value.current-this.value.min)/this.value.range),this.slider.x=this.limit.min+this.slider.value,this.eventScroll&&this.eventScroll(this.value.current,this))}},{key:"getValue",value:function(){return this.value.current}}]),r}(F(n.Sprite))}(n),function(e){var n=e.PIXI;q=function(e){function r(e){t(this,r);var a=s(this,(r.__proto__||Object.getPrototypeOf(r)).call(this)),i=a,o=e.spineDataGroup,c=e.textureGroup;i._game=e.game,i.conf=e.conf,i.type=J,i.name=e.name,i.objName=e.objName||null,i.isInScene=e.isInScene;var u={};return i.custom=u,u.childList=[],u.spineAnimList=[],u.group={},u.spineDataGroup=o,u.textureGroup=c,u.configList=e.configList||e.conf&&e.conf.configList,e.pos&&(i.x=e.pos.x||0,i.y=e.pos.y||0),n.spine?(u.configList.forEach(function(e,t){var r=void 0,a=void 0,i=void 0,s=void 0;if(a=new n.Sprite(n.Texture.EMPTY),i={x:0,y:0},s=(r=new n.spine.Spine(o[e.dataName])).getLocalBounds(),r.skeleton.setToSetupPose(),r.autoUpdate=!1,r.state.timeScale=0,r.x=.01,r.y=.01,r.childMap={},r.getChild=function(e){return r.childMap[e]},r.spineData.slots.forEach(function(e,t){var n=r.children[t];n&&n.children&&(n=n.children[0],r.childMap[e.name]=n)}),a.name=e.name,a.addChild(r),u.childList[t]=a,e.anchor&&(r.x=-r.width*e.anchor.x+.01,r.y=-r.height*e.anchor.y+.01),i.x=s.x,i.y=s.y,e.fixPosition){var c=e.fixPosition,l=c.offset||{x:0,y:0},f=null;c.childName&&(f=r.getChild(c.childName)),f||(f=r.children[c.childIndex||0].children[0]),s=f.getBounds(),r.x=-s.x+.5*-s.width,r.y=-s.y+.5*-s.height,i.x=r.x+s.x,i.y=r.y+s.y,r.x=r.x+l.x,r.y=r.y+l.y}if(e.debug){var h=new n.Graphics;a.addChild(h),h.x=0,h.y=0,h.lineStyle(1,16711680,.9),h.beginFill(16740363,.1),h.drawRect(r.x+s.x,r.y+s.y,s.width,s.height),h.endFill(),h.lineStyle(0),h.beginFill(0,1),h.drawCircle(i.x,i.y,3),h.endFill(),h.beginFill(16777215,1),h.drawCircle(i.x,i.y,1),h.endFill(),r.children.forEach(function(e){var t=e.children[0];if(t&&t.getBounds||(t=e),t&&t.getBounds){var r=t.getBounds(),a=new n.Graphics;t.addChild(a),a.x=0,a.y=0,a.lineStyle(1,65280,.75),a.beginFill(786288,.15),a.drawRect(.5*-r.width,.5*-r.height,r.width,r.height),a.endFill(),a.lineStyle(0),a.beginFill(0,1),a.drawCircle(0,0,3),a.endFill(),a.beginFill(16777215,1),a.drawCircle(0,0,1),a.endFill()}})}e.name&&(u.group[e.name]={sprite:a,spine:r,entry:null,animConfig:{animationName:e.animationName,timeScale:e.timeScale,loop:e.loop}}),u.spineAnimList.push(r)}),u.configList.forEach(function(e){var t=u.group[e.name].spine;if(t&&e.mask){var r=new n.Sprite(c[e.mask.name]),a=t;if(t.mask=r,e.mask.follow&&(a=u.group[e.mask.follow]),a){var i=a.getLocalBounds();e.mask.local?(r.x=i.x,r.y=i.y):(r.x=0,r.y=0),a.addChild(r)}var o=e.mask.fixPosition;if(o&&a){var s=o.offset||{x:0,y:0},l=void 0;o.childName&&(l=a.getChild(o.childName)),l||(l=a.children[o.childIndex||0].children[0]);var f=l.getBounds(),h=a.getBounds(),d=a.getLocalBounds();r.x=d.x+(f.x-h.x)+s.y,r.y=d.y+(f.y-h.y)+s.y}if(e.mask.debug){var m=new n.Graphics,p={x:0,y:0};a&&(p.x=a.x,p.y=a.y,a.parent.addChild(m)),m.x=p.x+r.x,m.y=p.y+r.y,m.lineStyle(1,255,.75),m.beginFill(16740363,.15),m.drawRect(0,0,r.width,r.height),m.endFill(),m.lineStyle(1,0),m.moveTo(0,0),m.lineTo(r.width,r.height),m.moveTo(r.width,0),m.lineTo(0,r.height)}}t&&e.maskList&&e.maskList.forEach(function(e){var r=void 0,a=void 0,i=new n.Sprite(c[e.name]),o=null;e.followName&&(o=t.getChild(e.followName)),o||(o=t.children[e.follow]&&t.children[e.follow].children[0]),r=o,o=null,e.targetName&&(o=t.getChild(e.targetName)),o||(o=t.children[e.target]&&t.children[e.target].children[0]),(a=o)&&(a.mask=i),r&&(i.x=-r.width/2,i.y=-r.height/2,r.addChild(i))})}),a):s(a)}return c(r,e),o(r,null,[{key:"getChild",value:function(e,t){var n=null,r=e.spineData.slots,a=-1;return r.some(function(e,n){return e.name===t&&(a=n,!0)}),a>=0&&(n=e.children[a].children[0]),n}},{key:"getRect",value:function(e,t){var r=e.getBounds();if(t){var a=new n.Graphics;e.addChild(a),a.x=0,a.y=0,a.lineStyle(1,255,.75),a.beginFill(65291,.15),a.drawRect(.5*-r.width,.5*-r.height,r.width,r.height),a.endFill(),a.lineStyle(1,0),a.moveTo(0,0),a.lineTo(r.width,r.height),a.moveTo(r.width,0),a.lineTo(0,r.height)}return r}},{key:"TYPE",get:function(){return J}}]),o(r,[{key:"clone",value:function(e){M(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"clone",this).call(this);var t=this.custom,n={game:e||this._game,conf:this.conf,isInScene:this.isInScene,name:this.name+".clone."+this.cloneIndex,textureGroup:t.textureGroup,spineDataGroup:t.spineDataGroup,configList:t.configList,pos:this.position};return new q(n)}},{key:"removeFromScene",value:function(){this.parent&&this.parent.removeChild(this),this._game.removeUpdate(this)}},{key:"getGroup",value:function(e){return this.custom.group[e]}},{key:"getSpine",value:function(e){var t=this.custom.group[e],n=void 0;return t&&(n=t.spine),n}},{key:"getEntry",value:function(e){var t=this.custom.group[e],n=void 0;return t&&(n=t.entry),n}},{key:"getAnimConfig",value:function(e){var t=this.custom.group[e],n=void 0;return t&&(n=t.animConfig),n}},{key:"play",value:function(e){var t=this,n=t.custom,r=[];e&&Array.isArray(e)?(n.childList.forEach(function(e){t.removeChild(e)}),e.forEach(function(e){var a=n.group[e.name];if(a){var i=a.spine,o=a.sprite,s=a.animConfig;i&&(a.entry=i.state.setAnimation(0,e.animationName||s.animationName,e.loop),i.update(0),i.state.timeScale=e.timeScale||s.timeScale,r.push(i)),t.addChild(o)}})):Object.getOwnPropertyNames(n.group).forEach(function(e){var a=n.group[e];if(a){var i=a.spine,o=a.sprite,s=a.animConfig;i&&(a.entry=i.state.setAnimation(0,s.animationName,s.loop),i.update(0),i.state.timeScale=s.timeScale,r.push(i)),t.addChild(o)}}),n.spineAnimList=r,t._game.addUpdate(t)}},{key:"pause",value:function(){var e=this.custom;Object.getOwnPropertyNames(e.group).forEach(function(t){var n=e.group[t].spine;n&&(n.state.timeScale=0)})}},{key:"resume",value:function(){var e=this.custom;Object.getOwnPropertyNames(e.group).forEach(function(t){var n=e.group[t],r=n.spine,a=n.animConfig;r&&(r.state.timeScale=a.timeScale)})}},{key:"stop",value:function(e){var t=this.custom;e&&Array.isArray(e)?e.forEach(function(e){var n=t.group[e.name],r=n.spine,a=n.animConfig;a.animationName=e.animationName||a.animationName,r&&(r.state.timeScale=0)}):(Object.getOwnPropertyNames(t.group).forEach(function(e){var n=t.group[e].spine;n&&(n.state.timeScale=0)}),this._game.removeUpdate(this))}},{key:"update",value:function(e){this.custom.spineAnimList.forEach(function(t){t.update(e)})}}]),r}(F(n.Container))}(n),function(e){var n=e.PIXI;W=function(e){function r(e){t(this,r);var a=s(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,n.Texture.EMPTY)),i=a;i._game=e.game,i.conf=e.conf,i.type=$,i.name=e.name,i.objName=e.objName||null,i.resource={},i.animation={timeScale:1},i.isInScene=e.isInScene,i.isUpdate=!1,e.animation&&(i.animation.name=e.animation.name,i.animation.timeScale=e.animation.timeScale),e.resource&&(i.resource.name=e.resource.name),e.pos&&(i.x=e.pos.x||0,i.y=e.pos.y||0),e.anchor&&(i.anchor.x=e.anchor.x||.5,i.anchor.y=e.anchor.y||.5);var o=Q&&Q.buildArmature(i.resource.name);if(o){var c=o.display;c.scale.set(1,1),i.addChild(c)}return i.armature=o,i.state=null,a}return c(r,e),o(r,null,[{key:"setFactory",value:function(e){Q=e}},{key:"getFactory",value:function(){return Q}},{key:"TYPE",get:function(){return $}}]),o(r,[{key:"clone",value:function(e){M(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"clone",this).call(this);var t=this.cloneIndex,n={game:e||this._game,conf:this.conf,isInScene:this.isInScene,resource:this.resource,animation:this.animation,name:this.name+".clone."+t,pos:this.sprite.position};return new W(n)}},{key:"removeFromScene",value:function(){this.parent&&this.parent.removeChild(this),this.stop()}},{key:"play",value:function(e){var t=this.armature,n=this.animation;t&&(n.name=e||n.name,this.state=t.animation.play(n.name),this.state&&(this.state.timeScale=n.timeScale),this.isUpdate||(this.isUpdate=!0,this._game.addUpdate(this)))}},{key:"stop",value:function(){this.armature&&this.isUpdate&&(this.isUpdate=!1,this._game.removeUpdate(this))}},{key:"update",value:function(e){var t=this.armature;t&&t.advanceTime(e)}},{key:"timeScale",set:function(e){this.animation.timeScale=e,this.state&&(this.state.timeScale=e)},get:function(){return this.animation.timeScale}}]),r}(F(n.Sprite))}(n),function(e){var n=e.PIXI;ie=function(e){function n(e){t(this,n);var r=s(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e.text||"test used")),a=r;a._game=e.game,a.conf=e.conf,a.type=ae,a.name=e.name,a.objName=e.objName,a.isInScene=e.isInScene;var i={fill:"#FFFFFF",stroke:"#000000",strokeThickness:0};return e.style&&(i.fill=e.style.fill||"#FFFFFF",i.stroke=e.style.stroke||"#000000",i.strokeThickness=e.style.strokeThickness||0),a.style=i,e.pos&&(a.x=e.pos.x,a.y=e.pos.y),e.anchor&&(a.anchor.x=e.anchor.x||0,a.anchor.y=e.anchor.y||0),r}return c(n,e),o(n,null,[{key:"TYPE",get:function(){return ae}}]),o(n,[{key:"clone",value:function(e){M(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"clone",this).call(this);var t={game:e||this._game,conf:this.conf,isInScene:this.isInScene,name:this.name+".clone."+this.cloneIndex,pos:this.position,anchor:this.anchor,style:this.style,text:this.text};return new ie(t)}}]),n}(F(n.Text))}(n),function(e){var n=e.PIXI;ce=function(e){function r(e){t(this,r);var a=s(this,(r.__proto__||Object.getPrototypeOf(r)).call(this)),i=a,o={},c=void 0;i.custom=o,i._game=e.game,i.conf=e.conf,i.type=oe,i.name=e.name,i.objName=e.objName,i.isInScene=e.isInScene;var u=e.setting;return o.type=u.type,o.config=u.config,o.art=u.art,o.ownerPos=new n.Point(0,0),i.setProperties({scale:!0,position:!0,rotation:!0,uvs:!0,alpha:!0}),n.particles&&n.particles.Emitter&&(c=new n.particles.Emitter(i,o.art,o.config)),c&&("path"===o.type?c.particleConstructor=n.particles.PathParticle:"anim"===o.type&&(c.particleConstructor=n.particles.AnimatedParticle)),e.pos&&(i.x=e.pos.x,i.y=e.pos.y),i.emitter=c,a}return c(r,e),o(r,null,[{key:"setConfigMap",value:function(e){se=e||se}},{key:"getConfig",value:function(e){return se[e]}},{key:"TYPE",get:function(){return oe}}]),o(r,[{key:"clone",value:function(e){M(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"clone",this).call(this);var t=this.cloneIndex,n=this.custom,a={game:e||this._game,conf:this.conf,isInScene:this.isInScene,name:this.name+".clone."+t,pos:this.position,setting:{type:n.type,config:n.config,art:n.art}};return new ce(a)}},{key:"removeFromScene",value:function(){M(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"removeFromScene",this).call(this),this._game.removeUpdate(this)}},{key:"play",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.emitter,r=e||this.custom.ownerPos;n&&(n.emit=!0,n.resetPositionTracking(),n.updateOwnerPos(r.x,r.y),n.update(t),this._game.addUpdate(this))}},{key:"stop",value:function(){this._game.removeUpdate(this)}},{key:"update",value:function(e){this.emitter.update(e)}}]),r}(F(n.particles.ParticleContainer))}(n),yt.Animation=V,yt.Button=Y,yt.Group=H,yt.Image=K,yt.Number=te,yt.Scrollbar=re,yt.Spine=q,yt.Bone=W,yt.Text=ie,yt.Particle=ce,pt(n)),k(),w(),r(n),xt=!0,e("!! init finish !!")}(null)})},e.updateManager=_,e.Lobby=A,e.game=vt,e.scene=gt,e.ui=yt,e.components=bt,e.client=i,Object.defineProperty(e,"__esModule",{value:!0})});