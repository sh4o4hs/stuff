var nuts=function(e){"use strict";let t=null;function n(e){t=e.io}class s{constructor(e,n=""){let s={event:e&&e.event,socket:null,cmdList:e&&e.commandList,isConnect:!1,host:e&&e.host,roomName:n};this.isConnect=(()=>s.isConnect),this.setHost=(e=>s.host=e),this.setCommandList=(e=>s.cmdList=e),this.registerCommand=((e,t)=>{let n=s.socket;n&&n.on(e,t)}),this.sendCommand=((e,t)=>{let n=s.socket;n&&n.compress(!0).emit(e,t)}),this.setEvent=(e=>{s.event=e}),this.connect=(e=>{let n,a=s.cmdList;if(s.socket)return!1;n=t.connect(s.host+s.roomName,{pingTimeout:15e3,pingInterval:3e4,secure:!0,transports:["websocket"]});let r={};if(e?(s.event=e,r.connect=e.connect,r.disconnect=e.disconnect):s.event&&(r.connect=s.event.connect,r.disconnect=s.event.disconnect),s.socket=n,n.on("connect",()=>{s.isConnect=!0,r.connect&&(r.connect(),r.connect=null)}),n.on("disconnect",()=>{s.isConnect=!1,r.disconnect&&(r.disconnect(),r.disconnect=null)}),a){Object.getOwnPropertyNames(a).forEach(e=>{n.on(e,a[e])})}return!0}),this.disconnect=(()=>{let e=s.socket;e&&e.disconnect()})}}var a=Object.freeze({init:n,Network:s});let r,i,o;class l{static init(e){r=e.CMD,i=e.RESULT,o=e.STATE}static create(e){let t,n=e.lobbyBuffer,s=e.gameBuffer,a=null,l={cmdList:null,gameProc:null,setEventMap(e){a=e}};t=(e=>{let t={},c=e.gameEvent;return t.checkData=((e,t,n,s)=>{let a=o.OK;return t.resultCode!==i.OK?(a=o.ERROR,s&&s.error&&s.error(t)):s&&s.handle&&s.handle(t),a}),t.gameProc=(e=>{let t=c[e.gid];t&&t.recvGameData&&t.recvGameData(e.packet)}),t.broadcastProc=(e=>{Object.getOwnPropertyNames(c).forEach(t=>{let n=c[t];n&&n.recvBroadcast&&n.recvBroadcast(e)})}),l.gameProc=t.gameProc,{connect(e){let t=a&&a.connect;t&&t.handle&&t.handle(e)},reconnect(e){let t=a&&a.reconnect;t&&t.handle&&t.handle(e)},login(s){let i=a&&a.login;t.checkData(r.LOGIN,s,n,i)&&(e.connectionToken=s.connectionToken)},relogin(s){let i=a&&a.relogin;t.checkData(r.RELOGIN,s,n,i)&&(e.connectionToken=s.connectionToken)},inGame(e){let s=a&&a.inGame;t.checkData(r.IN_GAME,e,n,s)},exitGame(e){let s=a&&a.exitGame;t.checkData(r.EXIT_GAME,e,n,s)},toGame(e){let n=a&&a.toGame;t.checkData(r.TO_GAME,e,s,n),t.gameProc(e)},broadCastMsg(e){let n=a&&a.broadcast;n&&n.handle&&n.handle(e),t.broadcastProc(e)},ping(e){let t=a&&a.ping;t&&t.handle&&t.handle(e)},pong(e){let t=a&&a.pong;t&&t.handle&&t.handle(e)},disconnectMsg(e){let t=a&&a.disconnectMsg;t&&t.handle&&t.handle(e)},disconnect(e){let t=a&&a.disconnect;t&&t.handle&&t.handle(e)}}})(e),l.cmdList=t,e.commandManager=l}}let c=null,u=[],m=[],h=!1;function d(e){let t=!1;return e&&e.update&&(e.hasOwnProperty("__updateIndex")||(e.__updateIndex=u.length,u.push(e),t=!0)),t}function p(e){let t,n,s=u.length;if("number"==typeof e.__updateIndex){if((t=e.__updateIndex)>=0&&t<s){let e=s-1;n=u[e],u[t]=n,n.__updateIndex=t,u.splice(e,1)}delete e.__updateIndex}}function g(e,t){let n={currentTime:0,func:e,update:e=>{n.currentTime+=e,n.currentTime>=t&&(n.func&&n.func(n.currentTime),n.currentTime=0)}};return d(n),n}function f(e){e&&e.update&&(m.push(e),h=!0)}function y(){u.forEach(e=>{delete e.__updateIndex}),u=[]}let b=-1;function x(e){let t,n=.001*performance.now();e.paused||(b<0?(t=0,b=n):(t=n-b,b=n),function(e){h&&(m.forEach(t=>{t.update(e),t.pause&&t.pause()}),m=[],h=!1),u.forEach(t=>{t.update(e)})}(t))}let v=!1,E=!1;function I(){E||(E=!0,(c=createjs.Ticker).timingMode=c.RAF,c.interval=1e3/60,c.addEventListener("tick",x),y())}function S(){v||(v=!0,b=-1,c.paused=!1)}var T=Object.freeze({add:d,remove:p,setTimeout:function(e,t){let n={currentTime:0,func:e,update:e=>{n.currentTime>=t&&(p(n),n.func&&n.func(n.currentTime)),n.currentTime+=e}};return d(n),n},setInterval:g,clearInterval:function(e){p(e)},once:f,reset:y,init:I,play:S,pause:function(){v&&(v=!1,c.paused=!0)}});const P="login",w="relogin",R="toGame",C={ERROR:"error",CONNECT:"connect",RECONNECT:"reconnect",LOGIN:P,RELOGIN:w,IN_GAME:"inGame",EXIT_GAME:"exitGame",TO_GAME:R,BROADCAST:"broadCastMsg",DISCONNECT_MSG:"disconnectMsg",DISCONNECT:"disconnect"},N={ERROR:0,OK:1},L={SEND_LOCK:-3,CONNECT_TIMEOUT:-2,BUFFER_FULL:-1,ERROR:0,OK:1,LOGIN:3,ROOM:4,CONNECT:2};class O extends s{constructor(e,t){let n={gameEvent:{},sendEvent:{},commandManager:null,connectionToken:null,timer:null,login:null,game:{configMap:{},template:null},lobbyBuffer:{sendCommandList:[],token:null},gameBuffer:{sendCommandList:[],token:null}},s=e.Loader;super(e,t);let a=this;l.init({CMD:C,RESULT:N,STATE:L}),n.timer||(n.timer=g(function(){let e,t=n.lobbyBuffer,s=n.gameBuffer,r=t.sendCommandList;r.length>0&&(e=r.shift(),a.sendLobbyCommand(e)),(r=s.sendCommandList).length>0&&(e=r.shift(),a.sendGameCommand(e))},.2)),this.init=((e,t)=>{let r={},i=new s;if(l.create(n),a.setCommandList(n.commandManager.cmdList),e){if(e.gameTemplate){Object.getOwnPropertyNames(e.gameTemplate).forEach(t=>{i.add(t,e.gameTemplate[t]),r[t]=!0})}e.login&&i.add("login",e.login),e.gameList&&i.add("gamelist",e.gameList),i.load((e,s)=>{if(s){if(n.game.template={},Object.getOwnPropertyNames(r).forEach(e=>{s[e]&&(n.game.template[e]=s[e].data)}),s.login&&(n.login=JSON.parse(s.login.data)),s.gamelist){JSON.parse(s.gamelist.data).forEach(e=>{n.game.configMap[e.id]=e})}}n.login&&n.login.server&&n.login.server.host&&a.setHost(n.login.server.host),t&&t({login:n.login})})}else t&&t({login:null})}),this.getGame=(()=>n.game),this.getCommandManager=(()=>n.commandManager),this.gameProc=(e=>{n.commandManager&&n.commandManager.gameProc(e)}),this.setEventMap=(e=>{n.commandManager&&n.commandManager.setEventMap(e)}),this.setSendEvent=(e=>{n.sendEvent.game=e.game}),this.login=(e=>{let t={token:e.token};a.sendCommand(P,t)}),this.relogin=(()=>{let e={connectionToken:n.connectionToken};a.sendCommand(w,e)}),this.registerGameEvent=((e,t)=>{t&&(n.gameEvent[t]=e)}),this.unregisterGameEvent=(e=>{n.gameEvent[e]=null}),this.setLobbyCommand=((e,t)=>{return n.lobbyBuffer.sendCommandList.push({name:e,data:t}),L.OK}),this.sendLobbyCommand=(e=>{a.sendCommand(e.name,e.data)}),this.setGameCommand=((e,t)=>{return n.gameBuffer.sendCommandList.push({gid:t,packet:e}),L.OK}),this.sendGameCommand=(e=>{let t={gid:e.gid,packet:e.packet};a.sendCommand(R,t),n.sendEvent.game&&n.sendEvent.game(e.gid)})}static get STATE(){return L}static get CMD(){return C}static get RESULT(){return N}}function j(e){return class extends e{constructor(e){super(e,!1),this.cloneIndex=0}clone(){this.cloneIndex+=1}addToScene(e){e.addChild(this)}removeFromScene(){this.parent&&this.parent.removeChild(this)}}}var A=Object.freeze({debug:function(e,t){let n=e.getBounds(),s=e.graphics;if(!s){let a=e.anchor;s=new t.Graphics,e.graphics=s,e.addChild(s),s.x=0,s.y=0,s.lineStyle(1,16777215,1),s.beginFill(65280,.15),s.drawRect(-n.width*a.x,-n.height*a.y,n.width,n.height),s.endFill()}},make:j,default:class{constructor(){this.cloneIndex=0}clone(){this.cloneIndex+=1}addToScene(e){e.addChild(this)}removeFromScene(){let e=this;e.parent&&e.parent.removeChild(e)}}});const M="animation";let F=null;const B="button";let k=null;const _="group";let D=null;const G="image";let V=null;const U="spine";let Y=null;const X="bone";let H=null,z=null;const K="digit",J={CHAR_MAP:["0","1","2","3","4","5","6","7","8","9","."],DISPLAY:{TRANSVERSE:1,STRAIGHT:2},ALIGN_TYPE:{POS:1,RECT:2},OFFSET_TYPE:{STATIC:1,DYNAMIC:2},HORI_ALIGN:{LEFT:1,CENTER:2,RIGHT:3},VERTI_ALIGN:{TOP:1,CENTER:2,BOTTOM:3}};let q=null;const $="scrollbar";let Q=null;const W="text";let Z=null;const ee="particle";let te={demo:{alpha:{start:1,end:0},scale:{start:.1,end:1.5},color:{start:"ffffff",end:"ffffff"},speed:{start:600,end:200},startRotation:{min:0,max:360},rotationSpeed:{min:0,max:20},lifetime:{min:.5,max:.7},blendMode:"normal",frequency:16e-6,emitterLifetime:-1,maxParticles:100,pos:{x:0,y:0},addAtBack:!1,spawnType:"point"}},ne=null;let se=null,ae=null,re=null;const ie="config",oe="sound",le="texture",ce="object",ue="asset",me="spine",he="bones",de={INFO:"info",GROUP:"group",SCROLLBAR:"scrollbar",BACKGROUND:"background",PARTICLE:"particle",TEXT:"text",IMAGE:"image",SPINE:"spine",BONE:"bone",ANMIMATION:"animation",NUMBER:"number",BUTTON:"button"};let pe={event:{resBegin:null,resEnd:null,sceneResBegin:null,SceneResLoading:null,SceneResEnd:null},state:null,game:null,baseURL:"",base:0,baseProgress:0,baseIndex:0,baseMax:0,objectFactory:{},isBusy:!1,textures:null,spines:null,bonesFactory:null,soundMapList:[]},ge=e=>{let t=pe.textures,n=e&&e.split(".");return n&&n.every(e=>{let n=t[e];return!!n&&(t=n,!0)}),t},fe=e=>{let t={};return t.conf=e,t.name=e.name,t.objName=e.objName,t};function ye(e,t,n="#000000"){return PIXI.Texture.Draw(e=>{t?(e.width=t.width||140,e.height=t.height||40):(e.width=100,e.height=24);let s=e.getContext("2d");s.strokeStyle=n,s.strokeRect(0,0,e.width,e.height),s.fillStyle="#FFFFFF",s.fillRect(0,0,2,2),s.fillRect(e.width-2,0,2,2),s.fillRect(0,e.height-2,2,2),s.fillRect(e.width-2,e.height-2,2,2),s.beginPath(),s.lineCap="round",s.moveTo(0,0),s.lineTo(e.width,e.height),s.moveTo(e.width,0),s.lineTo(0,e.height),s.stroke(),s.fillStyle="#FFFFFF";let a=e.width/2,r=e.height/2;s.fillRect(a,r,2,2)})}let be=(e,t)=>{let n=null,s=e.resource.group,a=e.resource.name,r=e.pos||{x:0,y:0},i=ge(s)[a];if(e.debug){let t=ye(e.name,e);Array.isArray(i)||(i=[i]),i.push(t)}let o=ne.getConfig(e.config.name);return i&&o&&(n=new ne({game:t,conf:e,name:e.name,objName:e.objName,isInScene:e.isInScene,setting:{type:e.type,config:o,art:i,useParticleContainer:e.useParticleContainer},pos:r})),n},xe=(e,t)=>{let n,s=e.pos||{x:0,y:0},a=(e=>{let t=pe.spines,n=e&&e.split(".");return n&&n.every(e=>{let n=t[e];return!!n&&(t=n,!0)}),t})(e.resource.spineData),r=ge(e.resource.texture);return n=new Y({game:t,conf:e,name:e.name,objName:e.objName,isInScene:e.isInScene,spineDataGroup:a,textureGroup:r,pos:s})},ve=(e,t)=>{let n,s=e.pos||{x:0,y:0},a={},r={timeScale:1};return e.resource&&"string"==typeof e.resource.name&&(a.name=e.resource.name),e.animation&&(r.name=e.animation.name,r.timeScale=e.animation.timeScale),n=new z({game:t,conf:e,name:e.name,objName:e.objName,resource:a,animation:r,isInScene:e.isInScene,pos:s})},Ee=(e,t)=>{let n,s=e.pos||{x:0,y:0},a=pe.objectFactory;return n=new D({game:t,conf:e,name:e.name,objName:e.objName,isInScene:e.isInScene,pivot:e.pivot,pos:s}),e.childList&&e.childList.forEach(e=>{let s,r=a[e.type];r&&(s=r(e,t))&&(e.isInScene&&s&&n.addChild(s),n.childList.push(s))}),n},Ie=(e,t)=>{let n,s=e.pos||{x:0,y:0},a=e.anchor||{x:0,y:0};return n=new Z({game:t,conf:e,name:e.name,objName:e.objName,isInScene:e.isInScene,pos:s,anchor:a,text:e.text||"文字訊息"})},Se=(e,t)=>{let n,s=e.resource,a=s.group,r=ge(a),i=PIXI.Texture.EMPTY,o=PIXI.Texture.EMPTY;return e.debug?o=ye(e.name,e):r&&(i=r[s.slider]||i,o=r[s.background]||o),n=new Q({game:t,conf:e,name:e.name,objName:e.objName,isInScene:e.isInScene,pos:e.pos,anchor:e.anchor,slider:i,background:o})},Te=(e,t)=>{let n,s=e.resource.group,a=e.resource.name,r=e.pos||{x:0,y:0},i=e.anchor||{x:0,y:0},o=ge(s),l=PIXI.Texture.EMPTY;return"number"==typeof a&&a<0&&(a=0),e.debug?l=ye(e.name,e):o&&(l=o[a]||l),n=new V({game:t,conf:e,name:e.name,objName:e.objName,isInScene:e.isInScene,pos:r,anchor:i,texture:l})},Pe=(e,t)=>{let n,s=e.resource.group,a=e.resource.name,r=e.pos||{x:0,y:0},i=e.anchor||{x:0,y:0},o=ge(s),l=e.blend,c=PIXI.Texture.EMPTY;return"number"==typeof a&&a<0&&(a=0),"number"==typeof l?l<0&&(l=0):l=0,e.debug?c=ye(e.name,e):o&&(c=o[a]||c),(n=new V({game:t,conf:e,name:e.name,objName:e.objName,isInScene:e.isInScene,pos:r,anchor:i,alpha:e.alpha||1,texture:c})).blendMode=l,n},we=(e,t)=>{let n,s=e.resource.group,a=e.resource.name,r=e.pos||{x:0,y:0},i=e.anchor||{x:0,y:0},o=e.speed||.33,l=e.loop,c=ge(s),u=[PIXI.Texture.EMPTY];return e.debug?u=[ye(e.name,e)]:c&&(u=c[a]||u),n=new F({game:t,conf:e,name:e.name,objName:e.objName,isInScene:e.isInScene,speed:o,loop:l,pos:r,anchor:i,textures:u})},Re=(e,t)=>{let n,s=e.resource.texture,a=ge(e.resource.group),r=e.numCounts||4,i=e.offset,o=e.symbolOffset,l=e.charMap,c=e.autoHide,u={pos:{x:0,y:0},width:e.width,height:e.height},m=PIXI.Texture.EMPTY;return e.debug?m=ye(e.name,e):a&&(m=a[e.resource.background]||m),n=new q({game:t,conf:e,name:e.name,objName:e.objName,isInScene:e.isInScene,autoHide:c,fixVal:e.fixVal,useComma:e.useComma,useDash:e.useDash,useMoney:e.useMoney,pos:e.pos,anchor:e.anchor,pivot:e.pivot,rect:u,textureName:s,background:m,numCounts:r,charMap:l,symbolOffset:o,offset:i})},Ce=(e,t)=>{let n,s,a=e.resource,r=a.group,i=a.name,o=ge(r),l={enter:PIXI.Texture.EMPTY,press:PIXI.Texture.EMPTY,leave:PIXI.Texture.EMPTY,disable:PIXI.Texture.EMPTY};return e.debug?(l.enter=ye(e.name,e),l.press=l.enter,l.leave=l.enter,l.disable=l.enter):o&&o[i]&&(n=o[i],l.enter=n[a.enter]||l.enter,l.press=n[a.press]||l.press,l.leave=n[a.leave]||l.leave,l.disable=n[a.disable]||l.disable),s=new k({game:t,conf:e,name:e.name,objName:e.objName,isInScene:e.isInScene,pos:e.pos,anchor:e.anchor,texture:l})};function Ne(e){pe.objectFactory[de.INFO]=fe,pe.objectFactory[de.GROUP]=Ee,pe.objectFactory[de.SCROLLBAR]=Se,pe.objectFactory[de.BACKGROUND]=Te,pe.objectFactory[de.TEXT]=Ie,pe.objectFactory[de.IMAGE]=Pe,pe.objectFactory[de.ANMIMATION]=we,pe.objectFactory[de.NUMBER]=Re,pe.objectFactory[de.BUTTON]=Ce,pe.objectFactory[de.SPINE]=xe,pe.objectFactory[de.PARTICLE]=be,re=e.jsyaml,ae=e.Loader,(se=e.dragon)&&(pe.objectFactory[de.BONE]=ve)}function Le(e){let t,n,s=pe.event;if(pe.isBusy)return!1;pe.isBusy=!0,pe.game=e.game;let a=e.filename,r=e.proc,i=e.callback,o=e.finish,l=[],c=0,u=e=>{let a=i[c];a&&a(e),0!==c&&s.resEnd&&s.resEnd(c),(c+=1)<l.length?(s.resBegin&&s.resBegin(c),n()):t()};if(t=(()=>{pe.isBusy=!1,o&&o()}),n=(()=>{let e,t,n;e=r[c],t=l[c];try{n=re.load(t),e&&(pe.baseIndex+=1,pe.baseProgress=pe.baseIndex/pe.baseMax*100,e(n,u))}catch(e){}}),!Array.isArray(a))return!1;if(!Array.isArray(r))return!1;if(!Array.isArray(i))return!1;if(a.length!==r.length)return!1;return function(){s.sceneResBegin&&s.sceneResBegin(ie),pe.baseIndex=0,pe.baseProgress=0,pe.baseMax=1+a.length,pe.baseProgress=pe.baseIndex/pe.baseMax*100,pe.base=1/pe.baseMax;let e=new ae(pe.baseURL);a.forEach((t,n)=>{e.add(n.toString(),t)}),e.onProgress.once(e=>{let t=e.progress;t>100&&(t=100);let n=pe.baseProgress+t*pe.base;s.sceneResLoading&&s.sceneResLoading({currentProgress:t,currentLength:a.length,totalProgress:n,state:pe.state})}),e.load((e,t)=>{Object.getOwnPropertyNames(t).forEach(e=>{let n=parseInt(e);l[n]=t[e].data}),s.sceneResEnd&&s.sceneResEnd(ie),c=0,n()})}(),!0}function Oe(e){let t,n,s=pe.event;if(pe.isBusy)return!1;pe.isBusy=!0,pe.game=e.game;let a=e.objData,r=e.proc,i=e.callback,o=e.finish,l=0,c=e=>{let r=i[l];r&&r(e),0!==l&&s.resEnd&&s.resEnd(l),(l+=1)<a.length?(s.resBegin&&s.resBegin(l),n(l)):t()};if(t=(()=>{pe.isBusy=!1,o&&o()}),n=(e=>{let t,n;t=r[e],n=a[e],pe.baseIndex=e,pe.baseProgress=pe.baseIndex/pe.baseMax*100,t&&n&&t(n,c)}),!Array.isArray(a))return!1;if(!Array.isArray(r))return!1;if(!Array.isArray(i))return!1;if(a.length!==r.length)return!1;return pe.baseIndex=0,pe.baseProgress=0,pe.baseMax=a.length,pe.base=1/pe.baseMax,n(l=0),!0}function je(e){let t=pe.event;e?(t.resBegin=e.resBegin||t.resBegin,t.resEnd=e.resEnd||t.resEnd,t.sceneResBegin=e.sceneResBegin||t.sceneResBegin,t.sceneResLoading=e.sceneResLoading||t.sceneResLoading,t.sceneResEnd=e.sceneResEnd||t.sceneResEnd):(t.resBegin=null,t.resEnd=null,t.sceneResBegin=null,t.sceneResLoading=null,t.sceneResEnd=null)}function Ae(e){pe.state=e}function Me(e,t){"object"==typeof e.particle&&ne.setConfigMap(e.particle),t(e)}function Fe(e,t){let n=pe.event,s=0,a={},r=t,i=e=>{let t=e.progress;t>100&&(t=100);let s={currentProgress:t,totalProgress:pe.baseProgress+t*pe.base,state:pe.state};n.sceneResLoading&&n.sceneResLoading(s)},o=t=>{let s={};if(!t)return void r(s);let a=t.resources,i=(e,t,n)=>{let s;Object.getOwnPropertyNames(e).forEach(a=>{let r=e[a];"string"==typeof r?t[a]=n(r):Array.isArray(r)?(((e,t,n)=>{e.forEach(e=>{t.push(n(e))})})(r,s=[],n),t[a]=s):"object"==typeof r&&(i(r,s={},n),t[a]=s)})};i(e.spines,s,e=>{return a[e].spineData}),n.sceneResEnd&&n.sceneResEnd(me),pe.spines=s,r(s)},l=e=>{a[e]=e},c=(e,t)=>{Object.getOwnPropertyNames(e).forEach(n=>{let s=e[n];"string"==typeof s?t(s):Array.isArray(s)?((e,t)=>{e.forEach(e=>{t(e)})})(s,t):"object"==typeof s&&c(s,t)})};(()=>{if(n.sceneResBegin&&n.sceneResBegin(me),e&&e.spines){c(e.spines,l);let t=Object.getOwnPropertyNames(a);if(0===(s=t.length))o();else{let e=new PIXI.loaders.Loader(pe.baseURL);t.forEach(t=>{e.add(t,t)}),e.on?(e.on("progress",i),e.once("complete",o),e.load()):(e.onProgress.add(i),e.load(o))}}else o()})()}function Be(e,t){let n=pe.event,s={},a=t,r=e=>{let t=e.progress;t>100&&(t=100),t=pe.baseProgress+t*pe.base,n.sceneResLoading&&n.sceneResLoading({current:t,length:100,state:pe.state})},i=t=>{let s=null;if(se&&(s=new se.dragonBones.PixiFactory),!t)return void a(s);let r=t.resources,i=(e,t,n)=>{e.forEach(e=>{t.push(n(e))})};i(e.bones.data,[],e=>{let t=r[e].data;return s&&s.parseDragonBonesData(t),t});i(e.bones.resource,[],e=>{let t=r[e.atlas]&&r[e.atlas].data;if(t=JSON.parse(t),s){let n=ge(e.texture.group)[e.texture.name];s.parseTextureAtlasData(t,n)}return t}),n.sceneResEnd&&n.sceneResEnd(he),pe.bonesFactory=s,z.setFactory(s),a(s)},o=e=>{s[e]=e},l=e=>{s[e.atlas]=e.atlas},c=(e,t)=>{e.forEach(e=>{t(e)})},u=(e,t)=>{Object.getOwnPropertyNames(e).forEach(n=>{let s=e[n];"string"==typeof s?t(s):Array.isArray(s)?c(s,t):"object"==typeof s&&u(s,t)})};(()=>{if(n.sceneResBegin&&n.sceneResBegin(he),e&&e.bones&&e.bones.data){u(e.bones.data,o),c(e.bones.resource,l);let t=Object.getOwnPropertyNames(s);if(0===t.length)i();else{let e=new PIXI.loaders.Loader(pe.baseURL);t.forEach(t=>{e.add(t,t)}),e.on?(e.on("progress",r),e.once("complete",i),e.load()):(e.onProgress.add(r),e.load(i))}}else i()})()}function ke(e,t){let n,s=e.objects,a=pe.objectFactory,r=[],i=0,o=0,l=pe.event,c=[];l.sceneResBegin&&l.sceneResBegin(ce),o=s.length,s.forEach(e=>{let t=a[e.type];t?(n=t(e,pe.game))&&r.push(n):c.push(e);let s=(i+=1)/o*100,u={currentProgress:s,totalProgress:pe.baseProgress+s*pe.base,state:pe.state};l.sceneResLoading&&l.sceneResLoading(u)}),l.sceneResEnd&&l.sceneResEnd(ce),t&&t(r,c)}function _e(e,t){let n={},s=!1,a={},r=pe.event,i={};pe.textures=null;let o=0,l={currentProgress:0,totalProgress:pe.baseProgress,state:pe.state};r.sceneResLoading&&r.sceneResLoading(l);let c=e=>{let t=e.progress;t>100&&(t=100);let n=0,s={currentProgress:t,totalProgress:n=o>0?100*o+pe.baseProgress+t*o:pe.baseProgress+t*pe.base,state:pe.state};r.sceneResLoading&&r.sceneResLoading(s)},u=()=>{let s,a=e=>{let t=PIXI.Texture.fromImage(pe.baseURL+e,!0);return t.baseTexture.scaleMode=PIXI.SCALE_MODES.NEAREST,t},i=(e,t,n)=>{e.forEach(e=>{t.push(n(e))})},o=(e,t,n)=>{let s;Object.getOwnPropertyNames(e).forEach(a=>{let r=e[a];"string"==typeof r?t[a]=n(r):Array.isArray(r)?(i(r,s=[],n),t[a]=s):"object"==typeof r&&(o(r,s={},n),t[a]=s)})};(s=Object.getOwnPropertyNames(e.images)).forEach(t=>{let s,r=n[t];s=e.images[t],Array.isArray(s)?r?i(s,r,a):(i(s,r=[],a),n[t]=r):"object"==typeof s?r?o(s,r,a):(o(s,r={},a),n[t]=r):"string"==typeof s&&(n[t]=a(s))}),r.sceneResEnd&&r.sceneResEnd(le),pe.textures=n,t&&t(n)},m=e=>{let t=e.progress;t>100&&(t=100);let n=0,s={currentProgress:t,totalProgress:n=o>0?pe.baseProgress+t*o:pe.baseProgress+t*pe.base,state:pe.state};r.sceneResLoading&&r.sceneResLoading(s)},h=null,d=()=>{r.sceneResEnd&&r.sceneResEnd(ue),h(e)},p=e=>{a[e]=e},g=(e,t)=>{e.forEach(e=>{t(e)})},f=(e,t)=>{if(!e)return;Object.getOwnPropertyNames(e).forEach(n=>{let s=e[n];"string"==typeof s?t(s):Array.isArray(s)?g(s,t):"object"==typeof s&&f(s,t)})},y=e=>PIXI.Texture.fromFrame(e),b=(e,t,n)=>{e.forEach(e=>{t.push(n(e))})},x=(e,t,n)=>{Object.getOwnPropertyNames(e).forEach(s=>{let a=e[s],r=[];"string"==typeof a?t[s]=n(a):Array.isArray(a)?(b(a,r,n),t[s]=r):"object"==typeof a&&(t[s]=r,x(a,r,n))})};if(h=(e=>{let i,o,l;if(e.images){(i=Object.getOwnPropertyNames(e.images)).forEach(t=>{let n;n=e.images[t],Array.isArray(n)?g(n,p):"object"==typeof n?f(n,p):"string"==typeof n&&p(n)}),o=Object.getOwnPropertyNames(a),r.sceneResBegin&&r.sceneResBegin(le);let t=new PIXI.loaders.Loader(pe.baseURL);o.forEach(e=>{t.add(e,e)}),t.on?(t.on("progress",c),t.once("complete",u),t.load()):(t.onProgress.add(c),t.load(u))}else s=!0;e.frames&&(l=Object.getOwnPropertyNames(e.frames)).forEach(t=>{let s,a=n[t];s=e.frames[t],Array.isArray(s)?a?b(s,a,y):(b(s,a=[],y),n[t]=a):"object"==typeof s?a?x(s,a,y):(x(s,a=[],y),n[t]=a):"string"==typeof s&&(n[t]=y(s))}),s&&(pe.textures=n,t&&t(n))}),e&&Array.isArray(e.assets)){e.images&&(o=.5*pe.base),r.sceneResBegin&&r.sceneResBegin(ue);let t=new PIXI.loaders.Loader(pe.baseURL);e.assets.forEach(e=>{t.add(e)}),t.on?(t.on("progress",m),t.once("complete",d),t.load()):(t.onProgress.add(m),t.load(d))}else h(e),i.textures=n;return i}function De(e){pe.textures=e}function Ge(e){pe.spines=e}function Ve(e,t){let n,s,a,r=0,i=0,o=pe.event,l={},c=pe.soundMapList;if(!Howl||!e.sounds)return t&&t(null),!1;s=Object.getOwnPropertyNames(e.sounds),o.sceneResBegin&&o.sceneResBegin(oe);let u=0,m=0;r=0;let h=pe.baseURL;return s.forEach(t=>{let s={};a=e.sounds[t],i=a.length,m+=i,a.forEach(e=>{let t=e.config.src;if(Array.isArray(e.config.src)){let t=[];e.config.src.forEach(e=>{t.push(h+e)}),e.config.src=t}n=new Howl(e.config),e.config.src=t,s[e.objName]=n,u=(r+=1)/m*100;let a=pe.baseProgress+u*pe.base,i={currentProgress:u,totalProgress:a,state:pe.state};o.sceneResLoading&&o.sceneResLoading(i)}),a.length>0?l[t]=s:l[t]=null}),o.sceneResEnd&&o.sceneResEnd(oe),c.push(l),t&&t(l),!0}function Ue(e){Object.getOwnPropertyNames(e).forEach(t=>{let n=e[t];n&&n.stop?(n.stop(),n.unload()):Ue(n),delete e[t]})}var Ye=Object.freeze({OBJ_TYPE:de,createDebugTxeture:ye,createGroup:Ee,init:Ne,registerFactory:function(e){pe.objectFactory[e.type]=e.create},loadScene:Le,loadSceneEx:Oe,setEvent:je,setState:Ae,createRawData:Me,createSpineData:Fe,createBonesData:Be,createObject:ke,createTexture:_e,setTextures:De,setSpineData:Ge,setBaseURL:function(e){pe.baseURL=e||""},getBaseURL:function(){return pe.baseURL},getTextures:function(e,t){let n,s=e;return t.split(".").every(function(e){return!!(n=s[e])&&(s=n,!0)}),s},createSound:Ve,destroySound:Ue,destroyAllSound:function(){pe.soundMapList.forEach(e=>{Object.getOwnPropertyNames(e).forEach(t=>{Ue(e[t]),delete e[t]})})}});let Xe={isBusy:!1,game:null,loading:null,useLobbyState:!1,state:{currentIndex:0,totals:0}};var He=Object.freeze({go:function(e,t){if(Xe.isBusy||!Xe.game||!Array.isArray(e))return!1;let n,s,a=Xe.game,r=Xe.loading,i=0,o=e.length,l=t,c=e;return Ae(Xe.state),n=(()=>{if(i<o){let e=c[i].scene;i+=1,e?s(e):n()}else Xe.isBusy=!1,Xe.useLobbyState||r&&r.setState(!0),l&&l()}),s=(e=>{Xe.state.currentIndex=i,Xe.state.totals=o,Xe.useLobbyState?!e.isCreate()&&e.createScene?e.createScene(n):n():!e.isCreate()&&e.createScene?r.go({game:a,layer:a.layer&&a.layer.overlay,load(t){e.createScene(t)},resourceFinish:n}):n()}),Xe.isBusy=!0,n(),!0},setUseLobbyState:function(e){Xe.useLobbyState=e,e&&Xe.game&&Xe.game.scene?je(Xe.game.scene.loadingEvent):Xe.useLobbyState=!1},setGame:function(e){Xe.game=e},setDisplayLoading:function(e){Xe.loading=e}});let ze={init:null,release:null,resource:null,eventResBegin:null,eventResCheck:null,eventResEnd:null,eventStart:null,eventEnter:null,eventLeave:null},Ke=null,Je=null;function qe(e){Ke&&Ke(e)}class $e{static resCreate(e){ze.resource&&ze.resource(e)}static frameStart(e){ze.eventStart&&ze.eventStart(e),Ke=$e.frameEnter}static frameFinish(e){ze.release&&ze.release(e),Ke=null,Je&&(Je(),Je=null)}static frameEnter(e){let t=!0;ze.eventEnter&&(t=ze.eventEnter(e)),t&&(Ke=$e.resBegin)}static frameLeave(e){let t=!0;ze.eventLeave&&(t=ze.eventLeave(e)),t&&(Ke=$e.frameFinish)}static resBegin(e){ze.eventResBegin&&ze.eventResBegin(e),$e.resCreate(),Ke=$e.resLoading}static resLoading(e){ze.eventResCheck?ze.eventResCheck(e)&&(Ke=$e.resEnd):Ke=$e.resEnd}static resEnd(e){ze.eventResEnd&&ze.eventResEnd(e),Ke=$e.frameLeave}}function Qe(e){return"object"==typeof e&&(ze.init=e.init,ze.release=e.release,ze.resource=e.resource,ze.eventResBegin=e.resBegin,ze.eventResCheck=e.resCheck,ze.eventResEnd=e.resEnd,ze.eventStart=e.start,ze.eventEnter=e.enter,ze.eventLeave=e.leave,Je=e.finish),ze.init&&ze.init(),Ke=$e.frameStart,!0}var We=Object.freeze({refresh:qe,go:Qe});let Ze={event:null,scene:{anim:null,message:null,percent:null},isInit:!1,strings:null,resList:null,state:!1},et=null;var tt=Object.freeze({setState:function(e){Ze.state=e},setStrings:function(e){Ze.strings=e},setPosition:function(e){let t=Ze.scene.anim;t&&(t.x=e.x,t.y=e.y),Ze.pos?(Ze.pos.x=e.x,Ze.pos.y=e.y):Ze.pos={x:e.x,y:e.y}},setScene:function(e){Ze.resList=e,Ze.isInit=!1},go:function(e){let t=e.loadingEvent||{},n=e.resourceFinish||null,s=e.game,a=Ze.strings;je(et={resBegin(e){t.resBegin&&t.resBegin(e),Ze.percent&&(Ze.percent.text="0%")},resEnd(e){t.resEnd&&t.resEnd(e)},sceneResBegin(e){let n=e;a&&a.get&&(n=a.get(e)),t.sceneResBegin&&t.sceneResBegin(e)},sceneResLoading(e){let n=e.state,s=e.totalProgress;n&&(s=(n.currentIndex-1)/n.totals*100+s/n.totals);let a=s.toFixed(0)+"%";t.sceneResLoading&&t.sceneResLoading(e),Ze.percent&&(Ze.percent.text=a)},sceneResEnd(e){let n=e;a&&a.get&&(n=a.get(e)),t.sceneResEnd&&t.sceneResEnd(e)}});let r={name:"loading",screen:{width:s.screen&&s.screen.width||1024,height:s.screen&&s.screen.height||768},movieClip:null,layer:e.layer||null,load:e.load,init:()=>{if(!Ze.isInit){Ze.isInit=!0;let e,t=Ze.resList,n=[];t.forEach(t=>{e=PIXI.Texture.fromImage(t),n.push(e)});let s=new PIXI.extras.AnimatedSprite(n);s.animationSpeed=.33,s.anchor.x=.5,s.anchor.y=.5,Ze.scene.anim=s;let a=new PIXI.Text("message");a.style.fill="#FFFFFF",a.style.stroke="#006600",a.style.strokeThickness=1,a.anchor.x=.5,a.anchor.y=.5,a.x=0,a.y=-44,Ze.message=a;let i=new PIXI.Text("init");i.style.fill="#FFFFFF",i.style.stroke="#aa0000",i.style.strokeThickness=1,i.anchor.x=.5,i.anchor.y=.5,i.x=0,i.y=24,Ze.percent=i,s.addChild(a),s.addChild(i),Ze.pos||(Ze.pos={x:r.screen.width/2,y:r.screen.height/2}),Ze.anchor=new PIXI.Point(.5,.5)}s.addRefresh(r.name,qe)},release:()=>{null!==r.layer&&null!==Ze.scene.anim&&r.layer.removeChild(Ze.scene.anim),s.removeRefresh(r.name)},resource:()=>{r.load?r.load(n):n&&n()},resBegin:()=>{},resCheck:()=>Ze.state,resEnd:()=>{},start:()=>{if(null!==r.layer&&null!==Ze.scene.anim){let e=Ze.scene.anim;e.x=Ze.pos.x,e.y=Ze.pos.y,e.anchor.x=Ze.anchor.x,e.anchor.y=Ze.anchor.y,e.alpha=0,e.gotoAndPlay(0),r.layer.addChild(e)}},enter:()=>{let e=!1,t=Ze.scene.anim;return null!==t?t.alpha>=1?(t.alpha=1,e=!0):t.alpha+=.05:e=!0,e},leave:()=>{let e=!1,t=Ze.scene.anim;return null!==t?(t.alpha<=0&&(t.alpha=0,e=!0),t.alpha-=.05,t.alpha<=0&&(t.alpha=0)):e=!0,e},finish:()=>{}};return Ze.event=r,Ze.state=!1,Qe(Ze.event)}});let nt=!1,st=null;class at{constructor(){let e=this,t=null,n={debug:!1,timeBase:1,currentTime:-1,renderer:null,pause:!0,isInit:!1},s=null,a=[],r=[],i={};e.custom={},e.setEngine=(e=>{s=e}),e.setElement=(e=>{n.element=e}),e.update=(e=>{n.debug&&t&&t.begin(),n.currentTime<0&&(e=0,n.currentTime=1),e*=n.timeBase,a.forEach(t=>{let n=i[t];n.update?n.update(e):n(e)}),r.forEach(t=>{t.update&&t.update(e)}),!n.pause&&s&&s.render(e),n.debug&&t&&t.end()}),n.debug=!1,e.addRefresh=((e,t)=>{i[e]=t,a=Object.getOwnPropertyNames(i)}),e.removeRefresh=(e=>{i.hasOwnProperty(e)&&(delete i[e],a=Object.getOwnPropertyNames(i))}),e.addUpdate=(e=>{let t=!1;return e&&e.update&&!e.hasOwnProperty("__updateIndex")&&(e.__updateIndex=r.length,r[e.__updateIndex]=e,t=!0),t}),e.removeUpdate=(e=>{let t,n,s=r.length;if("number"==typeof e.__updateIndex){if((t=e.__updateIndex)>=0&&t<s){let e=s-1;n=r[e],r[t]=n,n.__updateIndex=t,r.splice(e,1)}delete e.__updateIndex}}),e.resetUpdate=(()=>{r.forEach(e=>{delete e.__updateIndex}),r=[]}),e.setTimeout=((t,n)=>{let s={currentTime:0,func:t,update:t=>{s.currentTime.toFixed(2)>=n&&(e.removeUpdate(s),s.func&&s.func(s.currentTime)),s.currentTime+=t}};return e.addUpdate(s),s}),e.setInterval=((t,n)=>{let s=0,a={func:t,update:e=>{(s+=e).toFixed(2)>=n&&(a.func&&a.func(s),s=0)}};return e.addUpdate(a),a}),e.clearInterval=(t=>{e.removeUpdate(t)}),e.isPause=(()=>n.pause),e.play=(()=>{n.pause&&(n.pause=!1,n.currentTime=-1,d(e))}),e.once=(()=>{n.pause=!1,n.currentTime=-1,f(e)}),e.pause=(()=>{n.pause||(n.pause=!0,p(e))}),e.stop=(()=>{n.pause=!0,p(e),e.resetUpdate()}),e.add=(e=>{n.timeBase<1&&(n.timeBase=1),n.timeBase+=e,n.timeBase>4&&(n.timeBase=4)}),e.dec=(e=>{n.timeBase>1&&(n.timeBase=1),n.timeBase-=e,n.timeBase<.1&&(n.timeBase=.1)}),e.reset=(()=>{n.timeBase=1}),e.getTimeBase=(()=>n.timeBase),e.setTimeBase=(e=>{n.timeBase=e,n.timeBase<.1?n.timeBase=.1:n.timeBase>4&&(n.timeBase=4)}),e.init=(t=>{if(n.isInit)return!1;n.isInit=!0,n.element=t.element,n.currentTime=-1;let s={width:t.width,height:t.height};return e.pause(),e.screen=s,!0}),e.getRenderer=(()=>s&&s.renderer),Object.defineProperty(e,"layer",{get:()=>s&&s.layer}),Object.defineProperty(e,"debug",{set(s){t||st&&(t=new st,e.stats=t),s?t&&n.element&&(t.dom.style.position="absolute",n.element.appendChild(t.dom)):t&&n.element&&t.dom.parentElement&&n.element.removeChild(t.dom),n.debug=s},get:()=>n.debug}),e.stats=null}}let rt=!1;let it=null;let ot={position:"absolute",left:"0%",top:"0%",width:"100%",height:"100%"},lt={zIndex:10,position:"absolute",left:"0%",top:"0%",width:"100%",height:"100%"},ct={oninit(e){let t=e.attrs,n=e.attrs.config;rt||(rt=!0,PIXI.Texture.Draw=(e=>{let t=document.createElement("canvas");return"function"==typeof e&&e(t),PIXI.Texture.fromCanvas(t)})),this.config=n,this.game=n.game,this.style=t.style||lt,this.ready=t.ready},oncreate(e){let t=this,n=t.config;n.canvas=e.instance.children[0].dom,n.element=e.dom;let s=t.game;s||(s=new at,t.game=s),s.init(n);let a=function(e){let t,n,s={},a={width:e.width,height:e.height,view:e.canvas,resolution:e.resolution,antialias:e.antialias,transparent:e.transparent};return n=PIXI.autoDetectRenderer(a),t=new PIXI.Container,s.stage=t,s.overlay=new PIXI.Container,s.foreground=new PIXI.Container,s.main=new PIXI.Container,s.background=new PIXI.Container,t.addChildAt(s.overlay,0),t.addChildAt(s.foreground,0),t.addChildAt(s.main,0),t.addChildAt(s.background,0),{renderer:n,stage:t,layer:s,render(){n.render(t)}}}(n);s.setEngine(a),n&&n.ready&&n.ready(s),t.ready&&t.ready(s)},onremove(){let e=this.game;e&&e.stop()},view(){return it(".",{style:this.style},it("canvas",{style:ot}))}};function ut(e){!function(e){!nt&&(st=e.Stats,nt=!0)}(e),Ne(e),it=e.m}var mt=Object.freeze({init:ut,run:function(e){let t;if(t=new at,window.parent&&window.parent!==window){let n,s;if(window.Howl=window.parent.Howl,window.Howler=window.parent.Howler,window.parent.scene){let a=e.id,r=e.event||{};n=window.parent.scene[a],Object.defineProperty(t,"scene",{get:()=>n}),n&&n.event&&(s={create(e){window.parent.lobby&&(t.table=window.parent.lobby.table[e.id],t.currentUser=window.parent.lobby.currentUser,t.command=window.parent.lobby.net.gameCommand,t.lobby={setEvent:window.parent.lobby.setEvent,setCommand:window.parent.lobby.net.setLobbyCommand,CMD:window.parent.lobby.net.CMD}),r.create&&(e.game=t,r.create(e))},play(e){t.play(),r.play&&(e.game=t,r.play(e))},pause(e){t.pause(),r.pause&&(e.game=t,r.pause(e))},enter(e){r.enter&&(e.game=t,r.enter(e))},leave(e){r.leave&&(e.game=t,r.leave(e))},focus(){r.focus&&r.focus()},blur(){r.blur&&r.blur()},lock(e){r.lock&&r.lock(e)},fullscreen(e){r.fullscreen&&r.fullscreen(e)},resize(e){r.resize&&r.resize(e)},music(e){r.music&&r.music(e)},sound(e){r.sound&&r.sound(e)}},n.setEvent(s),n.game=t)}}return t}});let ht={Base:class{constructor(e){let t={name:e,root:null,game:null,center:{entity:{}},initMap:null,currentTime:0,isCreate:!1,isInScene:!1};this.properties=t,Object.defineProperty(this,"center",{get:()=>t.center}),Object.defineProperty(this,"entity",{get:()=>t.center.entity})}getName(){return this.properties.name}getGame(){return this.properties.game}isCreate(){return this.properties.isCreate}isInScene(){return this.properties.isInScene}getCurrentTime(){return this.properties.currentTime}getCenter(){return this.properties.center}getRoot(){return this.properties.root}setRoot(e){let t=this.properties;t.root=e,t.center=e.center}setInitMap(e){this.properties.initMap=e}setLayer(e){this.properties.center.layer=e}getLayer(){return this.properties.center.layer}getRawData(){return this.properties.center.rawdata}getSound(e){let t=this.properties.center.sounds;return t&&"string"==typeof e&&(t=t[e]),t}mute(e,t){let n=this.properties.center.sounds[e];n&&Object.getOwnPropertyNames(n).forEach(e=>{n[e].mute(t)})}getTexture(e){let t=this.properties.center.textures;return t&&"string"==typeof e&&(t=t[e]),t}getObject(){return this.properties.center.objs}getEntity(){return this.properties.center.entity}eventFinish(){let e=this,t=e.properties;De(t.center.textures),Ge(t.center.spines),t.initMap&&t.initMap(e)}eventRawData(e){}eventSound(e){}eventTexture(e){}eventSpine(e){}eventBones(e){}eventObject(e){}refresh(e){let t=this.getCenter();t&&t.update&&t.update(e)}setGame(e,t){let n=this.properties;n.game=e,e.layer.hasOwnProperty(t)&&(n.center.layer=e.layer[t])}addToScene(e){let t=this,n=t.properties;if(n.isInScene)return!1;n.isInScene=!0;let s=n.center;n.currentTime=-1,n.game=e||n.game,n.game&&n.game.addRefresh(n.name,function(e){n.currentTime<0?(n.currentTime=0,e=0):t.currentTime+=e,t.refresh(e)});let a=s.layer;return!s||!s.objs||(s.objs.forEach(e=>{e&&(e._game=n.game||e._game,e.isInScene&&(e.addToScene?e.addToScene(a):a.addChild(e)))}),!0)}removeFromScene(){let e=this.properties;if(!e.isInScene)return!1;e.isInScene=!1,e.game&&e.game.removeRefresh(e.name);let t=e.center;return!t||!t.objs||(t.objs.forEach(e=>{e&&(e.removeFromScene?e.removeFromScene():e.parent&&e.parent.removeChild(e))}),!0)}init(e){let t=this.properties.center;const n=de;if(!t||!t.objs)return;let s=t.entity,a={};e&&(a=e.set||{}),a.setupGroup=a.setupGroup||(e=>{e.childList.forEach(t=>{if(t){let n=t.conf;n.objName&&(e[n.objName]=t,t.objName)}}),e.childList.forEach(e=>{if(e){let t=e.conf;n.GROUP===e.type&&a.setupGroup(e,t),t&&a.hasOwnProperty(t.init)&&a[t.init](e)}})}),t.objs.forEach(e=>{let t="";e&&e.objName&&(s[e.objName]=e,t='set entity name"'+e.objName+'"')}),t.objs.forEach(e=>{let t,s="";e&&(t=e.conf,n.GROUP===e.type&&a.setupGroup(e,t),t&&a.hasOwnProperty(t.init)&&(s=(e.name||e.objName)+" init : "+t.init,a[t.init](e,t)))})}createScene(e,t){let n=this,s=n.properties;if(s.isCreate)return e&&e(),!1;let a=t.infoList,r=s.center,i={data:{proc:Me,callback:e=>{r&&(r.rawdata=e),n.eventRawData(e)}},sound:{proc:Ve,callback:e=>{r&&(r.sounds=e),n.eventSound(e)}},texture:{proc:_e,callback:e=>{r&&(r.textures=e),n.eventTexture(e)}},spine:{proc:Fe,callback:e=>{r&&(r.spines=e),n.eventSpine(e)}},bone:{proc:Be,callback:e=>{r&&(r.bonesFactory=e),n.eventBones(e)}},object:{proc:ke,callback:e=>{r&&(r.objs?e.forEach(e=>{r.objs.push(e)}):r.objs=e),n.eventObject(e)}}};function o(){s.isCreate=!0,r&&r.createFinish&&r.createFinish()}if(r&&(r.createFinish=e),t.isObject){let e={game:s.game,objData:[],proc:[],callback:[],finish:o};a&&Array.isArray(a)&&a.forEach(t=>{let n=i[t.eventName];n&&t.obj&&n.proc&&(e.objData.push(t.obj),e.proc.push(n.proc)),e.callback.push(n.callback)}),Oe(e)}else{let e={game:s.game,filename:[],proc:[],callback:[],finish:o};a&&Array.isArray(a)&&a.forEach(t=>{let n=i[t.eventName];n&&t.filename&&e.filename.push(t.filename),e.proc.push(n.proc),e.callback.push(n.callback)}),Le(e)}return!0}destroyScene(){this.removeFromScene();let e=this.properties,t=e.center;return!!e.isCreate&&(t&&(t.bonesFactory&&(t.bonesFactory.clear(),t.bonesFactory=null),t.sounds)&&Ue(t.sounds),t.objs&&(t.objs.forEach((e,n)=>{e&&delete t.objs[n]}),t.objs=null),e.isCreate=!1,!0)}},sceneManager:Ye,loadingManager:He,loading:We},dt={loading:tt,base:A},pt={game:{pixi:ct}},gt=!1;function ft(e){let t=e||{},s=t.plugin||[];return Array.isArray(s)||(s=[]),new Promise(e=>{gt&&e("!! init finish again !!"),function a(r){if(r&&r.Spine&&(PIXI.spine=r),s.length>0){let e=s.shift();System.import(e).then(a)}else t.sceneManager=Ye,t.PIXI&&(function(e){let t=e.PIXI;F=class extends(j(t.extras.AnimatedSprite)){static get TYPE(){return M}constructor(e){super(e.textures||[t.Texture.EMPTY],!1);let n=this;n._game=e.game,n.conf=e.conf,n.type=M,n.name=e.name,n.objName=e.objName||null,n.isInScene=e.isInScene,e.pos&&(n.x=e.pos.x,n.y=e.pos.y),e.anchor&&(n.anchor.x=e.anchor.x||0,n.anchor.y=e.anchor.y||0),n.loop=e.loop,"number"==typeof e.speed&&(n.animationSpeed=e.speed)}clone(e){super.clone();let t={game:e||this._game,conf:this.conf,isInScene:this.isInScene,name:this.name+".clone."+this.cloneIndex,loop:this.loop,speed:this.animationSpeed,pos:this.position,anchor:this.anchor,textures:this.textures};return new F(t)}removeFromScene(){super.removeFromScene(),this._game&&this._game.removeUpdate(this)}addToScene(e){e.addChild(this),this.playing&&this._game&&this._game.addUpdate(this)}play(){this._game&&this._game.addUpdate(this),super.play()}stop(){this._game&&this._game.removeUpdate(this),super.stop()}update(e){super.update(60*e)}}}(t),function(e){let t=e.PIXI;k=class extends(j(t.Sprite)){static get TYPE(){return B}constructor(e){super(e.texture&&e.texture.leave||t.Texture.EMPTY);let n=this;n._game=e.game,n.type=B,n.conf=e.conf,n.objName=e.objName||null,n.name=e.name,n.isInScene=e.isInScene,e.pos&&(n.x=e.pos.x,n.y=e.pos.y),e.anchor&&(n.anchor.x=e.anchor.x||0,n.anchor.y=e.anchor.y||0),n.scale.x=1,n.buttonMode=!0,n.interactive=!0;let s={};n.custom=s,s.texture=e.texture||{enter:t.Texture.EMPTY,leave:t.Texture.EMPTY,press:t.Texture.EMPTY,disable:t.Texture.EMPTY},s.isPress=!1,s.flagDrag=!1,s.canMove=!1,s.timer=null,s.obj=null,n.touchstart=n.mousedown=(e=>{s.flagDrag&&s.timer&&(n.dragEvent&&(n.dragEvent.curTimes=n.dragEvent.times,n.dragEvent.reset&&n.dragEvent.reset()),s.timer.restart()),n.eventPress(e)}),n.touchend=n.mouseup=(e=>{s.canMove=!1,s.flagDrag&&n.dragEvent&&n.dragEvent.reset&&n.dragEvent.reset(),n.eventRelease(e)}),n.mouseover=(e=>{s.flagDrag&&n.dragEvent&&n.dragEvent.reset&&n.dragEvent.reset(),n.eventEnter(e)}),n.mouseout=(e=>{s.canMove=!1,s.flagDrag&&n.dragEvent&&n.dragEvent.reset&&n.dragEvent.reset(),n.eventLeave(e)}),n.touchendoutside=n.mouseupoutside=(e=>{s.flagDrag&&n.dragEvent&&n.dragEvent.reset&&n.dragEvent.reset(),n.eventLeave(e)})}clone(e){super.clone();let t={game:e||this._game,conf:this.conf,isInScene:this.isInScene,name:this.name+".clone."+this.cloneIndex,pos:this.position,anchor:this.anchor,texture:this.custom.texture};return new k(t)}setTexture(e){let n=this.custom.texture;n.enter=e.enter||t.Texture.EMPTY,n.leave=e.leave||t.Texture.EMPTY,n.press=e.press||t.Texture.EMPTY,n.disable=e.disable||t.Texture.EMPTY,this.update()}setClick(e,t){this.eventClick=e,this.obj=t}eventPress(){let e=this.custom.texture;this.texture=e.press,this.custom.isPress=!0}eventRelease(){let e=this,t=e.custom.texture;e.custom.isPress?(e.texture=t.leave,"function"==typeof e.eventClick&&e.eventClick(e,e.obj)):e.texture=t.leave,e.custom.isPress=!1}eventEnter(){let e=this,t=e.custom.texture;e.custom.isPress?e.texture=t.press:e.texture=t.enter}eventLeave(){let e=this.custom.texture;this.texture=e.leave,this.custom.isPress=!1}setDragEnable(e){let t=this,n=t.custom;n.flagDrag=!0,t.mousemove=t.touchmove=(e=>{if(n.canMove){n.isPress=!1;let s={x:parseInt(e.data.global.x),y:parseInt(e.data.global.y)};t.x=s.x,t.y=s.y}}),t.dragEvent=e,t.dragEvent||(t.dragEvent={},t.dragEvent.times=10),t.dragEvent.curTimes=t.dragEvent.times}setDragDisable(){this.custom.flagDrag=!1,this.mousemove=this.touchmove=null}setEnable(e,t){e?this.enable(t):this.disable(t)}enable(e){this.interactive=!0;let t=this.custom.texture;e&&(this.texture=t.leave)}isEnabled(){return this.interactive}disable(e){this.interactive=!1;let t=this.custom.texture;e&&(this.texture=t.disable)}update(){let e=this.custom.texture;this.interactive?this.texture=e.leave:this.texture=e.disable}}}(t),function(e){let t=e.PIXI,n=e.sceneManager;D=class extends(j(t.Container)){static get TYPE(){return _}constructor(e){super();let t=this;t._game=e.game,t.conf=e.conf,t.type=_,t.name=e.name,t.objName=e.objName||null,t.isInScene=e.isInScene,t.childList=[],e.pos&&(t.x=e.pos.x||0,t.y=e.pos.y||0),e.pivot&&(t.pivot.x=e.pivot.x||0,t.pivot.y=e.pivot.y||0)}clone(e){super.clone();let t=null;this.conf&&this.conf.childList&&(t=this.conf.childList);let s={game:e||this._game,childList:t,isInScene:this.isInScene,name:this.name+".clone."+this.cloneIndex,pivot:this.pivot,pos:this.position};return n.createGroup(s,this._game)}removeFromScene(){super.removeFromScene(),this.stop()}stop(){this.childList.forEach(e=>{e.stop&&e.stop()})}}}(t),function(e){let t=e.PIXI;V=class extends(j(t.Sprite)){static get TYPE(){return G}constructor(e){super(e.texture||t.Texture.EMPTY);let n=this;n._game=e.game,n.conf=e.conf,n.type=G,n.name=e.name,n.objName=e.objName,n.isInScene=e.isInScene,e.pos&&(n.x=e.pos.x,n.y=e.pos.y),e.anchor&&(n.anchor.x=e.anchor.x||0,n.anchor.y=e.anchor.y||0)}clone(e){super.clone();let t={game:e||this._game,conf:this.conf,isInScene:this.isInScene,name:this.name+".clone."+this.cloneIndex,pos:this.position,anchor:this.anchor,alpha:this.alpha,texture:this.texture};return new V(t)}}}(t),function(e){let t=e.PIXI;q=class extends(j(t.Sprite)){static get TYPE(){return K}static get NUM(){return J}constructor(e){super(e.background||t.Texture.EMPTY);let n,s=this;s._game=e.game,s.conf=e.conf,s.type=K,s.name=e.name,s.objName=e.objName,s.isInScene=e.isInScene;let a,r,i,o,l,c,u,m={},h={};for(m.rect=h,m.event={},s.custom=m,h.pos=new t.Point(0,0),h.anchor=new t.Point(0,0),h.width=e.width||64,h.height=e.height||16,e.rect&&(e.rect.pos&&(h.x=e.rect.pos.x,h.y=e.rect.pos.y),e.rect.anchor&&(h.anchor.x=e.rect.anchor.x,h.anchor.y=e.rect.anchor.y),h.width=e.rect.width||h.width,h.height=e.rect.height||h.height),m.textureName=e.textureName||"",m.numCounts=e.numCounts||4,m.charMap=e.charMap||J.CHAR_MAP,m.shift=1,"number"==typeof e.shift&&(m.shift=e.shift),m.enable=!1,m.display=e.display||J.DISPLAY.TRANSVERSE,m.alignType=e.alignType||J.ALIGN_TYPE.RECT,m.offsetType=e.offsetType||J.OFFSET_TYPE.STATIC,m.horiType=e.horiType||J.HORI_ALIGN.LEFT,m.vertiType=e.vertiType||J.VERTI_ALIGN.TOP,m.alpha=1,m.anchor={x:0,y:0},e.anchor&&(m.anchor.x=e.anchor.x,m.anchor.y=e.anchor.y),m.lastCnt=0,m.value=0,m.currentValue=0,m.targetValue=0,m.offsetValue=0,m.background=e.background||t.Texture.EMPTY,m.autoHide=e.autoHide,m.useComma=e.useComma,m.useMoney=e.useMoney,m.useDash=e.useDash,"number"==typeof e.fixVal?m.fixVal=e.fixVal:m.fixVal=0,e.pos&&(s.x=e.pos.x,s.y=e.pos.y),e.pivot&&(s.pivot.x=e.pivot.x,s.pivot.y=e.pivot.y),m.numTe=[],m.numSprite=[],u=m.charMap.length,a=0;a<u;a+=1)c=m.charMap[a],r=m.textureName+c,m.numTe[c]=t.Texture.fromFrame(r);for(o=(i=m.numTe[m.charMap[0]]).frame,m.offset=e.offset||o.width,m.symbolOffset=-1,"number"==typeof e.symbolOffset&&(m.symbolOffset=e.symbolOffset),u=m.numCounts,a=0;a<u;a+=1)n=new t.Texture(i,o.clone()),(l=new t.Sprite(n)).anchor.x=m.anchor.x,l.anchor.y=m.anchor.y,m.numSprite[a]=l;s._eventUpdate=s._animChange}clone(e){super.clone();let t=this.custom,n={game:e||this._game,conf:this.conf,isInScene:this.isInScene,name:this.name+".clone."+this.cloneIndex,pos:this.position,pivot:this.pivot,anchor:t.anchor,rect:t.rect,display:t.display,alignType:t.alignType,offsetType:t.offsetType,horiType:t.horiType,vertiType:t.vertiType,textureName:t.textureName,numCounts:t.numCounts,charMap:t.charMap,offset:t.offset,symbolOffset:t.symbolOffset,shift:t.shift,background:t.background,autoHide:t.autoHide,fixVal:t.fixVal,useComma:t.useComma,useDash:t.useDash,useMoney:t.useMoney};return new q(n)}removeFromScene(){super.removeFromScene(),this._game.removeUpdate(this)}transverse(){this.setDisplay(J.DISPLAY.TRANSVERSE)}straight(){this.setDisplay(J.DISPLAY.TRANSVERSE)}setDisplay(e){if(e===J.DISPLAY.TRANSVERSE)this.display=e;else{if(e!==J.DISPLAY.STRAIGHT)return;this.display=e}this.setAlign(this.horiType,this.vertiType)}setBackground(e){this.texture=e}setAnchor(e){if(!e)return;let t,n=this.custom,s=n.anchor,a=n.numSprite.length;for(s.x=e.x,s.y=e.y,t=0;t<a;t+=1)(s=n.numSprite[t].anchor).x=e.x,s.y=e.y}setAlign(e,t){let n=this.custom;n.alignType=J.ALIGN_TYPE.RECT;let s,a,r=n.rect.pos,i={x:r.x,y:r.y},o=n.anchor,l=n.rect.width,c=n.rect.height,u=n.offset,m={w:0,h:0},h=this.children,d=h.length;if(n.lastCnt===d&&n.horiType===e&&n.vertiType===t)return;switch(n.lastCnt=d,n.horiType=e,n.vertiType=t,h.forEach(e=>{let t=e.texture.frame;"."===e.ch||","===e.ch?(m.w-=u,m.h-=u,a&&(m.w+=a.width,m.h+=a.height,a=null),m.w+=t.width,m.h+=t.height,m.w+=2*n.symbolOffset):(m.w+=u,m.h+=u),a=t}),n.horiType){case J.HORI_ALIGN.LEFT:n.display,J.DISPLAY.TRANSVERSE,i.x=r.x;break;case J.HORI_ALIGN.CENTER:n.display===J.DISPLAY.TRANSVERSE?i.x=r.x+.5*l-.5*m.w:i.x=r.x+.5*l;break;case J.HORI_ALIGN.RIGHT:n.display===J.DISPLAY.TRANSVERSE?i.x=r.x+l-m.w:i.x=r.x+l}switch(n.vertiType){case J.VERTI_ALIGN.TOP:i.y=r.y;break;case J.VERTI_ALIGN.CENTER:n.display===J.DISPLAY.TRANSVERSE?i.y=r.y+.5*c:i.y=r.y+.5*c-.5*m.h;break;case J.VERTI_ALIGN.BOTTOM:n.display===J.DISPLAY.TRANSVERSE?i.y=r.y+c:i.y=r.y+c-m.h}let p=0,g={width:0,height:0};for(s=d-1;s>=0;s-=1){let e=h[s],t=e.position,r=e.texture.frame;n.display===J.DISPLAY.TRANSVERSE?(t.x=p+i.x,t.y=i.y):(t.y=p+i.y,t.x=i.x),"."===e.ch||","===e.ch?n.display===J.DISPLAY.TRANSVERSE?(p-=u,p+=g.width,t.x=p+i.x-g.width*o.x+r.width*o.x,p+=r.width+2*n.symbolOffset,t.x+=n.symbolOffset):p+=r.height:p+=u,a=r,g=r}}setAlpha(e){this.children.forEach(t=>{t.alpha=e}),this.custom.alpha=e}set shift(e){this.custom.shift=e}get shift(){return this.custom.shift}set fixVal(e){this.custom.fixVal=e}get fixVal(){return this.custom.fixVal}getValue(){return this.custom.value}setValue(e,t){let n=this,s=n.custom,a=s.event;if(s.currentValue=s.value,s.value=e||0,s.targetValue=e||0,s.currentValue<s.targetValue?s.offsetValue=s.shift:s.currentValue>s.targetValue&&(s.offsetValue=-s.shift),a.begin&&a.begin(n),t)return void n.enable();s.currentValue=s.value;let r,i,o,l=n,c=n.fixValueString(s.currentValue),u=c.length,m=s.alpha,h=s.numSprite.length-1,d=s.numTe[0].frame;for(;h>=0;){u-=1;let e=s.numSprite[h];u>=0?(i=c[u],r=s.numTe[i],e.ch=i,e.alpha=m,r&&((o=e.texture.frame).copy(r.frame),e.texture.frame=o),l.addChild(e)):(e.ch="0",s.autoHide?l.removeChild(e):((o=e.texture.frame).copy(d),e.texture.frame=o,e.alpha=m,l.addChild(e))),h-=1}n.setAlign(s.horiType,s.vertiType)}setEvent(e){let t=this.custom.event;t.begin=e.begin||t.begin,t.end=e.end||t.end,t.changeString=e.changeString||t.changeString}_animChange(e){let t=this,n=t.custom,s=n.event,a=n.offsetValue*e*1e3;a<0?n.currentValue<=n.targetValue?(n.currentValue=n.targetValue,t.disable(),s.end&&s.end(t)):n.currentValue=n.currentValue+a:n.currentValue>=n.targetValue?(n.currentValue=n.targetValue,t.disable(),s.end&&s.end(t)):n.currentValue=n.currentValue+a;let r,i,o,l=t,c=t.fixValueString(n.currentValue),u=n.alpha,m=c.length,h=n.numSprite.length-1,d=n.numTe[0].frame;for(;h>=0;){m-=1;let e=n.numSprite[h];m>=0?(r=c[m],i=n.numTe[r],e.ch=r,e.alpha=u,i&&((o=e.texture.frame).copy(i.frame),e.texture.frame=o),l.addChild(e)):(e.ch="0",n.autoHide?l.removeChild(e):((o=e.texture.frame).copy(d),e.texture.frame=o,e.alpha=u,l.addChild(e))),h-=1}t.setAlign(n.horiType,n.vertiType)}fixValueString(e){let t=this.custom,n=t.event,s=e.toString(),a=s.lastIndexOf(".");a<0&&t.fixVal>0?a=(s+=".").length:a>=0&&0===t.fixVal&&(a=s.lastIndexOf("."),a=(s=s.substr(0,a)).length);for(let e=a+1;e<=a+t.fixVal;e+=1)e>=s.length&&(s=s.concat("0"));let r=s;t.fixVal>0&&s.length>a+t.fixVal&&(r=s.substr(0,a+t.fixVal+1));let i,o,l,c,u=null,m=r.length,h=Math.floor(e);return t.fixVal>0&&(c=r.substr(m-(t.fixVal+1),t.fixVal+1),m=(r=h.toString()).length),u=t.useComma?m>6?(i=r.substr(0,m-6))+","+(o=r.substr(m-6,3))+","+(l=r.substr(m-3,3)):m>3?(i=r.substr(0,m-3))+","+(o=r.substr(m-3,3)):r:r,t.useMoney&&(u="$"+u),t.useDash&&0===t.fixVal&&(u+="_"),t.fixVal>0&&(u+=c),n.changeString&&(u=n.changeString(u)),u}setTextures(e){let n=this.custom;if(n.textureName!==e){let s,a,r,i,o,l,c;for(n.textureName=e,s=0,c=n.charMap.length;s<c;s++)l=n.charMap[s],a=n.textureName+l,n.numTe[l]=t.Texture.fromFrame(a);for(i=(r=n.numTe[n.charMap[0]]).frame,s=0,c=n.numCounts;s<c;s++){let e=new t.Texture(r,i.clone());(o=n.numSprite[s]).texture=e,o.anchor.x=n.anchor.x,o.anchor.y=n.anchor.y}}}enable(){let e=this,t=e.custom;t.enable||(t.enable=!0,e._game.addUpdate(e))}disable(){let e=this,t=e.custom;t.enable&&(t.enable=!1,e._game.removeUpdate(e))}stop(){this.disable()}update(e){this._eventUpdate&&this._eventUpdate(e)}}}(t),function(e){let t=e.PIXI;Q=class extends(j(t.Sprite)){static get TYPE(){return $}constructor(e){super(e.background||t.Texture.EMPTY);let n=this;n._game=e.game,n.conf=e.conf,n.type=$,n.name=e.name,n.objName=e.objName,n.isInScene=e.isInScene,n.value={current:1,offset:1,min:1,max:10,range:9},n.value.range=n.value.max-n.value.min,n.eventScroll=null,n.slider=new t.Sprite(e.slider),n.slider.anchor.x=.5,n.addChild(n.slider),e.pos&&(n.x=e.pos.x||0,n.y=e.pos.y||0),e.anchor&&(n.anchor.x=e.anchor.x||0,n.anchor.y=e.anchor.y||0),n.limit={offset:0,min:.5*n.conf.slider.width,max:n.conf.width-.5*n.conf.slider.width},n.limit.length=n.limit.max-n.limit.min,n.slider.x=n.limit.min,n.slider.value=0,n.limit.offset=n.limit.length/n.value.range,n.hasMove=!1,n.buttonMode=!0,n.interactive=!0,n.obj=null,n.touchstart=n.mousedown=(e=>{let t=parseInt(e.data.global.x);parseInt(e.data.global.y),n.hasMove=!0,n.slider.x=t-n.x,n.slider.x<n.limit.min?n.slider.x=n.limit.min:n.slider.x>=n.limit.max&&(n.slider.x=n.limit.max),n.slider.value=n.slider.x-n.limit.min,n.value.current=n.value.min+n.value.offset*parseInt(n.slider.value/n.limit.offset),n.eventScroll&&n.eventScroll(n.value.current,n)}),n.touchend=n.mouseup=(e=>{parseInt(e.data.global.x),parseInt(e.data.global.y),n.hasMove=!1}),n.slider.buttonMode=!0,n.slider.interactive=!0,n.slider.mousedown=n.slider.touchstart=(()=>{n.hasMove=!0}),n.slider.mouseup=n.slider.mouseupoutside=n.slider.touchend=n.slider.touchendoutside=(()=>{n.hasMove=!1}),n.slider.mousemove=n.slider.touchmove=(e=>{if(0===e.which&&(n.hasMove=!1),n.hasMove){let t={x:parseInt(e.data.global.x),y:parseInt(e.data.global.y)};n.slider.x=t.x-n.x,n.slider.x<n.limit.min?n.slider.x=n.limit.min:n.slider.x>=n.limit.max&&(n.slider.x=n.limit.max),n.slider.value=n.slider.x-n.limit.min,n.value.current=n.value.min+n.value.offset*parseInt(n.slider.value/n.limit.offset),n.eventScroll&&n.eventScroll(n.value.current,n)}})}clone(){return null}setBindScrollEvent(e){this.eventScroll=e}reset(){this.hasMove=!1}setRange(e){"number"==typeof e.current&&(this.value.current=e.current),"number"==typeof e.offset&&(this.value.offset=e.offset),"number"==typeof e.min&&(this.value.min=e.min),"number"==typeof e.max&&(this.value.max=e.max),"number"==typeof e.range&&(this.value.range=e.range),this.value.current<this.value.min?this.value.current=this.value.min:this.value.current>this.value.max&&(this.value.current=this.value.max),this.value.offset=(this.value.max-this.value.min)/this.value.range,this.limit.offset=this.limit.length/this.value.range,this.slider.value=this.limit.offset*(this.value.current-this.value.min),this.slider.x=this.limit.min+this.slider.value,this.eventScroll&&this.eventScroll(this.value.current,this)}setValue(e){e>=this.value.min&&e<=this.value.max&&(this.value.current=e,this.slider.value=this.limit.offset*((this.value.current-this.value.min)/this.value.range),this.slider.x=this.limit.min+this.slider.value,this.eventScroll&&this.eventScroll(this.value.current,this))}getValue(){return this.value.current}}}(t),function(e){let t=e.PIXI;Y=class extends(j(t.Container)){static get TYPE(){return U}static getChild(e,t){let n=null,s=e.spineData.slots,a=-1;return s.some((e,n)=>e.name===t&&(a=n,!0)),a>=0&&(n=e.children[a].children[0]),n}static getRect(e,n){let s=e.getBounds();if(n){let n=new t.Graphics;e.addChild(n),n.x=0,n.y=0,n.lineStyle(1,255,.75),n.beginFill(65291,.15),n.drawRect(.5*-s.width,.5*-s.height,s.width,s.height),n.endFill(),n.lineStyle(1,0),n.moveTo(0,0),n.lineTo(s.width,s.height),n.moveTo(s.width,0),n.lineTo(0,s.height)}return s}constructor(e){super();let n=this,s=e.spineDataGroup,a=e.textureGroup;n._game=e.game,n.conf=e.conf,n.type=U,n.name=e.name,n.objName=e.objName||null,n.isInScene=e.isInScene;let r={};n.custom=r,r.childList=[],r.spineAnimList=[],r.group={},r.spineDataGroup=s,r.textureGroup=a,r.configList=e.configList||e.conf&&e.conf.configList,e.pos&&(n.x=e.pos.x||0,n.y=e.pos.y||0),t.spine&&(r.configList.forEach((e,n)=>{let a,i,o,l;if(i=new t.Sprite(t.Texture.EMPTY),o={x:0,y:0},l=(a=new t.spine.Spine(s[e.dataName])).getLocalBounds(),a.skeleton.setToSetupPose(),a.autoUpdate=!1,a.state.timeScale=0,a.x=.01,a.y=.01,a.childMap={},a.getChild=(e=>a.childMap[e]),a.spineData.slots.forEach((e,t)=>{let n=a.children[t];n&&n.children&&(n=n.children[0],a.childMap[e.name]=n)}),i.name=e.name,i.addChild(a),r.childList[n]=i,e.anchor&&(a.x=-a.width*e.anchor.x+.01,a.y=-a.height*e.anchor.y+.01),o.x=l.x,o.y=l.y,e.fixPosition){let t=e.fixPosition,n=t.offset||{x:0,y:0},s=null;t.childName&&(s=a.getChild(t.childName)),s||(s=a.children[t.childIndex||0].children[0]),l=s.getBounds(),a.x=-l.x+.5*-l.width,a.y=-l.y+.5*-l.height,o.x=a.x+l.x,o.y=a.y+l.y,a.x=a.x+n.x,a.y=a.y+n.y}if(e.debug){let e=new t.Graphics;i.addChild(e),e.x=0,e.y=0,e.lineStyle(1,16711680,.9),e.beginFill(16740363,.1),e.drawRect(a.x+l.x,a.y+l.y,l.width,l.height),e.endFill(),e.lineStyle(0),e.beginFill(0,1),e.drawCircle(o.x,o.y,3),e.endFill(),e.beginFill(16777215,1),e.drawCircle(o.x,o.y,1),e.endFill(),a.children.forEach(e=>{let n=e.children[0];if(n&&n.getBounds||(n=e),n&&n.getBounds){let e=n.getBounds(),s=new t.Graphics;n.addChild(s),s.x=0,s.y=0,s.lineStyle(1,65280,.75),s.beginFill(786288,.15),s.drawRect(.5*-e.width,.5*-e.height,e.width,e.height),s.endFill(),s.lineStyle(0),s.beginFill(0,1),s.drawCircle(0,0,3),s.endFill(),s.beginFill(16777215,1),s.drawCircle(0,0,1),s.endFill()}})}e.name&&(r.group[e.name]={sprite:i,spine:a,entry:null,animConfig:{animationName:e.animationName,timeScale:e.timeScale,loop:e.loop}}),r.spineAnimList.push(a)}),r.configList.forEach(e=>{let n=r.group[e.name].spine;if(n&&e.mask){let s=new t.Sprite(a[e.mask.name]),i=n;if(n.mask=s,e.mask.follow&&(i=r.group[e.mask.follow]),i){let t=i.getLocalBounds();e.mask.local?(s.x=t.x,s.y=t.y):(s.x=0,s.y=0),i.addChild(s)}let o=e.mask.fixPosition;if(o&&i){let e,t=o.offset||{x:0,y:0};o.childName&&(e=i.getChild(o.childName)),e||(e=i.children[o.childIndex||0].children[0]);let n=e.getBounds(),a=i.getBounds(),r=i.getLocalBounds();s.x=r.x+(n.x-a.x)+t.y,s.y=r.y+(n.y-a.y)+t.y}if(e.mask.debug){let e=new t.Graphics,n={x:0,y:0};i&&(n.x=i.x,n.y=i.y,i.parent.addChild(e)),e.x=n.x+s.x,e.y=n.y+s.y,e.lineStyle(1,255,.75),e.beginFill(16740363,.15),e.drawRect(0,0,s.width,s.height),e.endFill(),e.lineStyle(1,0),e.moveTo(0,0),e.lineTo(s.width,s.height),e.moveTo(s.width,0),e.lineTo(0,s.height)}}n&&e.maskList&&e.maskList.forEach(e=>{let s,r,i=new t.Sprite(a[e.name]),o=null;e.followName&&(o=n.getChild(e.followName)),o||(o=n.children[e.follow]&&n.children[e.follow].children[0]),s=o,o=null,e.targetName&&(o=n.getChild(e.targetName)),o||(o=n.children[e.target]&&n.children[e.target].children[0]),(r=o)&&(r.mask=i),s&&(i.x=-s.width/2,i.y=-s.height/2,s.addChild(i))})}))}clone(e){super.clone();let t=this.custom,n={game:e||this._game,conf:this.conf,isInScene:this.isInScene,name:this.name+".clone."+this.cloneIndex,textureGroup:t.textureGroup,spineDataGroup:t.spineDataGroup,configList:t.configList,pos:this.position};return new Y(n)}removeFromScene(){this.parent&&this.parent.removeChild(this),this._game.removeUpdate(this)}getGroup(e){return this.custom.group[e]}getSpine(e){let t,n=this.custom.group[e];return n&&(t=n.spine),t}getEntry(e){let t,n=this.custom.group[e];return n&&(t=n.entry),t}getAnimConfig(e){let t,n=this.custom.group[e];return n&&(t=n.animConfig),t}play(e){let t=this,n=t.custom,s=[];e&&Array.isArray(e)?(n.childList.forEach(e=>{t.removeChild(e)}),e.forEach(e=>{let a=n.group[e.name];if(a){let n=a.spine,r=a.sprite,i=a.animConfig;n&&(a.entry=n.state.setAnimation(0,e.animationName||i.animationName,e.loop),n.update(0),n.state.timeScale=e.timeScale||i.timeScale,s.push(n)),t.addChild(r)}})):Object.getOwnPropertyNames(n.group).forEach(e=>{let a=n.group[e];if(a){let e=a.spine,n=a.sprite,r=a.animConfig;e&&(a.entry=e.state.setAnimation(0,r.animationName,r.loop),e.update(0),e.state.timeScale=r.timeScale,s.push(e)),t.addChild(n)}}),n.spineAnimList=s,t._game.addUpdate(t)}pause(){let e=this.custom;Object.getOwnPropertyNames(e.group).forEach(t=>{let n=e.group[t].spine;n&&(n.state.timeScale=0)})}resume(){let e=this.custom;Object.getOwnPropertyNames(e.group).forEach(t=>{let n=e.group[t],s=n.spine,a=n.animConfig;s&&(s.state.timeScale=a.timeScale)})}stop(e){let t=this,n=t.custom;e&&Array.isArray(e)?e.forEach(e=>{let t=n.group[e.name],s=t.spine,a=t.animConfig;a.animationName=e.animationName||a.animationName,s&&(s.state.timeScale=0)}):(Object.getOwnPropertyNames(n.group).forEach(e=>{let t=n.group[e].spine;t&&(t.state.timeScale=0)}),t._game.removeUpdate(t))}update(e){this.custom.spineAnimList.forEach(t=>{t.update(e)})}}}(t),function(e){let t=e.PIXI;z=class extends(j(t.Sprite)){static get TYPE(){return X}static setFactory(e){H=e}static getFactory(){return H}constructor(e){super(t.Texture.EMPTY);let n=this;n._game=e.game,n.conf=e.conf,n.type=X,n.name=e.name,n.objName=e.objName||null,n.resource={},n.animation={timeScale:1},n.isInScene=e.isInScene,n.isUpdate=!1,e.animation&&(n.animation.name=e.animation.name,n.animation.timeScale=e.animation.timeScale),e.resource&&(n.resource.name=e.resource.name),e.pos&&(n.x=e.pos.x||0,n.y=e.pos.y||0),e.anchor&&(n.anchor.x=e.anchor.x||.5,n.anchor.y=e.anchor.y||.5);let s=H&&H.buildArmature(n.resource.name);if(s){let e=s.display;e.scale.set(1,1),n.addChild(e)}n.armature=s,n.state=null}clone(e){super.clone();let t=this.cloneIndex,n={game:e||this._game,conf:this.conf,isInScene:this.isInScene,resource:this.resource,animation:this.animation,name:this.name+".clone."+t,pos:this.sprite.position};return new z(n)}removeFromScene(){let e=this;e.parent&&e.parent.removeChild(e),e.stop()}play(e){let t=this.armature,n=this.animation;t&&(n.name=e||n.name,this.state=t.animation.play(n.name),this.state&&(this.state.timeScale=n.timeScale),this.isUpdate||(this.isUpdate=!0,this._game.addUpdate(this)))}stop(){this.armature&&this.isUpdate&&(this.isUpdate=!1,this._game.removeUpdate(this))}set timeScale(e){this.animation.timeScale=e,this.state&&(this.state.timeScale=e)}get timeScale(){return this.animation.timeScale}update(e){let t=this.armature;t&&t.advanceTime(e)}}}(t),function(e){let t=e.PIXI;Z=class extends(j(t.Text)){static get TYPE(){return W}constructor(e){super(e.text||"test used");let t=this;t._game=e.game,t.conf=e.conf,t.type=W,t.name=e.name,t.objName=e.objName,t.isInScene=e.isInScene;let n={fill:"#FFFFFF",stroke:"#000000",strokeThickness:0};e.style&&(n.fill=e.style.fill||"#FFFFFF",n.stroke=e.style.stroke||"#000000",n.strokeThickness=e.style.strokeThickness||0),t.style=n,e.pos&&(t.x=e.pos.x,t.y=e.pos.y),e.anchor&&(t.anchor.x=e.anchor.x||0,t.anchor.y=e.anchor.y||0)}clone(e){super.clone();let t={game:e||this._game,conf:this.conf,isInScene:this.isInScene,name:this.name+".clone."+this.cloneIndex,pos:this.position,anchor:this.anchor,style:this.style,text:this.text};return new Z(t)}}}(t),function(e){let t=e.PIXI;ne=class extends(j(t.particles.ParticleContainer)){static get TYPE(){return ee}static setConfigMap(e){te=e||te}static getConfig(e){return te[e]}constructor(e){super();let n,s=this,a={};s.custom=a,s._game=e.game,s.conf=e.conf,s.type=ee,s.name=e.name,s.objName=e.objName,s.isInScene=e.isInScene;let r=e.setting;a.type=r.type,a.config=r.config,a.art=r.art,a.ownerPos=new t.Point(0,0),s.setProperties({scale:!0,position:!0,rotation:!0,uvs:!0,alpha:!0}),t.particles&&t.particles.Emitter&&(n=new t.particles.Emitter(s,a.art,a.config)),n&&("path"===a.type?n.particleConstructor=t.particles.PathParticle:"anim"===a.type&&(n.particleConstructor=t.particles.AnimatedParticle)),e.pos&&(s.x=e.pos.x,s.y=e.pos.y),s.emitter=n}clone(e){super.clone();let t=this.cloneIndex,n=this.custom,s={game:e||this._game,conf:this.conf,isInScene:this.isInScene,name:this.name+".clone."+t,pos:this.position,setting:{type:n.type,config:n.config,art:n.art}};return new ne(s)}removeFromScene(){super.removeFromScene(),this._game.removeUpdate(this)}play(e,t=0){let n=this,s=n.emitter,a=e||n.custom.ownerPos;s&&(s.emit=!0,s.resetPositionTracking(),s.updateOwnerPos(a.x,a.y),s.update(t),n._game.addUpdate(n))}stop(){this._game.removeUpdate(this)}update(e){this.emitter.update(e)}}}(t),dt.Animation=F,dt.Button=k,dt.Group=D,dt.Image=V,dt.Number=q,dt.Scrollbar=Q,dt.Spine=Y,dt.Bone=z,dt.Text=Z,dt.Particle=ne,ut(t)),I(),S(),n(t),gt=!0,e("!! init finish !!")}(null)})}var yt={init:ft,updateManager:T,Lobby:O,game:mt,scene:ht,ui:dt,components:pt,client:a};return e.Lobby=O,e.client=a,e.components=pt,e.default=yt,e.game=mt,e.init=ft,e.scene=ht,e.ui=dt,e.updateManager=T,e}({});